window.__require=function t(e,n,o){function r(i,s){if(!n[i]){if(!e[i]){var c=i.split("/");if(c=c[c.length-1],!e[c]){var u="function"==typeof __require&&__require;if(!s&&u)return u(c,!0);if(a)return a(c,!0);throw new Error("Cannot find module '"+i+"'")}i=c}var l=n[i]={exports:{}};e[i][0].call(l.exports,function(t){return r(e[i][1][t]||t)},l,l.exports,t,e,n,o)}return n[i].exports}for(var a="function"==typeof __require&&__require,i=0;i<o.length;i++)r(o[i]);return r}({LuckDrawPanel:[function(t,e,n){"use strict";cc._RF.push(e,"2e73d3pEHZMUJV5PX/Ej6n+","LuckDrawPanel");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=this&&this.__decorate||function(t,e,n,o){var r,a=arguments.length,i=a<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(i=(a<3?r(i):a>3?r(e,n,i):r(e,n))||i);return a>3&&i&&Object.defineProperty(e,n,i),i};Object.defineProperty(n,"__esModule",{value:!0}),n.LuckDrawPanel=void 0;var i=t("../common/src/UIMgr"),s=t("../config/GameDataCenter"),c=t("../config/GConfig"),u=t("../framework/Random"),l=t("../framework/UIManager"),p=cc._decorator,d=p.ccclass,m=p.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mask=null,e.panel=null,e.rotaryTable=null,e.surplusTimes=null,e.luckDrawBtn=null,e.tips=null,e.rotationIndex=[325,250,180,110,35],e.prizeConfig=[1,2,4,5,10],e.resultPoint=0,e.isClickBtn=!1,e}return r(e,t),e.prototype.onEnable=function(){this.node.zIndex=1e3,i.UIMgr.setShowAnimation(this.panel,this.mask),cc.systemEvent.on(c.GameEvents.M_Updata_Luck_Draw_Times,this.updataSurplusTimes,this),cc.systemEvent.on(c.GameEvents.M_Updata_Luck_Draw_Btn,this.checkVideoBtnState,this)},e.prototype.onDisable=function(){cc.systemEvent.off(c.GameEvents.M_Updata_Luck_Draw_Times,this.updataSurplusTimes,this),cc.systemEvent.off(c.GameEvents.M_Updata_Luck_Draw_Btn,this.checkVideoBtnState,this)},e.prototype.start=function(){this.updataSurplusTimes(),this.checkVideoBtnState()},e.prototype.onClickClose=function(){cc.systemEvent.emit(c.GameEvents.S_Play_Sound,c.GameSounds.S_Btn_Click),this.isClickBtn||(cc.systemEvent.emit(c.GameEvents.M_Luck_Draw_Btn_Count_Down),i.UIMgr.setHideAnimation(this.panel,this.mask,function(){l.UIManager.close("luckDraw/LuckDrawPanel",!0)}))},e.prototype.onClickPlay=function(){var t=this;cc.systemEvent.emit(c.GameEvents.S_Play_Sound,c.GameSounds.S_Btn_Click),SDK.shipin(function(){t.isClickBtn||(t.isClickBtn=!0,s.GameDataCenter.isTodayFirstTurn||cc.sys.isBrowser,t.getCoronaResult())})},e.prototype.getCoronaResult=function(){s.GameDataCenter.isTodayFirstTurn?this.resultPoint=4:this.resultPoint=this.getRandomDrawIndex(),this.startRoll()},e.prototype.startRoll=function(){var t=this;cc.tween(this.rotaryTable).to(4,{angle:-(this.rotationIndex[this.resultPoint]+2520)},{easing:"sineInOut"}).delay(.5).call(function(){t.rotaryTable.angle+=2520,t.rollEnded()}).start()},e.prototype.rollEnded=function(){this.isClickBtn=!1,s.GameDataCenter.luckDrawTimes--,s.GameDataCenter.isTodayFirstTurn&&(s.GameDataCenter.isTodayFirstTurn=!1),s.GameDataCenter.isCountDown=!0,s.GameDataCenter.curPrizeAmount=this.prizeConfig[this.resultPoint],cc.assetManager.getBundle("prize")?l.UIManager.open("prize/PrizePanel"):cc.assetManager.loadBundle("prize",function(t){if(t)return console.log("\u52a0\u8f7dprize bundle \u5931\u8d25:",t);l.UIManager.open("prize/PrizePanel")})},e.prototype.updataSurplusTimes=function(){this.surplusTimes.string=""+s.GameDataCenter.luckDrawTimes,this.luckDrawBtn.active=!(s.GameDataCenter.luckDrawTimes<=0),this.tips.active=s.GameDataCenter.luckDrawTimes<=0},e.prototype.checkVideoBtnState=function(){this.luckDrawBtn.getChildByName("icon_video").active=!s.GameDataCenter.isTodayFirstTurn,this.luckDrawBtn.getChildByName("txt").x=s.GameDataCenter.isTodayFirstTurn?10:43},e.prototype.videoCallback=function(t){t||this.getCoronaResult()},e.prototype.getRandomDrawIndex=function(){return u.Random.randomNumber(1,5)-1},a([m({type:cc.Node,tooltip:"\u906e\u7f69"})],e.prototype,"mask",void 0),a([m({type:cc.Node,tooltip:"\u9762\u677f"})],e.prototype,"panel",void 0),a([m({type:cc.Node,tooltip:"\u8f6c\u76d8"})],e.prototype,"rotaryTable",void 0),a([m({type:cc.Label,tooltip:"\u5269\u4f59\u6b21\u6570"})],e.prototype,"surplusTimes",void 0),a([m({type:cc.Node,tooltip:"\u62bd\u5956\u6309\u94ae"})],e.prototype,"luckDrawBtn",void 0),a([m({type:cc.Node,tooltip:"\u63d0\u793a"})],e.prototype,"tips",void 0),a([d],e)}(cc.Component);n.LuckDrawPanel=f,cc._RF.pop()},{"../common/src/UIMgr":void 0,"../config/GConfig":void 0,"../config/GameDataCenter":void 0,"../framework/Random":void 0,"../framework/UIManager":void 0}]},{},["LuckDrawPanel"]);