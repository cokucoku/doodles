window.__require=function t(e,i,o){function n(a,s){if(!i[a]){if(!e[a]){var c=a.split("/");if(c=c[c.length-1],!e[c]){var p="function"==typeof __require&&__require;if(!s&&p)return p(c,!0);if(r)return r(c,!0);throw new Error("Cannot find module '"+a+"'")}a=c}var u=i[a]={exports:{}};e[a][0].call(u.exports,function(t){return n(e[a][1][t]||t)},u,u.exports,t,e,i,o)}return i[a].exports}for(var r="function"==typeof __require&&__require,a=0;a<o.length;a++)n(o[a]);return n}({FirstDayDiscountPanel:[function(t,e,i){"use strict";cc._RF.push(e,"902dbd+pxlNxoczwAsBFdvq","FirstDayDiscountPanel");var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),r=this&&this.__decorate||function(t,e,i,o){var n,r=arguments.length,a=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(r<3?n(a):r>3?n(e,i,a):n(e,i))||a);return r>3&&a&&Object.defineProperty(e,i,a),a};Object.defineProperty(i,"__esModule",{value:!0}),i.FirstDayDiscountPanel=void 0;var a=t("../common/src/UIMgr"),s=t("../common/src/Utils"),c=t("../config/GameDataCenter"),p=t("../config/GConfig"),u=t("../framework/DateTime"),l=t("../framework/Store"),m=t("../framework/UIManager"),d=cc._decorator,f=d.ccclass,y=d.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mask=null,e.panel=null,e.powerIcon=null,e.prize=null,e.timeNode=null,e.videoBtn=null,e.prizes=0,e.type=0,e.timeKey="discountTimeKey",e.curTimes=0,e.timeLab=null,e}return n(e,t),e.prototype.onEnable=function(){this.node.zIndex=1e3,a.UIMgr.setShowAnimation(this.panel,this.mask)},e.prototype.start=function(){this.initPanel()},e.prototype.onClickClose=function(){a.UIMgr.setHideAnimation(this.panel,this.mask,function(){m.UIManager.close("discount/FirstDayDiscountPanel",!0)})},e.prototype.onClickGain=function(){var t=this;SDK.shipin(function(){t.gainPrize()})},e.prototype.initPanel=function(){c.GameDataCenter.discountData.isFirstReceive?(this.powerIcon.y=80,this.timeNode.active=!0,this.videoBtn.y=-100,this.type=2,this.prizes=4,this.getTime()):(this.powerIcon.y=60,this.timeNode.active=!1,this.videoBtn.y=-70,this.type=1,this.prizes=3),this.prize.string="x"+this.prizes},e.prototype.gainPrize=function(){if(1==this.type)(t=c.GameDataCenter.discountData).isFirstReceive=!0,c.GameDataCenter.discountData=t;else if(2==this.type){var t;(t=c.GameDataCenter.discountData).isTwoReceive=!0,t.isShow=!1,c.GameDataCenter.discountData=t}cc.systemEvent.emit(p.GameEvents.M_Updata_Discount_Btn),c.GameDataCenter.curPrizeAmount=this.prizes,cc.assetManager.getBundle("prize")?(m.UIManager.close("discount/FirstDayDiscountPanel",!0),m.UIManager.open("prize/PrizePanel")):cc.assetManager.loadBundle("prize",function(t){if(t)return console.log("\u52a0\u8f7dprize bundle \u5931\u8d25:",t);m.UIManager.close("discount/FirstDayDiscountPanel",!0),m.UIManager.open("prize/PrizePanel")})},e.prototype.getTime=function(){this.timeLab=this.timeNode.getChildByName("txt_time").getComponent(cc.Label);var t=u.DateTime.getTimeStamp(!0),e=l.Store.get(this.timeKey);e||(e=t+864e5,l.Store.set(this.timeKey,e)),this.curTimes=u.DateTime.getInervalSecond(new Date(t),new Date(e)),this.schedule(this.onCountDownEvent,1),this.onCountDownEvent()},e.prototype.onCountDownEvent=function(){if(this.curTimes--,this.timeLab.string=s.Utils.formatTimeString(this.curTimes),this.curTimes<=0){this.unschedule(this.onCountDownEvent),l.Store.remove(this.timeKey);var t=c.GameDataCenter.discountData;t.isShow=!1,c.GameDataCenter.discountData=t,cc.systemEvent.emit(p.GameEvents.M_Updata_Discount_Btn),m.UIManager.close("discount/FirstDayDiscountPanel",!0)}},r([y({type:cc.Node,tooltip:"\u906e\u7f69"})],e.prototype,"mask",void 0),r([y({type:cc.Node,tooltip:"\u9762\u677f"})],e.prototype,"panel",void 0),r([y({type:cc.Node,tooltip:"\u4f53\u529bicon"})],e.prototype,"powerIcon",void 0),r([y({type:cc.Label,tooltip:"\u5956\u52b1\u6570\u91cf"})],e.prototype,"prize",void 0),r([y({type:cc.Node,tooltip:"\u65f6\u95f4\u8282\u70b9"})],e.prototype,"timeNode",void 0),r([y({type:cc.Node,tooltip:"\u89c6\u9891\u6309\u94ae"})],e.prototype,"videoBtn",void 0),r([f],e)}(cc.Component);i.FirstDayDiscountPanel=h,cc._RF.pop()},{"../common/src/UIMgr":void 0,"../common/src/Utils":void 0,"../config/GConfig":void 0,"../config/GameDataCenter":void 0,"../framework/DateTime":void 0,"../framework/Store":void 0,"../framework/UIManager":void 0}]},{},["FirstDayDiscountPanel"]);