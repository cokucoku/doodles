/*

 Copyright 2010-2021 Three.js Authors
 SPDX-License-Identifier: MIT
*/
var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.arrayIteratorImpl=function(p){var N=0;return function(){return N<p.length?{done:!1,value:p[N++]}:{done:!0}}};$jscomp.arrayIterator=function(p){return{next:$jscomp.arrayIteratorImpl(p)}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;$jscomp.ISOLATE_POLYFILLS=!1;$jscomp.FORCE_POLYFILL_PROMISE=!1;$jscomp.FORCE_POLYFILL_PROMISE_WHEN_NO_UNHANDLED_REJECTION=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(p,N,R){if(p==Array.prototype||p==Object.prototype)return p;p[N]=R.value;return p};$jscomp.getGlobal=function(p){p=["object"==typeof globalThis&&globalThis,p,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var N=0;N<p.length;++N){var R=p[N];if(R&&R.Math==Math)return R}throw Error("Cannot find global object");};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.IS_SYMBOL_NATIVE="function"===typeof Symbol&&"symbol"===typeof Symbol("x");$jscomp.TRUST_ES6_POLYFILLS=!$jscomp.ISOLATE_POLYFILLS||$jscomp.IS_SYMBOL_NATIVE;$jscomp.polyfills={};$jscomp.propertyToPolyfillSymbol={};$jscomp.POLYFILL_PREFIX="$jscp$";var $jscomp$lookupPolyfilledValue=function(p,N,R){if(!R||null!=p){R=$jscomp.propertyToPolyfillSymbol[N];if(null==R)return p[N];R=p[R];return void 0!==R?R:p[N]}};
$jscomp.polyfill=function(p,N,R,fa){N&&($jscomp.ISOLATE_POLYFILLS?$jscomp.polyfillIsolated(p,N,R,fa):$jscomp.polyfillUnisolated(p,N,R,fa))};$jscomp.polyfillUnisolated=function(p,N,R,fa){R=$jscomp.global;p=p.split(".");for(fa=0;fa<p.length-1;fa++){var ka=p[fa];if(!(ka in R))return;R=R[ka]}p=p[p.length-1];fa=R[p];N=N(fa);N!=fa&&null!=N&&$jscomp.defineProperty(R,p,{configurable:!0,writable:!0,value:N})};
$jscomp.polyfillIsolated=function(p,N,R,fa){var ka=p.split(".");p=1===ka.length;fa=ka[0];fa=!p&&fa in $jscomp.polyfills?$jscomp.polyfills:$jscomp.global;for(var cb=0;cb<ka.length-1;cb++){var ia=ka[cb];if(!(ia in fa))return;fa=fa[ia]}ka=ka[ka.length-1];R=$jscomp.IS_SYMBOL_NATIVE&&"es6"===R?fa[ka]:null;N=N(R);null!=N&&(p?$jscomp.defineProperty($jscomp.polyfills,ka,{configurable:!0,writable:!0,value:N}):N!==R&&(void 0===$jscomp.propertyToPolyfillSymbol[ka]&&(R=1E9*Math.random()>>>0,$jscomp.propertyToPolyfillSymbol[ka]=
$jscomp.IS_SYMBOL_NATIVE?$jscomp.global.Symbol(ka):$jscomp.POLYFILL_PREFIX+R+"$"+ka),$jscomp.defineProperty(fa,$jscomp.propertyToPolyfillSymbol[ka],{configurable:!0,writable:!0,value:N})))};$jscomp.initSymbol=function(){};
$jscomp.polyfill("Symbol",function(p){if(p)return p;var N=function(cb,ia){this.$jscomp$symbol$id_=cb;$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:ia})};N.prototype.toString=function(){return this.$jscomp$symbol$id_};var R="jscomp_symbol_"+(1E9*Math.random()>>>0)+"_",fa=0,ka=function(cb){if(this instanceof ka)throw new TypeError("Symbol is not a constructor");return new N(R+(cb||"")+"_"+fa++,cb)};return ka},"es6","es3");
$jscomp.polyfill("Symbol.iterator",function(p){if(p)return p;p=Symbol("Symbol.iterator");for(var N="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),R=0;R<N.length;R++){var fa=$jscomp.global[N[R]];"function"===typeof fa&&"function"!=typeof fa.prototype[p]&&$jscomp.defineProperty(fa.prototype,p,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}})}return p},"es6",
"es3");$jscomp.iteratorPrototype=function(p){p={next:p};p[Symbol.iterator]=function(){return this};return p};$jscomp.createTemplateTagFirstArg=function(p){return p.raw=p};$jscomp.createTemplateTagFirstArgWithRaw=function(p,N){p.raw=N;return p};$jscomp.makeIterator=function(p){var N="undefined"!=typeof Symbol&&Symbol.iterator&&p[Symbol.iterator];if(N)return N.call(p);if("number"==typeof p.length)return $jscomp.arrayIterator(p);throw Error(String(p)+" is not an iterable or ArrayLike");};
$jscomp.arrayFromIterator=function(p){for(var N,R=[];!(N=p.next()).done;)R.push(N.value);return R};$jscomp.arrayFromIterable=function(p){return p instanceof Array?p:$jscomp.arrayFromIterator($jscomp.makeIterator(p))};$jscomp.owns=function(p,N){return Object.prototype.hasOwnProperty.call(p,N)};
$jscomp.assign=$jscomp.TRUST_ES6_POLYFILLS&&"function"==typeof Object.assign?Object.assign:function(p,N){for(var R=1;R<arguments.length;R++){var fa=arguments[R];if(fa)for(var ka in fa)$jscomp.owns(fa,ka)&&(p[ka]=fa[ka])}return p};$jscomp.polyfill("Object.assign",function(p){return p||$jscomp.assign},"es6","es3");$jscomp.objectCreate=$jscomp.ASSUME_ES5||"function"==typeof Object.create?Object.create:function(p){var N=function(){};N.prototype=p;return new N};
$jscomp.getConstructImplementation=function(){function p(){function R(){}new R;Reflect.construct(R,[],function(){});return new R instanceof R}if($jscomp.TRUST_ES6_POLYFILLS&&"undefined"!=typeof Reflect&&Reflect.construct){if(p())return Reflect.construct;var N=Reflect.construct;return function(R,fa,ka){R=N(R,fa);ka&&Reflect.setPrototypeOf(R,ka.prototype);return R}}return function(R,fa,ka){void 0===ka&&(ka=R);ka=$jscomp.objectCreate(ka.prototype||Object.prototype);return Function.prototype.apply.call(R,
ka,fa)||ka}};$jscomp.construct={valueOf:$jscomp.getConstructImplementation}.valueOf();$jscomp.underscoreProtoCanBeSet=function(){var p={a:!0},N={};try{return N.__proto__=p,N.a}catch(R){}return!1};$jscomp.setPrototypeOf=$jscomp.TRUST_ES6_POLYFILLS&&"function"==typeof Object.setPrototypeOf?Object.setPrototypeOf:$jscomp.underscoreProtoCanBeSet()?function(p,N){p.__proto__=N;if(p.__proto__!==N)throw new TypeError(p+" is not extensible");return p}:null;
$jscomp.inherits=function(p,N){p.prototype=$jscomp.objectCreate(N.prototype);p.prototype.constructor=p;if($jscomp.setPrototypeOf){var R=$jscomp.setPrototypeOf;R(p,N)}else for(R in N)if("prototype"!=R)if(Object.defineProperties){var fa=Object.getOwnPropertyDescriptor(N,R);fa&&Object.defineProperty(p,R,fa)}else p[R]=N[R];p.superClass_=N.prototype};$jscomp.generator={};
$jscomp.generator.ensureIteratorResultIsObject_=function(p){if(!(p instanceof Object))throw new TypeError("Iterator result "+p+" is not an object");};$jscomp.generator.Context=function(){this.isRunning_=!1;this.yieldAllIterator_=null;this.yieldResult=void 0;this.nextAddress=1;this.finallyAddress_=this.catchAddress_=0;this.finallyContexts_=this.abruptCompletion_=null};
$jscomp.generator.Context.prototype.start_=function(){if(this.isRunning_)throw new TypeError("Generator is already running");this.isRunning_=!0};$jscomp.generator.Context.prototype.stop_=function(){this.isRunning_=!1};$jscomp.generator.Context.prototype.jumpToErrorHandler_=function(){this.nextAddress=this.catchAddress_||this.finallyAddress_};$jscomp.generator.Context.prototype.next_=function(p){this.yieldResult=p};
$jscomp.generator.Context.prototype.throw_=function(p){this.abruptCompletion_={exception:p,isException:!0};this.jumpToErrorHandler_()};$jscomp.generator.Context.prototype.return=function(p){this.abruptCompletion_={return:p};this.nextAddress=this.finallyAddress_};$jscomp.generator.Context.prototype.jumpThroughFinallyBlocks=function(p){this.abruptCompletion_={jumpTo:p};this.nextAddress=this.finallyAddress_};$jscomp.generator.Context.prototype.yield=function(p,N){this.nextAddress=N;return{value:p}};
$jscomp.generator.Context.prototype.yieldAll=function(p,N){p=$jscomp.makeIterator(p);var R=p.next();$jscomp.generator.ensureIteratorResultIsObject_(R);if(R.done)this.yieldResult=R.value,this.nextAddress=N;else return this.yieldAllIterator_=p,this.yield(R.value,N)};$jscomp.generator.Context.prototype.jumpTo=function(p){this.nextAddress=p};$jscomp.generator.Context.prototype.jumpToEnd=function(){this.nextAddress=0};
$jscomp.generator.Context.prototype.setCatchFinallyBlocks=function(p,N){this.catchAddress_=p;void 0!=N&&(this.finallyAddress_=N)};$jscomp.generator.Context.prototype.setFinallyBlock=function(p){this.catchAddress_=0;this.finallyAddress_=p||0};$jscomp.generator.Context.prototype.leaveTryBlock=function(p,N){this.nextAddress=p;this.catchAddress_=N||0};
$jscomp.generator.Context.prototype.enterCatchBlock=function(p){this.catchAddress_=p||0;p=this.abruptCompletion_.exception;this.abruptCompletion_=null;return p};$jscomp.generator.Context.prototype.enterFinallyBlock=function(p,N,R){R?this.finallyContexts_[R]=this.abruptCompletion_:this.finallyContexts_=[this.abruptCompletion_];this.catchAddress_=p||0;this.finallyAddress_=N||0};
$jscomp.generator.Context.prototype.leaveFinallyBlock=function(p,N){N=this.finallyContexts_.splice(N||0)[0];if(N=this.abruptCompletion_=this.abruptCompletion_||N){if(N.isException)return this.jumpToErrorHandler_();void 0!=N.jumpTo&&this.finallyAddress_<N.jumpTo?(this.nextAddress=N.jumpTo,this.abruptCompletion_=null):this.nextAddress=this.finallyAddress_}else this.nextAddress=p};$jscomp.generator.Context.prototype.forIn=function(p){return new $jscomp.generator.Context.PropertyIterator(p)};
$jscomp.generator.Context.PropertyIterator=function(p){this.object_=p;this.properties_=[];for(var N in p)this.properties_.push(N);this.properties_.reverse()};$jscomp.generator.Context.PropertyIterator.prototype.getNext=function(){for(;0<this.properties_.length;){var p=this.properties_.pop();if(p in this.object_)return p}return null};$jscomp.generator.Engine_=function(p){this.context_=new $jscomp.generator.Context;this.program_=p};
$jscomp.generator.Engine_.prototype.next_=function(p){this.context_.start_();if(this.context_.yieldAllIterator_)return this.yieldAllStep_(this.context_.yieldAllIterator_.next,p,this.context_.next_);this.context_.next_(p);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.return_=function(p){this.context_.start_();var N=this.context_.yieldAllIterator_;if(N)return this.yieldAllStep_("return"in N?N["return"]:function(R){return{value:R,done:!0}},p,this.context_.return);this.context_.return(p);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.throw_=function(p){this.context_.start_();if(this.context_.yieldAllIterator_)return this.yieldAllStep_(this.context_.yieldAllIterator_["throw"],p,this.context_.next_);this.context_.throw_(p);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.yieldAllStep_=function(p,N,R){try{var fa=p.call(this.context_.yieldAllIterator_,N);$jscomp.generator.ensureIteratorResultIsObject_(fa);if(!fa.done)return this.context_.stop_(),fa;var ka=fa.value}catch(cb){return this.context_.yieldAllIterator_=null,this.context_.throw_(cb),this.nextStep_()}this.context_.yieldAllIterator_=null;R.call(this.context_,ka);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.nextStep_=function(){for(;this.context_.nextAddress;)try{var p=this.program_(this.context_);if(p)return this.context_.stop_(),{value:p.value,done:!1}}catch(N){this.context_.yieldResult=void 0,this.context_.throw_(N)}this.context_.stop_();if(this.context_.abruptCompletion_){p=this.context_.abruptCompletion_;this.context_.abruptCompletion_=null;if(p.isException)throw p.exception;return{value:p.return,done:!0}}return{value:void 0,done:!0}};
$jscomp.generator.Generator_=function(p){this.next=function(N){return p.next_(N)};this.throw=function(N){return p.throw_(N)};this.return=function(N){return p.return_(N)};this[Symbol.iterator]=function(){return this}};$jscomp.generator.createGenerator=function(p,N){N=new $jscomp.generator.Generator_(new $jscomp.generator.Engine_(N));$jscomp.setPrototypeOf&&p.prototype&&$jscomp.setPrototypeOf(N,p.prototype);return N};
$jscomp.asyncExecutePromiseGenerator=function(p){function N(fa){return p.next(fa)}function R(fa){return p.throw(fa)}return new Promise(function(fa,ka){function cb(ia){ia.done?fa(ia.value):Promise.resolve(ia.value).then(N,R).then(cb,ka)}cb(p.next())})};$jscomp.asyncExecutePromiseGeneratorFunction=function(p){return $jscomp.asyncExecutePromiseGenerator(p())};$jscomp.asyncExecutePromiseGeneratorProgram=function(p){return $jscomp.asyncExecutePromiseGenerator(new $jscomp.generator.Generator_(new $jscomp.generator.Engine_(p)))};
$jscomp.polyfill("Reflect",function(p){return p?p:{}},"es6","es3");$jscomp.polyfill("Reflect.construct",function(p){return $jscomp.construct},"es6","es3");$jscomp.polyfill("Reflect.setPrototypeOf",function(p){if(p)return p;if($jscomp.setPrototypeOf){var N=$jscomp.setPrototypeOf;return function(R,fa){try{return N(R,fa),!0}catch(ka){return!1}}}return null},"es6","es5");
$jscomp.polyfill("Promise",function(p){function N(){this.batch_=null}function R(ia){return ia instanceof ka?ia:new ka(function(Na,oa){Na(ia)})}if(p&&(!($jscomp.FORCE_POLYFILL_PROMISE||$jscomp.FORCE_POLYFILL_PROMISE_WHEN_NO_UNHANDLED_REJECTION&&"undefined"===typeof $jscomp.global.PromiseRejectionEvent)||!$jscomp.global.Promise||-1===$jscomp.global.Promise.toString().indexOf("[native code]")))return p;N.prototype.asyncExecute=function(ia){if(null==this.batch_){this.batch_=[];var Na=this;this.asyncExecuteFunction(function(){Na.executeBatch_()})}this.batch_.push(ia)};
var fa=$jscomp.global.setTimeout;N.prototype.asyncExecuteFunction=function(ia){fa(ia,0)};N.prototype.executeBatch_=function(){for(;this.batch_&&this.batch_.length;){var ia=this.batch_;this.batch_=[];for(var Na=0;Na<ia.length;++Na){var oa=ia[Na];ia[Na]=null;try{oa()}catch(sa){this.asyncThrow_(sa)}}}this.batch_=null};N.prototype.asyncThrow_=function(ia){this.asyncExecuteFunction(function(){throw ia;})};var ka=function(ia){this.state_=0;this.result_=void 0;this.onSettledCallbacks_=[];this.isRejectionHandled_=
!1;var Na=this.createResolveAndReject_();try{ia(Na.resolve,Na.reject)}catch(oa){Na.reject(oa)}};ka.prototype.createResolveAndReject_=function(){function ia(sa){return function(xa){oa||(oa=!0,sa.call(Na,xa))}}var Na=this,oa=!1;return{resolve:ia(this.resolveTo_),reject:ia(this.reject_)}};ka.prototype.resolveTo_=function(ia){if(ia===this)this.reject_(new TypeError("A Promise cannot resolve to itself"));else if(ia instanceof ka)this.settleSameAsPromise_(ia);else{a:switch(typeof ia){case "object":var Na=
null!=ia;break a;case "function":Na=!0;break a;default:Na=!1}Na?this.resolveToNonPromiseObj_(ia):this.fulfill_(ia)}};ka.prototype.resolveToNonPromiseObj_=function(ia){var Na=void 0;try{Na=ia.then}catch(oa){this.reject_(oa);return}"function"==typeof Na?this.settleSameAsThenable_(Na,ia):this.fulfill_(ia)};ka.prototype.reject_=function(ia){this.settle_(2,ia)};ka.prototype.fulfill_=function(ia){this.settle_(1,ia)};ka.prototype.settle_=function(ia,Na){if(0!=this.state_)throw Error("Cannot settle("+ia+
", "+Na+"): Promise already settled in state"+this.state_);this.state_=ia;this.result_=Na;2===this.state_&&this.scheduleUnhandledRejectionCheck_();this.executeOnSettledCallbacks_()};ka.prototype.scheduleUnhandledRejectionCheck_=function(){var ia=this;fa(function(){if(ia.notifyUnhandledRejection_()){var Na=$jscomp.global.console;"undefined"!==typeof Na&&Na.error(ia.result_)}},1)};ka.prototype.notifyUnhandledRejection_=function(){if(this.isRejectionHandled_)return!1;var ia=$jscomp.global.CustomEvent,
Na=$jscomp.global.Event,oa=$jscomp.global.dispatchEvent;if("undefined"===typeof oa)return!0;"function"===typeof ia?ia=new ia("unhandledrejection",{cancelable:!0}):"function"===typeof Na?ia=new Na("unhandledrejection",{cancelable:!0}):(ia=$jscomp.global.document.createEvent("CustomEvent"),ia.initCustomEvent("unhandledrejection",!1,!0,ia));ia.promise=this;ia.reason=this.result_;return oa(ia)};ka.prototype.executeOnSettledCallbacks_=function(){if(null!=this.onSettledCallbacks_){for(var ia=0;ia<this.onSettledCallbacks_.length;++ia)cb.asyncExecute(this.onSettledCallbacks_[ia]);
this.onSettledCallbacks_=null}};var cb=new N;ka.prototype.settleSameAsPromise_=function(ia){var Na=this.createResolveAndReject_();ia.callWhenSettled_(Na.resolve,Na.reject)};ka.prototype.settleSameAsThenable_=function(ia,Na){var oa=this.createResolveAndReject_();try{ia.call(Na,oa.resolve,oa.reject)}catch(sa){oa.reject(sa)}};ka.prototype.then=function(ia,Na){function oa(qb,Ua){return"function"==typeof qb?function(Hc){try{sa(qb(Hc))}catch(Pc){xa(Pc)}}:Ua}var sa,xa,bb=new ka(function(qb,Ua){sa=qb;xa=
Ua});this.callWhenSettled_(oa(ia,sa),oa(Na,xa));return bb};ka.prototype.catch=function(ia){return this.then(void 0,ia)};ka.prototype.callWhenSettled_=function(ia,Na){function oa(){switch(sa.state_){case 1:ia(sa.result_);break;case 2:Na(sa.result_);break;default:throw Error("Unexpected state: "+sa.state_);}}var sa=this;null==this.onSettledCallbacks_?cb.asyncExecute(oa):this.onSettledCallbacks_.push(oa);this.isRejectionHandled_=!0};ka.resolve=R;ka.reject=function(ia){return new ka(function(Na,oa){oa(ia)})};
ka.race=function(ia){return new ka(function(Na,oa){for(var sa=$jscomp.makeIterator(ia),xa=sa.next();!xa.done;xa=sa.next())R(xa.value).callWhenSettled_(Na,oa)})};ka.all=function(ia){var Na=$jscomp.makeIterator(ia),oa=Na.next();return oa.done?R([]):new ka(function(sa,xa){function bb(Hc){return function(Pc){qb[Hc]=Pc;Ua--;0==Ua&&sa(qb)}}var qb=[],Ua=0;do qb.push(void 0),Ua++,R(oa.value).callWhenSettled_(bb(qb.length-1),xa),oa=Na.next();while(!oa.done)})};return ka},"es6","es3");
$jscomp.polyfill("Math.imul",function(p){return p?p:function(N,R){N=Number(N);R=Number(R);var fa=N&65535,ka=R&65535;return fa*ka+((N>>>16&65535)*ka+fa*(R>>>16&65535)<<16>>>0)|0}},"es6","es3");$jscomp.checkStringArgs=function(p,N,R){if(null==p)throw new TypeError("The 'this' value for String.prototype."+R+" must not be null or undefined");if(N instanceof RegExp)throw new TypeError("First argument to String.prototype."+R+" must not be a regular expression");return p+""};
$jscomp.polyfill("String.prototype.repeat",function(p){return p?p:function(N){var R=$jscomp.checkStringArgs(this,null,"repeat");if(0>N||1342177279<N)throw new RangeError("Invalid count value");N|=0;for(var fa="";N;)if(N&1&&(fa+=R),N>>>=1)R+=R;return fa}},"es6","es3");$jscomp.polyfill("Number.EPSILON",function(p){return Math.pow(2,-52)},"es6","es3");$jscomp.polyfill("Number.MAX_SAFE_INTEGER",function(){return 9007199254740991},"es6","es3");
$jscomp.polyfill("Math.trunc",function(p){return p?p:function(N){N=Number(N);if(isNaN(N)||Infinity===N||-Infinity===N||0===N)return N;var R=Math.floor(Math.abs(N));return 0>N?-R:R}},"es6","es3");$jscomp.atMethod=function(p){p=Math.trunc(p)||0;0>p&&(p+=this.length);if(!(0>p||p>=this.length))return this[p]};$jscomp.polyfill("Array.prototype.at",function(p){return p?p:$jscomp.atMethod},"es_next","es5");$jscomp.typedArrayAt=function(p){return p?p:$jscomp.atMethod};
$jscomp.polyfill("Int8Array.prototype.at",$jscomp.typedArrayAt,"es_next","es5");$jscomp.polyfill("Uint8Array.prototype.at",$jscomp.typedArrayAt,"es_next","es5");$jscomp.polyfill("Uint8ClampedArray.prototype.at",$jscomp.typedArrayAt,"es_next","es5");$jscomp.polyfill("Int16Array.prototype.at",$jscomp.typedArrayAt,"es_next","es5");$jscomp.polyfill("Uint16Array.prototype.at",$jscomp.typedArrayAt,"es_next","es5");$jscomp.polyfill("Int32Array.prototype.at",$jscomp.typedArrayAt,"es_next","es5");
$jscomp.polyfill("Uint32Array.prototype.at",$jscomp.typedArrayAt,"es_next","es5");$jscomp.polyfill("Float32Array.prototype.at",$jscomp.typedArrayAt,"es_next","es5");$jscomp.polyfill("Float64Array.prototype.at",$jscomp.typedArrayAt,"es_next","es5");$jscomp.polyfill("String.prototype.at",function(p){return p?p:$jscomp.atMethod},"es_next","es5");
$jscomp.iteratorFromArray=function(p,N){p instanceof String&&(p+="");var R=0,fa=!1,ka={next:function(){if(!fa&&R<p.length){var cb=R++;return{value:N(cb,p[cb]),done:!1}}fa=!0;return{done:!0,value:void 0}}};ka[Symbol.iterator]=function(){return ka};return ka};$jscomp.polyfill("Array.prototype.keys",function(p){return p?p:function(){return $jscomp.iteratorFromArray(this,function(N){return N})}},"es6","es3");
$jscomp.polyfill("Number.isFinite",function(p){return p?p:function(N){return"number"!==typeof N?!1:!isNaN(N)&&Infinity!==N&&-Infinity!==N}},"es6","es3");$jscomp.polyfill("Number.isInteger",function(p){return p?p:function(N){return Number.isFinite(N)?N===Math.floor(N):!1}},"es6","es3");$jscomp.checkEs6ConformanceViaProxy=function(){try{var p={},N=Object.create(new $jscomp.global.Proxy(p,{get:function(R,fa,ka){return R==p&&"q"==fa&&ka==N}}));return!0===N.q}catch(R){return!1}};
$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS=!1;$jscomp.ES6_CONFORMANCE=$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS&&$jscomp.checkEs6ConformanceViaProxy();
$jscomp.polyfill("WeakMap",function(p){function N(){if(!p||!Object.seal)return!1;try{var sa=Object.seal({}),xa=Object.seal({}),bb=new p([[sa,2],[xa,3]]);if(2!=bb.get(sa)||3!=bb.get(xa))return!1;bb.delete(sa);bb.set(xa,4);return!bb.has(sa)&&4==bb.get(xa)}catch(qb){return!1}}function R(){}function fa(sa){var xa=typeof sa;return"object"===xa&&null!==sa||"function"===xa}function ka(sa){if(!$jscomp.owns(sa,ia)){var xa=new R;$jscomp.defineProperty(sa,ia,{value:xa})}}function cb(sa){if(!$jscomp.ISOLATE_POLYFILLS){var xa=
Object[sa];xa&&(Object[sa]=function(bb){if(bb instanceof R)return bb;Object.isExtensible(bb)&&ka(bb);return xa(bb)})}}if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(p&&$jscomp.ES6_CONFORMANCE)return p}else if(N())return p;var ia="$jscomp_hidden_"+Math.random();cb("freeze");cb("preventExtensions");cb("seal");var Na=0,oa=function(sa){this.id_=(Na+=Math.random()+1).toString();if(sa){sa=$jscomp.makeIterator(sa);for(var xa;!(xa=sa.next()).done;)xa=xa.value,this.set(xa[0],xa[1])}};oa.prototype.set=
function(sa,xa){if(!fa(sa))throw Error("Invalid WeakMap key");ka(sa);if(!$jscomp.owns(sa,ia))throw Error("WeakMap key fail: "+sa);sa[ia][this.id_]=xa;return this};oa.prototype.get=function(sa){return fa(sa)&&$jscomp.owns(sa,ia)?sa[ia][this.id_]:void 0};oa.prototype.has=function(sa){return fa(sa)&&$jscomp.owns(sa,ia)&&$jscomp.owns(sa[ia],this.id_)};oa.prototype.delete=function(sa){return fa(sa)&&$jscomp.owns(sa,ia)&&$jscomp.owns(sa[ia],this.id_)?delete sa[ia][this.id_]:!1};return oa},"es6","es3");
$jscomp.polyfill("Math.log2",function(p){return p?p:function(N){return Math.log(N)/Math.LN2}},"es6","es3");$jscomp.polyfill("Array.prototype.values",function(p){return p?p:function(){return $jscomp.iteratorFromArray(this,function(N,R){return R})}},"es8","es3");$jscomp.MapEntry=function(){};
$jscomp.polyfill("Map",function(p){function N(){if($jscomp.ASSUME_NO_NATIVE_MAP||!p||"function"!=typeof p||!p.prototype.entries||"function"!=typeof Object.seal)return!1;try{var oa=Object.seal({x:4}),sa=new p($jscomp.makeIterator([[oa,"s"]]));if("s"!=sa.get(oa)||1!=sa.size||sa.get({x:4})||sa.set({x:4},"t")!=sa||2!=sa.size)return!1;var xa=sa.entries(),bb=xa.next();if(bb.done||bb.value[0]!=oa||"s"!=bb.value[1])return!1;bb=xa.next();return bb.done||4!=bb.value[0].x||"t"!=bb.value[1]||!xa.next().done?
!1:!0}catch(qb){return!1}}if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(p&&$jscomp.ES6_CONFORMANCE)return p}else if(N())return p;var R=new WeakMap,fa=function(oa){this.data_={};this.head_=ia();this.size=0;if(oa){oa=$jscomp.makeIterator(oa);for(var sa;!(sa=oa.next()).done;)sa=sa.value,this.set(sa[0],sa[1])}};fa.prototype.set=function(oa,sa){oa=0===oa?0:oa;var xa=ka(this,oa);xa.list||(xa.list=this.data_[xa.id]=[]);xa.entry?xa.entry.value=sa:(xa.entry={next:this.head_,previous:this.head_.previous,
head:this.head_,key:oa,value:sa},xa.list.push(xa.entry),this.head_.previous.next=xa.entry,this.head_.previous=xa.entry,this.size++);return this};fa.prototype.delete=function(oa){oa=ka(this,oa);return oa.entry&&oa.list?(oa.list.splice(oa.index,1),oa.list.length||delete this.data_[oa.id],oa.entry.previous.next=oa.entry.next,oa.entry.next.previous=oa.entry.previous,oa.entry.head=null,this.size--,!0):!1};fa.prototype.clear=function(){this.data_={};this.head_=this.head_.previous=ia();this.size=0};fa.prototype.has=
function(oa){return!!ka(this,oa).entry};fa.prototype.get=function(oa){return(oa=ka(this,oa).entry)&&oa.value};fa.prototype.entries=function(){return cb(this,function(oa){return[oa.key,oa.value]})};fa.prototype.keys=function(){return cb(this,function(oa){return oa.key})};fa.prototype.values=function(){return cb(this,function(oa){return oa.value})};fa.prototype.forEach=function(oa,sa){for(var xa=this.entries(),bb;!(bb=xa.next()).done;)bb=bb.value,oa.call(sa,bb[1],bb[0],this)};fa.prototype[Symbol.iterator]=
fa.prototype.entries;var ka=function(oa,sa){var xa=sa&&typeof sa;"object"==xa||"function"==xa?R.has(sa)?xa=R.get(sa):(xa=""+ ++Na,R.set(sa,xa)):xa="p_"+sa;var bb=oa.data_[xa];if(bb&&$jscomp.owns(oa.data_,xa))for(oa=0;oa<bb.length;oa++){var qb=bb[oa];if(sa!==sa&&qb.key!==qb.key||sa===qb.key)return{id:xa,list:bb,index:oa,entry:qb}}return{id:xa,list:bb,index:-1,entry:void 0}},cb=function(oa,sa){var xa=oa.head_;return $jscomp.iteratorPrototype(function(){if(xa){for(;xa.head!=oa.head_;)xa=xa.previous;
for(;xa.next!=xa.head;)return xa=xa.next,{done:!1,value:sa(xa)};xa=null}return{done:!0,value:void 0}})},ia=function(){var oa={};return oa.previous=oa.next=oa.head=oa},Na=0;return fa},"es6","es3");$jscomp.polyfill("Math.sign",function(p){return p?p:function(N){N=Number(N);return 0===N||isNaN(N)?N:0<N?1:-1}},"es6","es3");
$jscomp.polyfill("Set",function(p){function N(){if($jscomp.ASSUME_NO_NATIVE_SET||!p||"function"!=typeof p||!p.prototype.entries||"function"!=typeof Object.seal)return!1;try{var fa=Object.seal({x:4}),ka=new p($jscomp.makeIterator([fa]));if(!ka.has(fa)||1!=ka.size||ka.add(fa)!=ka||1!=ka.size||ka.add({x:4})!=ka||2!=ka.size)return!1;var cb=ka.entries(),ia=cb.next();if(ia.done||ia.value[0]!=fa||ia.value[1]!=fa)return!1;ia=cb.next();return ia.done||ia.value[0]==fa||4!=ia.value[0].x||ia.value[1]!=ia.value[0]?
!1:cb.next().done}catch(Na){return!1}}if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(p&&$jscomp.ES6_CONFORMANCE)return p}else if(N())return p;var R=function(fa){this.map_=new Map;if(fa){fa=$jscomp.makeIterator(fa);for(var ka;!(ka=fa.next()).done;)this.add(ka.value)}this.size=this.map_.size};R.prototype.add=function(fa){fa=0===fa?0:fa;this.map_.set(fa,fa);this.size=this.map_.size;return this};R.prototype.delete=function(fa){fa=this.map_.delete(fa);this.size=this.map_.size;return fa};R.prototype.clear=
function(){this.map_.clear();this.size=0};R.prototype.has=function(fa){return this.map_.has(fa)};R.prototype.entries=function(){return this.map_.entries()};R.prototype.values=function(){return this.map_.values()};R.prototype.keys=R.prototype.values;R.prototype[Symbol.iterator]=R.prototype.values;R.prototype.forEach=function(fa,ka){var cb=this;this.map_.forEach(function(ia){return fa.call(ka,ia,ia,cb)})};return R},"es6","es3");
$jscomp.findInternal=function(p,N,R){p instanceof String&&(p=String(p));for(var fa=p.length,ka=0;ka<fa;ka++){var cb=p[ka];if(N.call(R,cb,ka,p))return{i:ka,v:cb}}return{i:-1,v:void 0}};$jscomp.polyfill("Array.prototype.find",function(p){return p?p:function(N,R){return $jscomp.findInternal(this,N,R).v}},"es6","es3");$jscomp.polyfill("Array.prototype.entries",function(p){return p?p:function(){return $jscomp.iteratorFromArray(this,function(N,R){return[N,R]})}},"es6","es3");
$jscomp.polyfill("Object.values",function(p){return p?p:function(N){var R=[],fa;for(fa in N)$jscomp.owns(N,fa)&&R.push(N[fa]);return R}},"es8","es3");
!function(p,N){"object"==typeof exports&&"undefined"!=typeof module?N(exports):"function"==typeof define&&define.amd?define(["exports"],N):N((p="undefined"!=typeof globalThis?globalThis:p||self).THREE={})}(this,function(p){function N(){if(il)return crypto.randomUUID().toUpperCase();var l=4294967295*Math.random()|0,k=4294967295*Math.random()|0,f=4294967295*Math.random()|0,a=4294967295*Math.random()|0;return(gc[255&l]+gc[l>>8&255]+gc[l>>16&255]+gc[l>>24&255]+"-"+gc[255&k]+gc[k>>8&255]+"-"+gc[k>>16&
15|64]+gc[k>>24&255]+"-"+gc[63&f|128]+gc[f>>8&255]+"-"+gc[f>>16&255]+gc[f>>24&255]+gc[255&a]+gc[a>>8&255]+gc[a>>16&255]+gc[a>>24&255]).toUpperCase()}function R(l,k,f){return Math.max(k,Math.min(f,l))}function fa(l,k){return(l%k+k)%k}function ka(l,k,f){return(1-f)*l+f*k}function cb(l){return 0==(l&l-1)&&0!==l}function ia(l){return Math.pow(2,Math.ceil(Math.log(l)/Math.LN2))}function Na(l){return Math.pow(2,Math.floor(Math.log(l)/Math.LN2))}function oa(l){if(0===l.length)return-1/0;for(var k=l[0],f=
1,a=l.length;f<a;++f)l[f]>k&&(k=l[f]);return k}function sa(l){return document.createElementNS("http://www.w3.org/1999/xhtml",l)}function xa(l,k){k=void 0===k?0:k;var f=3735928559^k;k^=1103547991;for(var a,b=0;b<l.length;b++)a=l.charCodeAt(b),f=Math.imul(f^a,2654435761),k=Math.imul(k^a,1597334677);return f=Math.imul(f^f>>>16,2246822507)^Math.imul(k^k>>>13,3266489909),k=Math.imul(k^k>>>16,2246822507)^Math.imul(f^f>>>13,3266489909),4294967296*(2097151&k)+(f>>>0)}function bb(l){return"undefined"!=typeof HTMLImageElement&&
l instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&l instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&l instanceof ImageBitmap?Ed.getDataURL(l):l.data?{data:Array.prototype.slice.call(l.data),width:l.width,height:l.height,type:l.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}function qb(l,k,f,a,b){for(var c=0,d=l.length-3;c<=d;c+=3){fe.fromArray(l,c);var e=b.x*Math.abs(fe.x)+b.y*Math.abs(fe.y)+b.z*Math.abs(fe.z),g=k.dot(fe),
h=f.dot(fe),m=a.dot(fe);if(Math.max(-Math.max(g,h,m),Math.min(g,h,m))>e)return!1}return!0}function Ua(l,k,f){return 0>f&&(f+=1),1<f&&--f,f<1/6?l+6*(k-l)*f:.5>f?k:f<2/3?l+6*(k-l)*(2/3-f):l}function Hc(l){return.04045>l?.0773993808*l:Math.pow(.9478672986*l+.0521327014,2.4)}function Pc(l){return.0031308>l?12.92*l:1.055*Math.pow(l,.41666)-.055}function Fd(l,k,f,a,b,c,d,e,g,h,m,n){jd.fromBufferAttribute(b,h);kd.fromBufferAttribute(b,m);ld.fromBufferAttribute(b,n);b=l.morphTargetInfluences;if(c&&b){Fg.set(0,
0,0);Gg.set(0,0,0);Hg.set(0,0,0);for(var q=0,t=c.length;q<t;q++){var r=b[q],u=c[q];0!==r&&($h.fromBufferAttribute(u,h),ai.fromBufferAttribute(u,m),bi.fromBufferAttribute(u,n),d?(Fg.addScaledVector($h,r),Gg.addScaledVector(ai,r),Hg.addScaledVector(bi,r)):(Fg.addScaledVector($h.sub(jd),r),Gg.addScaledVector(ai.sub(kd),r),Hg.addScaledVector(bi.sub(ld),r)))}jd.add(Fg);kd.add(Gg);ld.add(Hg)}l.isSkinnedMesh&&(l.boneTransform(h,jd),l.boneTransform(m,kd),l.boneTransform(n,ld));var A;(A=1===k.side?a.intersectTriangle(ld,
kd,jd,!0,Df):a.intersectTriangle(jd,kd,ld,2!==k.side,Df),null===A)?l=null:(Ig.copy(Df),Ig.applyMatrix4(l.matrixWorld),k=f.ray.origin.distanceTo(Ig),l=k<f.near||k>f.far?null:{distance:k,point:Ig.clone(),object:l});l&&(e&&(Jg.fromBufferAttribute(e,h),Kg.fromBufferAttribute(e,m),Lg.fromBufferAttribute(e,n),l.uv=eb.getUV(Df,jd,kd,ld,Jg,Kg,Lg,new T)),g&&(Jg.fromBufferAttribute(g,h),Kg.fromBufferAttribute(g,m),Lg.fromBufferAttribute(g,n),l.uv2=eb.getUV(Df,jd,kd,ld,Jg,Kg,Lg,new T)),e={a:h,b:m,c:n,normal:new B,
materialIndex:0},eb.getNormal(jd,kd,ld,e.normal),l.face=e);return l}function $c(l){var k={},f;for(f in l){k[f]={};for(var a in l[f]){var b=l[f][a];b&&(b.isColor||b.isMatrix3||b.isMatrix4||b.isVector2||b.isVector3||b.isVector4||b.isTexture||b.isQuaternion)?k[f][a]=b.clone():Array.isArray(b)?k[f][a]=b.slice():k[f][a]=b}}return k}function Ub(l){for(var k={},f=0;f<l.length;f++){var a=$c(l[f]),b;for(b in a)k[b]=a[b]}return k}function Te(){function l(c,d){a(c,d);b=k.requestAnimationFrame(l)}var k=null,
f=!1,a=null,b=null;return{start:function(){!0!==f&&null!==a&&(b=k.requestAnimationFrame(l),f=!0)},stop:function(){k.cancelAnimationFrame(b);f=!1},setAnimationLoop:function(c){a=c},setContext:function(c){k=c}}}function Ef(l,k){var f=k.isWebGL2,a=new WeakMap;return{get:function(b){return b.isInterleavedBufferAttribute&&(b=b.data),a.get(b)},remove:function(b){b.isInterleavedBufferAttribute&&(b=b.data);var c=a.get(b);c&&(l.deleteBuffer(c.buffer),a.delete(b))},update:function(b,c){if(b.isGLBufferAttribute)return c=
a.get(b),void((!c||c.version<b.version)&&a.set(b,{buffer:b.buffer,type:b.type,bytesPerElement:b.elementSize,version:b.version}));b.isInterleavedBufferAttribute&&(b=b.data);var d=a.get(b);void 0===d?a.set(b,function(e,g){var h=e.array,m=e.usage,n=l.createBuffer();l.bindBuffer(g,n);l.bufferData(g,h,m);e.onUploadCallback();g=5126;return h instanceof Float32Array?g=5126:h instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):h instanceof Uint16Array?
e.isFloat16BufferAttribute?f?g=5131:console.warn("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2."):g=5123:h instanceof Int16Array?g=5122:h instanceof Uint32Array?g=5125:h instanceof Int32Array?g=5124:h instanceof Int8Array?g=5120:(h instanceof Uint8Array||h instanceof Uint8ClampedArray)&&(g=5121),{buffer:n,type:g,bytesPerElement:h.BYTES_PER_ELEMENT,version:e.version}}(b,c)):d.version<b.version&&(!function(e,g,h){var m=g.array;g=g.updateRange;l.bindBuffer(h,e);-1===g.count?
l.bufferSubData(h,0,m):(f?l.bufferSubData(h,g.offset*m.BYTES_PER_ELEMENT,m,g.offset,g.count):l.bufferSubData(h,g.offset*m.BYTES_PER_ELEMENT,m.subarray(g.offset,g.offset+g.count)),g.count=-1)}(d.buffer,b,c),d.version=b.version)}}}function Ff(l,k,f,a,b){function c(t,r){f.buffers.color.setClear(t.r,t.g,t.b,r,b)}var d=new ma(0),e,g,h=0,m=null,n=0,q=null;return{getClearColor:function(){return d},setClearColor:function(t,r){r=void 0===r?1:r;d.set(t);h=r;c(d,h)},getClearAlpha:function(){return h},setClearAlpha:function(t){h=
t;c(d,h)},render:function(t,r){var u=!1;(r=!0===r.isScene?r.background:null)&&r.isTexture&&(r=k.get(r));var A=l.xr;(A=A.getSession&&A.getSession())&&"additive"===A.environmentBlendMode&&(r=null);null===r?c(d,h):r&&r.isColor&&(c(r,1),u=!0);(l.autoClear||u)&&l.clear(l.autoClearColor,l.autoClearDepth,l.autoClearStencil);r&&(r.isCubeTexture||306===r.mapping)?(void 0===g&&(g=new vb(new ad(1,1,1),new Bc({name:"BackgroundCubeMaterial",uniforms:$c(Qc.cube.uniforms),vertexShader:Qc.cube.vertexShader,fragmentShader:Qc.cube.fragmentShader,
side:1,depthTest:!1,depthWrite:!1,fog:!1})),g.geometry.deleteAttribute("normal"),g.geometry.deleteAttribute("uv"),g.onBeforeRender=function(w,x,C){this.matrixWorld.copyPosition(C.matrixWorld)},Object.defineProperty(g.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),a.update(g)),g.material.uniforms.envMap.value=r,g.material.uniforms.flipEnvMap.value=r.isCubeTexture&&!1===r.isRenderTargetTexture?-1:1,m===r&&n===r.version&&q===l.toneMapping||(g.material.needsUpdate=!0,m=r,n=r.version,
q=l.toneMapping),t.unshift(g,g.geometry,g.material,0,0,null)):r&&r.isTexture&&(void 0===e&&(e=new vb(new Gd(2,2),new Bc({name:"BackgroundMaterial",uniforms:$c(Qc.background.uniforms),vertexShader:Qc.background.vertexShader,fragmentShader:Qc.background.fragmentShader,side:0,depthTest:!1,depthWrite:!1,fog:!1})),e.geometry.deleteAttribute("normal"),Object.defineProperty(e.material,"map",{get:function(){return this.uniforms.t2D.value}}),a.update(e)),e.material.uniforms.t2D.value=r,!0===r.matrixAutoUpdate&&
r.updateMatrix(),e.material.uniforms.uvTransform.value.copy(r.matrix),m===r&&n===r.version&&q===l.toneMapping||(e.material.needsUpdate=!0,m=r,n=r.version,q=l.toneMapping),t.unshift(e,e.geometry,e.material,0,0,null))}}}function Mg(l,k,f,a){function b(C){return a.isWebGL2?l.bindVertexArray(C):r.bindVertexArrayOES(C)}function c(C){return a.isWebGL2?l.deleteVertexArray(C):r.deleteVertexArrayOES(C)}function d(C){for(var G=[],I=[],P=[],O=0;O<t;O++)G[O]=0,I[O]=0,P[O]=0;return{geometry:null,program:null,
wireframe:!1,newAttributes:G,enabledAttributes:I,attributeDivisors:P,object:C,attributes:{},index:null}}function e(){for(var C=x.newAttributes,G=0,I=C.length;G<I;G++)C[G]=0}function g(C){h(C,0)}function h(C,G){var I=x.enabledAttributes,P=x.attributeDivisors;if(x.newAttributes[C]=1,0===I[C]&&(l.enableVertexAttribArray(C),I[C]=1),P[C]!==G)(a.isWebGL2?l:k.get("ANGLE_instanced_arrays"))[a.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](C,G),P[C]=G}function m(){for(var C=x.newAttributes,G=x.enabledAttributes,
I=0,P=G.length;I<P;I++)G[I]!==C[I]&&(l.disableVertexAttribArray(I),G[I]=0)}function n(){q();x!==w&&(x=w,b(x.object))}function q(){w.geometry=null;w.program=null;w.wireframe=!1}var t=l.getParameter(34921),r=a.isWebGL2?null:k.get("OES_vertex_array_object"),u=a.isWebGL2||null!==r,A={},w=d(null),x=w;return{setup:function(C,G,I,P,O){var M=!1;if(u){var S=function(V,ba,Y){Y=!0===Y.wireframe;var Z=A[V.id];void 0===Z&&(Z={},A[V.id]=Z);V=Z[ba.id];void 0===V&&(V={},Z[ba.id]=V);ba=V[Y];void 0===ba&&(ba=d(a.isWebGL2?
l.createVertexArray():r.createVertexArrayOES()),V[Y]=ba);return ba}(P,I,G);x!==S&&(x=S,b(x.object));(M=function(V,ba){var Y=x.attributes;V=V.attributes;var Z=0,Ha;for(Ha in V){var ya=Y[Ha],ja=V[Ha];if(void 0===ya||ya.attribute!==ja||ya.data!==ja.data)return!0;Z++}return x.attributesNum!==Z||x.index!==ba}(P,O))&&function(V,ba){var Y={};V=V.attributes;var Z=0,Ha;for(Ha in V){var ya=V[Ha],ja={attribute:ya};ya.data&&(ja.data=ya.data);Y[Ha]=ja;Z++}x.attributes=Y;x.attributesNum=Z;x.index=ba}(P,O)}else S=
!0===G.wireframe,x.geometry===P.id&&x.program===I.id&&x.wireframe===S||(x.geometry=P.id,x.program=I.id,x.wireframe=S,M=!0);!0===C.isInstancedMesh&&(M=!0);null!==O&&f.update(O,34963);M&&(!function(V,ba,Y,Z){if(!1!==a.isWebGL2||!V.isInstancedMesh&&!Z.isInstancedBufferGeometry||null!==k.get("ANGLE_instanced_arrays")){e();var Ha=Z.attributes;Y=Y.getAttributes();ba=ba.defaultAttributeValues;for(var ya in Y){var ja=Y[ya];if(0<=ja.location){var Ja=Ha[ya];if(void 0===Ja&&("instanceMatrix"===ya&&V.instanceMatrix&&
(Ja=V.instanceMatrix),"instanceColor"===ya&&V.instanceColor&&(Ja=V.instanceColor)),void 0!==Ja){var Va=Ja.normalized,db=Ja.itemSize,Xa=f.get(Ja);if(void 0!==Xa){var Qa=Xa.buffer,D=Xa.type;Xa=Xa.bytesPerElement;if(Ja.isInterleavedBufferAttribute){var E=Ja.data,J=E.stride;Ja=Ja.offset;if(E&&E.isInstancedInterleavedBuffer){for(var W=0;W<ja.locationSize;W++)h(ja.location+W,E.meshPerAttribute);!0!==V.isInstancedMesh&&void 0===Z._maxInstanceCount&&(Z._maxInstanceCount=E.meshPerAttribute*E.count)}else for(E=
0;E<ja.locationSize;E++)g(ja.location+E);l.bindBuffer(34962,Qa);for(Qa=0;Qa<ja.locationSize;Qa++){E=ja.location+Qa;W=db/ja.locationSize;var qa=J*Xa,K=(Ja+db/ja.locationSize*Qa)*Xa;!0!==a.isWebGL2||5124!==D&&5125!==D?l.vertexAttribPointer(E,W,D,Va,qa,K):l.vertexAttribIPointer(E,W,D,qa,K)}}else{if(Ja.isInstancedBufferAttribute){for(J=0;J<ja.locationSize;J++)h(ja.location+J,Ja.meshPerAttribute);!0!==V.isInstancedMesh&&void 0===Z._maxInstanceCount&&(Z._maxInstanceCount=Ja.meshPerAttribute*Ja.count)}else for(J=
0;J<ja.locationSize;J++)g(ja.location+J);l.bindBuffer(34962,Qa);for(J=0;J<ja.locationSize;J++)Ja=ja.location+J,Qa=db/ja.locationSize,E=db*Xa,W=db/ja.locationSize*J*Xa,!0!==a.isWebGL2||5124!==D&&5125!==D?l.vertexAttribPointer(Ja,Qa,D,Va,E,W):l.vertexAttribIPointer(Ja,Qa,D,E,W)}}}else if(void 0!==ba&&(Va=ba[ya],void 0!==Va))switch(Va.length){case 2:l.vertexAttrib2fv(ja.location,Va);break;case 3:l.vertexAttrib3fv(ja.location,Va);break;case 4:l.vertexAttrib4fv(ja.location,Va);break;default:l.vertexAttrib1fv(ja.location,
Va)}}}m()}}(C,G,I,P),null!==O&&l.bindBuffer(34963,f.get(O).buffer))},reset:n,resetDefaultState:q,dispose:function(){n();for(var C in A){var G=A[C],I;for(I in G){var P=G[I],O;for(O in P)c(P[O].object),delete P[O];delete G[I]}delete A[C]}},releaseStatesOfGeometry:function(C){if(void 0!==A[C.id]){var G=A[C.id],I;for(I in G){var P=G[I],O;for(O in P)c(P[O].object),delete P[O];delete G[I]}delete A[C.id]}},releaseStatesOfProgram:function(C){for(var G in A){var I=A[G];if(void 0!==I[C.id]){var P=I[C.id],O;
for(O in P)c(P[O].object),delete P[O];delete I[C.id]}}},initAttributes:e,enableAttribute:g,disableUnusedAttributes:m}}function Gf(l,k,f,a){var b=a.isWebGL2,c;this.setMode=function(d){c=d};this.render=function(d,e){l.drawArrays(c,d,e);f.update(e,c,1)};this.renderInstances=function(d,e,g){if(0!==g){if(b){var h=l;var m="drawArraysInstanced"}else if(h=k.get("ANGLE_instanced_arrays"),m="drawArraysInstancedANGLE",null===h)return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");
h[m](c,d,e,g);f.update(e,c,g)}}}function Ng(l,k,f){function a(x){if("highp"===x){if(0<l.getShaderPrecisionFormat(35633,36338).precision&&0<l.getShaderPrecisionFormat(35632,36338).precision)return"highp";x="mediump"}return"mediump"===x&&0<l.getShaderPrecisionFormat(35633,36337).precision&&0<l.getShaderPrecisionFormat(35632,36337).precision?"mediump":"lowp"}var b,c="undefined"!=typeof WebGL2RenderingContext&&l instanceof WebGL2RenderingContext||"undefined"!=typeof WebGL2ComputeRenderingContext&&l instanceof
WebGL2ComputeRenderingContext,d=void 0!==f.precision?f.precision:"highp",e=a(d);e!==d&&(console.warn("THREE.WebGLRenderer:",d,"not supported, using",e,"instead."),d=e);e=c||k.has("WEBGL_draw_buffers");f=!0===f.logarithmicDepthBuffer;var g=l.getParameter(34930),h=l.getParameter(35660),m=l.getParameter(3379),n=l.getParameter(34076),q=l.getParameter(34921),t=l.getParameter(36347),r=l.getParameter(36348),u=l.getParameter(36349),A=0<h,w=c||k.has("OES_texture_float");return{isWebGL2:c,drawBuffers:e,getMaxAnisotropy:function(){if(void 0!==
b)return b;if(!0===k.has("EXT_texture_filter_anisotropic")){var x=k.get("EXT_texture_filter_anisotropic");b=l.getParameter(x.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else b=0;return b},getMaxPrecision:a,precision:d,logarithmicDepthBuffer:f,maxTextures:g,maxVertexTextures:h,maxTextureSize:m,maxCubemapSize:n,maxAttributes:q,maxVertexUniforms:t,maxVaryings:r,maxFragmentUniforms:u,vertexTextures:A,floatFragmentTextures:w,floatVertexTextures:A&&w,maxSamples:c?l.getParameter(36183):0}}function ci(l){function k(){m.value!==
b&&(m.value=b,m.needsUpdate=0<c);a.numPlanes=c;a.numIntersection=0}function f(n,q,t,r){var u=null!==n?n.length:0,A=null;if(0!==u){if(A=m.value,!0!==r||null===A)for(r=t+4*u,q=q.matrixWorldInverse,h.getNormalMatrix(q),(null===A||A.length<r)&&(A=new Float32Array(r)),r=0;r!==u;++r,t+=4)g.copy(n[r]).applyMatrix4(q,h),g.normal.toArray(A,t),A[t+3]=g.constant;m.value=A;m.needsUpdate=!0}return a.numPlanes=u,a.numIntersection=0,A}var a=this,b=null,c=0,d=!1,e=!1,g=new zb,h=new fb,m={value:null,needsUpdate:!1};
this.uniform=m;this.numIntersection=this.numPlanes=0;this.init=function(n,q,t){var r=0!==n.length||q||0!==c||d;return d=q,b=f(n,t,0),c=n.length,r};this.beginShadows=function(){e=!0;f(null)};this.endShadows=function(){e=!1;k()};this.setState=function(n,q,t){var r=n.clippingPlanes,u=n.clipIntersection,A=n.clipShadows;n=l.get(n);if(!d||null===r||0===r.length||e&&!A)e?f(null):k();else{A=e?0:c;var w=4*A,x=n.clippingState||null;m.value=x;x=f(r,q,w,t);for(q=0;q!==w;++q)x[q]=b[q];n.clippingState=x;this.numIntersection=
u?this.numPlanes:0;this.numPlanes+=A}}}function Og(l){function k(b,c){return 303===c?b.mapping=301:304===c&&(b.mapping=302),b}function f(b){b=b.target;b.removeEventListener("dispose",f);var c=a.get(b);void 0!==c&&(a.delete(b),c.dispose())}var a=new WeakMap;return{get:function(b){if(b&&b.isTexture&&!1===b.isRenderTargetTexture){var c=b.mapping;if(303===c||304===c){if(a.has(b))return k(a.get(b).texture,b.mapping);var d=b.image;return d&&0<d.height?(c=l.getRenderTarget(),d=new ge(d.height/2),d.fromEquirectangularTexture(l,
b),a.set(b,d),l.setRenderTarget(c),b.addEventListener("dispose",f),k(d.texture,b.mapping)):null}}return b},dispose:function(){a=new WeakMap}}}function Hf(l){l=new Rb(3*bd,3*bd,l);return l.texture.mapping=306,l.texture.name="PMREM.cubeUv",l.scissorTest=!0,l}function cd(l,k,f,a,b){l.viewport.set(k,f,a,b);l.scissor.set(k,f,a,b)}function he(){var l=new T(1,1);return new ie({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null},texelSize:{value:l},inputEncoding:{value:Hd[3E3]},outputEncoding:{value:Hd[3E3]}},
vertexShader:qc(),fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform vec2 texelSize;\n\n\t\t\t"+If()+"\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tvec2 f = fract( uv / texelSize - 0.5 );\n\t\t\t\tuv -= f * texelSize;\n\t\t\t\tvec3 tl = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n\t\t\t\tuv.x += texelSize.x;\n\t\t\t\tvec3 tr = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n\t\t\t\tuv.y += texelSize.y;\n\t\t\t\tvec3 br = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n\t\t\t\tuv.x -= texelSize.x;\n\t\t\t\tvec3 bl = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n\n\t\t\t\tvec3 tm = mix( tl, tr, f.x );\n\t\t\t\tvec3 bm = mix( bl, br, f.x );\n\t\t\t\tgl_FragColor.rgb = mix( tm, bm, f.y );\n\n\t\t\t\tgl_FragColor = linearToOutputTexel( gl_FragColor );\n\n\t\t\t}\n\t\t",
blending:0,depthTest:!1,depthWrite:!1})}function Pg(){return new ie({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},inputEncoding:{value:Hd[3E3]},outputEncoding:{value:Hd[3E3]}},vertexShader:qc(),fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\t"+If()+"\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb = envMapTexelToLinear( textureCube( envMap, vec3( - vOutputDirection.x, vOutputDirection.yz ) ) ).rgb;\n\t\t\t\tgl_FragColor = linearToOutputTexel( gl_FragColor );\n\n\t\t\t}\n\t\t",
blending:0,depthTest:!1,depthWrite:!1})}function qc(){return"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute vec3 position;\n\t\tattribute vec2 uv;\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t"}
function If(){return"\n\n\t\tuniform int inputEncoding;\n\t\tuniform int outputEncoding;\n\n\t\t#include <encodings_pars_fragment>\n\n\t\tvec4 inputTexelToLinear( vec4 value ) {\n\n\t\t\tif ( inputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( inputEncoding == 1 ) {\n\n\t\t\t\treturn sRGBToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 2 ) {\n\n\t\t\t\treturn RGBEToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 3 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 7.0 );\n\n\t\t\t} else if ( inputEncoding == 4 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 16.0 );\n\n\t\t\t} else if ( inputEncoding == 5 ) {\n\n\t\t\t\treturn RGBDToLinear( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn GammaToLinear( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 linearToOutputTexel( vec4 value ) {\n\n\t\t\tif ( outputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( outputEncoding == 1 ) {\n\n\t\t\t\treturn LinearTosRGB( value );\n\n\t\t\t} else if ( outputEncoding == 2 ) {\n\n\t\t\t\treturn LinearToRGBE( value );\n\n\t\t\t} else if ( outputEncoding == 3 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 7.0 );\n\n\t\t\t} else if ( outputEncoding == 4 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 16.0 );\n\n\t\t\t} else if ( outputEncoding == 5 ) {\n\n\t\t\t\treturn LinearToRGBD( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn LinearToGamma( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 envMapTexelToLinear( vec4 color ) {\n\n\t\t\treturn inputTexelToLinear( color );\n\n\t\t}\n\t"}
function Jf(l){function k(b){b=b.target;b.removeEventListener("dispose",k);var c=f.get(b);void 0!==c&&(f.delete(b),c.dispose())}var f=new WeakMap,a=null;return{get:function(b){if(b&&b.isTexture&&!1===b.isRenderTargetTexture){var c=b.mapping,d=303===c||304===c,e=301===c||302===c;if(d||e){if(f.has(b))return f.get(b).texture;c=b.image;var g;if(!(g=d&&c&&0<c.height)){if(e=e&&c){for(g=e=0;6>g;g++)void 0!==c[g]&&e++;e=6===e}g=e}return g?(c=l.getRenderTarget(),null===a&&(a=new ac(l)),d=d?a.fromEquirectangular(b):
a.fromCubemap(b),f.set(b,d),l.setRenderTarget(c),b.addEventListener("dispose",k),d.texture):null}}return b},dispose:function(){f=new WeakMap;null!==a&&(a.dispose(),a=null)}}}function je(l){function k(a){if(void 0!==f[a])return f[a];switch(a){case "WEBGL_depth_texture":var b=l.getExtension("WEBGL_depth_texture")||l.getExtension("MOZ_WEBGL_depth_texture")||l.getExtension("WEBKIT_WEBGL_depth_texture");break;case "EXT_texture_filter_anisotropic":b=l.getExtension("EXT_texture_filter_anisotropic")||l.getExtension("MOZ_EXT_texture_filter_anisotropic")||
l.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case "WEBGL_compressed_texture_s3tc":b=l.getExtension("WEBGL_compressed_texture_s3tc")||l.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||l.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case "WEBGL_compressed_texture_pvrtc":b=l.getExtension("WEBGL_compressed_texture_pvrtc")||l.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:b=l.getExtension(a)}return f[a]=b,b}var f={};return{has:function(a){return null!==
k(a)},init:function(a){a.isWebGL2?k("EXT_color_buffer_float"):(k("WEBGL_depth_texture"),k("OES_texture_float"),k("OES_texture_half_float"),k("OES_texture_half_float_linear"),k("OES_standard_derivatives"),k("OES_element_index_uint"),k("OES_vertex_array_object"),k("ANGLE_instanced_arrays"));k("OES_texture_float_linear");k("EXT_color_buffer_half_float")},get:function(a){var b=k(a);return null===b&&console.warn("THREE.WebGLRenderer: "+a+" extension not supported."),b}}}function Qg(l,k,f,a){function b(g){g=
g.target;null!==g.index&&k.remove(g.index);for(var h in g.attributes)k.remove(g.attributes[h]);g.removeEventListener("dispose",b);delete d[g.id];(h=e.get(g))&&(k.remove(h),e.delete(g));a.releaseStatesOfGeometry(g);!0===g.isInstancedBufferGeometry&&delete g._maxInstanceCount;f.memory.geometries--}function c(g){var h=[],m=g.index,n=g.attributes.position;if(null!==m){n=m.array;m=m.version;for(var q=0,t=n.length;q<t;q+=3){var r=n[q+0],u=n[q+1],A=n[q+2];h.push(r,u,u,A,A,r)}}else for(q=n.array,m=n.version,
n=0,q=q.length/3-1;n<q;n+=3)t=n+0,r=n+1,u=n+2,h.push(t,r,r,u,u,t);h=new (65535<oa(h)?Kf:Lf)(h,1);h.version=m;(m=e.get(g))&&k.remove(m);e.set(g,h)}var d={},e=new WeakMap;return{get:function(g,h){return!0===d[h.id]||(h.addEventListener("dispose",b),d[h.id]=!0,f.memory.geometries++),h},update:function(g){var h=g.attributes;for(n in h)k.update(h[n],34962);g=g.morphAttributes;for(var m in g){h=g[m];var n=0;for(var q=h.length;n<q;n++)k.update(h[n],34962)}},getWireframeAttribute:function(g){var h=e.get(g);
if(h){var m=g.index;null!==m&&h.version<m.version&&c(g)}else c(g);return e.get(g)}}}function Rg(l,k,f,a){var b=a.isWebGL2,c,d,e;this.setMode=function(g){c=g};this.setIndex=function(g){d=g.type;e=g.bytesPerElement};this.render=function(g,h){l.drawElements(c,h,d,g*e);f.update(h,c,1)};this.renderInstances=function(g,h,m){if(0!==m){if(b){var n=l;var q="drawElementsInstanced"}else if(n=k.get("ANGLE_instanced_arrays"),q="drawElementsInstancedANGLE",null===n)return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");
n[q](c,h,d,g*e,m);f.update(h,c,m)}}}function Sg(l){var k={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:k,programs:null,autoReset:!0,reset:function(){k.frame++;k.calls=0;k.triangles=0;k.points=0;k.lines=0},update:function(f,a,b){switch(k.calls++,a){case 4:k.triangles+=f/3*b;break;case 1:k.lines+=f/2*b;break;case 3:k.lines+=b*(f-1);break;case 2:k.lines+=b*f;break;case 0:k.points+=b*f;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",a)}}}}
function Mf(l,k){return l[0]-k[0]}function Id(l,k){return Math.abs(k[1])-Math.abs(l[1])}function Tg(l,k){var f=1;k=k.isInterleavedBufferAttribute?k.data.array:k.array;k instanceof Int8Array?f=127:k instanceof Int16Array?f=32767:k instanceof Int32Array?f=2147483647:console.error("THREE.WebGLMorphtargets: Unsupported morph attribute data type: ",k);l.divideScalar(f)}function rb(l,k,f){for(var a={},b=new Float32Array(8),c=new WeakMap,d=new B,e=[],g=0;8>g;g++)e[g]=[g,0];return{update:function(h,m,n,q){h=
h.morphTargetInfluences;if(!0===k.isWebGL2){n=m.morphAttributes.position.length;var t=c.get(m);if(void 0===t||t.count!==n){void 0!==t&&t.texture.dispose();t=void 0!==m.morphAttributes.normal;var r=m.morphAttributes.position,u=m.morphAttributes.normal||[],A=!0===t?2:1,w=m.attributes.position.count*A,x=1;w>k.maxTextureSize&&(x=Math.ceil(w/k.maxTextureSize),w=k.maxTextureSize);var C=new Float32Array(w*x*4*n),G=new Nf(C,w,x,n);G.format=1023;G.type=1015;A*=4;for(var I=0;I<n;I++)for(var P=r[I],O=u[I],M=
w*x*4*I,S=0;S<P.count;S++){d.fromBufferAttribute(P,S);!0===P.normalized&&Tg(d,P);var V=S*A;C[M+V+0]=d.x;C[M+V+1]=d.y;C[M+V+2]=d.z;C[M+V+3]=0;!0===t&&(d.fromBufferAttribute(O,S),!0===O.normalized&&Tg(d,O),C[M+V+4]=d.x,C[M+V+5]=d.y,C[M+V+6]=d.z,C[M+V+7]=0)}t={count:n,texture:G,size:new T(w,x)};c.set(m,t)}for(r=n=0;r<h.length;r++)n+=h[r];m=m.morphTargetsRelative?1:1-n;q.getUniforms().setValue(l,"morphTargetBaseInfluence",m);q.getUniforms().setValue(l,"morphTargetInfluences",h);q.getUniforms().setValue(l,
"morphTargetsTexture",t.texture,f);q.getUniforms().setValue(l,"morphTargetsTextureSize",t.size)}else{n=void 0===h?0:h.length;t=a[m.id];if(void 0===t||t.length!==n){t=[];for(r=0;r<n;r++)t[r]=[r,0];a[m.id]=t}for(r=0;r<n;r++)u=t[r],u[0]=r,u[1]=h[r];t.sort(Id);for(h=0;8>h;h++)h<n&&t[h][1]?(e[h][0]=t[h][0],e[h][1]=t[h][1]):(e[h][0]=Number.MAX_SAFE_INTEGER,e[h][1]=0);e.sort(Mf);h=m.morphAttributes.position;n=m.morphAttributes.normal;for(r=t=0;8>r;r++)w=e[r],u=w[0],w=w[1],u!==Number.MAX_SAFE_INTEGER&&w?
(h&&m.getAttribute("morphTarget"+r)!==h[u]&&m.setAttribute("morphTarget"+r,h[u]),n&&m.getAttribute("morphNormal"+r)!==n[u]&&m.setAttribute("morphNormal"+r,n[u]),b[r]=w,t+=w):(h&&!0===m.hasAttribute("morphTarget"+r)&&m.deleteAttribute("morphTarget"+r),n&&!0===m.hasAttribute("morphNormal"+r)&&m.deleteAttribute("morphNormal"+r),b[r]=0);m=m.morphTargetsRelative?1:1-t;q.getUniforms().setValue(l,"morphTargetBaseInfluence",m);q.getUniforms().setValue(l,"morphTargetInfluences",b)}}}}function v(l,k,f,a){function b(d){d=
d.target;d.removeEventListener("dispose",b);f.remove(d.instanceMatrix);null!==d.instanceColor&&f.remove(d.instanceColor)}var c=new WeakMap;return{update:function(d){var e=a.render.frame,g=k.get(d,d.geometry);return c.get(g)!==e&&(k.update(g),c.set(g,e)),d.isInstancedMesh&&(!1===d.hasEventListener("dispose",b)&&d.addEventListener("dispose",b),f.update(d.instanceMatrix,34962),null!==d.instanceColor&&f.update(d.instanceColor,34962)),g},dispose:function(){c=new WeakMap}}}function z(l,k,f){var a=l[0];
if(0>=a||0<a)return l;var b=k*f,c=oj[b];if(void 0===c&&(c=new Float32Array(b),oj[b]=c),0!==k)for(a.toArray(c,0),a=1,b=0;a!==k;++a)b+=f,l[a].toArray(c,b);return c}function F(l,k){if(l.length!==k.length)return!1;for(var f=0,a=l.length;f<a;f++)if(l[f]!==k[f])return!1;return!0}function y(l,k){for(var f=0,a=k.length;f<a;f++)l[f]=k[f]}function L(l,k){var f=pj[k];void 0===f&&(f=new Int32Array(k),pj[k]=f);for(var a=0;a!==k;++a)f[a]=l.allocateTextureUnit();return f}function Q(l,k){var f=this.cache;f[0]!==
k&&(l.uniform1f(this.addr,k),f[0]=k)}function U(l,k){var f=this.cache;void 0!==k.x?f[0]===k.x&&f[1]===k.y||(l.uniform2f(this.addr,k.x,k.y),f[0]=k.x,f[1]=k.y):F(f,k)||(l.uniform2fv(this.addr,k),y(f,k))}function X(l,k){var f=this.cache;void 0!==k.x?f[0]===k.x&&f[1]===k.y&&f[2]===k.z||(l.uniform3f(this.addr,k.x,k.y,k.z),f[0]=k.x,f[1]=k.y,f[2]=k.z):void 0!==k.r?f[0]===k.r&&f[1]===k.g&&f[2]===k.b||(l.uniform3f(this.addr,k.r,k.g,k.b),f[0]=k.r,f[1]=k.g,f[2]=k.b):F(f,k)||(l.uniform3fv(this.addr,k),y(f,k))}
function ta(l,k){var f=this.cache;void 0!==k.x?f[0]===k.x&&f[1]===k.y&&f[2]===k.z&&f[3]===k.w||(l.uniform4f(this.addr,k.x,k.y,k.z,k.w),f[0]=k.x,f[1]=k.y,f[2]=k.z,f[3]=k.w):F(f,k)||(l.uniform4fv(this.addr,k),y(f,k))}function pa(l,k){var f=this.cache,a=k.elements;void 0===a?F(f,k)||(l.uniformMatrix2fv(this.addr,!1,k),y(f,k)):F(f,a)||(qj.set(a),l.uniformMatrix2fv(this.addr,!1,qj),y(f,a))}function Ea(l,k){var f=this.cache,a=k.elements;void 0===a?F(f,k)||(l.uniformMatrix3fv(this.addr,!1,k),y(f,k)):F(f,
a)||(rj.set(a),l.uniformMatrix3fv(this.addr,!1,rj),y(f,a))}function Ya(l,k){var f=this.cache,a=k.elements;void 0===a?F(f,k)||(l.uniformMatrix4fv(this.addr,!1,k),y(f,k)):F(f,a)||(sj.set(a),l.uniformMatrix4fv(this.addr,!1,sj),y(f,a))}function $a(l,k){var f=this.cache;f[0]!==k&&(l.uniform1i(this.addr,k),f[0]=k)}function nb(l,k){var f=this.cache;F(f,k)||(l.uniform2iv(this.addr,k),y(f,k))}function gb(l,k){var f=this.cache;F(f,k)||(l.uniform3iv(this.addr,k),y(f,k))}function Lb(l,k){var f=this.cache;F(f,
k)||(l.uniform4iv(this.addr,k),y(f,k))}function Mb(l,k){var f=this.cache;f[0]!==k&&(l.uniform1ui(this.addr,k),f[0]=k)}function rc(l,k){var f=this.cache;F(f,k)||(l.uniform2uiv(this.addr,k),y(f,k))}function Rc(l,k){var f=this.cache;F(f,k)||(l.uniform3uiv(this.addr,k),y(f,k))}function Sc(l,k){var f=this.cache;F(f,k)||(l.uniform4uiv(this.addr,k),y(f,k))}function md(l,k,f){var a=this.cache,b=f.allocateTextureUnit();a[0]!==b&&(l.uniform1i(this.addr,b),a[0]=b);f.safeSetTexture2D(k||tj,b)}function di(l,k,
f){var a=this.cache,b=f.allocateTextureUnit();a[0]!==b&&(l.uniform1i(this.addr,b),a[0]=b);f.setTexture3D(k||jl,b)}function mc(l,k,f){var a=this.cache,b=f.allocateTextureUnit();a[0]!==b&&(l.uniform1i(this.addr,b),a[0]=b);f.safeSetTextureCube(k||uj,b)}function ei(l,k,f){var a=this.cache,b=f.allocateTextureUnit();a[0]!==b&&(l.uniform1i(this.addr,b),a[0]=b);f.setTexture2DArray(k||kl,b)}function dd(l,k){l.uniform1fv(this.addr,k)}function Of(l,k){k=z(k,this.size,2);l.uniform2fv(this.addr,k)}function Pf(l,
k){k=z(k,this.size,3);l.uniform3fv(this.addr,k)}function Ue(l,k){k=z(k,this.size,4);l.uniform4fv(this.addr,k)}function Jd(l,k){k=z(k,this.size,4);l.uniformMatrix2fv(this.addr,!1,k)}function fi(l,k){k=z(k,this.size,9);l.uniformMatrix3fv(this.addr,!1,k)}function ed(l,k){k=z(k,this.size,16);l.uniformMatrix4fv(this.addr,!1,k)}function gi(l,k){l.uniform1iv(this.addr,k)}function Qf(l,k){l.uniform2iv(this.addr,k)}function ke(l,k){l.uniform3iv(this.addr,k)}function ll(l,k){l.uniform4iv(this.addr,k)}function ml(l,
k){l.uniform1uiv(this.addr,k)}function nl(l,k){l.uniform2uiv(this.addr,k)}function ol(l,k){l.uniform3uiv(this.addr,k)}function pl(l,k){l.uniform4uiv(this.addr,k)}function ql(l,k,f){var a=k.length,b=L(f,a);l.uniform1iv(this.addr,b);for(l=0;l!==a;++l)f.safeSetTexture2D(k[l]||tj,b[l])}function rl(l,k,f){var a=k.length,b=L(f,a);l.uniform1iv(this.addr,b);for(l=0;l!==a;++l)f.safeSetTextureCube(k[l]||uj,b[l])}function sl(l,k,f){this.id=l;this.addr=f;this.cache=[];this.setValue=function(a){switch(a){case 5126:return Q;
case 35664:return U;case 35665:return X;case 35666:return ta;case 35674:return pa;case 35675:return Ea;case 35676:return Ya;case 5124:case 35670:return $a;case 35667:case 35671:return nb;case 35668:case 35672:return gb;case 35669:case 35673:return Lb;case 5125:return Mb;case 36294:return rc;case 36295:return Rc;case 36296:return Sc;case 35678:case 36198:case 36298:case 36306:case 35682:return md;case 35679:case 36299:case 36307:return di;case 35680:case 36300:case 36308:case 36293:return mc;case 36289:case 36303:case 36311:case 36292:return ei}}(k.type)}
function vj(l,k,f){this.id=l;this.addr=f;this.cache=[];this.size=k.size;this.setValue=function(a){switch(a){case 5126:return dd;case 35664:return Of;case 35665:return Pf;case 35666:return Ue;case 35674:return Jd;case 35675:return fi;case 35676:return ed;case 5124:case 35670:return gi;case 35667:case 35671:return Qf;case 35668:case 35672:return ke;case 35669:case 35673:return ll;case 5125:return ml;case 36294:return nl;case 36295:return ol;case 36296:return pl;case 35678:case 36198:case 36298:case 36306:case 35682:return ql;
case 35680:case 36300:case 36308:case 36293:return rl}}(k.type)}function wj(l){this.id=l;this.seq=[];this.map={}}function Kd(l,k){this.seq=[];this.map={};for(var f=l.getProgramParameter(k,35718),a=0;a<f;++a){var b=l.getActiveUniform(k,a),c=l.getUniformLocation(k,b.name),d=this,e=b.name,g=e.length;for(hi.lastIndex=0;;){var h=hi.exec(e),m=hi.lastIndex,n=h[1],q=h[3];if("]"===h[2]&&(n|=0),void 0===q||"["===q&&m+2===g){e=d;b=void 0===q?new sl(n,b,c):new vj(n,b,c);e.seq.push(b);e.map[b.id]=b;break}q=d.map[n];
void 0===q&&(q=new wj(n),n=d,d=q,n.seq.push(d),n.map[d.id]=d);d=q}}}function xj(l,k,f){k=l.createShader(k);return l.shaderSource(k,f),l.compileShader(k),k}function yj(l){switch(l){case 3E3:return["Linear","( value )"];case 3001:return["sRGB","( value )"];case 3002:return["RGBE","( value )"];case 3004:return["RGBM","( value, 7.0 )"];case 3005:return["RGBM","( value, 16.0 )"];case 3006:return["RGBD","( value, 256.0 )"];case 3007:return["Gamma","( value, float( GAMMA_FACTOR ) )"];case 3003:return["LogLuv",
"( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",l),["Linear","( value )"]}}function zj(l,k,f){var a=l.getShaderParameter(k,35713),b=l.getShaderInfoLog(k).trim();if(a&&""===b)l="";else{f=f.toUpperCase()+"\n\n"+b+"\n\n";l=l.getShaderSource(k).split("\n");for(k=0;k<l.length;k++)l[k]=k+1+": "+l[k];l=l.join("\n");l=f+l}return l}function le(l,k){k=yj(k);return"vec4 "+l+"( vec4 value ) { return "+k[0]+"ToLinear"+k[1]+"; }"}function tl(l,k){k=yj(k);return"vec4 "+l+"( vec4 value ) { return LinearTo"+
k[0]+k[1]+"; }"}function ul(l,k){switch(k){case 1:k="Linear";break;case 2:k="Reinhard";break;case 3:k="OptimizedCineon";break;case 4:k="ACESFilmic";break;case 5:k="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",k),k="Linear"}return"vec3 "+l+"( vec3 color ) { return "+k+"ToneMapping( color ); }"}function Rf(l){return""!==l}function Aj(l,k){return l.replace(/NUM_DIR_LIGHTS/g,k.numDirLights).replace(/NUM_SPOT_LIGHTS/g,k.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,
k.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,k.numPointLights).replace(/NUM_HEMI_LIGHTS/g,k.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,k.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,k.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,k.numPointLightShadows)}function Bj(l,k){return l.replace(/NUM_CLIPPING_PLANES/g,k.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,k.numClippingPlanes-k.numClipIntersection)}function ii(l,k){l=jb[k];if(void 0===l)throw Error("Can not resolve #include <"+
k+">");return l.replace(ji,ii)}function Cj(l,k,f,a){return console.warn("WebGLProgram: #pragma unroll_loop shader syntax is deprecated. Please use #pragma unroll_loop_start syntax instead."),ki(l,k,f,a)}function ki(l,k,f,a){l="";for(k=parseInt(k);k<parseInt(f);k++)l+=a.replace(/\[\s*i\s*\]/g,"[ "+k+" ]").replace(/UNROLLED_LOOP_INDEX/g,k);return l}function Dj(l){var k="precision "+l.precision+" float;\nprecision "+l.precision+" int;";return"highp"===l.precision?k+="\n#define HIGH_PRECISION":"mediump"===
l.precision?k+="\n#define MEDIUM_PRECISION":"lowp"===l.precision&&(k+="\n#define LOW_PRECISION"),k}function vl(l,k,f,a){var b=l.getContext(),c=f.defines,d=f.vertexShader,e=f.fragmentShader,g=function(G){var I="SHADOWMAP_TYPE_BASIC";return 1===G.shadowMapType?I="SHADOWMAP_TYPE_PCF":2===G.shadowMapType?I="SHADOWMAP_TYPE_PCF_SOFT":3===G.shadowMapType&&(I="SHADOWMAP_TYPE_VSM"),I}(f),h=function(G){var I="ENVMAP_TYPE_CUBE";if(G.envMap)switch(G.envMapMode){case 301:case 302:I="ENVMAP_TYPE_CUBE";break;case 306:case 307:I=
"ENVMAP_TYPE_CUBE_UV"}return I}(f),m=function(G){var I="ENVMAP_MODE_REFLECTION";if(G.envMap)switch(G.envMapMode){case 302:case 307:I="ENVMAP_MODE_REFRACTION"}return I}(f),n=function(G){var I="ENVMAP_BLENDING_NONE";if(G.envMap)switch(G.combine){case 0:I="ENVMAP_BLENDING_MULTIPLY";break;case 1:I="ENVMAP_BLENDING_MIX";break;case 2:I="ENVMAP_BLENDING_ADD"}return I}(f),q=0<l.gammaFactor?l.gammaFactor:1,t=f.isWebGL2?"":[f.extensionDerivatives||f.envMapCubeUV||f.bumpMap||f.tangentSpaceNormalMap||f.clearcoatNormalMap||
f.flatShading||"physical"===f.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(f.extensionFragDepth||f.logarithmicDepthBuffer)&&f.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",f.extensionDrawBuffers&&f.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(f.extensionShaderTextureLOD||f.envMap||f.transmission)&&f.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(Rf).join("\n"),r=function(G){var I=
[],P;for(P in G){var O=G[P];!1!==O&&I.push("#define "+P+" "+O)}return I.join("\n")}(c),u=b.createProgram(),A,w;c=f.glslVersion?"#version "+f.glslVersion+"\n":"";f.isRawShaderMaterial?(A=[r].filter(Rf).join("\n"),0<A.length&&(A+="\n"),w=[t,r].filter(Rf).join("\n"),0<w.length&&(w+="\n")):(A=[Dj(f),"#define SHADER_NAME "+f.shaderName,r,f.instancing?"#define USE_INSTANCING":"",f.instancingColor?"#define USE_INSTANCING_COLOR":"",f.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+
q,"#define MAX_BONES "+f.maxBones,f.useFog&&f.fog?"#define USE_FOG":"",f.useFog&&f.fogExp2?"#define FOG_EXP2":"",f.map?"#define USE_MAP":"",f.envMap?"#define USE_ENVMAP":"",f.envMap?"#define "+m:"",f.lightMap?"#define USE_LIGHTMAP":"",f.aoMap?"#define USE_AOMAP":"",f.emissiveMap?"#define USE_EMISSIVEMAP":"",f.bumpMap?"#define USE_BUMPMAP":"",f.normalMap?"#define USE_NORMALMAP":"",f.normalMap&&f.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",f.normalMap&&f.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":
"",f.clearcoatMap?"#define USE_CLEARCOATMAP":"",f.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",f.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",f.displacementMap&&f.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",f.specularMap?"#define USE_SPECULARMAP":"",f.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",f.specularColorMap?"#define USE_SPECULARCOLORMAP":"",f.roughnessMap?"#define USE_ROUGHNESSMAP":"",f.metalnessMap?"#define USE_METALNESSMAP":"",f.alphaMap?
"#define USE_ALPHAMAP":"",f.transmission?"#define USE_TRANSMISSION":"",f.transmissionMap?"#define USE_TRANSMISSIONMAP":"",f.thicknessMap?"#define USE_THICKNESSMAP":"",f.sheenColorMap?"#define USE_SHEENCOLORMAP":"",f.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",f.vertexTangents?"#define USE_TANGENT":"",f.vertexColors?"#define USE_COLOR":"",f.vertexAlphas?"#define USE_COLOR_ALPHA":"",f.vertexUvs?"#define USE_UV":"",f.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",f.flatShading?"#define FLAT_SHADED":
"",f.skinning?"#define USE_SKINNING":"",f.useVertexTexture?"#define BONE_TEXTURE":"",f.morphTargets?"#define USE_MORPHTARGETS":"",f.morphNormals&&!1===f.flatShading?"#define USE_MORPHNORMALS":"",f.morphTargets&&f.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",f.morphTargets&&f.isWebGL2?"#define MORPHTARGETS_COUNT "+f.morphTargetsCount:"",f.doubleSided?"#define DOUBLE_SIDED":"",f.flipSided?"#define FLIP_SIDED":"",f.shadowMapEnabled?"#define USE_SHADOWMAP":"",f.shadowMapEnabled?"#define "+g:"",f.sizeAttenuation?
"#define USE_SIZEATTENUATION":"",f.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",f.logarithmicDepthBuffer&&f.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;",
"#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","\tattribute vec4 color;","#elif defined( USE_COLOR )","\tattribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;",
"\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(Rf).join("\n"),w=[t,Dj(f),"#define SHADER_NAME "+f.shaderName,r,"#define GAMMA_FACTOR "+q,f.useFog&&f.fog?"#define USE_FOG":
"",f.useFog&&f.fogExp2?"#define FOG_EXP2":"",f.map?"#define USE_MAP":"",f.matcap?"#define USE_MATCAP":"",f.envMap?"#define USE_ENVMAP":"",f.envMap?"#define "+h:"",f.envMap?"#define "+m:"",f.envMap?"#define "+n:"",f.lightMap?"#define USE_LIGHTMAP":"",f.aoMap?"#define USE_AOMAP":"",f.emissiveMap?"#define USE_EMISSIVEMAP":"",f.bumpMap?"#define USE_BUMPMAP":"",f.normalMap?"#define USE_NORMALMAP":"",f.normalMap&&f.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",f.normalMap&&f.tangentSpaceNormalMap?
"#define TANGENTSPACE_NORMALMAP":"",f.clearcoat?"#define USE_CLEARCOAT":"",f.clearcoatMap?"#define USE_CLEARCOATMAP":"",f.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",f.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",f.specularMap?"#define USE_SPECULARMAP":"",f.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",f.specularColorMap?"#define USE_SPECULARCOLORMAP":"",f.roughnessMap?"#define USE_ROUGHNESSMAP":"",f.metalnessMap?"#define USE_METALNESSMAP":"",f.alphaMap?"#define USE_ALPHAMAP":
"",f.alphaTest?"#define USE_ALPHATEST":"",f.sheen?"#define USE_SHEEN":"",f.sheenColorMap?"#define USE_SHEENCOLORMAP":"",f.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",f.transmission?"#define USE_TRANSMISSION":"",f.transmissionMap?"#define USE_TRANSMISSIONMAP":"",f.thicknessMap?"#define USE_THICKNESSMAP":"",f.vertexTangents?"#define USE_TANGENT":"",f.vertexColors||f.instancingColor?"#define USE_COLOR":"",f.vertexAlphas?"#define USE_COLOR_ALPHA":"",f.vertexUvs?"#define USE_UV":"",f.uvsVertexOnly?
"#define UVS_VERTEX_ONLY":"",f.gradientMap?"#define USE_GRADIENTMAP":"",f.flatShading?"#define FLAT_SHADED":"",f.doubleSided?"#define DOUBLE_SIDED":"",f.flipSided?"#define FLIP_SIDED":"",f.shadowMapEnabled?"#define USE_SHADOWMAP":"",f.shadowMapEnabled?"#define "+g:"",f.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",f.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",f.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",f.logarithmicDepthBuffer&&f.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":
"",(f.extensionShaderTextureLOD||f.envMap)&&f.rendererExtensionShaderTextureLod?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",0!==f.toneMapping?"#define TONE_MAPPING":"",0!==f.toneMapping?jb.tonemapping_pars_fragment:"",0!==f.toneMapping?ul("toneMapping",f.toneMapping):"",f.dithering?"#define DITHERING":"",1022===f.format?"#define OPAQUE":"",jb.encodings_pars_fragment,f.map?le("mapTexelToLinear",f.mapEncoding):"",f.matcap?le("matcapTexelToLinear",
f.matcapEncoding):"",f.envMap?le("envMapTexelToLinear",f.envMapEncoding):"",f.emissiveMap?le("emissiveMapTexelToLinear",f.emissiveMapEncoding):"",f.specularColorMap?le("specularColorMapTexelToLinear",f.specularColorMapEncoding):"",f.sheenColorMap?le("sheenColorMapTexelToLinear",f.sheenColorMapEncoding):"",f.lightMap?le("lightMapTexelToLinear",f.lightMapEncoding):"",tl("linearToOutputTexel",f.outputEncoding),f.depthPacking?"#define DEPTH_PACKING "+f.depthPacking:"","\n"].filter(Rf).join("\n"));d=d.replace(ji,
ii);d=Aj(d,f);d=Bj(d,f);e=e.replace(ji,ii);e=Aj(e,f);e=Bj(e,f);d=d.replace(Ej,ki).replace(Fj,Cj);e=e.replace(Ej,ki).replace(Fj,Cj);f.isWebGL2&&!0!==f.isRawShaderMaterial&&(c="#version 300 es\n",A="precision mediump sampler2DArray;\n#define attribute in\n#define varying out\n#define texture2D texture\n"+A,w=["#define varying in","300 es"===f.glslVersion?"":"out highp vec4 pc_fragColor;","300 es"===f.glslVersion?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth\n#define texture2D texture\n#define textureCube texture\n#define texture2DProj textureProj\n#define texture2DLodEXT textureLod\n#define texture2DProjLodEXT textureProjLod\n#define textureCubeLodEXT textureLod\n#define texture2DGradEXT textureGrad\n#define texture2DProjGradEXT textureProjGrad\n#define textureCubeGradEXT textureGrad"].join("\n")+
"\n"+w);e=c+w+e;d=xj(b,35633,c+A+d);e=xj(b,35632,e);if(b.attachShader(u,d),b.attachShader(u,e),void 0!==f.index0AttributeName?b.bindAttribLocation(u,0,f.index0AttributeName):!0===f.morphTargets&&b.bindAttribLocation(u,0,"position"),b.linkProgram(u),l.debug.checkShaderErrors)l=b.getProgramInfoLog(u).trim(),g=b.getShaderInfoLog(d).trim(),h=b.getShaderInfoLog(e).trim(),n=m=!0,!1===b.getProgramParameter(u,35714)?(m=!1,q=zj(b,d,"vertex"),t=zj(b,e,"fragment"),console.error("THREE.WebGLProgram: Shader Error "+
b.getError()+" - VALIDATE_STATUS "+b.getProgramParameter(u,35715)+"\n\nProgram Info Log: "+l+"\n"+q+"\n"+t)):""!==l?console.warn("THREE.WebGLProgram: Program Info Log:",l):""!==g&&""!==h||(n=!1),n&&(this.diagnostics={runnable:m,programLog:l,vertexShader:{log:g,prefix:A},fragmentShader:{log:h,prefix:w}});var x,C;return b.deleteShader(d),b.deleteShader(e),this.getUniforms=function(){return void 0===x&&(x=new Kd(b,u)),x},this.getAttributes=function(){if(void 0===C){for(var G={},I=b.getProgramParameter(u,
35721),P=0;P<I;P++){var O=b.getActiveAttrib(u,P),M=O.name,S=1;35674===O.type&&(S=2);35675===O.type&&(S=3);35676===O.type&&(S=4);G[M]={type:O.type,location:b.getAttribLocation(u,M),locationSize:S}}C=G}return C},this.destroy=function(){a.releaseStatesOfProgram(this);b.deleteProgram(u);this.program=void 0},this.name=f.shaderName,this.id=wl++,this.cacheKey=k,this.usedTimes=1,this.program=u,this.vertexShader=d,this.fragmentShader=e,this}function xl(l,k,f,a,b,c,d){function e(w){var x;return w&&w.isTexture?
x=w.encoding:w&&w.isWebGLRenderTarget?(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),x=w.texture.encoding):x=3E3,h&&w&&w.isTexture&&1023===w.format&&1009===w.type&&3001===w.encoding&&(x=3E3),x}var g=[],h=b.isWebGL2,m=b.logarithmicDepthBuffer,n=b.floatVertexTextures,q=b.maxVertexUniforms,t=b.vertexTextures,r=b.precision,u={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",
MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"},A=["precision","isWebGL2","supportsVertexTextures","outputEncoding","instancing","instancingColor","map","mapEncoding","matcap","matcapEncoding","envMap","envMapMode","envMapEncoding",
"envMapCubeUV","lightMap","lightMapEncoding","aoMap","emissiveMap","emissiveMapEncoding","bumpMap","normalMap","objectSpaceNormalMap","tangentSpaceNormalMap","clearcoat","clearcoatMap","clearcoatRoughnessMap","clearcoatNormalMap","displacementMap","specularMap",,"roughnessMap","metalnessMap","gradientMap","alphaMap","alphaTest","combine","vertexColors","vertexAlphas","vertexTangents","vertexUvs","uvsVertexOnly","fog","useFog","fogExp2","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning",
"maxBones","useVertexTexture","morphTargets","morphNormals","morphTargetsCount","premultipliedAlpha","numDirLights","numPointLights","numSpotLights","numHemiLights","numRectAreaLights","numDirLightShadows","numPointLightShadows","numSpotLightShadows","shadowMapEnabled","shadowMapType","toneMapping","physicallyCorrectLights","doubleSided","flipSided","numClippingPlanes","numClipIntersection","depthPacking","dithering","format","specularIntensityMap","specularColorMap","specularColorMapEncoding","transmission",
"transmissionMap","thicknessMap","sheen","sheenColorMap","sheenColorMapEncoding","sheenRoughnessMap"];return{getParameters:function(w,x,C,G,I){var P=G.fog;G=w.isMeshStandardMaterial?G.environment:null;G=(w.isMeshStandardMaterial?f:k).get(w.envMap||G);var O=u[w.type];if(I.isSkinnedMesh){var M=I.skeleton.bones;if(n)M=1024;else{var S=Math.min(Math.floor((q-20)/4),M.length);M=S<M.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+M.length+" bones. This GPU supports "+S+"."),0):S}}else M=0;if(null!==
w.precision&&(r=b.getMaxPrecision(w.precision),r!==w.precision&&console.warn("THREE.WebGLProgram.getParameters:",w.precision,"not supported, using",r,"instead.")),O){var V=Qc[O];S=V.vertexShader;V=V.fragmentShader}else S=w.vertexShader,V=w.fragmentShader;var ba=l.getRenderTarget(),Y=0<w.alphaTest,Z=0<w.clearcoat;return{isWebGL2:h,shaderID:O,shaderName:w.type,vertexShader:S,fragmentShader:V,defines:w.defines,isRawShaderMaterial:!0===w.isRawShaderMaterial,glslVersion:w.glslVersion,precision:r,instancing:!0===
I.isInstancedMesh,instancingColor:!0===I.isInstancedMesh&&null!==I.instanceColor,supportsVertexTextures:t,outputEncoding:null!==ba?e(ba.texture):l.outputEncoding,map:!!w.map,mapEncoding:e(w.map),matcap:!!w.matcap,matcapEncoding:e(w.matcap),envMap:!!G,envMapMode:G&&G.mapping,envMapEncoding:e(G),envMapCubeUV:!!G&&(306===G.mapping||307===G.mapping),lightMap:!!w.lightMap,lightMapEncoding:e(w.lightMap),aoMap:!!w.aoMap,emissiveMap:!!w.emissiveMap,emissiveMapEncoding:e(w.emissiveMap),bumpMap:!!w.bumpMap,
normalMap:!!w.normalMap,objectSpaceNormalMap:1===w.normalMapType,tangentSpaceNormalMap:0===w.normalMapType,clearcoat:Z,clearcoatMap:Z&&!!w.clearcoatMap,clearcoatRoughnessMap:Z&&!!w.clearcoatRoughnessMap,clearcoatNormalMap:Z&&!!w.clearcoatNormalMap,displacementMap:!!w.displacementMap,roughnessMap:!!w.roughnessMap,metalnessMap:!!w.metalnessMap,specularMap:!!w.specularMap,specularIntensityMap:!!w.specularIntensityMap,specularColorMap:!!w.specularColorMap,specularColorMapEncoding:e(w.specularColorMap),
alphaMap:!!w.alphaMap,alphaTest:Y,gradientMap:!!w.gradientMap,sheen:0<w.sheen,sheenColorMap:!!w.sheenColorMap,sheenColorMapEncoding:e(w.sheenColorMap),sheenRoughnessMap:!!w.sheenRoughnessMap,transmission:0<w.transmission,transmissionMap:!!w.transmissionMap,thicknessMap:!!w.thicknessMap,combine:w.combine,vertexTangents:!!w.normalMap&&!!I.geometry&&!!I.geometry.attributes.tangent,vertexColors:w.vertexColors,vertexAlphas:!0===w.vertexColors&&!!I.geometry&&!!I.geometry.attributes.color&&4===I.geometry.attributes.color.itemSize,
vertexUvs:!!w.map||!!w.bumpMap||!!w.normalMap||!!w.specularMap||!!w.alphaMap||!!w.emissiveMap||!!w.roughnessMap||!!w.metalnessMap||!!w.clearcoatMap||!!w.clearcoatRoughnessMap||!!w.clearcoatNormalMap||!!w.displacementMap||!!w.transmissionMap||!!w.thicknessMap||!!w.specularIntensityMap||!!w.specularColorMap||!!w.sheenColorMap||w.sheenRoughnessMap,uvsVertexOnly:!(w.map||w.bumpMap||w.normalMap||w.specularMap||w.alphaMap||w.emissiveMap||w.roughnessMap||w.metalnessMap||w.clearcoatNormalMap||0<w.transmission||
w.transmissionMap||w.thicknessMap||w.specularIntensityMap||w.specularColorMap||0< !!w.sheen||w.sheenColorMap||w.sheenRoughnessMap||!w.displacementMap),fog:!!P,useFog:w.fog,fogExp2:P&&P.isFogExp2,flatShading:!!w.flatShading,sizeAttenuation:w.sizeAttenuation,logarithmicDepthBuffer:m,skinning:!0===I.isSkinnedMesh&&0<M,maxBones:M,useVertexTexture:n,morphTargets:!!I.geometry&&!!I.geometry.morphAttributes.position,morphNormals:!!I.geometry&&!!I.geometry.morphAttributes.normal,morphTargetsCount:I.geometry&&
I.geometry.morphAttributes.position?I.geometry.morphAttributes.position.length:0,numDirLights:x.directional.length,numPointLights:x.point.length,numSpotLights:x.spot.length,numRectAreaLights:x.rectArea.length,numHemiLights:x.hemi.length,numDirLightShadows:x.directionalShadowMap.length,numPointLightShadows:x.pointShadowMap.length,numSpotLightShadows:x.spotShadowMap.length,numClippingPlanes:d.numPlanes,numClipIntersection:d.numIntersection,format:w.format,dithering:w.dithering,shadowMapEnabled:l.shadowMap.enabled&&
0<C.length,shadowMapType:l.shadowMap.type,toneMapping:w.toneMapped?l.toneMapping:0,physicallyCorrectLights:l.physicallyCorrectLights,premultipliedAlpha:w.premultipliedAlpha,doubleSided:2===w.side,flipSided:1===w.side,depthPacking:void 0!==w.depthPacking&&w.depthPacking,index0AttributeName:w.index0AttributeName,extensionDerivatives:w.extensions&&w.extensions.derivatives,extensionFragDepth:w.extensions&&w.extensions.fragDepth,extensionDrawBuffers:w.extensions&&w.extensions.drawBuffers,extensionShaderTextureLOD:w.extensions&&
w.extensions.shaderTextureLOD,rendererExtensionFragDepth:h||a.has("EXT_frag_depth"),rendererExtensionDrawBuffers:h||a.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:h||a.has("EXT_shader_texture_lod"),customProgramCacheKey:w.customProgramCacheKey()}},getProgramCacheKey:function(w){var x=[];if(w.shaderID?x.push(w.shaderID):(x.push(xa(w.fragmentShader)),x.push(xa(w.vertexShader))),void 0!==w.defines)for(var C in w.defines)x.push(C),x.push(w.defines[C]);if(!1===w.isRawShaderMaterial){for(C=
0;C<A.length;C++)x.push(w[A[C]]);x.push(l.outputEncoding);x.push(l.gammaFactor)}return x.push(w.customProgramCacheKey),x.join()},getUniforms:function(w){var x=u[w.type];return x?Gj.clone(Qc[x].uniforms):w.uniforms},acquireProgram:function(w,x){for(var C,G=0,I=g.length;G<I;G++){var P=g[G];if(P.cacheKey===x){C=P;++C.usedTimes;break}}return void 0===C&&(C=new vl(l,x,w,c),g.push(C)),C},releaseProgram:function(w){if(0==--w.usedTimes){var x=g.indexOf(w);g[x]=g[g.length-1];g.pop();w.destroy()}},programs:g}}
function yl(){var l=new WeakMap;return{get:function(k){var f=l.get(k);return void 0===f&&(f={},l.set(k,f)),f},remove:function(k){l.delete(k)},update:function(k,f,a){l.get(k)[f]=a},dispose:function(){l=new WeakMap}}}function zl(l,k){return l.groupOrder!==k.groupOrder?l.groupOrder-k.groupOrder:l.renderOrder!==k.renderOrder?l.renderOrder-k.renderOrder:l.program!==k.program?l.program.id-k.program.id:l.material.id!==k.material.id?l.material.id-k.material.id:l.z!==k.z?l.z-k.z:l.id-k.id}function Hj(l,k){return l.groupOrder!==
k.groupOrder?l.groupOrder-k.groupOrder:l.renderOrder!==k.renderOrder?l.renderOrder-k.renderOrder:l.z!==k.z?k.z-l.z:l.id-k.id}function Ij(l){function k(g,h,m,n,q,t){var r=f[a],u=l.get(m);return void 0===r?(r={id:g.id,object:g,geometry:h,material:m,program:u.program||e,groupOrder:n,renderOrder:g.renderOrder,z:q,group:t},f[a]=r):(r.id=g.id,r.object=g,r.geometry=h,r.material=m,r.program=u.program||e,r.groupOrder=n,r.renderOrder=g.renderOrder,r.z=q,r.group=t),a++,r}var f=[],a=0,b=[],c=[],d=[],e={id:-1};
return{opaque:b,transmissive:c,transparent:d,init:function(){a=0;b.length=0;c.length=0;d.length=0},push:function(g,h,m,n,q,t){g=k(g,h,m,n,q,t);0<m.transmission?c.push(g):!0===m.transparent?d.push(g):b.push(g)},unshift:function(g,h,m,n,q,t){g=k(g,h,m,n,q,t);0<m.transmission?c.unshift(g):!0===m.transparent?d.unshift(g):b.unshift(g)},finish:function(){for(var g=a,h=f.length;g<h;g++){var m=f[g];if(null===m.id)break;m.id=null;m.object=null;m.geometry=null;m.material=null;m.program=null;m.group=null}},
sort:function(g,h){1<b.length&&b.sort(g||zl);1<c.length&&c.sort(h||Hj);1<d.length&&d.sort(h||Hj)}}}function Al(l){var k=new WeakMap;return{get:function(f,a){var b;return!1===k.has(f)?(b=new Ij(l),k.set(f,[b])):a>=k.get(f).length?(b=new Ij(l),k.get(f).push(b)):b=k.get(f)[a],b},dispose:function(){k=new WeakMap}}}function Bl(){var l={};return{get:function(k){if(void 0!==l[k.id])return l[k.id];switch(k.type){case "DirectionalLight":var f={direction:new B,color:new ma};break;case "SpotLight":f={position:new B,
direction:new B,color:new ma,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case "PointLight":f={position:new B,color:new ma,distance:0,decay:0};break;case "HemisphereLight":f={direction:new B,skyColor:new ma,groundColor:new ma};break;case "RectAreaLight":f={color:new ma,position:new B,halfWidth:new B,halfHeight:new B}}return l[k.id]=f,f}}}function Cl(l,k){return(k.castShadow?1:0)-(l.castShadow?1:0)}function Dl(l,k){for(var f=new Bl,a=function(){var h={};return{get:function(m){if(void 0!==h[m.id])return h[m.id];
switch(m.type){case "DirectionalLight":case "SpotLight":var n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new T};break;case "PointLight":n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new T,shadowCameraNear:1,shadowCameraFar:1E3}}return h[m.id]=n,n}}}(),b={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],
directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadow:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]},c=0;9>c;c++)b.probe.push(new B);var d=new B,e=new ua,g=new ua;return{setup:function(h,m){for(var n=0,q=0,t=0,r=0;9>r;r++)b.probe[r].set(0,0,0);var u=r=0,A=0,w=0,x=0,C=0,G=0,I=0;h.sort(Cl);m=!0!==m?Math.PI:1;for(var P=0,O=h.length;P<O;P++){var M=h[P],S=M.color,V=M.intensity,
ba=M.distance,Y=M.shadow&&M.shadow.map?M.shadow.map.texture:null;if(M.isAmbientLight)n+=S.r*V*m,q+=S.g*V*m,t+=S.b*V*m;else if(M.isLightProbe)for(Y=0;9>Y;Y++)b.probe[Y].addScaledVector(M.sh.coefficients[Y],V);else if(M.isDirectionalLight){V=f.get(M);if(V.color.copy(M.color).multiplyScalar(M.intensity*m),M.castShadow){var Z=M.shadow;S=a.get(M);S.shadowBias=Z.bias;S.shadowNormalBias=Z.normalBias;S.shadowRadius=Z.radius;S.shadowMapSize=Z.mapSize;b.directionalShadow[r]=S;b.directionalShadowMap[r]=Y;b.directionalShadowMatrix[r]=
M.shadow.matrix;C++}b.directional[r]=V;r++}else if(M.isSpotLight){Z=f.get(M);if(Z.position.setFromMatrixPosition(M.matrixWorld),Z.color.copy(S).multiplyScalar(V*m),Z.distance=ba,Z.coneCos=Math.cos(M.angle),Z.penumbraCos=Math.cos(M.angle*(1-M.penumbra)),Z.decay=M.decay,M.castShadow)V=M.shadow,S=a.get(M),S.shadowBias=V.bias,S.shadowNormalBias=V.normalBias,S.shadowRadius=V.radius,S.shadowMapSize=V.mapSize,b.spotShadow[A]=S,b.spotShadowMap[A]=Y,b.spotShadowMatrix[A]=M.shadow.matrix,I++;b.spot[A]=Z;A++}else if(M.isRectAreaLight)Y=
f.get(M),Y.color.copy(S).multiplyScalar(V),Y.halfWidth.set(.5*M.width,0,0),Y.halfHeight.set(0,.5*M.height,0),b.rectArea[w]=Y,w++;else if(M.isPointLight){V=f.get(M);if(V.color.copy(M.color).multiplyScalar(M.intensity*m),V.distance=M.distance,V.decay=M.decay,M.castShadow)Z=M.shadow,S=a.get(M),S.shadowBias=Z.bias,S.shadowNormalBias=Z.normalBias,S.shadowRadius=Z.radius,S.shadowMapSize=Z.mapSize,S.shadowCameraNear=Z.camera.near,S.shadowCameraFar=Z.camera.far,b.pointShadow[u]=S,b.pointShadowMap[u]=Y,b.pointShadowMatrix[u]=
M.shadow.matrix,G++;b.point[u]=V;u++}else M.isHemisphereLight&&(Y=f.get(M),Y.skyColor.copy(M.color).multiplyScalar(V*m),Y.groundColor.copy(M.groundColor).multiplyScalar(V*m),b.hemi[x]=Y,x++)}0<w&&(k.isWebGL2||!0===l.has("OES_texture_float_linear")?(b.rectAreaLTC1=Ca.LTC_FLOAT_1,b.rectAreaLTC2=Ca.LTC_FLOAT_2):!0===l.has("OES_texture_half_float_linear")?(b.rectAreaLTC1=Ca.LTC_HALF_1,b.rectAreaLTC2=Ca.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions."));
b.ambient[0]=n;b.ambient[1]=q;b.ambient[2]=t;h=b.hash;h.directionalLength===r&&h.pointLength===u&&h.spotLength===A&&h.rectAreaLength===w&&h.hemiLength===x&&h.numDirectionalShadows===C&&h.numPointShadows===G&&h.numSpotShadows===I||(b.directional.length=r,b.spot.length=A,b.rectArea.length=w,b.point.length=u,b.hemi.length=x,b.directionalShadow.length=C,b.directionalShadowMap.length=C,b.pointShadow.length=G,b.pointShadowMap.length=G,b.spotShadow.length=I,b.spotShadowMap.length=I,b.directionalShadowMatrix.length=
C,b.pointShadowMatrix.length=G,b.spotShadowMatrix.length=I,h.directionalLength=r,h.pointLength=u,h.spotLength=A,h.rectAreaLength=w,h.hemiLength=x,h.numDirectionalShadows=C,h.numPointShadows=G,h.numSpotShadows=I,b.version=El++)},setupView:function(h,m){var n=0,q=0,t=0,r=0,u=0;m=m.matrixWorldInverse;for(var A=0,w=h.length;A<w;A++){var x=h[A];if(x.isDirectionalLight){var C=b.directional[n];C.direction.setFromMatrixPosition(x.matrixWorld);d.setFromMatrixPosition(x.target.matrixWorld);C.direction.sub(d);
C.direction.transformDirection(m);n++}else x.isSpotLight?(C=b.spot[t],C.position.setFromMatrixPosition(x.matrixWorld),C.position.applyMatrix4(m),C.direction.setFromMatrixPosition(x.matrixWorld),d.setFromMatrixPosition(x.target.matrixWorld),C.direction.sub(d),C.direction.transformDirection(m),t++):x.isRectAreaLight?(C=b.rectArea[r],C.position.setFromMatrixPosition(x.matrixWorld),C.position.applyMatrix4(m),g.identity(),e.copy(x.matrixWorld),e.premultiply(m),g.extractRotation(e),C.halfWidth.set(.5*x.width,
0,0),C.halfHeight.set(0,.5*x.height,0),C.halfWidth.applyMatrix4(g),C.halfHeight.applyMatrix4(g),r++):x.isPointLight?(C=b.point[q],C.position.setFromMatrixPosition(x.matrixWorld),C.position.applyMatrix4(m),q++):x.isHemisphereLight&&(C=b.hemi[u],C.direction.setFromMatrixPosition(x.matrixWorld),C.direction.transformDirection(m),C.direction.normalize(),u++)}},state:b}}function Jj(l,k){var f=new Dl(l,k),a=[],b=[];return{init:function(){a.length=0;b.length=0},state:{lightsArray:a,shadowsArray:b,lights:f},
setupLights:function(c){f.setup(a,c)},setupLightsView:function(c){f.setupView(a,c)},pushLight:function(c){a.push(c)},pushShadow:function(c){b.push(c)}}}function Fl(l,k){var f=new WeakMap;return{get:function(a,b){b=void 0===b?0:b;var c;return!1===f.has(a)?(c=new Jj(l,k),f.set(a,[c])):b>=f.get(a).length?(c=new Jj(l,k),f.get(a).push(c)):c=f.get(a)[b],c},dispose:function(){f=new WeakMap}}}function Kj(l,k,f){function a(x,C,G,I,P,O,M){x=!0===I.isPointLight?x.customDistanceMaterial:x.customDepthMaterial;
if(x=void 0!==x?x:!0===I.isPointLight?m:h,l.localClippingEnabled&&!0===G.clipShadows&&0!==G.clippingPlanes.length||G.displacementMap&&0!==G.displacementScale||G.alphaMap&&0<G.alphaTest){var S=x.uuid;C=G.uuid;var V=n[S];void 0===V&&(V={},n[S]=V);S=V[C];void 0===S&&(S=x.clone(),V[C]=S);x=S}return x.visible=G.visible,x.wireframe=G.wireframe,x.side=3===M?null!==G.shadowSide?G.shadowSide:G.side:null!==G.shadowSide?G.shadowSide:t[G.side],x.alphaMap=G.alphaMap,x.alphaTest=G.alphaTest,x.clipShadows=G.clipShadows,
x.clippingPlanes=G.clippingPlanes,x.clipIntersection=G.clipIntersection,x.displacementMap=G.displacementMap,x.displacementScale=G.displacementScale,x.displacementBias=G.displacementBias,x.wireframeLinewidth=G.wireframeLinewidth,x.linewidth=G.linewidth,!0===I.isPointLight&&!0===x.isMeshDistanceMaterial&&(x.referencePosition.setFromMatrixPosition(I.matrixWorld),x.nearDistance=P,x.farDistance=O),x}function b(x,C,G,I,P){if(!1!==x.visible){if(x.layers.test(C.layers)&&(x.isMesh||x.isLine||x.isPoints)&&
(x.castShadow||x.receiveShadow&&3===P)&&(!x.frustumCulled||c.intersectsObject(x))){x.modelViewMatrix.multiplyMatrices(G.matrixWorldInverse,x.matrixWorld);var O=k.update(x),M=x.material;if(Array.isArray(M))for(var S=O.groups,V=0,ba=S.length;V<ba;V++){var Y=S[V],Z=M[Y.materialIndex];Z&&Z.visible&&(Z=a(x,0,Z,I,G.near,G.far,P),l.renderBufferDirect(G,null,O,Z,x,Y))}else M.visible&&(M=a(x,0,M,I,G.near,G.far,P),l.renderBufferDirect(G,null,O,M,x,null))}x=x.children;O=0;for(M=x.length;O<M;O++)b(x[O],C,G,I,
P)}}var c=new wc,d=new T,e=new T,g=new za,h=new Ve({depthPacking:3201}),m=new We,n={},q=f.maxTextureSize,t={0:1,1:0,2:2},r=new Bc({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new T},radius:{value:4}},vertexShader:"void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n\tconst float samples = float( VSM_SAMPLES );\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );\n\tfloat uvStart = samples <= 1.0 ? 0.0 : - 1.0;\n\tfor ( float i = 0.0; i < samples; i ++ ) {\n\t\tfloat uvOffset = uvStart + i * uvStride;\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean / samples;\n\tsquared_mean = squared_mean / samples;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}"}),
u=r.clone();u.defines.HORIZONTAL_PASS=1;f=new ra;f.setAttribute("position",new Ba(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));var A=new vb(f,r),w=this;this.enabled=!1;this.autoUpdate=!0;this.needsUpdate=!1;this.type=1;this.render=function(x,C,G){if(!1!==w.enabled&&(!1!==w.autoUpdate||!1!==w.needsUpdate)&&0!==x.length){var I=l.getRenderTarget(),P=l.getActiveCubeFace(),O=l.getActiveMipmapLevel(),M=l.state;M.setBlending(0);M.buffers.color.setClear(1,1,1,1);M.buffers.depth.setTest(!0);M.setScissorTest(!1);
for(var S=0,V=x.length;S<V;S++){var ba=x[S],Y=ba.shadow;if(void 0===Y)console.warn("THREE.WebGLShadowMap:",ba,"has no shadow.");else if(!1!==Y.autoUpdate||!1!==Y.needsUpdate){d.copy(Y.mapSize);var Z=Y.getFrameExtents();(d.multiply(Z),e.copy(Y.mapSize),(d.x>q||d.y>q)&&(d.x>q&&(e.x=Math.floor(q/Z.x),d.x=e.x*Z.x,Y.mapSize.x=e.x),d.y>q&&(e.y=Math.floor(q/Z.y),d.y=e.y*Z.y,Y.mapSize.y=e.y)),null!==Y.map||Y.isPointLightShadow||3!==this.type)||(Z={minFilter:1006,magFilter:1006,format:1023},Y.map=new Rb(d.x,
d.y,Z),Y.map.texture.name=ba.name+".shadowMap",Y.mapPass=new Rb(d.x,d.y,Z),Y.camera.updateProjectionMatrix());null===Y.map&&(Y.map=new Rb(d.x,d.y,{minFilter:1003,magFilter:1003,format:1023}),Y.map.texture.name=ba.name+".shadowMap",Y.camera.updateProjectionMatrix());l.setRenderTarget(Y.map);l.clear();Z=Y.getViewportCount();for(var Ha=0;Ha<Z;Ha++){var ya=Y.getViewport(Ha);g.set(e.x*ya.x,e.y*ya.y,e.x*ya.z,e.y*ya.w);M.viewport(g);Y.updateMatrices(ba,Ha);c=Y.getFrustum();b(C,G,Y.camera,ba,this.type)}Y.isPointLightShadow||
3!==this.type||(ba=G,Z=k.update(A),r.defines.VSM_SAMPLES!==Y.blurSamples&&(r.defines.VSM_SAMPLES=Y.blurSamples,u.defines.VSM_SAMPLES=Y.blurSamples,r.needsUpdate=!0,u.needsUpdate=!0),r.uniforms.shadow_pass.value=Y.map.texture,r.uniforms.resolution.value=Y.mapSize,r.uniforms.radius.value=Y.radius,l.setRenderTarget(Y.mapPass),l.clear(),l.renderBufferDirect(ba,null,Z,r,A,null),u.uniforms.shadow_pass.value=Y.mapPass.texture,u.uniforms.resolution.value=Y.mapSize,u.uniforms.radius.value=Y.radius,l.setRenderTarget(Y.map),
l.clear(),l.renderBufferDirect(ba,null,Z,u,A,null));Y.needsUpdate=!1}}w.needsUpdate=!1;l.setRenderTarget(I,P,O)}}}function Gl(l,k,f){function a(K,ha,da){var wa=new Uint8Array(4),na=l.createTexture();l.bindTexture(K,na);l.texParameteri(K,10241,9728);l.texParameteri(K,10240,9728);for(K=0;K<da;K++)l.texImage2D(ha+K,0,6408,1,1,0,6408,5121,wa);return na}function b(K){!0!==u[K]&&(l.enable(K),u[K]=!0)}function c(K){!1!==u[K]&&(l.disable(K),u[K]=!1)}function d(K,ha,da,wa,na,Za,Ka,pb){if(0!==K)if(!1===C&&
(b(3042),C=!0),5===K)na=na||ha,Za=Za||da,Ka=Ka||wa,ha===I&&na===M||(l.blendEquationSeparate(W[ha],W[na]),I=ha,M=na),da===P&&wa===O&&Za===S&&Ka===V||(l.blendFuncSeparate(qa[da],qa[wa],qa[Za],qa[Ka]),P=da,O=wa,S=Za,V=Ka),G=K,ba=null;else{if(K!==G||pb!==ba){if(100===I&&100===M||(l.blendEquation(32774),I=100,M=100),pb)switch(K){case 1:l.blendFuncSeparate(1,771,1,771);break;case 2:l.blendFunc(1,1);break;case 3:l.blendFuncSeparate(0,0,769,771);break;case 4:l.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",
K)}else switch(K){case 1:l.blendFuncSeparate(770,771,1,771);break;case 2:l.blendFunc(770,1);break;case 3:l.blendFunc(0,769);break;case 4:l.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",K)}V=S=O=P=null;G=K;ba=pb}}else!0===C&&(c(3042),C=!1)}function e(K){Y!==K&&(K?l.frontFace(2304):l.frontFace(2305),Y=K)}function g(K){0!==K?(b(2884),K!==Z&&(1===K?l.cullFace(1029):2===K?l.cullFace(1028):l.cullFace(1032))):c(2884);Z=K}function h(K,ha,da){K?(b(32823),ya===ha&&ja===
da||(l.polygonOffset(ha,da),ya=ha,ja=da)):c(32823)}function m(K){void 0===K&&(K=33984+Ja-1);Xa!==K&&(l.activeTexture(K),Xa=K)}var n=f.isWebGL2,q=new function(){var K=!1,ha=new za,da=null,wa=new za(0,0,0,0);return{setMask:function(na){da===na||K||(l.colorMask(na,na,na,na),da=na)},setLocked:function(na){K=na},setClear:function(na,Za,Ka,pb,xc){!0===xc&&(na*=pb,Za*=pb,Ka*=pb);ha.set(na,Za,Ka,pb);!1===wa.equals(ha)&&(l.clearColor(na,Za,Ka,pb),wa.copy(ha))},reset:function(){K=!1;da=null;wa.set(-1,0,0,0)}}},
t=new function(){var K=!1,ha=null,da=null,wa=null;return{setTest:function(na){na?b(2929):c(2929)},setMask:function(na){ha===na||K||(l.depthMask(na),ha=na)},setFunc:function(na){if(da!==na){if(na)switch(na){case 0:l.depthFunc(512);break;case 1:l.depthFunc(519);break;case 2:l.depthFunc(513);break;default:l.depthFunc(515);break;case 4:l.depthFunc(514);break;case 5:l.depthFunc(518);break;case 6:l.depthFunc(516);break;case 7:l.depthFunc(517)}else l.depthFunc(515);da=na}},setLocked:function(na){K=na},setClear:function(na){wa!==
na&&(l.clearDepth(na),wa=na)},reset:function(){K=!1;wa=da=ha=null}}},r=new function(){var K=!1,ha=null,da=null,wa=null,na=null,Za=null,Ka=null,pb=null,xc=null;return{setTest:function(Eb){K||(Eb?b(2960):c(2960))},setMask:function(Eb){ha===Eb||K||(l.stencilMask(Eb),ha=Eb)},setFunc:function(Eb,Fa,Da){da===Eb&&wa===Fa&&na===Da||(l.stencilFunc(Eb,Fa,Da),da=Eb,wa=Fa,na=Da)},setOp:function(Eb,Fa,Da){Za===Eb&&Ka===Fa&&pb===Da||(l.stencilOp(Eb,Fa,Da),Za=Eb,Ka=Fa,pb=Da)},setLocked:function(Eb){K=Eb},setClear:function(Eb){xc!==
Eb&&(l.clearStencil(Eb),xc=Eb)},reset:function(){K=!1;xc=pb=Ka=Za=na=wa=da=ha=null}}},u={},A=null,w={},x=null,C=!1,G=null,I=null,P=null,O=null,M=null,S=null,V=null,ba=!1,Y=null,Z=null,Ha=null,ya=null,ja=null,Ja=l.getParameter(35661),Va=!1;f=0;var db=l.getParameter(7938);-1!==db.indexOf("WebGL")?(f=parseFloat(/^WebGL (\d)/.exec(db)[1]),Va=1<=f):-1!==db.indexOf("OpenGL ES")&&(f=parseFloat(/^OpenGL ES (\d)/.exec(db)[1]),Va=2<=f);var Xa=null,Qa={};f=l.getParameter(3088);db=l.getParameter(2978);var D=
(new za).fromArray(f),E=(new za).fromArray(db),J={};J[3553]=a(3553,3553,1);J[34067]=a(34067,34069,6);q.setClear(0,0,0,1);t.setClear(1);r.setClear(0);b(2929);t.setFunc(3);e(!1);g(1);b(2884);d(0);f={};var W=(f[100]=32774,f["101"]=32778,f["102"]=32779,f);n?(W[103]=32775,W[104]=32776):(k=k.get("EXT_blend_minmax"),null!==k&&(W[103]=k.MIN_EXT,W[104]=k.MAX_EXT));var qa={200:0,201:1,202:768,204:770,210:776,208:774,206:772,203:769,205:771,209:775,207:773};return{buffers:{color:q,depth:t,stencil:r},enable:b,
disable:c,bindFramebuffer:function(K,ha){return null===ha&&null!==A&&(ha=A),w[K]!==ha&&(l.bindFramebuffer(K,ha),w[K]=ha,n&&(36009===K&&(w[36160]=ha),36160===K&&(w[36009]=ha)),!0)},bindXRFramebuffer:function(K){K!==A&&(l.bindFramebuffer(36160,K),A=K)},useProgram:function(K){return x!==K&&(l.useProgram(K),x=K,!0)},setBlending:d,setMaterial:function(K,ha){2===K.side?c(2884):b(2884);var da=1===K.side;ha&&(da=!da);e(da);1===K.blending&&!1===K.transparent?d(0):d(K.blending,K.blendEquation,K.blendSrc,K.blendDst,
K.blendEquationAlpha,K.blendSrcAlpha,K.blendDstAlpha,K.premultipliedAlpha);t.setFunc(K.depthFunc);t.setTest(K.depthTest);t.setMask(K.depthWrite);q.setMask(K.colorWrite);ha=K.stencilWrite;r.setTest(ha);ha&&(r.setMask(K.stencilWriteMask),r.setFunc(K.stencilFunc,K.stencilRef,K.stencilFuncMask),r.setOp(K.stencilFail,K.stencilZFail,K.stencilZPass));h(K.polygonOffset,K.polygonOffsetFactor,K.polygonOffsetUnits);!0===K.alphaToCoverage?b(32926):c(32926)},setFlipSided:e,setCullFace:g,setLineWidth:function(K){K!==
Ha&&(Va&&l.lineWidth(K),Ha=K)},setPolygonOffset:h,setScissorTest:function(K){K?b(3089):c(3089)},activeTexture:m,bindTexture:function(K,ha){null===Xa&&m();var da=Qa[Xa];void 0===da&&(da={type:void 0,texture:void 0},Qa[Xa]=da);da.type===K&&da.texture===ha||(l.bindTexture(K,ha||J[K]),da.type=K,da.texture=ha)},unbindTexture:function(){var K=Qa[Xa];void 0!==K&&void 0!==K.type&&(l.bindTexture(K.type,null),K.type=void 0,K.texture=void 0)},compressedTexImage2D:function(){try{l.compressedTexImage2D.apply(l,
arguments)}catch(K){console.error("THREE.WebGLState:",K)}},texImage2D:function(){try{l.texImage2D.apply(l,arguments)}catch(K){console.error("THREE.WebGLState:",K)}},texImage3D:function(){try{l.texImage3D.apply(l,arguments)}catch(K){console.error("THREE.WebGLState:",K)}},scissor:function(K){!1===D.equals(K)&&(l.scissor(K.x,K.y,K.z,K.w),D.copy(K))},viewport:function(K){!1===E.equals(K)&&(l.viewport(K.x,K.y,K.z,K.w),E.copy(K))},reset:function(){l.disable(3042);l.disable(2884);l.disable(2929);l.disable(32823);
l.disable(3089);l.disable(2960);l.disable(32926);l.blendEquation(32774);l.blendFunc(1,0);l.blendFuncSeparate(1,0,1,0);l.colorMask(!0,!0,!0,!0);l.clearColor(0,0,0,0);l.depthMask(!0);l.depthFunc(513);l.clearDepth(1);l.stencilMask(4294967295);l.stencilFunc(519,0,4294967295);l.stencilOp(7680,7680,7680);l.clearStencil(0);l.cullFace(1029);l.frontFace(2305);l.polygonOffset(0,0);l.activeTexture(33984);l.bindFramebuffer(36160,null);!0===n&&(l.bindFramebuffer(36009,null),l.bindFramebuffer(36008,null));l.useProgram(null);
l.lineWidth(1);l.scissor(0,0,l.canvas.width,l.canvas.height);l.viewport(0,0,l.canvas.width,l.canvas.height);u={};Xa=null;Qa={};A=null;w={};x=null;C=!1;V=S=M=O=P=I=G=null;ba=!1;ja=ya=Ha=Z=Y=null;D.set(0,0,l.canvas.width,l.canvas.height);E.set(0,0,l.canvas.width,l.canvas.height);q.reset();t.reset();r.reset()}}}function Hl(l,k,f,a,b,c,d){function e(D,E,J,W){var qa=1;return((D.width>W||D.height>W)&&(qa=W/Math.max(D.width,D.height)),1>qa||!0===E)?"undefined"!=typeof HTMLImageElement&&D instanceof HTMLImageElement||
"undefined"!=typeof HTMLCanvasElement&&D instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&D instanceof ImageBitmap?(W=E?Na:Math.floor,E=W(qa*D.width),qa=W(qa*D.height),void 0===Z&&(Z=Ha?new OffscreenCanvas(E,qa):sa("canvas")),J=J?Ha?new OffscreenCanvas(E,qa):sa("canvas"):Z,J.width=E,J.height=qa,J.getContext("2d").drawImage(D,0,0,E,qa),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+D.width+"x"+D.height+") to ("+E+"x"+qa+")."),J):("data"in D&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+
D.width+"x"+D.height+")."),D):D}function g(D){return cb(D.width)&&cb(D.height)}function h(D,E){return D.generateMipmaps&&E&&1003!==D.minFilter&&1006!==D.minFilter}function m(D,E,J,W,qa){qa=void 0===qa?1:qa;l.generateMipmap(D);a.get(E).__maxMipLevel=Math.log2(Math.max(J,W,qa))}function n(D,E,J,W){if(!1===O)return E;if(null!==D){if(void 0!==l[D])return l[D];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+D+"'")}D=E;return 6403===E&&(5126===J&&(D=33326),5131===
J&&(D=33325),5121===J&&(D=33321)),6407===E&&(5126===J&&(D=34837),5131===J&&(D=34843),5121===J&&(D=32849)),6408===E&&(5126===J&&(D=34836),5131===J&&(D=34842),5121===J&&(D=3001===W?35907:32856)),33325!==D&&33326!==D&&34842!==D&&34836!==D||k.get("EXT_color_buffer_float"),D}function q(D){return 1003===D||1004===D||1005===D?9728:9729}function t(D){D=D.target;D.removeEventListener("dispose",t);var E=a.get(D);void 0!==E.__webglInit&&(l.deleteTexture(E.__webglTexture),a.remove(D));D.isVideoTexture&&Y.delete(D);
d.memory.textures--}function r(D){D=D.target;D.removeEventListener("dispose",r);var E=D.texture,J=a.get(D),W=a.get(E);if(D){void 0!==W.__webglTexture&&(l.deleteTexture(W.__webglTexture),d.memory.textures--);D.depthTexture&&D.depthTexture.dispose();if(D.isWebGLCubeRenderTarget)for(W=0;6>W;W++)l.deleteFramebuffer(J.__webglFramebuffer[W]),J.__webglDepthbuffer&&l.deleteRenderbuffer(J.__webglDepthbuffer[W]);else l.deleteFramebuffer(J.__webglFramebuffer),J.__webglDepthbuffer&&l.deleteRenderbuffer(J.__webglDepthbuffer),
J.__webglMultisampledFramebuffer&&l.deleteFramebuffer(J.__webglMultisampledFramebuffer),J.__webglColorRenderbuffer&&l.deleteRenderbuffer(J.__webglColorRenderbuffer),J.__webglDepthRenderbuffer&&l.deleteRenderbuffer(J.__webglDepthRenderbuffer);if(D.isWebGLMultipleRenderTargets)for(J=0,W=E.length;J<W;J++){var qa=a.get(E[J]);qa.__webglTexture&&(l.deleteTexture(qa.__webglTexture),d.memory.textures--);a.remove(E[J])}a.remove(E);a.remove(D)}}function u(D,E){var J=a.get(D);if(D.isVideoTexture){var W=d.render.frame;
Y.get(D)!==W&&(Y.set(D,W),D.update())}if(0<D.version&&J.__version!==D.version)if(W=D.image,void 0===W)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined");else{if(!1!==W.complete)return void C(J,D,E);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}f.activeTexture(33984+E);f.bindTexture(3553,J.__webglTexture)}function A(D,E){var J=a.get(D);if(0<D.version&&J.__version!==D.version){if(6===D.image.length){x(J,D);f.activeTexture(33984+
E);f.bindTexture(34067,J.__webglTexture);l.pixelStorei(37440,D.flipY);l.pixelStorei(37441,D.premultiplyAlpha);l.pixelStorei(3317,D.unpackAlignment);l.pixelStorei(37443,0);var W=D&&(D.isCompressedTexture||D.image[0].isCompressedTexture),qa=D.image[0]&&D.image[0].isDataTexture;E=[];for(var K=0;6>K;K++)E[K]=W||qa?qa?D.image[K].image:D.image[K]:e(D.image[K],!1,!0,S);K=E[0];var ha=g(K)||O,da=c.convert(D.format),wa=c.convert(D.type),na=n(D.internalFormat,da,wa,D.encoding);if(w(34067,D,ha),W){for(qa=0;6>
qa;qa++){var Za=E[qa].mipmaps;for(W=0;W<Za.length;W++){var Ka=Za[W];1023!==D.format&&1022!==D.format?null!==da?f.compressedTexImage2D(34069+qa,W,na,Ka.width,Ka.height,0,Ka.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):f.texImage2D(34069+qa,W,na,Ka.width,Ka.height,0,da,wa,Ka.data)}}J.__maxMipLevel=Za.length-1}else{Za=D.mipmaps;for(W=0;6>W;W++)if(qa)for(f.texImage2D(34069+W,0,na,E[W].width,E[W].height,0,da,wa,E[W].data),Ka=0;Ka<
Za.length;Ka++){var pb=Za[Ka].image[W].image;f.texImage2D(34069+W,Ka+1,na,pb.width,pb.height,0,da,wa,pb.data)}else for(f.texImage2D(34069+W,0,na,da,wa,E[W]),Ka=0;Ka<Za.length;Ka++)f.texImage2D(34069+W,Ka+1,na,da,wa,Za[Ka].image[W]);J.__maxMipLevel=Za.length}h(D,ha)&&m(34067,D,K.width,K.height);J.__version=D.version;D.onUpdate&&D.onUpdate(D)}}else f.activeTexture(33984+E),f.bindTexture(34067,J.__webglTexture)}function w(D,E,J){if(J?(l.texParameteri(D,10242,Va[E.wrapS]),l.texParameteri(D,10243,Va[E.wrapT]),
32879!==D&&35866!==D||l.texParameteri(D,32882,Va[E.wrapR]),l.texParameteri(D,10240,db[E.magFilter]),l.texParameteri(D,10241,db[E.minFilter])):(l.texParameteri(D,10242,33071),l.texParameteri(D,10243,33071),32879!==D&&35866!==D||l.texParameteri(D,32882,33071),1001===E.wrapS&&1001===E.wrapT||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),l.texParameteri(D,10240,q(E.magFilter)),l.texParameteri(D,10241,q(E.minFilter)),
1003!==E.minFilter&&1006!==E.minFilter&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),!0===k.has("EXT_texture_filter_anisotropic"))J=k.get("EXT_texture_filter_anisotropic"),1015===E.type&&!1===k.has("OES_texture_float_linear")||!1===O&&1016===E.type&&!1===k.has("OES_texture_half_float_linear")||(1<E.anisotropy||a.get(E).__currentAnisotropy)&&(l.texParameterf(D,J.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(E.anisotropy,
b.getMaxAnisotropy())),a.get(E).__currentAnisotropy=E.anisotropy)}function x(D,E){void 0===D.__webglInit&&(D.__webglInit=!0,E.addEventListener("dispose",t),D.__webglTexture=l.createTexture(),d.memory.textures++)}function C(D,E,J){var W=3553;E.isDataTexture2DArray&&(W=35866);E.isDataTexture3D&&(W=32879);x(D,E);f.activeTexture(33984+J);f.bindTexture(W,D.__webglTexture);l.pixelStorei(37440,E.flipY);l.pixelStorei(37441,E.premultiplyAlpha);l.pixelStorei(3317,E.unpackAlignment);l.pixelStorei(37443,0);J=
!O&&(1001!==E.wrapS||1001!==E.wrapT||1003!==E.minFilter&&1006!==E.minFilter)&&!1===g(E.image);J=e(E.image,J,!1,V);var qa=g(J)||O,K=c.convert(E.format),ha=c.convert(E.type),da=n(E.internalFormat,K,ha,E.encoding);w(W,E,qa);var wa=E.mipmaps;if(E.isDepthTexture)da=6402,O?da=1015===E.type?36012:1014===E.type?33190:1020===E.type?35056:33189:1015===E.type&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),1026===E.format&&6402===da&&1012!==E.type&&1014!==E.type&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),
E.type=1012,ha=c.convert(E.type)),1027===E.format&&6402===da&&(da=34041,1020!==E.type&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),E.type=1020,ha=c.convert(E.type))),f.texImage2D(3553,0,da,J.width,J.height,0,K,ha,null);else if(E.isDataTexture)if(0<wa.length&&qa){for(var na=0,Za=wa.length;na<Za;na++){var Ka=wa[na];f.texImage2D(3553,na,da,Ka.width,Ka.height,0,K,ha,Ka.data)}E.generateMipmaps=!1;D.__maxMipLevel=wa.length-1}else f.texImage2D(3553,0,
da,J.width,J.height,0,K,ha,J.data),D.__maxMipLevel=0;else if(E.isCompressedTexture){na=0;for(Za=wa.length;na<Za;na++)Ka=wa[na],1023!==E.format&&1022!==E.format?null!==K?f.compressedTexImage2D(3553,na,da,Ka.width,Ka.height,0,Ka.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):f.texImage2D(3553,na,da,Ka.width,Ka.height,0,K,ha,Ka.data);D.__maxMipLevel=wa.length-1}else if(E.isDataTexture2DArray)f.texImage3D(35866,0,da,J.width,J.height,
J.depth,0,K,ha,J.data),D.__maxMipLevel=0;else if(E.isDataTexture3D)f.texImage3D(32879,0,da,J.width,J.height,J.depth,0,K,ha,J.data),D.__maxMipLevel=0;else if(0<wa.length&&qa){na=0;for(Za=wa.length;na<Za;na++)Ka=wa[na],f.texImage2D(3553,na,da,K,ha,Ka);E.generateMipmaps=!1;D.__maxMipLevel=wa.length-1}else f.texImage2D(3553,0,da,K,ha,J),D.__maxMipLevel=0;h(E,qa)&&m(W,E,J.width,J.height);D.__version=E.version;E.onUpdate&&E.onUpdate(E)}function G(D,E,J,W,qa){var K=c.convert(J.format),ha=c.convert(J.type),
da=n(J.internalFormat,K,ha,J.encoding);32879===qa||35866===qa?f.texImage3D(qa,0,da,E.width,E.height,E.depth,0,K,ha,null):f.texImage2D(qa,0,da,E.width,E.height,0,K,ha,null);f.bindFramebuffer(36160,D);l.framebufferTexture2D(36160,W,qa,a.get(J).__webglTexture,0);f.bindFramebuffer(36160,null)}function I(D,E,J){if(l.bindRenderbuffer(36161,D),E.depthBuffer&&!E.stencilBuffer){var W=33189;J?((J=E.depthTexture)&&J.isDepthTexture&&(1015===J.type?W=36012:1014===J.type&&(W=33190)),J=P(E),l.renderbufferStorageMultisample(36161,
J,W,E.width,E.height)):l.renderbufferStorage(36161,W,E.width,E.height);l.framebufferRenderbuffer(36160,36096,36161,D)}else if(E.depthBuffer&&E.stencilBuffer)J?(J=P(E),l.renderbufferStorageMultisample(36161,J,35056,E.width,E.height)):l.renderbufferStorage(36161,34041,E.width,E.height),l.framebufferRenderbuffer(36160,33306,36161,D);else{D=!0===E.isWebGLMultipleRenderTargets?E.texture[0]:E.texture;W=c.convert(D.format);var qa=c.convert(D.type);D=n(D.internalFormat,W,qa,D.encoding);J?(J=P(E),l.renderbufferStorageMultisample(36161,
J,D,E.width,E.height)):l.renderbufferStorage(36161,D,E.width,E.height)}l.bindRenderbuffer(36161,null)}function P(D){return O&&D.isWebGLMultisampleRenderTarget?Math.min(ba,D.samples):0}var O=b.isWebGL2,M=b.maxTextures,S=b.maxCubemapSize,V=b.maxTextureSize,ba=b.maxSamples,Y=new WeakMap,Z,Ha=!1;try{Ha="undefined"!=typeof OffscreenCanvas&&null!==(new OffscreenCanvas(1,1)).getContext("2d")}catch(D){}var ya=0,ja={},Ja={},Va=(ja[1E3]=10497,ja[1001]=33071,ja[1002]=33648,ja),db=(Ja[1003]=9728,Ja[1004]=9984,
Ja[1005]=9986,Ja[1006]=9729,Ja[1007]=9985,Ja[1008]=9987,Ja),Xa=!1,Qa=!1;this.allocateTextureUnit=function(){var D=ya;return D>=M&&console.warn("THREE.WebGLTextures: Trying to use "+D+" texture units while this GPU supports only "+M),ya+=1,D};this.resetTextureUnits=function(){ya=0};this.setTexture2D=u;this.setTexture2DArray=function(D,E){var J=a.get(D);0<D.version&&J.__version!==D.version?C(J,D,E):(f.activeTexture(33984+E),f.bindTexture(35866,J.__webglTexture))};this.setTexture3D=function(D,E){var J=
a.get(D);0<D.version&&J.__version!==D.version?C(J,D,E):(f.activeTexture(33984+E),f.bindTexture(32879,J.__webglTexture))};this.setTextureCube=A;this.setupRenderTarget=function(D){var E=D.texture,J=a.get(D),W=a.get(E);D.addEventListener("dispose",r);!0!==D.isWebGLMultipleRenderTargets&&(W.__webglTexture=l.createTexture(),W.__version=E.version,d.memory.textures++);var qa=!0===D.isWebGLCubeRenderTarget,K=!0===D.isWebGLMultipleRenderTargets,ha=!0===D.isWebGLMultisampleRenderTarget,da=E.isDataTexture3D||
E.isDataTexture2DArray,wa=g(D)||O;if(!O||1022!==E.format||1015!==E.type&&1016!==E.type||(E.format=1023,console.warn("THREE.WebGLRenderer: Rendering to textures with RGB format is not supported. Using RGBA format instead.")),qa)for(J.__webglFramebuffer=[],ha=0;6>ha;ha++)J.__webglFramebuffer[ha]=l.createFramebuffer();else if(J.__webglFramebuffer=l.createFramebuffer(),K)if(b.drawBuffers){ha=D.texture;for(var na=0,Za=ha.length;na<Za;na++){var Ka=a.get(ha[na]);void 0===Ka.__webglTexture&&(Ka.__webglTexture=
l.createTexture(),d.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");else ha&&(O?(J.__webglMultisampledFramebuffer=l.createFramebuffer(),J.__webglColorRenderbuffer=l.createRenderbuffer(),l.bindRenderbuffer(36161,J.__webglColorRenderbuffer),ha=c.convert(E.format),na=c.convert(E.type),ha=n(E.internalFormat,ha,na,E.encoding),na=P(D),l.renderbufferStorageMultisample(36161,na,ha,D.width,D.height),f.bindFramebuffer(36160,
J.__webglMultisampledFramebuffer),l.framebufferRenderbuffer(36160,36064,36161,J.__webglColorRenderbuffer),l.bindRenderbuffer(36161,null),D.depthBuffer&&(J.__webglDepthRenderbuffer=l.createRenderbuffer(),I(J.__webglDepthRenderbuffer,D,!0)),f.bindFramebuffer(36160,null)):console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2."));if(qa){f.bindTexture(34067,W.__webglTexture);w(34067,E,wa);for(W=0;6>W;W++)G(J.__webglFramebuffer[W],D,E,36064,34069+W);h(E,wa)&&m(34067,
E,D.width,D.height)}else if(K)for(E=D.texture,W=0,da=E.length;W<da;W++)qa=E[W],K=a.get(qa),f.bindTexture(3553,K.__webglTexture),w(3553,qa,wa),G(J.__webglFramebuffer,D,qa,36064+W,3553),h(qa,wa)&&m(3553,qa,D.width,D.height);else qa=3553,da&&(O?qa=E.isDataTexture3D?32879:35866:console.warn("THREE.DataTexture3D and THREE.DataTexture2DArray only supported with WebGL2.")),f.bindTexture(qa,W.__webglTexture),w(qa,E,wa),G(J.__webglFramebuffer,D,E,36064,qa),h(E,wa)&&m(qa,E,D.width,D.height,D.depth);f.unbindTexture();
if(D.depthBuffer){J=a.get(D);wa=!0===D.isWebGLCubeRenderTarget;if(D.depthTexture){if(wa)throw Error("target.depthTexture not supported in Cube render targets");if(D&&D.isWebGLCubeRenderTarget)throw Error("Depth Texture with cube render targets is not supported");if(f.bindFramebuffer(36160,J.__webglFramebuffer),!D.depthTexture||!D.depthTexture.isDepthTexture)throw Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");a.get(D.depthTexture).__webglTexture&&D.depthTexture.image.width===
D.width&&D.depthTexture.image.height===D.height||(D.depthTexture.image.width=D.width,D.depthTexture.image.height=D.height,D.depthTexture.needsUpdate=!0);u(D.depthTexture,0);J=a.get(D.depthTexture).__webglTexture;if(1026===D.depthTexture.format)l.framebufferTexture2D(36160,36096,3553,J,0);else{if(1027!==D.depthTexture.format)throw Error("Unknown depthTexture format");l.framebufferTexture2D(36160,33306,3553,J,0)}!0}else if(wa)for(J.__webglDepthbuffer=[],wa=0;6>wa;wa++)f.bindFramebuffer(36160,J.__webglFramebuffer[wa]),
J.__webglDepthbuffer[wa]=l.createRenderbuffer(),I(J.__webglDepthbuffer[wa],D,!1);else f.bindFramebuffer(36160,J.__webglFramebuffer),J.__webglDepthbuffer=l.createRenderbuffer(),I(J.__webglDepthbuffer,D,!1);f.bindFramebuffer(36160,null)}};this.updateRenderTargetMipmap=function(D){for(var E=g(D)||O,J=!0===D.isWebGLMultipleRenderTargets?D.texture:[D.texture],W=0,qa=J.length;W<qa;W++){var K=J[W];if(h(K,E)){var ha=D.isWebGLCubeRenderTarget?34067:3553,da=a.get(K).__webglTexture;f.bindTexture(ha,da);m(ha,
K,D.width,D.height);f.unbindTexture()}}};this.updateMultisampleRenderTarget=function(D){if(D.isWebGLMultisampleRenderTarget)if(O){var E=D.width,J=D.height,W=16384;D.depthBuffer&&(W|=256);D.stencilBuffer&&(W|=1024);D=a.get(D);f.bindFramebuffer(36008,D.__webglMultisampledFramebuffer);f.bindFramebuffer(36009,D.__webglFramebuffer);l.blitFramebuffer(0,0,E,J,0,0,E,J,W,9728);f.bindFramebuffer(36008,null);f.bindFramebuffer(36009,D.__webglMultisampledFramebuffer)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.")};
this.safeSetTexture2D=function(D,E){D&&D.isWebGLRenderTarget&&(!1===Xa&&(console.warn("THREE.WebGLTextures.safeSetTexture2D: don't use render targets as textures. Use their .texture property instead."),Xa=!0),D=D.texture);u(D,E)};this.safeSetTextureCube=function(D,E){D&&D.isWebGLCubeRenderTarget&&(!1===Qa&&(console.warn("THREE.WebGLTextures.safeSetTextureCube: don't use cube render targets as textures. Use their .texture property instead."),Qa=!0),D=D.texture);A(D,E)}}function Lj(l,k,f){var a=f.isWebGL2;
return{convert:function(b){var c;if(1009===b)return 5121;if(1017===b)return 32819;if(1018===b)return 32820;if(1019===b)return 33635;if(1010===b)return 5120;if(1011===b)return 5122;if(1012===b)return 5123;if(1013===b)return 5124;if(1014===b)return 5125;if(1015===b)return 5126;if(1016===b)return a?5131:(c=k.get("OES_texture_half_float"),null!==c?c.HALF_FLOAT_OES:null);if(1021===b)return 6406;if(1022===b)return 6407;if(1023===b)return 6408;if(1024===b)return 6409;if(1025===b)return 6410;if(1026===b)return 6402;
if(1027===b)return 34041;if(1028===b)return 6403;if(1029===b)return 36244;if(1030===b)return 33319;if(1031===b)return 33320;if(1032===b)return 36248;if(1033===b)return 36249;if(33776===b||33777===b||33778===b||33779===b){if(c=k.get("WEBGL_compressed_texture_s3tc"),null===c)return null;if(33776===b)return c.COMPRESSED_RGB_S3TC_DXT1_EXT;if(33777===b)return c.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(33778===b)return c.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(33779===b)return c.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(35840===
b||35841===b||35842===b||35843===b){if(c=k.get("WEBGL_compressed_texture_pvrtc"),null===c)return null;if(35840===b)return c.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(35841===b)return c.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(35842===b)return c.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(35843===b)return c.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(36196===b)return c=k.get("WEBGL_compressed_texture_etc1"),null!==c?c.COMPRESSED_RGB_ETC1_WEBGL:null;if((37492===b||37496===b)&&(c=k.get("WEBGL_compressed_texture_etc"),null!==c)){if(37492===
b)return c.COMPRESSED_RGB8_ETC2;if(37496===b)return c.COMPRESSED_RGBA8_ETC2_EAC}return 37808===b||37809===b||37810===b||37811===b||37812===b||37813===b||37814===b||37815===b||37816===b||37817===b||37818===b||37819===b||37820===b||37821===b||37840===b||37841===b||37842===b||37843===b||37844===b||37845===b||37846===b||37847===b||37848===b||37849===b||37850===b||37851===b||37852===b||37853===b?(c=k.get("WEBGL_compressed_texture_astc"),null!==c?b:null):36492===b?(c=k.get("EXT_texture_compression_bptc"),
null!==c?b:null):1020===b?a?34042:(c=k.get("WEBGL_depth_texture"),null!==c?c.UNSIGNED_INT_24_8_WEBGL:null):void 0}}}function Il(l){function k(a,b){a.opacity.value=b.opacity;b.color&&a.diffuse.value.copy(b.color);b.emissive&&a.emissive.value.copy(b.emissive).multiplyScalar(b.emissiveIntensity);b.map&&(a.map.value=b.map);b.alphaMap&&(a.alphaMap.value=b.alphaMap);b.specularMap&&(a.specularMap.value=b.specularMap);0<b.alphaTest&&(a.alphaTest.value=b.alphaTest);var c=l.get(b).envMap;c&&(a.envMap.value=
c,a.flipEnvMap.value=c.isCubeTexture&&!1===c.isRenderTargetTexture?-1:1,a.reflectivity.value=b.reflectivity,a.ior.value=b.ior,a.refractionRatio.value=b.refractionRatio,c=l.get(c).__maxMipLevel,void 0!==c&&(a.maxMipLevel.value=c));var d,e;b.lightMap&&(a.lightMap.value=b.lightMap,a.lightMapIntensity.value=b.lightMapIntensity);b.aoMap&&(a.aoMap.value=b.aoMap,a.aoMapIntensity.value=b.aoMapIntensity);b.map?d=b.map:b.specularMap?d=b.specularMap:b.displacementMap?d=b.displacementMap:b.normalMap?d=b.normalMap:
b.bumpMap?d=b.bumpMap:b.roughnessMap?d=b.roughnessMap:b.metalnessMap?d=b.metalnessMap:b.alphaMap?d=b.alphaMap:b.emissiveMap?d=b.emissiveMap:b.clearcoatMap?d=b.clearcoatMap:b.clearcoatNormalMap?d=b.clearcoatNormalMap:b.clearcoatRoughnessMap?d=b.clearcoatRoughnessMap:b.specularIntensityMap?d=b.specularIntensityMap:b.specularColorMap?d=b.specularColorMap:b.transmissionMap?d=b.transmissionMap:b.thicknessMap?d=b.thicknessMap:b.sheenColorMap?d=b.sheenColorMap:b.sheenRoughnessMap&&(d=b.sheenRoughnessMap);
void 0!==d&&(d.isWebGLRenderTarget&&(d=d.texture),!0===d.matrixAutoUpdate&&d.updateMatrix(),a.uvTransform.value.copy(d.matrix));b.aoMap?e=b.aoMap:b.lightMap&&(e=b.lightMap);void 0!==e&&(e.isWebGLRenderTarget&&(e=e.texture),!0===e.matrixAutoUpdate&&e.updateMatrix(),a.uv2Transform.value.copy(e.matrix))}function f(a,b){a.roughness.value=b.roughness;a.metalness.value=b.metalness;b.roughnessMap&&(a.roughnessMap.value=b.roughnessMap);b.metalnessMap&&(a.metalnessMap.value=b.metalnessMap);b.emissiveMap&&
(a.emissiveMap.value=b.emissiveMap);b.bumpMap&&(a.bumpMap.value=b.bumpMap,a.bumpScale.value=b.bumpScale,1===b.side&&(a.bumpScale.value*=-1));b.normalMap&&(a.normalMap.value=b.normalMap,a.normalScale.value.copy(b.normalScale),1===b.side&&a.normalScale.value.negate());b.displacementMap&&(a.displacementMap.value=b.displacementMap,a.displacementScale.value=b.displacementScale,a.displacementBias.value=b.displacementBias);l.get(b).envMap&&(a.envMapIntensity.value=b.envMapIntensity)}return{refreshFogUniforms:function(a,
b){a.fogColor.value.copy(b.color);b.isFog?(a.fogNear.value=b.near,a.fogFar.value=b.far):b.isFogExp2&&(a.fogDensity.value=b.density)},refreshMaterialUniforms:function(a,b,c,d,e){b.isMeshBasicMaterial?k(a,b):b.isMeshLambertMaterial?(k(a,b),b.emissiveMap&&(a.emissiveMap.value=b.emissiveMap)):b.isMeshToonMaterial?(k(a,b),function(g,h){h.gradientMap&&(g.gradientMap.value=h.gradientMap);h.emissiveMap&&(g.emissiveMap.value=h.emissiveMap);h.bumpMap&&(g.bumpMap.value=h.bumpMap,g.bumpScale.value=h.bumpScale,
1===h.side&&(g.bumpScale.value*=-1));h.normalMap&&(g.normalMap.value=h.normalMap,g.normalScale.value.copy(h.normalScale),1===h.side&&g.normalScale.value.negate());h.displacementMap&&(g.displacementMap.value=h.displacementMap,g.displacementScale.value=h.displacementScale,g.displacementBias.value=h.displacementBias)}(a,b)):b.isMeshPhongMaterial?(k(a,b),function(g,h){g.specular.value.copy(h.specular);g.shininess.value=Math.max(h.shininess,1E-4);h.emissiveMap&&(g.emissiveMap.value=h.emissiveMap);h.bumpMap&&
(g.bumpMap.value=h.bumpMap,g.bumpScale.value=h.bumpScale,1===h.side&&(g.bumpScale.value*=-1));h.normalMap&&(g.normalMap.value=h.normalMap,g.normalScale.value.copy(h.normalScale),1===h.side&&g.normalScale.value.negate());h.displacementMap&&(g.displacementMap.value=h.displacementMap,g.displacementScale.value=h.displacementScale,g.displacementBias.value=h.displacementBias)}(a,b)):b.isMeshStandardMaterial?(k(a,b),b.isMeshPhysicalMaterial?function(g,h,m){f(g,h);g.ior.value=h.ior;0<h.sheen&&(g.sheenColor.value.copy(h.sheenColor).multiplyScalar(h.sheen),
g.sheenRoughness.value=h.sheenRoughness,h.sheenColorMap&&(g.sheenColorMap.value=h.sheenColorMap),h.sheenRoughnessMap&&(g.sheenRoughnessMap.value=h.sheenRoughnessMap));0<h.clearcoat&&(g.clearcoat.value=h.clearcoat,g.clearcoatRoughness.value=h.clearcoatRoughness,h.clearcoatMap&&(g.clearcoatMap.value=h.clearcoatMap),h.clearcoatRoughnessMap&&(g.clearcoatRoughnessMap.value=h.clearcoatRoughnessMap),h.clearcoatNormalMap&&(g.clearcoatNormalScale.value.copy(h.clearcoatNormalScale),g.clearcoatNormalMap.value=
h.clearcoatNormalMap,1===h.side&&g.clearcoatNormalScale.value.negate()));0<h.transmission&&(g.transmission.value=h.transmission,g.transmissionSamplerMap.value=m.texture,g.transmissionSamplerSize.value.set(m.width,m.height),h.transmissionMap&&(g.transmissionMap.value=h.transmissionMap),g.thickness.value=h.thickness,h.thicknessMap&&(g.thicknessMap.value=h.thicknessMap),g.attenuationDistance.value=h.attenuationDistance,g.attenuationColor.value.copy(h.attenuationColor));g.specularIntensity.value=h.specularIntensity;
g.specularColor.value.copy(h.specularColor);h.specularIntensityMap&&(g.specularIntensityMap.value=h.specularIntensityMap);h.specularColorMap&&(g.specularColorMap.value=h.specularColorMap)}(a,b,e):f(a,b)):b.isMeshMatcapMaterial?(k(a,b),function(g,h){h.matcap&&(g.matcap.value=h.matcap);h.bumpMap&&(g.bumpMap.value=h.bumpMap,g.bumpScale.value=h.bumpScale,1===h.side&&(g.bumpScale.value*=-1));h.normalMap&&(g.normalMap.value=h.normalMap,g.normalScale.value.copy(h.normalScale),1===h.side&&g.normalScale.value.negate());
h.displacementMap&&(g.displacementMap.value=h.displacementMap,g.displacementScale.value=h.displacementScale,g.displacementBias.value=h.displacementBias)}(a,b)):b.isMeshDepthMaterial?(k(a,b),function(g,h){h.displacementMap&&(g.displacementMap.value=h.displacementMap,g.displacementScale.value=h.displacementScale,g.displacementBias.value=h.displacementBias)}(a,b)):b.isMeshDistanceMaterial?(k(a,b),function(g,h){h.displacementMap&&(g.displacementMap.value=h.displacementMap,g.displacementScale.value=h.displacementScale,
g.displacementBias.value=h.displacementBias);g.referencePosition.value.copy(h.referencePosition);g.nearDistance.value=h.nearDistance;g.farDistance.value=h.farDistance}(a,b)):b.isMeshNormalMaterial?(k(a,b),function(g,h){h.bumpMap&&(g.bumpMap.value=h.bumpMap,g.bumpScale.value=h.bumpScale,1===h.side&&(g.bumpScale.value*=-1));h.normalMap&&(g.normalMap.value=h.normalMap,g.normalScale.value.copy(h.normalScale),1===h.side&&g.normalScale.value.negate());h.displacementMap&&(g.displacementMap.value=h.displacementMap,
g.displacementScale.value=h.displacementScale,g.displacementBias.value=h.displacementBias)}(a,b)):b.isLineBasicMaterial?(function(g,h){g.diffuse.value.copy(h.color);g.opacity.value=h.opacity}(a,b),b.isLineDashedMaterial&&function(g,h){g.dashSize.value=h.dashSize;g.totalSize.value=h.dashSize+h.gapSize;g.scale.value=h.scale}(a,b)):b.isPointsMaterial?function(g,h,m,n){g.diffuse.value.copy(h.color);g.opacity.value=h.opacity;g.size.value=h.size*m;g.scale.value=.5*n;h.map&&(g.map.value=h.map);h.alphaMap&&
(g.alphaMap.value=h.alphaMap);0<h.alphaTest&&(g.alphaTest.value=h.alphaTest);var q;h.map?q=h.map:h.alphaMap&&(q=h.alphaMap);void 0!==q&&(!0===q.matrixAutoUpdate&&q.updateMatrix(),g.uvTransform.value.copy(q.matrix))}(a,b,c,d):b.isSpriteMaterial?function(g,h){g.diffuse.value.copy(h.color);g.opacity.value=h.opacity;g.rotation.value=h.rotation;h.map&&(g.map.value=h.map);h.alphaMap&&(g.alphaMap.value=h.alphaMap);0<h.alphaTest&&(g.alphaTest.value=h.alphaTest);var m;h.map?m=h.map:h.alphaMap&&(m=h.alphaMap);
void 0!==m&&(!0===m.matrixAutoUpdate&&m.updateMatrix(),g.uvTransform.value.copy(m.matrix))}(a,b):b.isShadowMaterial?(a.color.value.copy(b.color),a.opacity.value=b.opacity):b.isShaderMaterial&&(b.uniformsNeedUpdate=!1)}}}function wb(l){function k(H,ca){for(var ea=0;ea<H.length;ea++){var aa=t.getContext(H[ea],ca);if(null!==aa)return aa}return null}function f(){Fa=new je(Aa);Da=new Ng(Aa,Fa,l);Fa.init(Da);Ic=new Lj(Aa,Fa,Da);La=new Gl(Aa,Fa,Da);da[0]=1029;ib=new Sg(Aa);kb=new yl;ob=new Hl(Aa,Fa,La,kb,
Da,Ic,ib);nc=new Og(ba);Jb=new Jf(ba);Yb=new Ef(Aa,Da);me=new Mg(Aa,Fa,Yb,Da);oc=new Qg(Aa,Yb,ib,me);bc=new v(Aa,oc,Yb,ib);Mj=new rb(Aa,Da,ob);nd=new ci(kb);ne=new xl(ba,nc,Jb,Fa,Da,me,nd);li=new Il(kb);Ug=new Al(kb);Vg=new Fl(Fa,Da);Ld=new Ff(ba,nc,La,bc,C);Tc=new Kj(ba,bc,Da);Nj=new Gf(Aa,Fa,ib,Da);Oj=new Rg(Aa,Fa,ib,Da);ib.programs=ne.programs;ba.capabilities=Da;ba.extensions=Fa;ba.properties=kb;ba.renderLists=Ug;ba.shadowMap=Tc;ba.state=La;ba.info=ib}function a(H){H.preventDefault();console.log("THREE.WebGLRenderer: Context Lost.");
Y=!0}function b(){console.log("THREE.WebGLRenderer: Context Restored.");Y=!1;var H=ib.autoReset,ca=Tc.enabled,ea=Tc.autoUpdate,aa=Tc.needsUpdate,va=Tc.type;f();ib.autoReset=H;Tc.enabled=ca;Tc.autoUpdate=ea;Tc.needsUpdate=aa;Tc.type=va}function c(H){H=H.target;H.removeEventListener("dispose",c);(function(ca){(function(ea){ea=kb.get(ea).programs;void 0!==ea&&ea.forEach(function(aa){ne.releaseProgram(aa)})})(ca);kb.remove(ca)})(H)}function d(){oe.stop()}function e(){oe.start()}function g(H,ca,ea,aa){if(!1!==
H.visible){if(H.layers.test(ca.layers))if(H.isGroup)ea=H.renderOrder;else if(H.isLOD)!0===H.autoUpdate&&H.update(ca);else if(H.isLight)M.pushLight(H),H.castShadow&&M.pushShadow(H);else if(H.isSprite){if(!H.frustumCulled||wa.intersectsSprite(H)){aa&&xc.setFromMatrixPosition(H.matrixWorld).applyMatrix4(pb);var va=bc.update(H),Ta=H.material;Ta.visible&&O.push(H,va,Ta,ea,xc.z,null)}}else if((H.isMesh||H.isLine||H.isPoints)&&(H.isSkinnedMesh&&H.skeleton.frame!==ib.render.frame&&(H.skeleton.update(),H.skeleton.frame=
ib.render.frame),!H.frustumCulled||wa.intersectsObject(H)))if(aa&&xc.setFromMatrixPosition(H.matrixWorld).applyMatrix4(pb),va=bc.update(H),Ta=H.material,Array.isArray(Ta))for(var Ia=va.groups,Wa=0,Ra=Ia.length;Wa<Ra;Wa++){var sb=Ia[Wa],hb=Ta[sb.materialIndex];hb&&hb.visible&&O.push(H,va,hb,ea,xc.z,sb)}else Ta.visible&&O.push(H,va,Ta,ea,xc.z,null);H=H.children;va=0;for(Ta=H.length;va<Ta;va++)g(H[va],ca,ea,aa)}}function h(H,ca,ea,aa){var va=H.opaque,Ta=H.transmissive;H=H.transparent;M.setupLightsView(ea);
if(0<Ta.length){null===Ka&&(Ka=new (!0===x&&!0===Da.isWebGL2?Sf:Rb)(1024,1024,{generateMipmaps:!0,type:null!==Ic.convert(1016)?1016:1009,minFilter:1008,magFilter:1003,wrapS:1001,wrapT:1001}));var Ia=ba.getRenderTarget();ba.setRenderTarget(Ka);ba.clear();var Wa=ba.toneMapping;ba.toneMapping=0;m(va,ca,ea);ba.toneMapping=Wa;ob.updateMultisampleRenderTarget(Ka);ob.updateRenderTargetMipmap(Ka);ba.setRenderTarget(Ia)}aa&&La.viewport(Va.copy(aa));0<va.length&&m(va,ca,ea);0<Ta.length&&m(Ta,ca,ea);0<H.length&&
m(H,ca,ea)}function m(H,ca,ea){for(var aa=!0===ca.isScene?ca.overrideMaterial:null,va=0,Ta=H.length;va<Ta;va++){var Ia=H[va],Wa=Ia.object,Ra=Ia.geometry,sb=null===aa?Ia.material:aa;Ia=Ia.group;if(Wa.layers.test(ea.layers)){var hb=ca,Zb=ea;Wa.onBeforeRender(ba,hb,Zb,Ra,sb,Ia);Wa.modelViewMatrix.multiplyMatrices(Zb.matrixWorldInverse,Wa.matrixWorld);Wa.normalMatrix.getNormalMatrix(Wa.modelViewMatrix);sb.onBeforeRender(ba,hb,Zb,Ra,Wa,Ia);!0===sb.transparent&&2===sb.side?(sb.side=1,sb.needsUpdate=!0,
ba.renderBufferDirect(Zb,hb,Ra,sb,Wa,Ia),sb.side=0,sb.needsUpdate=!0,ba.renderBufferDirect(Zb,hb,Ra,sb,Wa,Ia),sb.side=2):ba.renderBufferDirect(Zb,hb,Ra,sb,Wa,Ia);Wa.onAfterRender(ba,hb,Zb,Ra,sb,Ia)}}}function n(H,ca,ea){!0!==ca.isScene&&(ca=Eb);var aa=kb.get(H),va=M.state.lights,Ta=va.state.version,Ia=ne.getParameters(H,va.state,M.state.shadowsArray,ca,ea),Wa=ne.getProgramCacheKey(Ia),Ra=aa.programs;aa.environment=H.isMeshStandardMaterial?ca.environment:null;aa.fog=ca.fog;aa.envMap=(H.isMeshStandardMaterial?
Jb:nc).get(H.envMap||aa.environment);void 0===Ra&&(H.addEventListener("dispose",c),Ra=new Map,aa.programs=Ra);ca=Ra.get(Wa);if(void 0!==ca){if(aa.currentProgram===ca&&aa.lightsStateVersion===Ta)return q(H,Ia),ca}else Ia.uniforms=ne.getUniforms(H),H.onBuild(ea,Ia,ba),H.onBeforeCompile(Ia,ba),ca=ne.acquireProgram(Ia,Wa),Ra.set(Wa,ca),aa.uniforms=Ia.uniforms;ea=aa.uniforms;(H.isShaderMaterial||H.isRawShaderMaterial)&&!0!==H.clipping||(ea.clippingPlanes=nd.uniform);q(H,Ia);aa.needsLights=H.isMeshLambertMaterial||
H.isMeshToonMaterial||H.isMeshPhongMaterial||H.isMeshStandardMaterial||H.isShadowMaterial||H.isShaderMaterial&&!0===H.lights;aa.lightsStateVersion=Ta;aa.needsLights&&(ea.ambientLightColor.value=va.state.ambient,ea.lightProbe.value=va.state.probe,ea.directionalLights.value=va.state.directional,ea.directionalLightShadows.value=va.state.directionalShadow,ea.spotLights.value=va.state.spot,ea.spotLightShadows.value=va.state.spotShadow,ea.rectAreaLights.value=va.state.rectArea,ea.ltc_1.value=va.state.rectAreaLTC1,
ea.ltc_2.value=va.state.rectAreaLTC2,ea.pointLights.value=va.state.point,ea.pointLightShadows.value=va.state.pointShadow,ea.hemisphereLights.value=va.state.hemi,ea.directionalShadowMap.value=va.state.directionalShadowMap,ea.directionalShadowMatrix.value=va.state.directionalShadowMatrix,ea.spotShadowMap.value=va.state.spotShadowMap,ea.spotShadowMatrix.value=va.state.spotShadowMatrix,ea.pointShadowMap.value=va.state.pointShadowMap,ea.pointShadowMatrix.value=va.state.pointShadowMatrix);H=ca.getUniforms();
H=Kd.seqWithValue(H.seq,ea);return aa.currentProgram=ca,aa.uniformsList=H,ca}function q(H,ca){H=kb.get(H);H.outputEncoding=ca.outputEncoding;H.instancing=ca.instancing;H.skinning=ca.skinning;H.morphTargets=ca.morphTargets;H.morphNormals=ca.morphNormals;H.morphTargetsCount=ca.morphTargetsCount;H.numClippingPlanes=ca.numClippingPlanes;H.numIntersection=ca.numClipIntersection;H.vertexAlphas=ca.vertexAlphas;H.vertexTangents=ca.vertexTangents}l=void 0===l?{}:l;var t=void 0!==l.canvas?l.canvas:function(){var H=
sa("canvas");return H.style.display="block",H}(),r=void 0!==l.context?l.context:null,u=void 0!==l.alpha&&l.alpha,A=void 0===l.depth||l.depth,w=void 0===l.stencil||l.stencil,x=void 0!==l.antialias&&l.antialias,C=void 0===l.premultipliedAlpha||l.premultipliedAlpha,G=void 0!==l.preserveDrawingBuffer&&l.preserveDrawingBuffer,I=void 0!==l.powerPreference?l.powerPreference:"default",P=void 0!==l.failIfMajorPerformanceCaveat&&l.failIfMajorPerformanceCaveat,O=null,M=null,S=[],V=[];this.domElement=t;this.debug=
{checkShaderErrors:!0};this.sortObjects=this.autoClearStencil=this.autoClearDepth=this.autoClearColor=this.autoClear=!0;this.clippingPlanes=[];this.localClippingEnabled=!1;this.gammaFactor=2;this.outputEncoding=3E3;this.physicallyCorrectLights=!1;this.toneMapping=0;this.toneMappingExposure=1;var ba=this,Y=!1,Z=0,Ha=0,ya=null,ja=-1,Ja=null,Va=new za,db=new za,Xa=null,Qa=t.width,D=t.height,E=1,J=null,W=null,qa=new za(0,0,Qa,D),K=new za(0,0,Qa,D),ha=!1,da=[],wa=new wc,na=!1,Za=!1,Ka=null,pb=new ua,xc=
new B,Eb={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0},Fa,Da,La,ib,kb,ob,nc,Jb,Yb,oc,bc,ne,li,Ug,Vg,nd,Tc,Ld,Mj,Nj,Oj,Ic,me,Aa=r;try{r={alpha:u,depth:A,stencil:w,antialias:x,premultipliedAlpha:C,preserveDrawingBuffer:G,powerPreference:I,failIfMajorPerformanceCaveat:P};if(t.addEventListener("webglcontextlost",a,!1),t.addEventListener("webglcontextrestored",b,!1),null===Aa)if(u=["webgl2","webgl","experimental-webgl"],!0===ba.isWebGL1Renderer&&u.shift(),Aa=k(u,r),null===
Aa)throw k(u)?Error("Error creating WebGL context with your selected attributes."):Error("Error creating WebGL context.");void 0===Aa.getShaderPrecisionFormat&&(Aa.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(H){throw console.error("THREE.WebGLRenderer: "+H.message),H;}f();var Cc=new Pj(ba,Aa);this.xr=Cc;this.getContext=function(){return Aa};this.getContextAttributes=function(){return Aa.getContextAttributes()};this.forceContextLoss=function(){var H=Fa.get("WEBGL_lose_context");
H&&H.loseContext()};this.forceContextRestore=function(){var H=Fa.get("WEBGL_lose_context");H&&H.restoreContext()};this.getPixelRatio=function(){return E};this.setPixelRatio=function(H){void 0!==H&&(E=H,this.setSize(Qa,D,!1))};this.getSize=function(H){return H.set(Qa,D)};this.setSize=function(H,ca,ea){Cc.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(Qa=H,D=ca,t.width=Math.floor(H*E),t.height=Math.floor(ca*E),!1!==ea&&(t.style.width=H+"px",t.style.height=
ca+"px"),this.setViewport(0,0,H,ca))};this.getDrawingBufferSize=function(H){return H.set(Qa*E,D*E).floor()};this.setDrawingBufferSize=function(H,ca,ea){Qa=H;D=ca;E=ea;t.width=Math.floor(H*ea);t.height=Math.floor(ca*ea);this.setViewport(0,0,H,ca)};this.getCurrentViewport=function(H){return H.copy(Va)};this.getViewport=function(H){return H.copy(qa)};this.setViewport=function(H,ca,ea,aa){H.isVector4?qa.set(H.x,H.y,H.z,H.w):qa.set(H,ca,ea,aa);La.viewport(Va.copy(qa).multiplyScalar(E).floor())};this.getScissor=
function(H){return H.copy(K)};this.setScissor=function(H,ca,ea,aa){H.isVector4?K.set(H.x,H.y,H.z,H.w):K.set(H,ca,ea,aa);La.scissor(db.copy(K).multiplyScalar(E).floor())};this.getScissorTest=function(){return ha};this.setScissorTest=function(H){La.setScissorTest(ha=H)};this.setOpaqueSort=function(H){J=H};this.setTransparentSort=function(H){W=H};this.getClearColor=function(H){return H.copy(Ld.getClearColor())};this.setClearColor=function(){Ld.setClearColor.apply(Ld,arguments)};this.getClearAlpha=function(){return Ld.getClearAlpha()};
this.setClearAlpha=function(){Ld.setClearAlpha.apply(Ld,arguments)};this.clear=function(H,ca,ea){var aa=0;(void 0===H||H)&&(aa|=16384);(void 0===ca||ca)&&(aa|=256);(void 0===ea||ea)&&(aa|=1024);Aa.clear(aa)};this.clearColor=function(){this.clear(!0,!1,!1)};this.clearDepth=function(){this.clear(!1,!0,!1)};this.clearStencil=function(){this.clear(!1,!1,!0)};this.dispose=function(){t.removeEventListener("webglcontextlost",a,!1);t.removeEventListener("webglcontextrestored",b,!1);Ug.dispose();Vg.dispose();
kb.dispose();nc.dispose();Jb.dispose();bc.dispose();me.dispose();Cc.dispose();Cc.removeEventListener("sessionstart",d);Cc.removeEventListener("sessionend",e);Ka&&(Ka.dispose(),Ka=null);oe.stop()};this.renderBufferDirect=function(H,ca,ea,aa,va,Ta){null===ca&&(ca=Eb);var Ia=va.isMesh&&0>va.matrixWorld.determinant(),Wa=ca;!0!==Wa.isScene&&(Wa=Eb);ob.resetTextureUnits();ca=Wa.fog;var Ra=aa.isMeshStandardMaterial?Wa.environment:null,sb=null===ya?ba.outputEncoding:ya.texture.encoding,hb=(aa.isMeshStandardMaterial?
Jb:nc).get(aa.envMap||Ra),Zb=!0===aa.vertexColors&&!!ea.attributes.color&&4===ea.attributes.color.itemSize,od=!!aa.normalMap&&!!ea.attributes.tangent,mi=!!ea.morphAttributes.position,ni=!!ea.morphAttributes.normal,oi=ea.morphAttributes.position?ea.morphAttributes.position.length:0;Ra=kb.get(aa);var pe=M.state.lights;!0!==na||!0!==Za&&H===Ja||nd.setState(aa,H,H===Ja&&aa.id===ja);var Dc=!1;aa.version===Ra.__version?Ra.needsLights&&Ra.lightsStateVersion!==pe.state.version||Ra.outputEncoding!==sb||va.isInstancedMesh&&
!1===Ra.instancing?Dc=!0:va.isInstancedMesh||!0!==Ra.instancing?va.isSkinnedMesh&&!1===Ra.skinning?Dc=!0:va.isSkinnedMesh||!0!==Ra.skinning?Ra.envMap!==hb||aa.fog&&Ra.fog!==ca?Dc=!0:void 0===Ra.numClippingPlanes||Ra.numClippingPlanes===nd.numPlanes&&Ra.numIntersection===nd.numIntersection?(Ra.vertexAlphas!==Zb||Ra.vertexTangents!==od||Ra.morphTargets!==mi||Ra.morphNormals!==ni||!0===Da.isWebGL2&&Ra.morphTargetsCount!==oi)&&(Dc=!0):Dc=!0:Dc=!0:Dc=!0:(Dc=!0,Ra.__version=aa.version);sb=Ra.currentProgram;
!0===Dc&&(sb=n(aa,Wa,va));Dc=Wa=od=!1;hb=sb.getUniforms();Zb=Ra.uniforms;La.useProgram(sb.program)&&(od=!0,Wa=!0,Dc=!0);aa.id!==ja&&(ja=aa.id,Wa=!0);if(od||Ja!==H){if(hb.setValue(Aa,"projectionMatrix",H.projectionMatrix),Da.logarithmicDepthBuffer&&hb.setValue(Aa,"logDepthBufFC",2/(Math.log(H.far+1)/Math.LN2)),Ja!==H&&(Ja=H,Wa=!0,Dc=!0),aa.isShaderMaterial||aa.isMeshPhongMaterial||aa.isMeshToonMaterial||aa.isMeshStandardMaterial||aa.envMap)od=hb.map.cameraPosition,void 0!==od&&od.setValue(Aa,xc.setFromMatrixPosition(H.matrixWorld));
(aa.isMeshPhongMaterial||aa.isMeshToonMaterial||aa.isMeshLambertMaterial||aa.isMeshBasicMaterial||aa.isMeshStandardMaterial||aa.isShaderMaterial)&&hb.setValue(Aa,"isOrthographic",!0===H.isOrthographicCamera);(aa.isMeshPhongMaterial||aa.isMeshToonMaterial||aa.isMeshLambertMaterial||aa.isMeshBasicMaterial||aa.isMeshStandardMaterial||aa.isShaderMaterial||aa.isShadowMaterial||va.isSkinnedMesh)&&hb.setValue(Aa,"viewMatrix",H.matrixWorldInverse)}va.isSkinnedMesh&&(hb.setOptional(Aa,va,"bindMatrix"),hb.setOptional(Aa,
va,"bindMatrixInverse"),(H=va.skeleton)&&(Da.floatVertexTextures?(null===H.boneTexture&&H.computeBoneTexture(),hb.setValue(Aa,"boneTexture",H.boneTexture,ob),hb.setValue(Aa,"boneTextureSize",H.boneTextureSize)):hb.setOptional(Aa,H,"boneMatrices")));!ea||void 0===ea.morphAttributes.position&&void 0===ea.morphAttributes.normal||Mj.update(va,ea,aa,sb);(Wa||Ra.receiveShadow!==va.receiveShadow)&&(Ra.receiveShadow=va.receiveShadow,hb.setValue(Aa,"receiveShadow",va.receiveShadow));Wa&&(hb.setValue(Aa,"toneMappingExposure",
ba.toneMappingExposure),Ra.needsLights&&(sc=Dc,($b=Zb).ambientLightColor.needsUpdate=sc,$b.lightProbe.needsUpdate=sc,$b.directionalLights.needsUpdate=sc,$b.directionalLightShadows.needsUpdate=sc,$b.pointLights.needsUpdate=sc,$b.pointLightShadows.needsUpdate=sc,$b.spotLights.needsUpdate=sc,$b.spotLightShadows.needsUpdate=sc,$b.rectAreaLights.needsUpdate=sc,$b.hemisphereLights.needsUpdate=sc),ca&&aa.fog&&li.refreshFogUniforms(Zb,ca),li.refreshMaterialUniforms(Zb,aa,E,D,Ka),Kd.upload(Aa,Ra.uniformsList,
Zb,ob));var $b,sc;aa.isShaderMaterial&&!0===aa.uniformsNeedUpdate&&(Kd.upload(Aa,Ra.uniformsList,Zb,ob),aa.uniformsNeedUpdate=!1);aa.isSpriteMaterial&&hb.setValue(Aa,"center",va.center);ca=(hb.setValue(Aa,"modelViewMatrix",va.modelViewMatrix),hb.setValue(Aa,"normalMatrix",va.normalMatrix),hb.setValue(Aa,"modelMatrix",va.matrixWorld),sb);La.setMaterial(aa,Ia);$b=ea.index;sc=ea.attributes.position;if(null===$b){if(void 0===sc||0===sc.count)return}else if(0===$b.count)return;var Tf;H=1;!0===aa.wireframe&&
($b=oc.getWireframeAttribute(ea),H=2);me.setup(va,aa,ca,ea,$b);Ia=Nj;null!==$b&&(Tf=Yb.get($b),Ia=Oj,Ia.setIndex(Tf));Tf=ea.drawRange.start*H;ca=null!==Ta?Ta.start*H:0;var Wg=Math.max(Tf,ca);Ta=Math.max(0,Math.min(null!==$b?$b.count:sc.count,Tf+ea.drawRange.count*H,ca+(null!==Ta?Ta.count*H:1/0))-1-Wg+1);0!==Ta&&(va.isMesh?!0===aa.wireframe?(La.setLineWidth(aa.wireframeLinewidth*(null===ya?E:1)),Ia.setMode(1)):Ia.setMode(4):va.isLine?(aa=aa.linewidth,void 0===aa&&(aa=1),La.setLineWidth(aa*(null===
ya?E:1)),va.isLineSegments?Ia.setMode(1):va.isLineLoop?Ia.setMode(2):Ia.setMode(3)):va.isPoints?Ia.setMode(0):va.isSprite&&Ia.setMode(4),va.isInstancedMesh?Ia.renderInstances(Wg,Ta,va.count):ea.isInstancedBufferGeometry?Ia.renderInstances(Wg,Ta,Math.min(ea.instanceCount,ea._maxInstanceCount)):Ia.render(Wg,Ta))};this.compile=function(H,ca){M=Vg.get(H);M.init();V.push(M);H.traverseVisible(function(ea){ea.isLight&&ea.layers.test(ca.layers)&&(M.pushLight(ea),ea.castShadow&&M.pushShadow(ea))});M.setupLights(ba.physicallyCorrectLights);
H.traverse(function(ea){var aa=ea.material;if(aa)if(Array.isArray(aa))for(var va=0;va<aa.length;va++)n(aa[va],H,ea);else n(aa,H,ea)});V.pop();M=null};var pi=null,oe=new Te;oe.setAnimationLoop(function(H){pi&&pi(H)});"undefined"!=typeof window&&oe.setContext(window);this.setAnimationLoop=function(H){pi=H;Cc.setAnimationLoop(H);null===H?oe.stop():oe.start()};Cc.addEventListener("sessionstart",d);Cc.addEventListener("sessionend",e);this.render=function(H,ca){if(void 0!==ca&&!0!==ca.isCamera)return void console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");
if(!0!==Y){!0===H.autoUpdate&&H.updateMatrixWorld();null===ca.parent&&ca.updateMatrixWorld();!0===Cc.enabled&&!0===Cc.isPresenting&&(!0===Cc.cameraAutoUpdate&&Cc.updateCamera(ca),ca=Cc.getCamera());!0===H.isScene&&H.onBeforeRender(ba,H,ca,ya);M=Vg.get(H,V.length);M.init();V.push(M);pb.multiplyMatrices(ca.projectionMatrix,ca.matrixWorldInverse);wa.setFromProjectionMatrix(pb);Za=this.localClippingEnabled;na=nd.init(this.clippingPlanes,Za,ca);O=Ug.get(H,S.length);O.init();S.push(O);g(H,ca,0,ba.sortObjects);
O.finish();!0===ba.sortObjects&&O.sort(J,W);!0===na&&nd.beginShadows();if(Tc.render(M.state.shadowsArray,H,ca),!0===na&&nd.endShadows(),!0===this.info.autoReset&&this.info.reset(),Ld.render(O,H),M.setupLights(ba.physicallyCorrectLights),ca.isArrayCamera)for(var ea=ca.cameras,aa=0,va=ea.length;aa<va;aa++){var Ta=ea[aa];h(O,H,Ta,Ta.viewport)}else h(O,H,ca);null!==ya&&(ob.updateMultisampleRenderTarget(ya),ob.updateRenderTargetMipmap(ya));!0===H.isScene&&H.onAfterRender(ba,H,ca);La.buffers.depth.setTest(!0);
La.buffers.depth.setMask(!0);La.buffers.color.setMask(!0);La.setPolygonOffset(!1);me.resetDefaultState();ja=-1;Ja=null;V.pop();M=0<V.length?V[V.length-1]:null;S.pop();O=0<S.length?S[S.length-1]:null}};this.getActiveCubeFace=function(){return Z};this.getActiveMipmapLevel=function(){return Ha};this.getRenderTarget=function(){return ya};this.setRenderTarget=function(H,ca,ea){ca=void 0===ca?0:ca;ea=void 0===ea?0:ea;ya=H;Z=ca;Ha=ea;H&&void 0===kb.get(H).__webglFramebuffer&&ob.setupRenderTarget(H);var aa=
null,va=!1,Ta=!1;if(H){var Ia=H.texture;(Ia.isDataTexture3D||Ia.isDataTexture2DArray)&&(Ta=!0);Ia=kb.get(H).__webglFramebuffer;H.isWebGLCubeRenderTarget?(aa=Ia[ca],va=!0):aa=H.isWebGLMultisampleRenderTarget?kb.get(H).__webglMultisampledFramebuffer:Ia;Va.copy(H.viewport);db.copy(H.scissor);Xa=H.scissorTest}else Va.copy(qa).multiplyScalar(E).floor(),db.copy(K).multiplyScalar(E).floor(),Xa=ha;if(La.bindFramebuffer(36160,aa)&&Da.drawBuffers){Ia=!1;if(H)if(H.isWebGLMultipleRenderTargets){if(aa=H.texture,
da.length!==aa.length||36064!==da[0]){Ia=0;for(var Wa=aa.length;Ia<Wa;Ia++)da[Ia]=36064+Ia;da.length=aa.length;Ia=!0}}else 1===da.length&&36064===da[0]||(da[0]=36064,da.length=1,Ia=!0);else 1===da.length&&1029===da[0]||(da[0]=1029,da.length=1,Ia=!0);Ia&&(Da.isWebGL2?Aa.drawBuffers(da):Fa.get("WEBGL_draw_buffers").drawBuffersWEBGL(da))}(La.viewport(Va),La.scissor(db),La.setScissorTest(Xa),va)?(H=kb.get(H.texture),Aa.framebufferTexture2D(36160,36064,34069+ca,H.__webglTexture,ea)):Ta&&(H=kb.get(H.texture),
Aa.framebufferTextureLayer(36160,36064,H.__webglTexture,ea||0,ca||0));ja=-1};this.readRenderTargetPixels=function(H,ca,ea,aa,va,Ta,Ia){if(!H||!H.isWebGLRenderTarget)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");var Wa=kb.get(H).__webglFramebuffer;if(H.isWebGLCubeRenderTarget&&void 0!==Ia&&(Wa=Wa[Ia]),Wa){La.bindFramebuffer(36160,Wa);try{var Ra=H.texture,sb=Ra.format,hb=Ra.type;if(1023!==sb&&Ic.convert(sb)!==Aa.getParameter(35739))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");
var Zb=1016===hb&&(Fa.has("EXT_color_buffer_half_float")||Da.isWebGL2&&Fa.has("EXT_color_buffer_float"));if(!(1009===hb||Ic.convert(hb)===Aa.getParameter(35738)||1015===hb&&(Da.isWebGL2||Fa.has("OES_texture_float")||Fa.has("WEBGL_color_buffer_float"))||Zb))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");36053===Aa.checkFramebufferStatus(36160)?0<=ca&&ca<=H.width-aa&&0<=ea&&ea<=H.height-va&&Aa.readPixels(ca,
ea,aa,va,Ic.convert(sb),Ic.convert(hb),Ta):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{H=null!==ya?kb.get(ya).__webglFramebuffer:null,La.bindFramebuffer(36160,H)}}};this.copyFramebufferToTexture=function(H,ca,ea){ea=void 0===ea?0:ea;var aa=Math.pow(2,-ea),va=Math.floor(ca.image.width*aa);aa=Math.floor(ca.image.height*aa);var Ta=Ic.convert(ca.format);Da.isWebGL2&&(6407===Ta&&(Ta=32849),6408===Ta&&(Ta=32856));ob.setTexture2D(ca,
0);Aa.copyTexImage2D(3553,ea,Ta,H.x,H.y,va,aa,0);La.unbindTexture()};this.copyTextureToTexture=function(H,ca,ea,aa){aa=void 0===aa?0:aa;var va=ca.image.width,Ta=ca.image.height,Ia=Ic.convert(ea.format),Wa=Ic.convert(ea.type);ob.setTexture2D(ea,0);Aa.pixelStorei(37440,ea.flipY);Aa.pixelStorei(37441,ea.premultiplyAlpha);Aa.pixelStorei(3317,ea.unpackAlignment);ca.isDataTexture?Aa.texSubImage2D(3553,aa,H.x,H.y,va,Ta,Ia,Wa,ca.image.data):ca.isCompressedTexture?Aa.compressedTexSubImage2D(3553,aa,H.x,H.y,
ca.mipmaps[0].width,ca.mipmaps[0].height,Ia,ca.mipmaps[0].data):Aa.texSubImage2D(3553,aa,H.x,H.y,Ia,Wa,ca.image);0===aa&&ea.generateMipmaps&&Aa.generateMipmap(3553);La.unbindTexture()};this.copyTextureToTexture3D=function(H,ca,ea,aa,va){va=void 0===va?0:va;if(ba.isWebGL1Renderer)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");var Ta=H.max.x-H.min.x+1,Ia=H.max.y-H.min.y+1,Wa=H.max.z-H.min.z+1,Ra=Ic.convert(aa.format),sb=Ic.convert(aa.type);if(aa.isDataTexture3D){ob.setTexture3D(aa,
0);var hb=32879}else{if(!aa.isDataTexture2DArray)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");ob.setTexture2DArray(aa,0);hb=35866}Aa.pixelStorei(37440,aa.flipY);Aa.pixelStorei(37441,aa.premultiplyAlpha);Aa.pixelStorei(3317,aa.unpackAlignment);var Zb=Aa.getParameter(3314),od=Aa.getParameter(32878),mi=Aa.getParameter(3316),ni=Aa.getParameter(3315),oi=Aa.getParameter(32877),pe=ea.isCompressedTexture?ea.mipmaps[0]:
ea.image;Aa.pixelStorei(3314,pe.width);Aa.pixelStorei(32878,pe.height);Aa.pixelStorei(3316,H.min.x);Aa.pixelStorei(3315,H.min.y);Aa.pixelStorei(32877,H.min.z);ea.isDataTexture||ea.isDataTexture3D?Aa.texSubImage3D(hb,va,ca.x,ca.y,ca.z,Ta,Ia,Wa,Ra,sb,pe.data):ea.isCompressedTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),Aa.compressedTexSubImage3D(hb,va,ca.x,ca.y,ca.z,Ta,Ia,Wa,Ra,pe.data)):Aa.texSubImage3D(hb,va,ca.x,ca.y,ca.z,Ta,Ia,Wa,
Ra,sb,pe);Aa.pixelStorei(3314,Zb);Aa.pixelStorei(32878,od);Aa.pixelStorei(3316,mi);Aa.pixelStorei(3315,ni);Aa.pixelStorei(32877,oi);0===va&&aa.generateMipmaps&&Aa.generateMipmap(hb);La.unbindTexture()};this.initTexture=function(H){ob.setTexture2D(H,0);La.unbindTexture()};this.resetState=function(){Ha=Z=0;ya=null;La.reset();me.reset()};"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}function Xg(l,k,f,a,b,c){Xe.subVectors(l,f).addScalar(.5).multiply(a);
void 0!==b?(Uf.x=c*Xe.x-b*Xe.y,Uf.y=b*Xe.x+c*Xe.y):Uf.copy(Xe);l.copy(k);l.x+=Uf.x;l.y+=Uf.y;l.applyMatrix4(Qj)}function Rj(l,k,f,a,b,c,d){var e=qi.distanceSqToPoint(l);e<f&&(f=new B,qi.closestPointToPoint(l,f),f.applyMatrix4(a),l=b.ray.origin.distanceTo(f),l<b.near||l>b.far||c.push({distance:l,distanceToRay:Math.sqrt(e),point:f,index:k,face:null,object:d}))}function ri(){var l=0,k=0,f=0,a=0;return{initCatmullRom:function(b,c,d,e,g){b=g*(d-b);e=g*(e-c);l=c;k=b;f=-3*c+3*d-2*b-e;a=2*c-2*d+b+e},initNonuniformCatmullRom:function(b,
c,d,e,g,h,m){b=((c-b)/g-(d-b)/(g+h)+(d-c)/h)*h;e=((d-c)/h-(e-c)/(h+m)+(e-d)/m)*h;l=c;k=b;f=-3*c+3*d-2*b-e;a=2*c-2*d+b+e},calc:function(b){var c=b*b;return l+k*b+f*c+a*c*b}}}function Sj(l,k,f,a,b){k=.5*(a-k);b=.5*(b-f);var c=l*l;return(2*f-2*a+k+b)*l*c+(-3*f+3*a-2*k-b)*c+k*l+f}function Vf(l,k,f,a){var b=1-l;return b*b*k+2*(1-l)*l*f+l*l*a}function Wf(l,k,f,a,b){return function(c,d){c=1-c;return c*c*c*d}(l,k)+function(c,d){var e=1-c;return 3*e*e*c*d}(l,f)+3*(1-l)*l*l*a+l*l*l*b}function Tj(l,k,f,a,b){for(var c,
d=0,e=k,g=f-a;e<f;e+=a)d+=(l[g]-l[e])*(l[e+1]+l[g+1]),g=e;if(b===0<d)for(b=k;b<f;b+=a)c=Uj(b,l[b],l[b+1],c);else for(b=f-a;b>=k;b-=a)c=Uj(b,l[b],l[b+1],c);return c&&Yg(c,c.next)&&(Xf(c),c=c.next),c}function Md(l,k){if(!l)return l;k||(k=l);var f=l;do if(l=!1,f.steiner||!Yg(f,f.next)&&0!==Nb(f.prev,f,f.next))f=f.next;else{if(Xf(f),f=k=f.prev,f===f.next)break;l=!0}while(l||f!==k);return k}function Yf(l,k,f,a,b,c,d){if(l){if(!d&&c){var e=l,g=e;do null===g.z&&(g.z=si(g.x,g.y,a,b,c)),g.prevZ=g.prev,g=g.nextZ=
g.next;while(g!==e);g.prevZ.nextZ=null;g.prevZ=null;e=g;var h,m,n,q,t=1;do{g=e;var r=e=null;for(n=0;g;){n++;var u=g;for(h=q=0;h<t&&(q++,u=u.nextZ,u);h++);for(h=t;0<q||0<h&&u;)0!==q&&(0===h||!u||g.z<=u.z)?(m=g,g=g.nextZ,q--):(m=u,u=u.nextZ,h--),r?r.nextZ=m:e=m,m.prevZ=r,r=m;g=u}r.nextZ=null;t*=2}while(1<n)}for(g=l;l.prev!==l.next;){m=l.prev;e=l.next;if(c)a:{u=l;t=a;h=b;var A=c;r=u.prev;n=u.next;if(0<=Nb(r,u,n))u=!1;else{var w=r.x>u.x?r.x>n.x?r.x:n.x:u.x>n.x?u.x:n.x,x=r.y>u.y?r.y>n.y?r.y:n.y:u.y>n.y?
u.y:n.y;q=si(r.x<u.x?r.x<n.x?r.x:n.x:u.x<n.x?u.x:n.x,r.y<u.y?r.y<n.y?r.y:n.y:u.y<n.y?u.y:n.y,t,h,A);t=si(w,x,t,h,A);h=u.prevZ;for(A=u.nextZ;h&&h.z>=q&&A&&A.z<=t;){if(h!==u.prev&&h!==u.next&&Ye(r.x,r.y,u.x,u.y,n.x,n.y,h.x,h.y)&&0<=Nb(h.prev,h,h.next)||(h=h.prevZ,A!==u.prev&&A!==u.next&&Ye(r.x,r.y,u.x,u.y,n.x,n.y,A.x,A.y)&&0<=Nb(A.prev,A,A.next))){u=!1;break a}A=A.nextZ}for(;h&&h.z>=q;){if(h!==u.prev&&h!==u.next&&Ye(r.x,r.y,u.x,u.y,n.x,n.y,h.x,h.y)&&0<=Nb(h.prev,h,h.next)){u=!1;break a}h=h.prevZ}for(;A&&
A.z<=t;){if(A!==u.prev&&A!==u.next&&Ye(r.x,r.y,u.x,u.y,n.x,n.y,A.x,A.y)&&0<=Nb(A.prev,A,A.next)){u=!1;break a}A=A.nextZ}u=!0}}else a:if(u=l,r=u.prev,n=u.next,0<=Nb(r,u,n))u=!1;else{for(q=u.next.next;q!==u.prev;){if(Ye(r.x,r.y,u.x,u.y,n.x,n.y,q.x,q.y)&&0<=Nb(q.prev,q,q.next)){u=!1;break a}q=q.next}u=!0}if(u)k.push(m.i/f),k.push(l.i/f),k.push(e.i/f),Xf(l),g=l=e.next;else if((l=e)===g){if(d)if(1===d){l=Md(l);d=k;m=f;e=l;do g=e.prev,u=e.next.next,!Yg(g,u)&&Vj(g,e,e.next,u)&&Zf(g,u)&&Zf(u,g)&&(d.push(g.i/
m),d.push(e.i/m),d.push(u.i/m),Xf(e),Xf(e.next),e=l=u),e=e.next;while(e!==l);l=Md(e);Yf(l,k,f,a,b,c,2)}else{if(2===d)a:{d=l;do{for(m=d.next.next;m!==d.prev;){if(d.i!==m.i&&Jl(d,m)){l=Wj(d,m);d=Md(d,d.next);l=Md(l,l.next);Yf(d,k,f,a,b,c);Yf(l,k,f,a,b,c);break a}m=m.next}d=d.next}while(d!==l)}}else Yf(Md(l),k,f,a,b,c,1);break}}}}function Kl(l,k){return l.x-k.x}function Ll(l,k){if(k=function(f,a){var b=a,c=f.x,d=f.y,e=-1/0;do{if(d<=b.y&&d>=b.next.y&&b.next.y!==b.y){var g=b.x+(d-b.y)*(b.next.x-b.x)/(b.next.y-
b.y);if(g<=c&&g>e){if(e=g,g===c){if(d===b.y)return b;if(d===b.next.y)return b.next}var h=b.x<b.next.x?b:b.next}}b=b.next}while(b!==a);if(!h)return null;if(c===e)return h;a=h;g=h.x;var m=h.y,n=1/0;b=h;do{if(c>=b.x&&b.x>=g&&c!==b.x&&Ye(d<m?c:e,d,g,m,d<m?e:c,d,b.x,b.y)){var q=Math.abs(d-b.y)/(c-b.x);var t;if((t=Zf(b,f))&&!(t=q<n)&&(t=q===n)&&!(t=b.x>h.x)&&(t=b.x===h.x)){t=h;var r=b;t=0>Nb(t.prev,t,r.prev)&&0>Nb(r.next,t,t.next)}t&&(h=b,n=q)}b=b.next}while(b!==a);return h}(l,k),k)l=Wj(k,l),Md(k,k.next),
Md(l,l.next)}function si(l,k,f,a,b){return 1431655765&((l=858993459&((l=252645135&((l=16711935&((l=32767*(l-f)*b)|l<<8))|l<<4))|l<<2))|l<<1)|(1431655765&((k=858993459&((k=252645135&((k=16711935&((k=32767*(k-a)*b)|k<<8))|k<<4))|k<<2))|k<<1))<<1}function Ye(l,k,f,a,b,c,d,e){return 0<=(b-d)*(k-e)-(l-d)*(c-e)&&0<=(l-d)*(a-e)-(f-d)*(k-e)&&0<=(f-d)*(c-e)-(b-d)*(a-e)}function Jl(l,k){return l.next.i!==k.i&&l.prev.i!==k.i&&!function(f,a){var b=f;do{if(b.i!==f.i&&b.next.i!==f.i&&b.i!==a.i&&b.next.i!==a.i&&
Vj(b,b.next,f,a))return!0;b=b.next}while(b!==f);return!1}(l,k)&&(Zf(l,k)&&Zf(k,l)&&function(f,a){var b=f,c=!1,d=(f.x+a.x)/2;a=(f.y+a.y)/2;do b.y>a!=b.next.y>a&&b.next.y!==b.y&&d<(b.next.x-b.x)*(a-b.y)/(b.next.y-b.y)+b.x&&(c=!c),b=b.next;while(b!==f);return c}(l,k)&&(Nb(l.prev,l,k.prev)||Nb(l,k.prev,k))||Yg(l,k)&&0<Nb(l.prev,l,l.next)&&0<Nb(k.prev,k,k.next))}function Nb(l,k,f){return(k.y-l.y)*(f.x-k.x)-(k.x-l.x)*(f.y-k.y)}function Yg(l,k){return l.x===k.x&&l.y===k.y}function Vj(l,k,f,a){var b=Zg(Nb(l,
k,f)),c=Zg(Nb(l,k,a)),d=Zg(Nb(f,a,l)),e=Zg(Nb(f,a,k));return b!==c&&d!==e||!(0!==b||!$g(l,f,k))||!(0!==c||!$g(l,a,k))||!(0!==d||!$g(f,l,a))||!(0!==e||!$g(f,k,a))}function $g(l,k,f){return k.x<=Math.max(l.x,f.x)&&k.x>=Math.min(l.x,f.x)&&k.y<=Math.max(l.y,f.y)&&k.y>=Math.min(l.y,f.y)}function Zg(l){return 0<l?1:0>l?-1:0}function Zf(l,k){return 0>Nb(l.prev,l,l.next)?0<=Nb(l,k,l.next)&&0<=Nb(l,l.prev,k):0>Nb(l,k,l.prev)||0>Nb(l,l.next,k)}function Wj(l,k){var f=new ti(l.i,l.x,l.y),a=new ti(k.i,k.x,k.y),
b=l.next,c=k.prev;return l.next=k,k.prev=l,f.next=b,b.prev=f,a.next=f,f.prev=a,c.next=a,a.prev=c,a}function Uj(l,k,f,a){l=new ti(l,k,f);return a?(l.next=a.next,l.prev=a,a.next.prev=l,a.next=l):(l.prev=l,l.next=l),l}function Xf(l){l.next.prev=l.prev;l.prev.next=l.next;l.prevZ&&(l.prevZ.nextZ=l.nextZ);l.nextZ&&(l.nextZ.prevZ=l.prevZ)}function ti(l,k,f){this.i=l;this.x=k;this.y=f;this.nextZ=this.prevZ=this.z=this.next=this.prev=null;this.steiner=!1}function Xj(l){var k=l.length;2<k&&l[k-1].equals(l[0])&&
l.pop()}function Yj(l,k){for(var f=0;f<k.length;f++)l.push(k[f].x),l.push(k[f].y)}function Zj(l,k,f){var a=l.x+","+l.y+","+l.z+"-"+k.x+","+k.y+","+k.z;l=k.x+","+k.y+","+k.z+"-"+l.x+","+l.y+","+l.z;return!0!==f.has(a)&&!0!==f.has(l)&&(f.add(a,l),!0)}function Ml(l){if(void 0===l.type)throw Error("THREE.KeyframeTrack: track type undefined, can not parse");var k=function(b){switch(b.toLowerCase()){case "scalar":case "double":case "float":case "number":case "integer":return Ze;case "vector":case "vector2":case "vector3":case "vector4":return $e;
case "color":return ah;case "quaternion":return Nd;case "bool":case "boolean":return Od;case "string":return Pd}throw Error("THREE.KeyframeTrack: Unsupported typeName: "+b);}(l.type);if(void 0===l.times){var f=[],a=[];Hb.flattenJSON(l.keys,f,a,"value");l.times=f;l.values=a}return void 0!==k.parse?k.parse(l):new k(l.name,l.times,l.values,l.interpolation)}function ak(){return("undefined"==typeof performance?Date:performance).now()}function bk(l,k){return l.distance-k.distance}function ui(l,k,f,a){if(l.layers.test(k.layers)&&
l.raycast(k,f),!0===a){l=l.children;a=0;for(var b=l.length;a<b;a++)ui(l[a],k,f,!0)}}function ck(l){var k=[];l&&l.isBone&&k.push(l);for(var f=0;f<l.children.length;f++)k.push.apply(k,ck(l.children[f]));return k}function Sb(l,k,f,a,b,c,d){bh.set(b,c,d).unproject(a);l=k[l];if(void 0!==l)for(f=f.getAttribute("position"),k=0,a=l.length;k<a;k++)f.setXYZ(l[k],bh.x,bh.y,bh.z)}var Jc=function(){};Jc.prototype.addEventListener=function(l,k){void 0===this._listeners&&(this._listeners={});var f=this._listeners;
void 0===f[l]&&(f[l]=[]);-1===f[l].indexOf(k)&&f[l].push(k)};Jc.prototype.hasEventListener=function(l,k){if(void 0===this._listeners)return!1;var f=this._listeners;return void 0!==f[l]&&-1!==f[l].indexOf(k)};Jc.prototype.removeEventListener=function(l,k){void 0!==this._listeners&&(l=this._listeners[l],void 0!==l&&(k=l.indexOf(k),-1!==k&&l.splice(k,1)))};Jc.prototype.dispatchEvent=function(l){if(void 0!==this._listeners){var k=this._listeners[l.type];if(void 0!==k){l.target=this;k=k.slice(0);for(var f=
0,a=k.length;f<a;f++)k[f].call(this,l);l.target=null}}};for(var ch=1234567,qe=Math.PI/180,$f=180/Math.PI,gc=[],ag=0;256>ag;ag++)gc[ag]=(16>ag?"0":"")+ag.toString(16);var il="undefined"!=typeof crypto&&"randomUUID"in crypto,dk=Object.freeze({__proto__:null,DEG2RAD:qe,RAD2DEG:$f,generateUUID:N,clamp:R,euclideanModulo:fa,mapLinear:function(l,k,f,a,b){return a+(l-k)*(b-a)/(f-k)},inverseLerp:function(l,k,f){return l!==k?(f-l)/(k-l):0},lerp:ka,damp:function(l,k,f,a){return ka(l,k,1-Math.exp(-f*a))},pingpong:function(l,
k){k=void 0===k?1:k;return k-Math.abs(fa(l,2*k)-k)},smoothstep:function(l,k,f){return l<=k?0:l>=f?1:(l=(l-k)/(f-k))*l*(3-2*l)},smootherstep:function(l,k,f){return l<=k?0:l>=f?1:(l=(l-k)/(f-k))*l*l*(l*(6*l-15)+10)},randInt:function(l,k){return l+Math.floor(Math.random()*(k-l+1))},randFloat:function(l,k){return l+Math.random()*(k-l)},randFloatSpread:function(l){return l*(.5-Math.random())},seededRandom:function(l){return void 0!==l&&(ch=l%2147483647),ch=16807*ch%2147483647,(ch-1)/2147483646},degToRad:function(l){return l*
qe},radToDeg:function(l){return l*$f},isPowerOfTwo:cb,ceilPowerOfTwo:ia,floorPowerOfTwo:Na,setQuaternionFromProperEuler:function(l,k,f,a,b){var c=Math.cos,d=Math.sin,e=c(f/2);f=d(f/2);var g=c((k+a)/2),h=d((k+a)/2),m=c((k-a)/2),n=d((k-a)/2);c=c((a-k)/2);k=d((a-k)/2);switch(b){case "XYX":l.set(e*h,f*m,f*n,e*g);break;case "YZY":l.set(f*n,e*h,f*m,e*g);break;case "ZXZ":l.set(f*m,f*n,e*h,e*g);break;case "XZX":l.set(e*h,f*k,f*c,e*g);break;case "YXY":l.set(f*c,e*h,f*k,e*g);break;case "ZYZ":l.set(f*k,f*c,
e*h,e*g);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+b)}}}),T=function(l,k){this.x=void 0===l?0:l;this.y=void 0===k?0:k};T.prototype.set=function(l,k){return this.x=l,this.y=k,this};T.prototype.setScalar=function(l){return this.x=l,this.y=l,this};T.prototype.setX=function(l){return this.x=l,this};T.prototype.setY=function(l){return this.y=l,this};T.prototype.setComponent=function(l,k){switch(l){case 0:this.x=k;break;case 1:this.y=k;
break;default:throw Error("index is out of range: "+l);}return this};T.prototype.getComponent=function(l){switch(l){case 0:return this.x;case 1:return this.y;default:throw Error("index is out of range: "+l);}};T.prototype.clone=function(){return new this.constructor(this.x,this.y)};T.prototype.copy=function(l){return this.x=l.x,this.y=l.y,this};T.prototype.add=function(l,k){return void 0!==k?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(l,
k)):(this.x+=l.x,this.y+=l.y,this)};T.prototype.addScalar=function(l){return this.x+=l,this.y+=l,this};T.prototype.addVectors=function(l,k){return this.x=l.x+k.x,this.y=l.y+k.y,this};T.prototype.addScaledVector=function(l,k){return this.x+=l.x*k,this.y+=l.y*k,this};T.prototype.sub=function(l,k){return void 0!==k?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(l,k)):(this.x-=l.x,this.y-=l.y,this)};T.prototype.subScalar=function(l){return this.x-=
l,this.y-=l,this};T.prototype.subVectors=function(l,k){return this.x=l.x-k.x,this.y=l.y-k.y,this};T.prototype.multiply=function(l){return this.x*=l.x,this.y*=l.y,this};T.prototype.multiplyScalar=function(l){return this.x*=l,this.y*=l,this};T.prototype.divide=function(l){return this.x/=l.x,this.y/=l.y,this};T.prototype.divideScalar=function(l){return this.multiplyScalar(1/l)};T.prototype.applyMatrix3=function(l){var k=this.x,f=this.y;l=l.elements;return this.x=l[0]*k+l[3]*f+l[6],this.y=l[1]*k+l[4]*
f+l[7],this};T.prototype.min=function(l){return this.x=Math.min(this.x,l.x),this.y=Math.min(this.y,l.y),this};T.prototype.max=function(l){return this.x=Math.max(this.x,l.x),this.y=Math.max(this.y,l.y),this};T.prototype.clamp=function(l,k){return this.x=Math.max(l.x,Math.min(k.x,this.x)),this.y=Math.max(l.y,Math.min(k.y,this.y)),this};T.prototype.clampScalar=function(l,k){return this.x=Math.max(l,Math.min(k,this.x)),this.y=Math.max(l,Math.min(k,this.y)),this};T.prototype.clampLength=function(l,k){var f=
this.length();return this.divideScalar(f||1).multiplyScalar(Math.max(l,Math.min(k,f)))};T.prototype.floor=function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this};T.prototype.ceil=function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this};T.prototype.round=function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this};T.prototype.roundToZero=function(){return this.x=0>this.x?Math.ceil(this.x):Math.floor(this.x),this.y=0>this.y?Math.ceil(this.y):Math.floor(this.y),
this};T.prototype.negate=function(){return this.x=-this.x,this.y=-this.y,this};T.prototype.dot=function(l){return this.x*l.x+this.y*l.y};T.prototype.cross=function(l){return this.x*l.y-this.y*l.x};T.prototype.lengthSq=function(){return this.x*this.x+this.y*this.y};T.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)};T.prototype.manhattanLength=function(){return Math.abs(this.x)+Math.abs(this.y)};T.prototype.normalize=function(){return this.divideScalar(this.length()||1)};T.prototype.angle=
function(){return Math.atan2(-this.y,-this.x)+Math.PI};T.prototype.distanceTo=function(l){return Math.sqrt(this.distanceToSquared(l))};T.prototype.distanceToSquared=function(l){var k=this.x-l.x;l=this.y-l.y;return k*k+l*l};T.prototype.manhattanDistanceTo=function(l){return Math.abs(this.x-l.x)+Math.abs(this.y-l.y)};T.prototype.setLength=function(l){return this.normalize().multiplyScalar(l)};T.prototype.lerp=function(l,k){return this.x+=(l.x-this.x)*k,this.y+=(l.y-this.y)*k,this};T.prototype.lerpVectors=
function(l,k,f){return this.x=l.x+(k.x-l.x)*f,this.y=l.y+(k.y-l.y)*f,this};T.prototype.equals=function(l){return l.x===this.x&&l.y===this.y};T.prototype.fromArray=function(l,k){k=void 0===k?0:k;return this.x=l[k],this.y=l[k+1],this};T.prototype.toArray=function(l,k){l=void 0===l?[]:l;k=void 0===k?0:k;return l[k]=this.x,l[k+1]=this.y,l};T.prototype.fromBufferAttribute=function(l,k,f){return void 0!==f&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=l.getX(k),
this.y=l.getY(k),this};T.prototype.rotateAround=function(l,k){var f=Math.cos(k);k=Math.sin(k);var a=this.x-l.x,b=this.y-l.y;return this.x=a*f-b*k+l.x,this.y=a*k+b*f+l.y,this};T.prototype.random=function(){return this.x=Math.random(),this.y=Math.random(),this};T.prototype[Symbol.iterator]=function k(){var f=this;return $jscomp.generator.createGenerator(k,function(a){if(1==a.nextAddress)return a.yield(f.x,2);if(3!=a.nextAddress)return a.yield(f.y,3);a.jumpToEnd()})};$jscomp.global.Object.defineProperties(T.prototype,
{width:{configurable:!0,enumerable:!0,get:function(){return this.x},set:function(k){this.x=k}},height:{configurable:!0,enumerable:!0,get:function(){return this.y},set:function(k){this.y=k}}});T.prototype.isVector2=!0;var fb=function(){this.elements=[1,0,0,0,1,0,0,0,1];0<arguments.length&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")};fb.prototype.set=function(k,f,a,b,c,d,e,g,h){var m=this.elements;return m[0]=k,m[1]=b,m[2]=e,m[3]=f,m[4]=c,m[5]=g,m[6]=
a,m[7]=d,m[8]=h,this};fb.prototype.identity=function(){return this.set(1,0,0,0,1,0,0,0,1),this};fb.prototype.copy=function(k){var f=this.elements;k=k.elements;return f[0]=k[0],f[1]=k[1],f[2]=k[2],f[3]=k[3],f[4]=k[4],f[5]=k[5],f[6]=k[6],f[7]=k[7],f[8]=k[8],this};fb.prototype.extractBasis=function(k,f,a){return k.setFromMatrix3Column(this,0),f.setFromMatrix3Column(this,1),a.setFromMatrix3Column(this,2),this};fb.prototype.setFromMatrix4=function(k){k=k.elements;return this.set(k[0],k[4],k[8],k[1],k[5],
k[9],k[2],k[6],k[10]),this};fb.prototype.multiply=function(k){return this.multiplyMatrices(this,k)};fb.prototype.premultiply=function(k){return this.multiplyMatrices(k,this)};fb.prototype.multiplyMatrices=function(k,f){var a=k.elements,b=f.elements;f=this.elements;k=a[0];var c=a[3],d=a[6],e=a[1],g=a[4],h=a[7],m=a[2],n=a[5];a=a[8];var q=b[0],t=b[3],r=b[6],u=b[1],A=b[4],w=b[7],x=b[2],C=b[5];b=b[8];return f[0]=k*q+c*u+d*x,f[3]=k*t+c*A+d*C,f[6]=k*r+c*w+d*b,f[1]=e*q+g*u+h*x,f[4]=e*t+g*A+h*C,f[7]=e*r+g*
w+h*b,f[2]=m*q+n*u+a*x,f[5]=m*t+n*A+a*C,f[8]=m*r+n*w+a*b,this};fb.prototype.multiplyScalar=function(k){var f=this.elements;return f[0]*=k,f[3]*=k,f[6]*=k,f[1]*=k,f[4]*=k,f[7]*=k,f[2]*=k,f[5]*=k,f[8]*=k,this};fb.prototype.determinant=function(){var k=this.elements,f=k[0],a=k[1],b=k[2],c=k[3],d=k[4],e=k[5],g=k[6],h=k[7];k=k[8];return f*d*k-f*e*h-a*c*k+a*e*g+b*c*h-b*d*g};fb.prototype.invert=function(){var k=this.elements,f=k[0],a=k[1],b=k[2],c=k[3],d=k[4],e=k[5],g=k[6],h=k[7],m=k[8],n=m*d-e*h,q=e*g-
m*c,t=h*c-d*g,r=f*n+a*q+b*t;if(0===r)return this.set(0,0,0,0,0,0,0,0,0);r=1/r;return k[0]=n*r,k[1]=(b*h-m*a)*r,k[2]=(e*a-b*d)*r,k[3]=q*r,k[4]=(m*f-b*g)*r,k[5]=(b*c-e*f)*r,k[6]=t*r,k[7]=(a*g-h*f)*r,k[8]=(d*f-a*c)*r,this};fb.prototype.transpose=function(){var k,f=this.elements;return k=f[1],f[1]=f[3],f[3]=k,k=f[2],f[2]=f[6],f[6]=k,k=f[5],f[5]=f[7],f[7]=k,this};fb.prototype.getNormalMatrix=function(k){return this.setFromMatrix4(k).invert().transpose()};fb.prototype.transposeIntoArray=function(k){var f=
this.elements;return k[0]=f[0],k[1]=f[3],k[2]=f[6],k[3]=f[1],k[4]=f[4],k[5]=f[7],k[6]=f[2],k[7]=f[5],k[8]=f[8],this};fb.prototype.setUvTransform=function(k,f,a,b,c,d,e){var g=Math.cos(c);c=Math.sin(c);return this.set(a*g,a*c,-a*(g*d+c*e)+d+k,-b*c,b*g,-b*(-c*d+g*e)+e+f,0,0,1),this};fb.prototype.scale=function(k,f){var a=this.elements;return a[0]*=k,a[3]*=k,a[6]*=k,a[1]*=f,a[4]*=f,a[7]*=f,this};fb.prototype.rotate=function(k){var f=Math.cos(k);k=Math.sin(k);var a=this.elements,b=a[0],c=a[3],d=a[6],
e=a[1],g=a[4],h=a[7];return a[0]=f*b+k*e,a[3]=f*c+k*g,a[6]=f*d+k*h,a[1]=-k*b+f*e,a[4]=-k*c+f*g,a[7]=-k*d+f*h,this};fb.prototype.translate=function(k,f){var a=this.elements;return a[0]+=k*a[2],a[3]+=k*a[5],a[6]+=k*a[8],a[1]+=f*a[2],a[4]+=f*a[5],a[7]+=f*a[8],this};fb.prototype.equals=function(k){var f=this.elements;k=k.elements;for(var a=0;9>a;a++)if(f[a]!==k[a])return!1;return!0};fb.prototype.fromArray=function(k,f){f=void 0===f?0:f;for(var a=0;9>a;a++)this.elements[a]=k[a+f];return this};fb.prototype.toArray=
function(k,f){k=void 0===k?[]:k;f=void 0===f?0:f;var a=this.elements;return k[f]=a[0],k[f+1]=a[1],k[f+2]=a[2],k[f+3]=a[3],k[f+4]=a[4],k[f+5]=a[5],k[f+6]=a[6],k[f+7]=a[7],k[f+8]=a[8],k};fb.prototype.clone=function(){return(new this.constructor).fromArray(this.elements)};fb.prototype.isMatrix3=!0;var af={Int8Array:Int8Array,Uint8Array:Uint8Array,Uint8ClampedArray:Uint8ClampedArray,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array},
bf,Ed=function(){};Ed.getDataURL=function(k){if(/^data:/i.test(k.src)||"undefined"==typeof HTMLCanvasElement)return k.src;if(k instanceof HTMLCanvasElement)var f=k;else void 0===bf&&(bf=sa("canvas")),bf.width=k.width,bf.height=k.height,f=bf.getContext("2d"),k instanceof ImageData?f.putImageData(k,0,0):f.drawImage(k,0,0,k.width,k.height),f=bf;return 2048<f.width||2048<f.height?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",k),f.toDataURL("image/jpeg",.6)):
f.toDataURL("image/png")};var Nl=0,mb=function(k,f,a,b,c,d,e,g,h,m){k=void 0===k?mb.DEFAULT_IMAGE:k;f=void 0===f?mb.DEFAULT_MAPPING:f;a=void 0===a?1001:a;b=void 0===b?1001:b;c=void 0===c?1006:c;d=void 0===d?1008:d;e=void 0===e?1023:e;g=void 0===g?1009:g;h=void 0===h?1:h;m=void 0===m?3E3:m;Object.defineProperty(this,"id",{value:Nl++});this.uuid=N();this.name="";this.image=k;this.mipmaps=[];this.mapping=f;this.wrapS=a;this.wrapT=b;this.magFilter=c;this.minFilter=d;this.anisotropy=h;this.format=e;this.internalFormat=
null;this.type=g;this.offset=new T(0,0);this.repeat=new T(1,1);this.center=new T(0,0);this.rotation=0;this.matrixAutoUpdate=!0;this.matrix=new fb;this.generateMipmaps=!0;this.premultiplyAlpha=!1;this.flipY=!0;this.unpackAlignment=4;this.encoding=m;this.userData={};this.version=0;this.onUpdate=null;this.isRenderTargetTexture=!1;return this};$jscomp.inherits(mb,Jc);mb.prototype.updateMatrix=function(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,
this.center.y)};mb.prototype.clone=function(){return(new this.constructor).copy(this)};mb.prototype.copy=function(k){return this.name=k.name,this.image=k.image,this.mipmaps=k.mipmaps.slice(0),this.mapping=k.mapping,this.wrapS=k.wrapS,this.wrapT=k.wrapT,this.magFilter=k.magFilter,this.minFilter=k.minFilter,this.anisotropy=k.anisotropy,this.format=k.format,this.internalFormat=k.internalFormat,this.type=k.type,this.offset.copy(k.offset),this.repeat.copy(k.repeat),this.center.copy(k.center),this.rotation=
k.rotation,this.matrixAutoUpdate=k.matrixAutoUpdate,this.matrix.copy(k.matrix),this.generateMipmaps=k.generateMipmaps,this.premultiplyAlpha=k.premultiplyAlpha,this.flipY=k.flipY,this.unpackAlignment=k.unpackAlignment,this.encoding=k.encoding,this.userData=JSON.parse(JSON.stringify(k.userData)),this};mb.prototype.toJSON=function(k){var f=void 0===k||"string"==typeof k;if(!f&&void 0!==k.textures[this.uuid])return k.textures[this.uuid];var a={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},
uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};if(void 0!==this.image){var b=this.image;if(void 0===b.uuid&&
(b.uuid=N()),!f&&void 0===k.images[b.uuid]){if(Array.isArray(b)){var c=[];for(var d=0,e=b.length;d<e;d++)b[d].isDataTexture?c.push(bb(b[d].image)):c.push(bb(b[d]))}else c=bb(b);k.images[b.uuid]={uuid:b.uuid,url:c}}a.image=b.uuid}return"{}"!==JSON.stringify(this.userData)&&(a.userData=this.userData),f||(k.textures[this.uuid]=a),a};mb.prototype.dispose=function(){this.dispatchEvent({type:"dispose"})};mb.prototype.transformUv=function(k){if(300!==this.mapping)return k;if(k.applyMatrix3(this.matrix),
0>k.x||1<k.x)switch(this.wrapS){case 1E3:k.x-=Math.floor(k.x);break;case 1001:k.x=0>k.x?0:1;break;case 1002:1===Math.abs(Math.floor(k.x)%2)?k.x=Math.ceil(k.x)-k.x:k.x-=Math.floor(k.x)}if(0>k.y||1<k.y)switch(this.wrapT){case 1E3:k.y-=Math.floor(k.y);break;case 1001:k.y=0>k.y?0:1;break;case 1002:1===Math.abs(Math.floor(k.y)%2)?k.y=Math.ceil(k.y)-k.y:k.y-=Math.floor(k.y)}return this.flipY&&(k.y=1-k.y),k};$jscomp.global.Object.defineProperties(mb.prototype,{needsUpdate:{configurable:!0,enumerable:!0,
set:function(k){!0===k&&this.version++}}});mb.DEFAULT_IMAGE=void 0;mb.DEFAULT_MAPPING=300;mb.prototype.isTexture=!0;var za=function(k,f,a,b){this.x=void 0===k?0:k;this.y=void 0===f?0:f;this.z=void 0===a?0:a;this.w=void 0===b?1:b};za.prototype.set=function(k,f,a,b){return this.x=k,this.y=f,this.z=a,this.w=b,this};za.prototype.setScalar=function(k){return this.x=k,this.y=k,this.z=k,this.w=k,this};za.prototype.setX=function(k){return this.x=k,this};za.prototype.setY=function(k){return this.y=k,this};
za.prototype.setZ=function(k){return this.z=k,this};za.prototype.setW=function(k){return this.w=k,this};za.prototype.setComponent=function(k,f){switch(k){case 0:this.x=f;break;case 1:this.y=f;break;case 2:this.z=f;break;case 3:this.w=f;break;default:throw Error("index is out of range: "+k);}return this};za.prototype.getComponent=function(k){switch(k){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw Error("index is out of range: "+k);}};za.prototype.clone=
function(){return new this.constructor(this.x,this.y,this.z,this.w)};za.prototype.copy=function(k){return this.x=k.x,this.y=k.y,this.z=k.z,this.w=void 0!==k.w?k.w:1,this};za.prototype.add=function(k,f){return void 0!==f?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(k,f)):(this.x+=k.x,this.y+=k.y,this.z+=k.z,this.w+=k.w,this)};za.prototype.addScalar=function(k){return this.x+=k,this.y+=k,this.z+=k,this.w+=k,this};za.prototype.addVectors=
function(k,f){return this.x=k.x+f.x,this.y=k.y+f.y,this.z=k.z+f.z,this.w=k.w+f.w,this};za.prototype.addScaledVector=function(k,f){return this.x+=k.x*f,this.y+=k.y*f,this.z+=k.z*f,this.w+=k.w*f,this};za.prototype.sub=function(k,f){return void 0!==f?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(k,f)):(this.x-=k.x,this.y-=k.y,this.z-=k.z,this.w-=k.w,this)};za.prototype.subScalar=function(k){return this.x-=k,this.y-=k,this.z-=k,
this.w-=k,this};za.prototype.subVectors=function(k,f){return this.x=k.x-f.x,this.y=k.y-f.y,this.z=k.z-f.z,this.w=k.w-f.w,this};za.prototype.multiply=function(k){return this.x*=k.x,this.y*=k.y,this.z*=k.z,this.w*=k.w,this};za.prototype.multiplyScalar=function(k){return this.x*=k,this.y*=k,this.z*=k,this.w*=k,this};za.prototype.applyMatrix4=function(k){var f=this.x,a=this.y,b=this.z,c=this.w;k=k.elements;return this.x=k[0]*f+k[4]*a+k[8]*b+k[12]*c,this.y=k[1]*f+k[5]*a+k[9]*b+k[13]*c,this.z=k[2]*f+k[6]*
a+k[10]*b+k[14]*c,this.w=k[3]*f+k[7]*a+k[11]*b+k[15]*c,this};za.prototype.divideScalar=function(k){return this.multiplyScalar(1/k)};za.prototype.setAxisAngleFromQuaternion=function(k){this.w=2*Math.acos(k.w);var f=Math.sqrt(1-k.w*k.w);return 1E-4>f?(this.x=1,this.y=0,this.z=0):(this.x=k.x/f,this.y=k.y/f,this.z=k.z/f),this};za.prototype.setAxisAngleFromRotationMatrix=function(k){var f,a,b;var c=k.elements;var d=c[0],e=c[4],g=c[8],h=c[1],m=c[5];k=c[9];var n=c[2],q=c[6],t=c[10];if(.01>Math.abs(e-h)&&
.01>Math.abs(g-n)&&.01>Math.abs(k-q)){if(.1>Math.abs(e+h)&&.1>Math.abs(g+n)&&.1>Math.abs(k+q)&&.1>Math.abs(d+m+t-3))return this.set(1,0,0,0),this;c=Math.PI;d=(d+1)/2;m=(m+1)/2;t=(t+1)/2;e=(e+h)/4;g=(g+n)/4;var r=(k+q)/4;return d>m&&d>t?.01>d?(f=0,a=.707106781,b=.707106781):(f=Math.sqrt(d),a=e/f,b=g/f):m>t?.01>m?(f=.707106781,a=0,b=.707106781):(a=Math.sqrt(m),f=e/a,b=r/a):.01>t?(f=.707106781,a=.707106781,b=0):(b=Math.sqrt(t),f=g/b,a=r/b),this.set(f,a,b,c),this}f=Math.sqrt((q-k)*(q-k)+(g-n)*(g-n)+(h-
e)*(h-e));return.001>Math.abs(f)&&(f=1),this.x=(q-k)/f,this.y=(g-n)/f,this.z=(h-e)/f,this.w=Math.acos((d+m+t-1)/2),this};za.prototype.min=function(k){return this.x=Math.min(this.x,k.x),this.y=Math.min(this.y,k.y),this.z=Math.min(this.z,k.z),this.w=Math.min(this.w,k.w),this};za.prototype.max=function(k){return this.x=Math.max(this.x,k.x),this.y=Math.max(this.y,k.y),this.z=Math.max(this.z,k.z),this.w=Math.max(this.w,k.w),this};za.prototype.clamp=function(k,f){return this.x=Math.max(k.x,Math.min(f.x,
this.x)),this.y=Math.max(k.y,Math.min(f.y,this.y)),this.z=Math.max(k.z,Math.min(f.z,this.z)),this.w=Math.max(k.w,Math.min(f.w,this.w)),this};za.prototype.clampScalar=function(k,f){return this.x=Math.max(k,Math.min(f,this.x)),this.y=Math.max(k,Math.min(f,this.y)),this.z=Math.max(k,Math.min(f,this.z)),this.w=Math.max(k,Math.min(f,this.w)),this};za.prototype.clampLength=function(k,f){var a=this.length();return this.divideScalar(a||1).multiplyScalar(Math.max(k,Math.min(f,a)))};za.prototype.floor=function(){return this.x=
Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this};za.prototype.ceil=function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this};za.prototype.round=function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this};za.prototype.roundToZero=function(){return this.x=0>this.x?Math.ceil(this.x):Math.floor(this.x),this.y=0>this.y?
Math.ceil(this.y):Math.floor(this.y),this.z=0>this.z?Math.ceil(this.z):Math.floor(this.z),this.w=0>this.w?Math.ceil(this.w):Math.floor(this.w),this};za.prototype.negate=function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this};za.prototype.dot=function(k){return this.x*k.x+this.y*k.y+this.z*k.z+this.w*k.w};za.prototype.lengthSq=function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w};za.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+
this.z*this.z+this.w*this.w)};za.prototype.manhattanLength=function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)};za.prototype.normalize=function(){return this.divideScalar(this.length()||1)};za.prototype.setLength=function(k){return this.normalize().multiplyScalar(k)};za.prototype.lerp=function(k,f){return this.x+=(k.x-this.x)*f,this.y+=(k.y-this.y)*f,this.z+=(k.z-this.z)*f,this.w+=(k.w-this.w)*f,this};za.prototype.lerpVectors=function(k,f,a){return this.x=k.x+(f.x-
k.x)*a,this.y=k.y+(f.y-k.y)*a,this.z=k.z+(f.z-k.z)*a,this.w=k.w+(f.w-k.w)*a,this};za.prototype.equals=function(k){return k.x===this.x&&k.y===this.y&&k.z===this.z&&k.w===this.w};za.prototype.fromArray=function(k,f){f=void 0===f?0:f;return this.x=k[f],this.y=k[f+1],this.z=k[f+2],this.w=k[f+3],this};za.prototype.toArray=function(k,f){k=void 0===k?[]:k;f=void 0===f?0:f;return k[f]=this.x,k[f+1]=this.y,k[f+2]=this.z,k[f+3]=this.w,k};za.prototype.fromBufferAttribute=function(k,f,a){return void 0!==a&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),
this.x=k.getX(f),this.y=k.getY(f),this.z=k.getZ(f),this.w=k.getW(f),this};za.prototype.random=function(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this};za.prototype[Symbol.iterator]=function f(){var a=this;return $jscomp.generator.createGenerator(f,function(b){switch(b.nextAddress){case 1:return b.yield(a.x,2);case 2:return b.yield(a.y,3);case 3:return b.yield(a.z,4);case 4:return b.yield(a.w,5);case 5:b.jumpToEnd()}})};$jscomp.global.Object.defineProperties(za.prototype,
{width:{configurable:!0,enumerable:!0,get:function(){return this.z},set:function(f){this.z=f}},height:{configurable:!0,enumerable:!0,get:function(){return this.w},set:function(f){this.w=f}}});za.prototype.isVector4=!0;var Rb=function(f,a,b){b=void 0===b?{}:b;this.width=f;this.height=a;this.depth=1;this.scissor=new za(0,0,f,a);this.scissorTest=!1;this.viewport=new za(0,0,f,a);this.texture=new mb(void 0,b.mapping,b.wrapS,b.wrapT,b.magFilter,b.minFilter,b.format,b.type,b.anisotropy,b.encoding);this.texture.isRenderTargetTexture=
!0;this.texture.image={width:f,height:a,depth:1};this.texture.generateMipmaps=void 0!==b.generateMipmaps&&b.generateMipmaps;this.texture.internalFormat=void 0!==b.internalFormat?b.internalFormat:null;this.texture.minFilter=void 0!==b.minFilter?b.minFilter:1006;this.depthBuffer=void 0===b.depthBuffer||b.depthBuffer;this.stencilBuffer=void 0!==b.stencilBuffer&&b.stencilBuffer;this.depthTexture=void 0!==b.depthTexture?b.depthTexture:null;return this};$jscomp.inherits(Rb,Jc);Rb.prototype.setTexture=function(f){f.image=
{width:this.width,height:this.height,depth:this.depth};this.texture=f};Rb.prototype.setSize=function(f,a,b){b=void 0===b?1:b;this.width===f&&this.height===a&&this.depth===b||(this.width=f,this.height=a,this.depth=b,this.texture.image.width=f,this.texture.image.height=a,this.texture.image.depth=b,this.dispose());this.viewport.set(0,0,f,a);this.scissor.set(0,0,f,a)};Rb.prototype.clone=function(){return(new this.constructor).copy(this)};Rb.prototype.copy=function(f){return this.width=f.width,this.height=
f.height,this.depth=f.depth,this.viewport.copy(f.viewport),this.texture=f.texture.clone(),this.texture.image=Object.assign({},this.texture.image),this.depthBuffer=f.depthBuffer,this.stencilBuffer=f.stencilBuffer,this.depthTexture=f.depthTexture,this};Rb.prototype.dispose=function(){this.dispatchEvent({type:"dispose"})};Rb.prototype.isWebGLRenderTarget=!0;var bg=function(f,a,b){f=Rb.call(this,f,a)||this;a=f.texture;f.texture=[];for(var c=0;c<b;c++)f.texture[c]=a.clone();return f};$jscomp.inherits(bg,
Rb);bg.prototype.setSize=function(f,a,b){b=void 0===b?1:b;if(this.width!==f||this.height!==a||this.depth!==b){this.width=f;this.height=a;this.depth=b;for(var c=0,d=this.texture.length;c<d;c++)this.texture[c].image.width=f,this.texture[c].image.height=a,this.texture[c].image.depth=b;this.dispose()}return this.viewport.set(0,0,f,a),this.scissor.set(0,0,f,a),this};bg.prototype.copy=function(f){this.dispose();this.width=f.width;this.height=f.height;this.depth=f.depth;this.viewport.set(0,0,this.width,
this.height);this.scissor.set(0,0,this.width,this.height);this.depthBuffer=f.depthBuffer;this.stencilBuffer=f.stencilBuffer;this.depthTexture=f.depthTexture;for(var a=this.texture.length=0,b=f.texture.length;a<b;a++)this.texture[a]=f.texture[a].clone();return this};bg.prototype.isWebGLMultipleRenderTargets=!0;var Sf=function(f,a,b){f=Rb.call(this,f,a,b)||this;f.samples=4;return f};$jscomp.inherits(Sf,Rb);Sf.prototype.copy=function(f){return Rb.prototype.copy.call(this,f),this.samples=f.samples,this};
Sf.prototype.isWebGLMultisampleRenderTarget=!0;var Sa=function(f,a,b,c){this._x=void 0===f?0:f;this._y=void 0===a?0:a;this._z=void 0===b?0:b;this._w=void 0===c?1:c};Sa.slerp=function(f,a,b,c){return console.warn("THREE.Quaternion: Static .slerp() has been deprecated. Use qm.slerpQuaternions( qa, qb, t ) instead."),b.slerpQuaternions(f,a,c)};Sa.slerpFlat=function(f,a,b,c,d,e,g){var h=b[c+0],m=b[c+1],n=b[c+2];b=b[c+3];c=d[e+0];var q=d[e+1],t=d[e+2];d=d[e+3];if(0===g)return f[a+0]=h,f[a+1]=m,f[a+2]=
n,void(f[a+3]=b);if(1===g)return f[a+0]=c,f[a+1]=q,f[a+2]=t,void(f[a+3]=d);if(b!==d||h!==c||m!==q||n!==t){e=1-g;var r=h*c+m*q+n*t+b*d,u=0<=r?1:-1,A=1-r*r;A>Number.EPSILON&&(A=Math.sqrt(A),r=Math.atan2(A,r*u),e=Math.sin(e*r)/A,g=Math.sin(g*r)/A);u*=g;if(h=h*e+c*u,m=m*e+q*u,n=n*e+t*u,b=b*e+d*u,e===1-g)g=1/Math.sqrt(h*h+m*m+n*n+b*b),h*=g,m*=g,n*=g,b*=g}f[a]=h;f[a+1]=m;f[a+2]=n;f[a+3]=b};Sa.multiplyQuaternionsFlat=function(f,a,b,c,d,e){var g=b[c],h=b[c+1],m=b[c+2];b=b[c+3];c=d[e];var n=d[e+1],q=d[e+2];
d=d[e+3];return f[a]=g*d+b*c+h*q-m*n,f[a+1]=h*d+b*n+m*c-g*q,f[a+2]=m*d+b*q+g*n-h*c,f[a+3]=b*d-g*c-h*n-m*q,f};Sa.prototype.set=function(f,a,b,c){return this._x=f,this._y=a,this._z=b,this._w=c,this._onChangeCallback(),this};Sa.prototype.clone=function(){return new this.constructor(this._x,this._y,this._z,this._w)};Sa.prototype.copy=function(f){return this._x=f.x,this._y=f.y,this._z=f.z,this._w=f.w,this._onChangeCallback(),this};Sa.prototype.setFromEuler=function(f,a){if(!f||!f.isEuler)throw Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");
var b=f._x,c=f._y,d=f._z;f=f._order;var e=Math.cos,g=Math.sin,h=e(b/2),m=e(c/2);e=e(d/2);b=g(b/2);c=g(c/2);d=g(d/2);switch(f){case "XYZ":this._x=b*m*e+h*c*d;this._y=h*c*e-b*m*d;this._z=h*m*d+b*c*e;this._w=h*m*e-b*c*d;break;case "YXZ":this._x=b*m*e+h*c*d;this._y=h*c*e-b*m*d;this._z=h*m*d-b*c*e;this._w=h*m*e+b*c*d;break;case "ZXY":this._x=b*m*e-h*c*d;this._y=h*c*e+b*m*d;this._z=h*m*d+b*c*e;this._w=h*m*e-b*c*d;break;case "ZYX":this._x=b*m*e-h*c*d;this._y=h*c*e+b*m*d;this._z=h*m*d-b*c*e;this._w=h*m*e+
b*c*d;break;case "YZX":this._x=b*m*e+h*c*d;this._y=h*c*e+b*m*d;this._z=h*m*d-b*c*e;this._w=h*m*e-b*c*d;break;case "XZY":this._x=b*m*e-h*c*d;this._y=h*c*e-b*m*d;this._z=h*m*d+b*c*e;this._w=h*m*e+b*c*d;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+f)}return!1!==a&&this._onChangeCallback(),this};Sa.prototype.setFromAxisAngle=function(f,a){a/=2;var b=Math.sin(a);return this._x=f.x*b,this._y=f.y*b,this._z=f.z*b,this._w=Math.cos(a),this._onChangeCallback(),
this};Sa.prototype.setFromRotationMatrix=function(f){var a=f.elements,b=a[0];f=a[4];var c=a[8],d=a[1],e=a[5],g=a[9],h=a[2],m=a[6];a=a[10];var n=b+e+a;0<n?(b=.5/Math.sqrt(n+1),this._w=.25/b,this._x=(m-g)*b,this._y=(c-h)*b,this._z=(d-f)*b):b>e&&b>a?(b=2*Math.sqrt(1+b-e-a),this._w=(m-g)/b,this._x=.25*b,this._y=(f+d)/b,this._z=(c+h)/b):e>a?(b=2*Math.sqrt(1+e-b-a),this._w=(c-h)/b,this._x=(f+d)/b,this._y=.25*b,this._z=(g+m)/b):(b=2*Math.sqrt(1+a-b-e),this._w=(d-f)/b,this._x=(c+h)/b,this._y=(g+m)/b,this._z=
.25*b);return this._onChangeCallback(),this};Sa.prototype.setFromUnitVectors=function(f,a){var b=f.dot(a)+1;return b<Number.EPSILON?(b=0,Math.abs(f.x)>Math.abs(f.z)?(this._x=-f.y,this._y=f.x,this._z=0,this._w=b):(this._x=0,this._y=-f.z,this._z=f.y,this._w=b)):(this._x=f.y*a.z-f.z*a.y,this._y=f.z*a.x-f.x*a.z,this._z=f.x*a.y-f.y*a.x,this._w=b),this.normalize()};Sa.prototype.angleTo=function(f){return 2*Math.acos(Math.abs(R(this.dot(f),-1,1)))};Sa.prototype.rotateTowards=function(f,a){var b=this.angleTo(f);
return 0===b?this:(this.slerp(f,Math.min(1,a/b)),this)};Sa.prototype.identity=function(){return this.set(0,0,0,1)};Sa.prototype.invert=function(){return this.conjugate()};Sa.prototype.conjugate=function(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this};Sa.prototype.dot=function(f){return this._x*f._x+this._y*f._y+this._z*f._z+this._w*f._w};Sa.prototype.lengthSq=function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w};Sa.prototype.length=function(){return Math.sqrt(this._x*
this._x+this._y*this._y+this._z*this._z+this._w*this._w)};Sa.prototype.normalize=function(){var f=this.length();return 0===f?(this._x=0,this._y=0,this._z=0,this._w=1):(f=1/f,this._x*=f,this._y*=f,this._z*=f,this._w*=f),this._onChangeCallback(),this};Sa.prototype.multiply=function(f,a){return void 0!==a?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(f,a)):this.multiplyQuaternions(this,f)};Sa.prototype.premultiply=
function(f){return this.multiplyQuaternions(f,this)};Sa.prototype.multiplyQuaternions=function(f,a){var b=f._x,c=f._y,d=f._z;f=f._w;var e=a._x,g=a._y,h=a._z;a=a._w;return this._x=b*a+f*e+c*h-d*g,this._y=c*a+f*g+d*e-b*h,this._z=d*a+f*h+b*g-c*e,this._w=f*a-b*e-c*g-d*h,this._onChangeCallback(),this};Sa.prototype.slerp=function(f,a){if(0===a)return this;if(1===a)return this.copy(f);var b=this._x,c=this._y,d=this._z,e=this._w,g=e*f._w+b*f._x+c*f._y+d*f._z;if(0>g?(this._w=-f._w,this._x=-f._x,this._y=-f._y,
this._z=-f._z,g=-g):this.copy(f),1<=g)return this._w=e,this._x=b,this._y=c,this._z=d,this;f=1-g*g;if(f<=Number.EPSILON)return g=1-a,this._w=g*e+a*this._w,this._x=g*b+a*this._x,this._y=g*c+a*this._y,this._z=g*d+a*this._z,this.normalize(),this._onChangeCallback(),this;f=Math.sqrt(f);var h=Math.atan2(f,g);g=Math.sin((1-a)*h)/f;a=Math.sin(a*h)/f;return this._w=e*g+this._w*a,this._x=b*g+this._x*a,this._y=c*g+this._y*a,this._z=d*g+this._z*a,this._onChangeCallback(),this};Sa.prototype.slerpQuaternions=function(f,
a,b){this.copy(f).slerp(a,b)};Sa.prototype.random=function(){var f=Math.random(),a=Math.sqrt(1-f);f=Math.sqrt(f);var b=2*Math.PI*Math.random(),c=2*Math.PI*Math.random();return this.set(a*Math.cos(b),f*Math.sin(c),f*Math.cos(c),a*Math.sin(b))};Sa.prototype.equals=function(f){return f._x===this._x&&f._y===this._y&&f._z===this._z&&f._w===this._w};Sa.prototype.fromArray=function(f,a){a=void 0===a?0:a;return this._x=f[a],this._y=f[a+1],this._z=f[a+2],this._w=f[a+3],this._onChangeCallback(),this};Sa.prototype.toArray=
function(f,a){f=void 0===f?[]:f;a=void 0===a?0:a;return f[a]=this._x,f[a+1]=this._y,f[a+2]=this._z,f[a+3]=this._w,f};Sa.prototype.fromBufferAttribute=function(f,a){return this._x=f.getX(a),this._y=f.getY(a),this._z=f.getZ(a),this._w=f.getW(a),this};Sa.prototype._onChange=function(f){return this._onChangeCallback=f,this};Sa.prototype._onChangeCallback=function(){};$jscomp.global.Object.defineProperties(Sa.prototype,{x:{configurable:!0,enumerable:!0,get:function(){return this._x},set:function(f){this._x=
f;this._onChangeCallback()}},y:{configurable:!0,enumerable:!0,get:function(){return this._y},set:function(f){this._y=f;this._onChangeCallback()}},z:{configurable:!0,enumerable:!0,get:function(){return this._z},set:function(f){this._z=f;this._onChangeCallback()}},w:{configurable:!0,enumerable:!0,get:function(){return this._w},set:function(f){this._w=f;this._onChangeCallback()}}});Sa.prototype.isQuaternion=!0;var B=function(f,a,b){this.x=void 0===f?0:f;this.y=void 0===a?0:a;this.z=void 0===b?0:b};B.prototype.set=
function(f,a,b){return void 0===b&&(b=this.z),this.x=f,this.y=a,this.z=b,this};B.prototype.setScalar=function(f){return this.x=f,this.y=f,this.z=f,this};B.prototype.setX=function(f){return this.x=f,this};B.prototype.setY=function(f){return this.y=f,this};B.prototype.setZ=function(f){return this.z=f,this};B.prototype.setComponent=function(f,a){switch(f){case 0:this.x=a;break;case 1:this.y=a;break;case 2:this.z=a;break;default:throw Error("index is out of range: "+f);}return this};B.prototype.getComponent=
function(f){switch(f){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw Error("index is out of range: "+f);}};B.prototype.clone=function(){return new this.constructor(this.x,this.y,this.z)};B.prototype.copy=function(f){return this.x=f.x,this.y=f.y,this.z=f.z,this};B.prototype.add=function(f,a){return void 0!==a?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(f,a)):(this.x+=f.x,this.y+=f.y,this.z+=f.z,
this)};B.prototype.addScalar=function(f){return this.x+=f,this.y+=f,this.z+=f,this};B.prototype.addVectors=function(f,a){return this.x=f.x+a.x,this.y=f.y+a.y,this.z=f.z+a.z,this};B.prototype.addScaledVector=function(f,a){return this.x+=f.x*a,this.y+=f.y*a,this.z+=f.z*a,this};B.prototype.sub=function(f,a){return void 0!==a?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(f,a)):(this.x-=f.x,this.y-=f.y,this.z-=f.z,this)};B.prototype.subScalar=
function(f){return this.x-=f,this.y-=f,this.z-=f,this};B.prototype.subVectors=function(f,a){return this.x=f.x-a.x,this.y=f.y-a.y,this.z=f.z-a.z,this};B.prototype.multiply=function(f,a){return void 0!==a?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(f,a)):(this.x*=f.x,this.y*=f.y,this.z*=f.z,this)};B.prototype.multiplyScalar=function(f){return this.x*=f,this.y*=f,this.z*=f,this};B.prototype.multiplyVectors=function(f,
a){return this.x=f.x*a.x,this.y=f.y*a.y,this.z=f.z*a.z,this};B.prototype.applyEuler=function(f){return f&&f.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(ek.setFromEuler(f))};B.prototype.applyAxisAngle=function(f,a){return this.applyQuaternion(ek.setFromAxisAngle(f,a))};B.prototype.applyMatrix3=function(f){var a=this.x,b=this.y,c=this.z;f=f.elements;return this.x=f[0]*a+f[3]*b+f[6]*c,this.y=f[1]*a+f[4]*b+
f[7]*c,this.z=f[2]*a+f[5]*b+f[8]*c,this};B.prototype.applyNormalMatrix=function(f){return this.applyMatrix3(f).normalize()};B.prototype.applyMatrix4=function(f){var a=this.x,b=this.y,c=this.z;f=f.elements;var d=1/(f[3]*a+f[7]*b+f[11]*c+f[15]);return this.x=(f[0]*a+f[4]*b+f[8]*c+f[12])*d,this.y=(f[1]*a+f[5]*b+f[9]*c+f[13])*d,this.z=(f[2]*a+f[6]*b+f[10]*c+f[14])*d,this};B.prototype.applyQuaternion=function(f){var a=this.x,b=this.y,c=this.z,d=f.x,e=f.y,g=f.z;f=f.w;var h=f*a+e*c-g*b,m=f*b+g*a-d*c,n=f*
c+d*b-e*a;a=-d*a-e*b-g*c;return this.x=h*f+a*-d+m*-g-n*-e,this.y=m*f+a*-e+n*-d-h*-g,this.z=n*f+a*-g+h*-e-m*-d,this};B.prototype.project=function(f){return this.applyMatrix4(f.matrixWorldInverse).applyMatrix4(f.projectionMatrix)};B.prototype.unproject=function(f){return this.applyMatrix4(f.projectionMatrixInverse).applyMatrix4(f.matrixWorld)};B.prototype.transformDirection=function(f){var a=this.x,b=this.y,c=this.z;f=f.elements;return this.x=f[0]*a+f[4]*b+f[8]*c,this.y=f[1]*a+f[5]*b+f[9]*c,this.z=
f[2]*a+f[6]*b+f[10]*c,this.normalize()};B.prototype.divide=function(f){return this.x/=f.x,this.y/=f.y,this.z/=f.z,this};B.prototype.divideScalar=function(f){return this.multiplyScalar(1/f)};B.prototype.min=function(f){return this.x=Math.min(this.x,f.x),this.y=Math.min(this.y,f.y),this.z=Math.min(this.z,f.z),this};B.prototype.max=function(f){return this.x=Math.max(this.x,f.x),this.y=Math.max(this.y,f.y),this.z=Math.max(this.z,f.z),this};B.prototype.clamp=function(f,a){return this.x=Math.max(f.x,Math.min(a.x,
this.x)),this.y=Math.max(f.y,Math.min(a.y,this.y)),this.z=Math.max(f.z,Math.min(a.z,this.z)),this};B.prototype.clampScalar=function(f,a){return this.x=Math.max(f,Math.min(a,this.x)),this.y=Math.max(f,Math.min(a,this.y)),this.z=Math.max(f,Math.min(a,this.z)),this};B.prototype.clampLength=function(f,a){var b=this.length();return this.divideScalar(b||1).multiplyScalar(Math.max(f,Math.min(a,b)))};B.prototype.floor=function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),
this};B.prototype.ceil=function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this};B.prototype.round=function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this};B.prototype.roundToZero=function(){return this.x=0>this.x?Math.ceil(this.x):Math.floor(this.x),this.y=0>this.y?Math.ceil(this.y):Math.floor(this.y),this.z=0>this.z?Math.ceil(this.z):Math.floor(this.z),this};B.prototype.negate=function(){return this.x=-this.x,
this.y=-this.y,this.z=-this.z,this};B.prototype.dot=function(f){return this.x*f.x+this.y*f.y+this.z*f.z};B.prototype.lengthSq=function(){return this.x*this.x+this.y*this.y+this.z*this.z};B.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)};B.prototype.manhattanLength=function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)};B.prototype.normalize=function(){return this.divideScalar(this.length()||1)};B.prototype.setLength=function(f){return this.normalize().multiplyScalar(f)};
B.prototype.lerp=function(f,a){return this.x+=(f.x-this.x)*a,this.y+=(f.y-this.y)*a,this.z+=(f.z-this.z)*a,this};B.prototype.lerpVectors=function(f,a,b){return this.x=f.x+(a.x-f.x)*b,this.y=f.y+(a.y-f.y)*b,this.z=f.z+(a.z-f.z)*b,this};B.prototype.cross=function(f,a){return void 0!==a?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(f,a)):this.crossVectors(this,f)};B.prototype.crossVectors=function(f,a){var b=f.x,c=f.y;f=f.z;
var d=a.x,e=a.y;a=a.z;return this.x=c*a-f*e,this.y=f*d-b*a,this.z=b*e-c*d,this};B.prototype.projectOnVector=function(f){var a=f.lengthSq();if(0===a)return this.set(0,0,0);a=f.dot(this)/a;return this.copy(f).multiplyScalar(a)};B.prototype.projectOnPlane=function(f){return vi.copy(this).projectOnVector(f),this.sub(vi)};B.prototype.reflect=function(f){return this.sub(vi.copy(f).multiplyScalar(2*this.dot(f)))};B.prototype.angleTo=function(f){var a=Math.sqrt(this.lengthSq()*f.lengthSq());if(0===a)return Math.PI/
2;f=this.dot(f)/a;return Math.acos(R(f,-1,1))};B.prototype.distanceTo=function(f){return Math.sqrt(this.distanceToSquared(f))};B.prototype.distanceToSquared=function(f){var a=this.x-f.x,b=this.y-f.y;f=this.z-f.z;return a*a+b*b+f*f};B.prototype.manhattanDistanceTo=function(f){return Math.abs(this.x-f.x)+Math.abs(this.y-f.y)+Math.abs(this.z-f.z)};B.prototype.setFromSpherical=function(f){return this.setFromSphericalCoords(f.radius,f.phi,f.theta)};B.prototype.setFromSphericalCoords=function(f,a,b){var c=
Math.sin(a)*f;return this.x=c*Math.sin(b),this.y=Math.cos(a)*f,this.z=c*Math.cos(b),this};B.prototype.setFromCylindrical=function(f){return this.setFromCylindricalCoords(f.radius,f.theta,f.y)};B.prototype.setFromCylindricalCoords=function(f,a,b){return this.x=f*Math.sin(a),this.y=b,this.z=f*Math.cos(a),this};B.prototype.setFromMatrixPosition=function(f){f=f.elements;return this.x=f[12],this.y=f[13],this.z=f[14],this};B.prototype.setFromMatrixScale=function(f){var a=this.setFromMatrixColumn(f,0).length(),
b=this.setFromMatrixColumn(f,1).length();f=this.setFromMatrixColumn(f,2).length();return this.x=a,this.y=b,this.z=f,this};B.prototype.setFromMatrixColumn=function(f,a){return this.fromArray(f.elements,4*a)};B.prototype.setFromMatrix3Column=function(f,a){return this.fromArray(f.elements,3*a)};B.prototype.equals=function(f){return f.x===this.x&&f.y===this.y&&f.z===this.z};B.prototype.fromArray=function(f,a){a=void 0===a?0:a;return this.x=f[a],this.y=f[a+1],this.z=f[a+2],this};B.prototype.toArray=function(f,
a){f=void 0===f?[]:f;a=void 0===a?0:a;return f[a]=this.x,f[a+1]=this.y,f[a+2]=this.z,f};B.prototype.fromBufferAttribute=function(f,a,b){return void 0!==b&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=f.getX(a),this.y=f.getY(a),this.z=f.getZ(a),this};B.prototype.random=function(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this};B.prototype.randomDirection=function(){var f=2*(Math.random()-.5),a=Math.random()*Math.PI*2,b=Math.sqrt(1-
Math.pow(f,2));return this.x=b*Math.cos(a),this.y=b*Math.sin(a),this.z=f,this};B.prototype[Symbol.iterator]=function a(){var b=this;return $jscomp.generator.createGenerator(a,function(c){switch(c.nextAddress){case 1:return c.yield(b.x,2);case 2:return c.yield(b.y,3);case 3:return c.yield(b.z,4);case 4:c.jumpToEnd()}})};B.prototype.isVector3=!0;var vi=new B,ek=new Sa,ab=function(a,b){a=void 0===a?new B(1/0,1/0,1/0):a;b=void 0===b?new B(-1/0,-1/0,-1/0):b;this.min=a;this.max=b};ab.prototype.set=function(a,
b){return this.min.copy(a),this.max.copy(b),this};ab.prototype.setFromArray=function(a){for(var b=1/0,c=1/0,d=1/0,e=-1/0,g=-1/0,h=-1/0,m=0,n=a.length;m<n;m+=3){var q=a[m],t=a[m+1],r=a[m+2];q<b&&(b=q);t<c&&(c=t);r<d&&(d=r);q>e&&(e=q);t>g&&(g=t);r>h&&(h=r)}return this.min.set(b,c,d),this.max.set(e,g,h),this};ab.prototype.setFromBufferAttribute=function(a){for(var b=1/0,c=1/0,d=1/0,e=-1/0,g=-1/0,h=-1/0,m=0,n=a.count;m<n;m++){var q=a.getX(m),t=a.getY(m),r=a.getZ(m);q<b&&(b=q);t<c&&(c=t);r<d&&(d=r);q>
e&&(e=q);t>g&&(g=t);r>h&&(h=r)}return this.min.set(b,c,d),this.max.set(e,g,h),this};ab.prototype.setFromPoints=function(a){this.makeEmpty();for(var b=0,c=a.length;b<c;b++)this.expandByPoint(a[b]);return this};ab.prototype.setFromCenterAndSize=function(a,b){b=cg.copy(b).multiplyScalar(.5);return this.min.copy(a).sub(b),this.max.copy(a).add(b),this};ab.prototype.setFromObject=function(a){return this.makeEmpty(),this.expandByObject(a)};ab.prototype.clone=function(){return(new this.constructor).copy(this)};
ab.prototype.copy=function(a){return this.min.copy(a.min),this.max.copy(a.max),this};ab.prototype.makeEmpty=function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this};ab.prototype.isEmpty=function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z};ab.prototype.getCenter=function(a){return this.isEmpty()?a.set(0,0,0):a.addVectors(this.min,this.max).multiplyScalar(.5)};ab.prototype.getSize=function(a){return this.isEmpty()?a.set(0,0,
0):a.subVectors(this.max,this.min)};ab.prototype.expandByPoint=function(a){return this.min.min(a),this.max.max(a),this};ab.prototype.expandByVector=function(a){return this.min.sub(a),this.max.add(a),this};ab.prototype.expandByScalar=function(a){return this.min.addScalar(-a),this.max.addScalar(a),this};ab.prototype.expandByObject=function(a){a.updateWorldMatrix(!1,!1);var b=a.geometry;void 0!==b&&(null===b.boundingBox&&b.computeBoundingBox(),wi.copy(b.boundingBox),wi.applyMatrix4(a.matrixWorld),this.union(wi));
a=a.children;b=0;for(var c=a.length;b<c;b++)this.expandByObject(a[b]);return this};ab.prototype.containsPoint=function(a){return!(a.x<this.min.x||a.x>this.max.x||a.y<this.min.y||a.y>this.max.y||a.z<this.min.z||a.z>this.max.z)};ab.prototype.containsBox=function(a){return this.min.x<=a.min.x&&a.max.x<=this.max.x&&this.min.y<=a.min.y&&a.max.y<=this.max.y&&this.min.z<=a.min.z&&a.max.z<=this.max.z};ab.prototype.getParameter=function(a,b){return b.set((a.x-this.min.x)/(this.max.x-this.min.x),(a.y-this.min.y)/
(this.max.y-this.min.y),(a.z-this.min.z)/(this.max.z-this.min.z))};ab.prototype.intersectsBox=function(a){return!(a.max.x<this.min.x||a.min.x>this.max.x||a.max.y<this.min.y||a.min.y>this.max.y||a.max.z<this.min.z||a.min.z>this.max.z)};ab.prototype.intersectsSphere=function(a){return this.clampPoint(a.center,cg),cg.distanceToSquared(a.center)<=a.radius*a.radius};ab.prototype.intersectsPlane=function(a){var b,c;return 0<a.normal.x?(b=a.normal.x*this.min.x,c=a.normal.x*this.max.x):(b=a.normal.x*this.max.x,
c=a.normal.x*this.min.x),0<a.normal.y?(b+=a.normal.y*this.min.y,c+=a.normal.y*this.max.y):(b+=a.normal.y*this.max.y,c+=a.normal.y*this.min.y),0<a.normal.z?(b+=a.normal.z*this.min.z,c+=a.normal.z*this.max.z):(b+=a.normal.z*this.max.z,c+=a.normal.z*this.min.z),b<=-a.constant&&c>=-a.constant};ab.prototype.intersectsTriangle=function(a){if(this.isEmpty())return!1;this.getCenter(dg);dh.subVectors(this.max,dg);cf.subVectors(a.a,dg);df.subVectors(a.b,dg);ef.subVectors(a.c,dg);Qd.subVectors(df,cf);Rd.subVectors(ef,
df);re.subVectors(cf,ef);a=[0,-Qd.z,Qd.y,0,-Rd.z,Rd.y,0,-re.z,re.y,Qd.z,0,-Qd.x,Rd.z,0,-Rd.x,re.z,0,-re.x,-Qd.y,Qd.x,0,-Rd.y,Rd.x,0,-re.y,re.x,0];return!!qb(a,cf,df,ef,dh)&&(a=[1,0,0,0,1,0,0,0,1],!!qb(a,cf,df,ef,dh)&&(eh.crossVectors(Qd,Rd),a=[eh.x,eh.y,eh.z],qb(a,cf,df,ef,dh)))};ab.prototype.clampPoint=function(a,b){return b.copy(a).clamp(this.min,this.max)};ab.prototype.distanceToPoint=function(a){return cg.copy(a).clamp(this.min,this.max).sub(a).length()};ab.prototype.getBoundingSphere=function(a){return this.getCenter(a.center),
a.radius=.5*this.getSize(cg).length(),a};ab.prototype.intersect=function(a){return this.min.max(a.min),this.max.min(a.max),this.isEmpty()&&this.makeEmpty(),this};ab.prototype.union=function(a){return this.min.min(a.min),this.max.max(a.max),this};ab.prototype.applyMatrix4=function(a){return this.isEmpty()||(pd[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(a),pd[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(a),pd[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(a),pd[3].set(this.min.x,
this.max.y,this.max.z).applyMatrix4(a),pd[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(a),pd[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(a),pd[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(a),pd[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(a),this.setFromPoints(pd)),this};ab.prototype.translate=function(a){return this.min.add(a),this.max.add(a),this};ab.prototype.equals=function(a){return a.min.equals(this.min)&&a.max.equals(this.max)};ab.prototype.isBox3=!0;var pd=
[new B,new B,new B,new B,new B,new B,new B,new B],cg=new B,wi=new ab,cf=new B,df=new B,ef=new B,Qd=new B,Rd=new B,re=new B,dg=new B,dh=new B,eh=new B,fe=new B,Ol=new ab,fk=new B,xi=new B,yi=new B,Fb=function(a,b){this.center=a=void 0===a?new B:a;this.radius=void 0===b?-1:b};Fb.prototype.set=function(a,b){return this.center.copy(a),this.radius=b,this};Fb.prototype.setFromPoints=function(a,b){var c=this.center;void 0!==b?c.copy(b):Ol.setFromPoints(a).getCenter(c);for(var d=b=0,e=a.length;d<e;d++)b=
Math.max(b,c.distanceToSquared(a[d]));return this.radius=Math.sqrt(b),this};Fb.prototype.copy=function(a){return this.center.copy(a.center),this.radius=a.radius,this};Fb.prototype.isEmpty=function(){return 0>this.radius};Fb.prototype.makeEmpty=function(){return this.center.set(0,0,0),this.radius=-1,this};Fb.prototype.containsPoint=function(a){return a.distanceToSquared(this.center)<=this.radius*this.radius};Fb.prototype.distanceToPoint=function(a){return a.distanceTo(this.center)-this.radius};Fb.prototype.intersectsSphere=
function(a){var b=this.radius+a.radius;return a.center.distanceToSquared(this.center)<=b*b};Fb.prototype.intersectsBox=function(a){return a.intersectsSphere(this)};Fb.prototype.intersectsPlane=function(a){return Math.abs(a.distanceToPoint(this.center))<=this.radius};Fb.prototype.clampPoint=function(a,b){var c=this.center.distanceToSquared(a);return b.copy(a),c>this.radius*this.radius&&(b.sub(this.center).normalize(),b.multiplyScalar(this.radius).add(this.center)),b};Fb.prototype.getBoundingBox=function(a){return this.isEmpty()?
(a.makeEmpty(),a):(a.set(this.center,this.center),a.expandByScalar(this.radius),a)};Fb.prototype.applyMatrix4=function(a){return this.center.applyMatrix4(a),this.radius*=a.getMaxScaleOnAxis(),this};Fb.prototype.translate=function(a){return this.center.add(a),this};Fb.prototype.expandByPoint=function(a){yi.subVectors(a,this.center);a=yi.lengthSq();if(a>this.radius*this.radius){a=Math.sqrt(a);var b=.5*(a-this.radius);this.center.add(yi.multiplyScalar(b/a));this.radius+=b}return this};Fb.prototype.union=
function(a){return xi.subVectors(a.center,this.center).normalize().multiplyScalar(a.radius),this.expandByPoint(fk.copy(a.center).add(xi)),this.expandByPoint(fk.copy(a.center).sub(xi)),this};Fb.prototype.equals=function(a){return a.center.equals(this.center)&&a.radius===this.radius};Fb.prototype.clone=function(){return(new this.constructor).copy(this)};var qd=new B,zi=new B,fh=new B,Sd=new B,Ai=new B,gh=new B,Bi=new B,Bb=function(a,b){a=void 0===a?new B:a;b=void 0===b?new B(0,0,-1):b;this.origin=a;
this.direction=b};Bb.prototype.set=function(a,b){return this.origin.copy(a),this.direction.copy(b),this};Bb.prototype.copy=function(a){return this.origin.copy(a.origin),this.direction.copy(a.direction),this};Bb.prototype.at=function(a,b){return b.copy(this.direction).multiplyScalar(a).add(this.origin)};Bb.prototype.lookAt=function(a){return this.direction.copy(a).sub(this.origin).normalize(),this};Bb.prototype.recast=function(a){return this.origin.copy(this.at(a,qd)),this};Bb.prototype.closestPointToPoint=
function(a,b){b.subVectors(a,this.origin);a=b.dot(this.direction);return 0>a?b.copy(this.origin):b.copy(this.direction).multiplyScalar(a).add(this.origin)};Bb.prototype.distanceToPoint=function(a){return Math.sqrt(this.distanceSqToPoint(a))};Bb.prototype.distanceSqToPoint=function(a){var b=qd.subVectors(a,this.origin).dot(this.direction);return 0>b?this.origin.distanceToSquared(a):(qd.copy(this.direction).multiplyScalar(b).add(this.origin),qd.distanceToSquared(a))};Bb.prototype.distanceSqToSegment=
function(a,b,c,d){zi.copy(a).add(b).multiplyScalar(.5);fh.copy(b).sub(a).normalize();Sd.copy(this.origin).sub(zi);var e=.5*a.distanceTo(b);a=-this.direction.dot(fh);b=Sd.dot(this.direction);var g=-Sd.dot(fh),h=Sd.lengthSq(),m=Math.abs(1-a*a),n,q,t;if(0<m)if(n=a*g-b,q=a*b-g,t=e*m,0<=n)if(q>=-t)if(q<=t){var r=1/m;n*=r;q*=r;r=n*(n+a*q+2*b)+q*(a*n+q+2*g)+h}else q=e,n=Math.max(0,-(a*q+b)),r=-n*n+q*(q+2*g)+h;else q=-e,n=Math.max(0,-(a*q+b)),r=-n*n+q*(q+2*g)+h;else q<=-t?(n=Math.max(0,-(-a*e+b)),q=0<n?-e:
Math.min(Math.max(-e,-g),e),r=-n*n+q*(q+2*g)+h):q<=t?(n=0,q=Math.min(Math.max(-e,-g),e),r=q*(q+2*g)+h):(n=Math.max(0,-(a*e+b)),q=0<n?e:Math.min(Math.max(-e,-g),e),r=-n*n+q*(q+2*g)+h);else q=0<a?-e:e,n=Math.max(0,-(a*q+b)),r=-n*n+q*(q+2*g)+h;return c&&c.copy(this.direction).multiplyScalar(n).add(this.origin),d&&d.copy(fh).multiplyScalar(q).add(zi),r};Bb.prototype.intersectSphere=function(a,b){qd.subVectors(a.center,this.origin);var c=qd.dot(this.direction),d=qd.dot(qd)-c*c;a=a.radius*a.radius;if(d>
a)return null;a=Math.sqrt(a-d);d=c-a;c+=a;return 0>d&&0>c?null:0>d?this.at(c,b):this.at(d,b)};Bb.prototype.intersectsSphere=function(a){return this.distanceSqToPoint(a.center)<=a.radius*a.radius};Bb.prototype.distanceToPlane=function(a){var b=a.normal.dot(this.direction);if(0===b)return 0===a.distanceToPoint(this.origin)?0:null;a=-(this.origin.dot(a.normal)+a.constant)/b;return 0<=a?a:null};Bb.prototype.intersectPlane=function(a,b){a=this.distanceToPlane(a);return null===a?null:this.at(a,b)};Bb.prototype.intersectsPlane=
function(a){var b=a.distanceToPoint(this.origin);return 0===b?!0:0>a.normal.dot(this.direction)*b};Bb.prototype.intersectBox=function(a,b){var c,d,e,g,h,m,n=1/this.direction.x,q=1/this.direction.y,t=1/this.direction.z,r=this.origin;return 0<=n?(c=(a.min.x-r.x)*n,d=(a.max.x-r.x)*n):(c=(a.max.x-r.x)*n,d=(a.min.x-r.x)*n),0<=q?(e=(a.min.y-r.y)*q,g=(a.max.y-r.y)*q):(e=(a.max.y-r.y)*q,g=(a.min.y-r.y)*q),c>g||e>d?null:((e>c||c!=c)&&(c=e),(g<d||d!=d)&&(d=g),0<=t?(h=(a.min.z-r.z)*t,m=(a.max.z-r.z)*t):(h=(a.max.z-
r.z)*t,m=(a.min.z-r.z)*t),c>m||h>d?null:((h>c||c!=c)&&(c=h),(m<d||d!=d)&&(d=m),0>d?null:this.at(0<=c?c:d,b)))};Bb.prototype.intersectsBox=function(a){return null!==this.intersectBox(a,qd)};Bb.prototype.intersectTriangle=function(a,b,c,d,e){Ai.subVectors(b,a);gh.subVectors(c,a);Bi.crossVectors(Ai,gh);b=this.direction.dot(Bi);if(0<b){if(d)return null;d=1}else{if(!(0>b))return null;d=-1;b=-b}Sd.subVectors(this.origin,a);a=d*this.direction.dot(gh.crossVectors(Sd,gh));if(0>a)return null;c=d*this.direction.dot(Ai.cross(Sd));
if(0>c||a+c>b)return null;a=-d*Sd.dot(Bi);return 0>a?null:this.at(a/b,e)};Bb.prototype.applyMatrix4=function(a){return this.origin.applyMatrix4(a),this.direction.transformDirection(a),this};Bb.prototype.equals=function(a){return a.origin.equals(this.origin)&&a.direction.equals(this.direction)};Bb.prototype.clone=function(){return(new this.constructor).copy(this)};var ua=function(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];0<arguments.length&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")};
ua.prototype.set=function(a,b,c,d,e,g,h,m,n,q,t,r,u,A,w,x){var C=this.elements;return C[0]=a,C[4]=b,C[8]=c,C[12]=d,C[1]=e,C[5]=g,C[9]=h,C[13]=m,C[2]=n,C[6]=q,C[10]=t,C[14]=r,C[3]=u,C[7]=A,C[11]=w,C[15]=x,this};ua.prototype.identity=function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this};ua.prototype.clone=function(){return(new ua).fromArray(this.elements)};ua.prototype.copy=function(a){var b=this.elements;a=a.elements;return b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],b[4]=a[4],b[5]=a[5],b[6]=
a[6],b[7]=a[7],b[8]=a[8],b[9]=a[9],b[10]=a[10],b[11]=a[11],b[12]=a[12],b[13]=a[13],b[14]=a[14],b[15]=a[15],this};ua.prototype.copyPosition=function(a){var b=this.elements;a=a.elements;return b[12]=a[12],b[13]=a[13],b[14]=a[14],this};ua.prototype.setFromMatrix3=function(a){a=a.elements;return this.set(a[0],a[3],a[6],0,a[1],a[4],a[7],0,a[2],a[5],a[8],0,0,0,0,1),this};ua.prototype.extractBasis=function(a,b,c){return a.setFromMatrixColumn(this,0),b.setFromMatrixColumn(this,1),c.setFromMatrixColumn(this,
2),this};ua.prototype.makeBasis=function(a,b,c){return this.set(a.x,b.x,c.x,0,a.y,b.y,c.y,0,a.z,b.z,c.z,0,0,0,0,1),this};ua.prototype.extractRotation=function(a){var b=this.elements,c=a.elements,d=1/ff.setFromMatrixColumn(a,0).length(),e=1/ff.setFromMatrixColumn(a,1).length();a=1/ff.setFromMatrixColumn(a,2).length();return b[0]=c[0]*d,b[1]=c[1]*d,b[2]=c[2]*d,b[3]=0,b[4]=c[4]*e,b[5]=c[5]*e,b[6]=c[6]*e,b[7]=0,b[8]=c[8]*a,b[9]=c[9]*a,b[10]=c[10]*a,b[11]=0,b[12]=0,b[13]=0,b[14]=0,b[15]=1,this};ua.prototype.makeRotationFromEuler=
function(a){a&&a.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var b=this.elements,c=a.x,d=a.y,e=a.z,g=Math.cos(c);c=Math.sin(c);var h=Math.cos(d);d=Math.sin(d);var m=Math.cos(e);e=Math.sin(e);if("XYZ"===a.order){a=g*m;var n=g*e,q=c*m,t=c*e;b[0]=h*m;b[4]=-h*e;b[8]=d;b[1]=n+q*d;b[5]=a-t*d;b[9]=-c*h;b[2]=t-a*d;b[6]=q+n*d;b[10]=g*h}else"YXZ"===a.order?(a=h*m,n=h*e,q=d*m,t=d*e,b[0]=a+t*c,b[4]=q*c-n,b[8]=g*d,b[1]=g*e,b[5]=
g*m,b[9]=-c,b[2]=n*c-q,b[6]=t+a*c,b[10]=g*h):"ZXY"===a.order?(a=h*m,n=h*e,q=d*m,t=d*e,b[0]=a-t*c,b[4]=-g*e,b[8]=q+n*c,b[1]=n+q*c,b[5]=g*m,b[9]=t-a*c,b[2]=-g*d,b[6]=c,b[10]=g*h):"ZYX"===a.order?(a=g*m,n=g*e,q=c*m,t=c*e,b[0]=h*m,b[4]=q*d-n,b[8]=a*d+t,b[1]=h*e,b[5]=t*d+a,b[9]=n*d-q,b[2]=-d,b[6]=c*h,b[10]=g*h):"YZX"===a.order?(a=g*h,n=g*d,q=c*h,t=c*d,b[0]=h*m,b[4]=t-a*e,b[8]=q*e+n,b[1]=e,b[5]=g*m,b[9]=-c*m,b[2]=-d*m,b[6]=n*e+q,b[10]=a-t*e):"XZY"===a.order&&(a=g*h,n=g*d,q=c*h,t=c*d,b[0]=h*m,b[4]=-e,b[8]=
d*m,b[1]=a*e+t,b[5]=g*m,b[9]=n*e-q,b[2]=q*e-n,b[6]=c*m,b[10]=t*e+a);return b[3]=0,b[7]=0,b[11]=0,b[12]=0,b[13]=0,b[14]=0,b[15]=1,this};ua.prototype.makeRotationFromQuaternion=function(a){return this.compose(Pl,a,Ql)};ua.prototype.lookAt=function(a,b,c){var d=this.elements;return tc.subVectors(a,b),0===tc.lengthSq()&&(tc.z=1),tc.normalize(),Td.crossVectors(c,tc),0===Td.lengthSq()&&(1===Math.abs(c.z)?tc.x+=1E-4:tc.z+=1E-4,tc.normalize(),Td.crossVectors(c,tc)),Td.normalize(),hh.crossVectors(tc,Td),d[0]=
Td.x,d[4]=hh.x,d[8]=tc.x,d[1]=Td.y,d[5]=hh.y,d[9]=tc.y,d[2]=Td.z,d[6]=hh.z,d[10]=tc.z,this};ua.prototype.multiply=function(a,b){return void 0!==b?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(a,b)):this.multiplyMatrices(this,a)};ua.prototype.premultiply=function(a){return this.multiplyMatrices(a,this)};ua.prototype.multiplyMatrices=function(a,b){var c=a.elements,d=b.elements;b=this.elements;a=c[0];var e=c[4],
g=c[8],h=c[12],m=c[1],n=c[5],q=c[9],t=c[13],r=c[2],u=c[6],A=c[10],w=c[14],x=c[3],C=c[7],G=c[11],I=c[15];c=d[0];var P=d[4],O=d[8],M=d[12],S=d[1],V=d[5],ba=d[9],Y=d[13],Z=d[2],Ha=d[6],ya=d[10],ja=d[14],Ja=d[3],Va=d[7],db=d[11];d=d[15];return b[0]=a*c+e*S+g*Z+h*Ja,b[4]=a*P+e*V+g*Ha+h*Va,b[8]=a*O+e*ba+g*ya+h*db,b[12]=a*M+e*Y+g*ja+h*d,b[1]=m*c+n*S+q*Z+t*Ja,b[5]=m*P+n*V+q*Ha+t*Va,b[9]=m*O+n*ba+q*ya+t*db,b[13]=m*M+n*Y+q*ja+t*d,b[2]=r*c+u*S+A*Z+w*Ja,b[6]=r*P+u*V+A*Ha+w*Va,b[10]=r*O+u*ba+A*ya+w*db,b[14]=r*
M+u*Y+A*ja+w*d,b[3]=x*c+C*S+G*Z+I*Ja,b[7]=x*P+C*V+G*Ha+I*Va,b[11]=x*O+C*ba+G*ya+I*db,b[15]=x*M+C*Y+G*ja+I*d,this};ua.prototype.multiplyScalar=function(a){var b=this.elements;return b[0]*=a,b[4]*=a,b[8]*=a,b[12]*=a,b[1]*=a,b[5]*=a,b[9]*=a,b[13]*=a,b[2]*=a,b[6]*=a,b[10]*=a,b[14]*=a,b[3]*=a,b[7]*=a,b[11]*=a,b[15]*=a,this};ua.prototype.determinant=function(){var a=this.elements,b=a[0],c=a[4],d=a[8],e=a[12],g=a[1],h=a[5],m=a[9],n=a[13],q=a[2],t=a[6],r=a[10],u=a[14];return a[3]*(+e*m*t-d*n*t-e*h*r+c*n*
r+d*h*u-c*m*u)+a[7]*(+b*m*u-b*n*r+e*g*r-d*g*u+d*n*q-e*m*q)+a[11]*(+b*n*t-b*h*u-e*g*t+c*g*u+e*h*q-c*n*q)+a[15]*(-d*h*q-b*m*t+b*h*r+d*g*t-c*g*r+c*m*q)};ua.prototype.transpose=function(){var a=this.elements,b;return b=a[1],a[1]=a[4],a[4]=b,b=a[2],a[2]=a[8],a[8]=b,b=a[6],a[6]=a[9],a[9]=b,b=a[3],a[3]=a[12],a[12]=b,b=a[7],a[7]=a[13],a[13]=b,b=a[11],a[11]=a[14],a[14]=b,this};ua.prototype.setPosition=function(a,b,c){var d=this.elements;return a.isVector3?(d[12]=a.x,d[13]=a.y,d[14]=a.z):(d[12]=a,d[13]=b,d[14]=
c),this};ua.prototype.invert=function(){var a=this.elements,b=a[0],c=a[1],d=a[2],e=a[3],g=a[4],h=a[5],m=a[6],n=a[7],q=a[8],t=a[9],r=a[10],u=a[11],A=a[12],w=a[13],x=a[14],C=a[15],G=t*x*n-w*r*n+w*m*u-h*x*u-t*m*C+h*r*C,I=A*r*n-q*x*n-A*m*u+g*x*u+q*m*C-g*r*C,P=q*w*n-A*t*n+A*h*u-g*w*u-q*h*C+g*t*C,O=A*t*m-q*w*m-A*h*r+g*w*r+q*h*x-g*t*x,M=b*G+c*I+d*P+e*O;if(0===M)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);M=1/M;return a[0]=G*M,a[1]=(w*r*e-t*x*e-w*d*u+c*x*u+t*d*C-c*r*C)*M,a[2]=(h*x*e-w*m*e+w*d*n-c*x*
n-h*d*C+c*m*C)*M,a[3]=(t*m*e-h*r*e-t*d*n+c*r*n+h*d*u-c*m*u)*M,a[4]=I*M,a[5]=(q*x*e-A*r*e+A*d*u-b*x*u-q*d*C+b*r*C)*M,a[6]=(A*m*e-g*x*e-A*d*n+b*x*n+g*d*C-b*m*C)*M,a[7]=(g*r*e-q*m*e+q*d*n-b*r*n-g*d*u+b*m*u)*M,a[8]=P*M,a[9]=(A*t*e-q*w*e-A*c*u+b*w*u+q*c*C-b*t*C)*M,a[10]=(g*w*e-A*h*e+A*c*n-b*w*n-g*c*C+b*h*C)*M,a[11]=(q*h*e-g*t*e-q*c*n+b*t*n+g*c*u-b*h*u)*M,a[12]=O*M,a[13]=(q*w*d-A*t*d+A*c*r-b*w*r-q*c*x+b*t*x)*M,a[14]=(A*h*d-g*w*d-A*c*m+b*w*m+g*c*x-b*h*x)*M,a[15]=(g*t*d-q*h*d+q*c*m-b*t*m-g*c*r+b*h*r)*M,this};
ua.prototype.scale=function(a){var b=this.elements,c=a.x,d=a.y;a=a.z;return b[0]*=c,b[4]*=d,b[8]*=a,b[1]*=c,b[5]*=d,b[9]*=a,b[2]*=c,b[6]*=d,b[10]*=a,b[3]*=c,b[7]*=d,b[11]*=a,this};ua.prototype.getMaxScaleOnAxis=function(){var a=this.elements;return Math.sqrt(Math.max(a[0]*a[0]+a[1]*a[1]+a[2]*a[2],a[4]*a[4]+a[5]*a[5]+a[6]*a[6],a[8]*a[8]+a[9]*a[9]+a[10]*a[10]))};ua.prototype.makeTranslation=function(a,b,c){return this.set(1,0,0,a,0,1,0,b,0,0,1,c,0,0,0,1),this};ua.prototype.makeRotationX=function(a){var b=
Math.cos(a);a=Math.sin(a);return this.set(1,0,0,0,0,b,-a,0,0,a,b,0,0,0,0,1),this};ua.prototype.makeRotationY=function(a){var b=Math.cos(a);a=Math.sin(a);return this.set(b,0,a,0,0,1,0,0,-a,0,b,0,0,0,0,1),this};ua.prototype.makeRotationZ=function(a){var b=Math.cos(a);a=Math.sin(a);return this.set(b,-a,0,0,a,b,0,0,0,0,1,0,0,0,0,1),this};ua.prototype.makeRotationAxis=function(a,b){var c=Math.cos(b);b=Math.sin(b);var d=1-c,e=a.x,g=a.y;a=a.z;var h=d*e,m=d*g;return this.set(h*e+c,h*g-b*a,h*a+b*g,0,h*g+b*
a,m*g+c,m*a-b*e,0,h*a-b*g,m*a+b*e,d*a*a+c,0,0,0,0,1),this};ua.prototype.makeScale=function(a,b,c){return this.set(a,0,0,0,0,b,0,0,0,0,c,0,0,0,0,1),this};ua.prototype.makeShear=function(a,b,c,d,e,g){return this.set(1,c,e,0,a,1,g,0,b,d,1,0,0,0,0,1),this};ua.prototype.compose=function(a,b,c){var d=this.elements,e=b._x,g=b._y,h=b._z,m=b._w,n=e+e,q=g+g,t=h+h;b=e*n;var r=e*q;e*=t;var u=g*q;g*=t;h*=t;n*=m;q*=m;m*=t;var A=c.x;t=c.y;c=c.z;return d[0]=(1-(u+h))*A,d[1]=(r+m)*A,d[2]=(e-q)*A,d[3]=0,d[4]=(r-m)*
t,d[5]=(1-(b+h))*t,d[6]=(g+n)*t,d[7]=0,d[8]=(e+q)*c,d[9]=(g-n)*c,d[10]=(1-(b+u))*c,d[11]=0,d[12]=a.x,d[13]=a.y,d[14]=a.z,d[15]=1,this};ua.prototype.decompose=function(a,b,c){var d=this.elements,e=ff.set(d[0],d[1],d[2]).length(),g=ff.set(d[4],d[5],d[6]).length(),h=ff.set(d[8],d[9],d[10]).length();0>this.determinant()&&(e=-e);a.x=d[12];a.y=d[13];a.z=d[14];Vb.copy(this);a=1/e;d=1/g;var m=1/h;return Vb.elements[0]*=a,Vb.elements[1]*=a,Vb.elements[2]*=a,Vb.elements[4]*=d,Vb.elements[5]*=d,Vb.elements[6]*=
d,Vb.elements[8]*=m,Vb.elements[9]*=m,Vb.elements[10]*=m,b.setFromRotationMatrix(Vb),c.x=e,c.y=g,c.z=h,this};ua.prototype.makePerspective=function(a,b,c,d,e,g){void 0===g&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");var h=this.elements;return h[0]=2*e/(b-a),h[4]=0,h[8]=(b+a)/(b-a),h[12]=0,h[1]=0,h[5]=2*e/(c-d),h[9]=(c+d)/(c-d),h[13]=0,h[2]=0,h[6]=0,h[10]=-(g+e)/(g-e),h[14]=-2*g*e/(g-e),h[3]=0,h[7]=0,h[11]=-1,h[15]=0,this};ua.prototype.makeOrthographic=
function(a,b,c,d,e,g){var h=this.elements,m=1/(b-a),n=1/(c-d),q=1/(g-e);return h[0]=2*m,h[4]=0,h[8]=0,h[12]=-((b+a)*m),h[1]=0,h[5]=2*n,h[9]=0,h[13]=-((c+d)*n),h[2]=0,h[6]=0,h[10]=-2*q,h[14]=-((g+e)*q),h[3]=0,h[7]=0,h[11]=0,h[15]=1,this};ua.prototype.equals=function(a){var b=this.elements;a=a.elements;for(var c=0;16>c;c++)if(b[c]!==a[c])return!1;return!0};ua.prototype.fromArray=function(a,b){b=void 0===b?0:b;for(var c=0;16>c;c++)this.elements[c]=a[c+b];return this};ua.prototype.toArray=function(a,
b){a=void 0===a?[]:a;b=void 0===b?0:b;var c=this.elements;return a[b]=c[0],a[b+1]=c[1],a[b+2]=c[2],a[b+3]=c[3],a[b+4]=c[4],a[b+5]=c[5],a[b+6]=c[6],a[b+7]=c[7],a[b+8]=c[8],a[b+9]=c[9],a[b+10]=c[10],a[b+11]=c[11],a[b+12]=c[12],a[b+13]=c[13],a[b+14]=c[14],a[b+15]=c[15],a};ua.prototype.isMatrix4=!0;var ff=new B,Vb=new ua,Pl=new B(0,0,0),Ql=new B(1,1,1),Td=new B,hh=new B,tc=new B,gk=new ua,hk=new Sa,Wb=function(a,b,c,d){d=void 0===d?Wb.DefaultOrder:d;this._x=void 0===a?0:a;this._y=void 0===b?0:b;this._z=
void 0===c?0:c;this._order=d};Wb.prototype.set=function(a,b,c,d){d=void 0===d?this._order:d;return this._x=a,this._y=b,this._z=c,this._order=d,this._onChangeCallback(),this};Wb.prototype.clone=function(){return new this.constructor(this._x,this._y,this._z,this._order)};Wb.prototype.copy=function(a){return this._x=a._x,this._y=a._y,this._z=a._z,this._order=a._order,this._onChangeCallback(),this};Wb.prototype.setFromRotationMatrix=function(a,b,c){b=void 0===b?this._order:b;c=void 0===c?!0:c;var d=a.elements;
a=d[0];var e=d[4],g=d[8],h=d[1],m=d[5],n=d[9],q=d[2],t=d[6];d=d[10];switch(b){case "XYZ":this._y=Math.asin(R(g,-1,1));.9999999>Math.abs(g)?(this._x=Math.atan2(-n,d),this._z=Math.atan2(-e,a)):(this._x=Math.atan2(t,m),this._z=0);break;case "YXZ":this._x=Math.asin(-R(n,-1,1));.9999999>Math.abs(n)?(this._y=Math.atan2(g,d),this._z=Math.atan2(h,m)):(this._y=Math.atan2(-q,a),this._z=0);break;case "ZXY":this._x=Math.asin(R(t,-1,1));.9999999>Math.abs(t)?(this._y=Math.atan2(-q,d),this._z=Math.atan2(-e,m)):
(this._y=0,this._z=Math.atan2(h,a));break;case "ZYX":this._y=Math.asin(-R(q,-1,1));.9999999>Math.abs(q)?(this._x=Math.atan2(t,d),this._z=Math.atan2(h,a)):(this._x=0,this._z=Math.atan2(-e,m));break;case "YZX":this._z=Math.asin(R(h,-1,1));.9999999>Math.abs(h)?(this._x=Math.atan2(-n,m),this._y=Math.atan2(-q,a)):(this._x=0,this._y=Math.atan2(g,d));break;case "XZY":this._z=Math.asin(-R(e,-1,1));.9999999>Math.abs(e)?(this._x=Math.atan2(t,m),this._y=Math.atan2(g,a)):(this._x=Math.atan2(-n,d),this._y=0);
break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+b)}return this._order=b,!0===c&&this._onChangeCallback(),this};Wb.prototype.setFromQuaternion=function(a,b,c){return gk.makeRotationFromQuaternion(a),this.setFromRotationMatrix(gk,b,c)};Wb.prototype.setFromVector3=function(a,b){b=void 0===b?this._order:b;return this.set(a.x,a.y,a.z,b)};Wb.prototype.reorder=function(a){return hk.setFromEuler(this),this.setFromQuaternion(hk,a)};Wb.prototype.equals=function(a){return a._x===
this._x&&a._y===this._y&&a._z===this._z&&a._order===this._order};Wb.prototype.fromArray=function(a){return this._x=a[0],this._y=a[1],this._z=a[2],void 0!==a[3]&&(this._order=a[3]),this._onChangeCallback(),this};Wb.prototype.toArray=function(a,b){a=void 0===a?[]:a;b=void 0===b?0:b;return a[b]=this._x,a[b+1]=this._y,a[b+2]=this._z,a[b+3]=this._order,a};Wb.prototype.toVector3=function(a){return a?a.set(this._x,this._y,this._z):new B(this._x,this._y,this._z)};Wb.prototype._onChange=function(a){return this._onChangeCallback=
a,this};Wb.prototype._onChangeCallback=function(){};$jscomp.global.Object.defineProperties(Wb.prototype,{x:{configurable:!0,enumerable:!0,get:function(){return this._x},set:function(a){this._x=a;this._onChangeCallback()}},y:{configurable:!0,enumerable:!0,get:function(){return this._y},set:function(a){this._y=a;this._onChangeCallback()}},z:{configurable:!0,enumerable:!0,get:function(){return this._z},set:function(a){this._z=a;this._onChangeCallback()}},order:{configurable:!0,enumerable:!0,get:function(){return this._order},
set:function(a){this._order=a;this._onChangeCallback()}}});Wb.prototype.isEuler=!0;Wb.DefaultOrder="XYZ";Wb.RotationOrders="XYZ YZX ZXY XZY YXZ ZYX".split(" ");var fd=function(){this.mask=1};fd.prototype.set=function(a){this.mask=1<<a|0};fd.prototype.enable=function(a){this.mask=this.mask|1<<a|0};fd.prototype.enableAll=function(){this.mask=-1};fd.prototype.toggle=function(a){this.mask^=1<<a|0};fd.prototype.disable=function(a){this.mask&=~(1<<a|0)};fd.prototype.disableAll=function(){this.mask=0};fd.prototype.test=
function(a){return 0!=(this.mask&a.mask)};var Rl=0,ik=new B,gf=new Sa,rd=new ua,ih=new B,eg=new B,Sl=new B,Tl=new Sa,jk=new B(1,0,0),kk=new B(0,1,0),lk=new B(0,0,1),Ul={type:"added"},mk={type:"removed"},la=function(){Object.defineProperty(this,"id",{value:Rl++});this.uuid=N();this.name="";this.type="Object3D";this.parent=null;this.children=[];this.up=la.DefaultUp.clone();var a=new B,b=new Wb,c=new Sa,d=new B(1,1,1);b._onChange(function(){c.setFromEuler(b,!1)});c._onChange(function(){b.setFromQuaternion(c,
void 0,!1)});Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:a},rotation:{configurable:!0,enumerable:!0,value:b},quaternion:{configurable:!0,enumerable:!0,value:c},scale:{configurable:!0,enumerable:!0,value:d},modelViewMatrix:{value:new ua},normalMatrix:{value:new fb}});this.matrix=new ua;this.matrixWorld=new ua;this.matrixAutoUpdate=la.DefaultMatrixAutoUpdate;this.matrixWorldNeedsUpdate=!1;this.layers=new fd;this.visible=!0;this.receiveShadow=this.castShadow=!1;this.frustumCulled=
!0;this.renderOrder=0;this.animations=[];this.userData={};return this};$jscomp.inherits(la,Jc);la.prototype.onBeforeRender=function(){};la.prototype.onAfterRender=function(){};la.prototype.applyMatrix4=function(a){this.matrixAutoUpdate&&this.updateMatrix();this.matrix.premultiply(a);this.matrix.decompose(this.position,this.quaternion,this.scale)};la.prototype.applyQuaternion=function(a){return this.quaternion.premultiply(a),this};la.prototype.setRotationFromAxisAngle=function(a,b){this.quaternion.setFromAxisAngle(a,
b)};la.prototype.setRotationFromEuler=function(a){this.quaternion.setFromEuler(a,!0)};la.prototype.setRotationFromMatrix=function(a){this.quaternion.setFromRotationMatrix(a)};la.prototype.setRotationFromQuaternion=function(a){this.quaternion.copy(a)};la.prototype.rotateOnAxis=function(a,b){return gf.setFromAxisAngle(a,b),this.quaternion.multiply(gf),this};la.prototype.rotateOnWorldAxis=function(a,b){return gf.setFromAxisAngle(a,b),this.quaternion.premultiply(gf),this};la.prototype.rotateX=function(a){return this.rotateOnAxis(jk,
a)};la.prototype.rotateY=function(a){return this.rotateOnAxis(kk,a)};la.prototype.rotateZ=function(a){return this.rotateOnAxis(lk,a)};la.prototype.translateOnAxis=function(a,b){return ik.copy(a).applyQuaternion(this.quaternion),this.position.add(ik.multiplyScalar(b)),this};la.prototype.translateX=function(a){return this.translateOnAxis(jk,a)};la.prototype.translateY=function(a){return this.translateOnAxis(kk,a)};la.prototype.translateZ=function(a){return this.translateOnAxis(lk,a)};la.prototype.localToWorld=
function(a){return a.applyMatrix4(this.matrixWorld)};la.prototype.worldToLocal=function(a){return a.applyMatrix4(rd.copy(this.matrixWorld).invert())};la.prototype.lookAt=function(a,b,c){a.isVector3?ih.copy(a):ih.set(a,b,c);a=this.parent;this.updateWorldMatrix(!0,!1);eg.setFromMatrixPosition(this.matrixWorld);this.isCamera||this.isLight?rd.lookAt(eg,ih,this.up):rd.lookAt(ih,eg,this.up);this.quaternion.setFromRotationMatrix(rd);a&&(rd.extractRotation(a.matrixWorld),gf.setFromRotationMatrix(rd),this.quaternion.premultiply(gf.invert()))};
la.prototype.add=function(a){if(1<arguments.length){for(var b=0;b<arguments.length;b++)this.add(arguments[b]);return this}return a===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",a),this):(a&&a.isObject3D?(null!==a.parent&&a.parent.remove(a),a.parent=this,this.children.push(a),a.dispatchEvent(Ul)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",a),this)};la.prototype.remove=function(a){if(1<arguments.length){for(var b=0;b<arguments.length;b++)this.remove(arguments[b]);
return this}b=this.children.indexOf(a);return-1!==b&&(a.parent=null,this.children.splice(b,1),a.dispatchEvent(mk)),this};la.prototype.removeFromParent=function(){var a=this.parent;return null!==a&&a.remove(this),this};la.prototype.clear=function(){for(var a=0;a<this.children.length;a++){var b=this.children[a];b.parent=null;b.dispatchEvent(mk)}return this.children.length=0,this};la.prototype.attach=function(a){return this.updateWorldMatrix(!0,!1),rd.copy(this.matrixWorld).invert(),null!==a.parent&&
(a.parent.updateWorldMatrix(!0,!1),rd.multiply(a.parent.matrixWorld)),a.applyMatrix4(rd),this.add(a),a.updateWorldMatrix(!1,!0),this};la.prototype.getObjectById=function(a){return this.getObjectByProperty("id",a)};la.prototype.getObjectByName=function(a){return this.getObjectByProperty("name",a)};la.prototype.getObjectByProperty=function(a,b){if(this[a]===b)return this;for(var c=0,d=this.children.length;c<d;c++){var e=this.children[c].getObjectByProperty(a,b);if(void 0!==e)return e}};la.prototype.getWorldPosition=
function(a){return this.updateWorldMatrix(!0,!1),a.setFromMatrixPosition(this.matrixWorld)};la.prototype.getWorldQuaternion=function(a){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(eg,a,Sl),a};la.prototype.getWorldScale=function(a){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(eg,Tl,a),a};la.prototype.getWorldDirection=function(a){this.updateWorldMatrix(!0,!1);var b=this.matrixWorld.elements;return a.set(b[8],b[9],b[10]).normalize()};la.prototype.raycast=function(){};
la.prototype.traverse=function(a){a(this);for(var b=this.children,c=0,d=b.length;c<d;c++)b[c].traverse(a)};la.prototype.traverseVisible=function(a){if(!1!==this.visible){a(this);for(var b=this.children,c=0,d=b.length;c<d;c++)b[c].traverseVisible(a)}};la.prototype.traverseAncestors=function(a){var b=this.parent;null!==b&&(a(b),b.traverseAncestors(a))};la.prototype.updateMatrix=function(){this.matrix.compose(this.position,this.quaternion,this.scale);this.matrixWorldNeedsUpdate=!0};la.prototype.updateMatrixWorld=
function(a){this.matrixAutoUpdate&&this.updateMatrix();(this.matrixWorldNeedsUpdate||a)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,a=!0);for(var b=this.children,c=0,d=b.length;c<d;c++)b[c].updateMatrixWorld(a)};la.prototype.updateWorldMatrix=function(a,b){var c=this.parent;if(!0===a&&null!==c&&c.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):
this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===b)for(a=this.children,b=0,c=a.length;b<c;b++)a[b].updateWorldMatrix(!1,!0)};la.prototype.toJSON=function(a){function b(u,A){return void 0===u[A.uuid]&&(u[A.uuid]=A.toJSON(a)),A.uuid}function c(u){var A=[],w;for(w in u){var x=u[w];delete x.metadata;A.push(x)}return A}var d=void 0===a||"string"==typeof a,e={};d&&(a={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{}},e.metadata={version:4.5,
type:"Object",generator:"Object3D.toJSON"});var g={};if(g.uuid=this.uuid,g.type=this.type,""!==this.name&&(g.name=this.name),!0===this.castShadow&&(g.castShadow=!0),!0===this.receiveShadow&&(g.receiveShadow=!0),!1===this.visible&&(g.visible=!1),!1===this.frustumCulled&&(g.frustumCulled=!1),0!==this.renderOrder&&(g.renderOrder=this.renderOrder),"{}"!==JSON.stringify(this.userData)&&(g.userData=this.userData),g.layers=this.layers.mask,g.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(g.matrixAutoUpdate=
!1),this.isInstancedMesh&&(g.type="InstancedMesh",g.count=this.count,g.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(g.instanceColor=this.instanceColor.toJSON())),this.isScene)this.background&&(this.background.isColor?g.background=this.background.toJSON():this.background.isTexture&&(g.background=this.background.toJSON(a).uuid)),this.environment&&this.environment.isTexture&&(g.environment=this.environment.toJSON(a).uuid);else if(this.isMesh||this.isLine||this.isPoints){g.geometry=
b(a.geometries,this.geometry);var h=this.geometry.parameters;if(void 0!==h&&void 0!==h.shapes)if(h=h.shapes,Array.isArray(h))for(var m=0,n=h.length;m<n;m++)b(a.shapes,h[m]);else b(a.shapes,h)}if(this.isSkinnedMesh&&(g.bindMode=this.bindMode,g.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(b(a.skeletons,this.skeleton),g.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){h=[];m=0;for(n=this.material.length;m<n;m++)h.push(b(a.materials,this.material[m]));
g.material=h}else g.material=b(a.materials,this.material);if(0<this.children.length)for(g.children=[],h=0;h<this.children.length;h++)g.children.push(this.children[h].toJSON(a).object);if(0<this.animations.length)for(g.animations=[],h=0;h<this.animations.length;h++)g.animations.push(b(a.animations,this.animations[h]));if(d){d=c(a.geometries);h=c(a.materials);m=c(a.textures);n=c(a.images);var q=c(a.shapes),t=c(a.skeletons),r=c(a.animations);0<d.length&&(e.geometries=d);0<h.length&&(e.materials=h);0<
m.length&&(e.textures=m);0<n.length&&(e.images=n);0<q.length&&(e.shapes=q);0<t.length&&(e.skeletons=t);0<r.length&&(e.animations=r)}return e.object=g,e};la.prototype.clone=function(a){return(new this.constructor).copy(this,a)};la.prototype.copy=function(a,b){b=void 0===b?!0:b;if(this.name=a.name,this.up.copy(a.up),this.position.copy(a.position),this.rotation.order=a.rotation.order,this.quaternion.copy(a.quaternion),this.scale.copy(a.scale),this.matrix.copy(a.matrix),this.matrixWorld.copy(a.matrixWorld),
this.matrixAutoUpdate=a.matrixAutoUpdate,this.matrixWorldNeedsUpdate=a.matrixWorldNeedsUpdate,this.layers.mask=a.layers.mask,this.visible=a.visible,this.castShadow=a.castShadow,this.receiveShadow=a.receiveShadow,this.frustumCulled=a.frustumCulled,this.renderOrder=a.renderOrder,this.userData=JSON.parse(JSON.stringify(a.userData)),!0===b)for(b=0;b<a.children.length;b++)this.add(a.children[b].clone());return this};la.DefaultUp=new B(0,1,0);la.DefaultMatrixAutoUpdate=!0;la.prototype.isObject3D=!0;var Uc=
new B,sd=new B,Ci=new B,td=new B,hf=new B,jf=new B,nk=new B,Di=new B,Ei=new B,Fi=new B,eb=function(a,b,c){a=void 0===a?new B:a;b=void 0===b?new B:b;c=void 0===c?new B:c;this.a=a;this.b=b;this.c=c};eb.getNormal=function(a,b,c,d){d.subVectors(c,b);Uc.subVectors(a,b);d.cross(Uc);a=d.lengthSq();return 0<a?d.multiplyScalar(1/Math.sqrt(a)):d.set(0,0,0)};eb.getBarycoord=function(a,b,c,d,e){Uc.subVectors(d,b);sd.subVectors(c,b);Ci.subVectors(a,b);a=Uc.dot(Uc);b=Uc.dot(sd);c=Uc.dot(Ci);var g=sd.dot(sd);d=
sd.dot(Ci);var h=a*g-b*b;if(0===h)return e.set(-2,-1,-1);h=1/h;g=(g*c-b*d)*h;a=(a*d-b*c)*h;return e.set(1-g-a,a,g)};eb.containsPoint=function(a,b,c,d){return this.getBarycoord(a,b,c,d,td),0<=td.x&&0<=td.y&&1>=td.x+td.y};eb.getUV=function(a,b,c,d,e,g,h,m){return this.getBarycoord(a,b,c,d,td),m.set(0,0),m.addScaledVector(e,td.x),m.addScaledVector(g,td.y),m.addScaledVector(h,td.z),m};eb.isFrontFacing=function(a,b,c,d){return Uc.subVectors(c,b),sd.subVectors(a,b),0>Uc.cross(sd).dot(d)};eb.prototype.set=
function(a,b,c){return this.a.copy(a),this.b.copy(b),this.c.copy(c),this};eb.prototype.setFromPointsAndIndices=function(a,b,c,d){return this.a.copy(a[b]),this.b.copy(a[c]),this.c.copy(a[d]),this};eb.prototype.setFromAttributeAndIndices=function(a,b,c,d){return this.a.fromBufferAttribute(a,b),this.b.fromBufferAttribute(a,c),this.c.fromBufferAttribute(a,d),this};eb.prototype.clone=function(){return(new this.constructor).copy(this)};eb.prototype.copy=function(a){return this.a.copy(a.a),this.b.copy(a.b),
this.c.copy(a.c),this};eb.prototype.getArea=function(){return Uc.subVectors(this.c,this.b),sd.subVectors(this.a,this.b),.5*Uc.cross(sd).length()};eb.prototype.getMidpoint=function(a){return a.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)};eb.prototype.getNormal=function(a){return eb.getNormal(this.a,this.b,this.c,a)};eb.prototype.getPlane=function(a){return a.setFromCoplanarPoints(this.a,this.b,this.c)};eb.prototype.getBarycoord=function(a,b){return eb.getBarycoord(a,this.a,this.b,this.c,
b)};eb.prototype.getUV=function(a,b,c,d,e){return eb.getUV(a,this.a,this.b,this.c,b,c,d,e)};eb.prototype.containsPoint=function(a){return eb.containsPoint(a,this.a,this.b,this.c)};eb.prototype.isFrontFacing=function(a){return eb.isFrontFacing(this.a,this.b,this.c,a)};eb.prototype.intersectsBox=function(a){return a.intersectsTriangle(this)};eb.prototype.closestPointToPoint=function(a,b){var c=this.a,d=this.b,e=this.c,g,h;hf.subVectors(d,c);jf.subVectors(e,c);Di.subVectors(a,c);var m=hf.dot(Di),n=jf.dot(Di);
if(0>=m&&0>=n)return b.copy(c);Ei.subVectors(a,d);var q=hf.dot(Ei),t=jf.dot(Ei);if(0<=q&&t<=q)return b.copy(d);var r=m*t-q*n;if(0>=r&&0<=m&&0>=q)return g=m/(m-q),b.copy(c).addScaledVector(hf,g);Fi.subVectors(a,e);a=hf.dot(Fi);var u=jf.dot(Fi);if(0<=u&&a<=u)return b.copy(e);m=a*n-m*u;if(0>=m&&0<=n&&0>=u)return h=n/(n-u),b.copy(c).addScaledVector(jf,h);n=q*u-a*t;if(0>=n&&0<=t-q&&0<=a-u)return nk.subVectors(e,d),h=(t-q)/(t-q+(a-u)),b.copy(d).addScaledVector(nk,h);d=1/(n+m+r);return g=m*d,h=r*d,b.copy(c).addScaledVector(hf,
g).addScaledVector(jf,h)};eb.prototype.equals=function(a){return a.a.equals(this.a)&&a.b.equals(this.b)&&a.c.equals(this.c)};var Vl=0,Oa=function(){Object.defineProperty(this,"id",{value:Vl++});this.uuid=N();this.name="";this.type="Material";this.fog=!0;this.blending=1;this.side=0;this.vertexColors=!1;this.opacity=1;this.format=1023;this.transparent=!1;this.blendSrc=204;this.blendDst=205;this.blendEquation=100;this.blendEquationAlpha=this.blendDstAlpha=this.blendSrcAlpha=null;this.depthFunc=3;this.depthWrite=
this.depthTest=!0;this.stencilWriteMask=255;this.stencilFunc=519;this.stencilRef=0;this.stencilFuncMask=255;this.stencilZPass=this.stencilZFail=this.stencilFail=7680;this.stencilWrite=!1;this.clippingPlanes=null;this.clipShadows=this.clipIntersection=!1;this.shadowSide=null;this.colorWrite=!0;this.precision=null;this.polygonOffset=!1;this.polygonOffsetUnits=this.polygonOffsetFactor=0;this.premultipliedAlpha=this.alphaToCoverage=this.dithering=!1;this.toneMapped=this.visible=!0;this.userData={};this._alphaTest=
this.version=0;return this};$jscomp.inherits(Oa,Jc);Oa.prototype.onBuild=function(){};Oa.prototype.onBeforeRender=function(){};Oa.prototype.onBeforeCompile=function(){};Oa.prototype.customProgramCacheKey=function(){return this.onBeforeCompile.toString()};Oa.prototype.setValues=function(a){if(void 0!==a)for(var b in a){var c=a[b];if(void 0===c)console.warn("THREE.Material: '"+b+"' parameter is undefined.");else if("shading"===b)console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),
this.flatShading=1===c;else{var d=this[b];void 0!==d?d&&d.isColor?d.set(c):d&&d.isVector3&&c&&c.isVector3?d.copy(c):this[b]=c:console.warn("THREE."+this.type+": '"+b+"' is not a property of this material.")}}};Oa.prototype.toJSON=function(a){function b(e){var g=[],h;for(h in e){var m=e[h];delete m.metadata;g.push(m)}return g}var c=void 0===a||"string"==typeof a;c&&(a={textures:{},images:{}});var d={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};if(d.uuid=this.uuid,d.type=this.type,
""!==this.name&&(d.name=this.name),this.color&&this.color.isColor&&(d.color=this.color.getHex()),void 0!==this.roughness&&(d.roughness=this.roughness),void 0!==this.metalness&&(d.metalness=this.metalness),void 0!==this.sheen&&(d.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(d.sheenColor=this.sheenColor.getHex()),void 0!==this.sheenRoughness&&(d.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(d.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&
(d.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(d.specular=this.specular.getHex()),void 0!==this.specularIntensity&&(d.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(d.specularColor=this.specularColor.getHex()),void 0!==this.shininess&&(d.shininess=this.shininess),void 0!==this.clearcoat&&(d.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(d.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&
(d.clearcoatMap=this.clearcoatMap.toJSON(a).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(d.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(a).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(d.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(a).uuid,d.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.map&&this.map.isTexture&&(d.map=this.map.toJSON(a).uuid),this.matcap&&this.matcap.isTexture&&(d.matcap=this.matcap.toJSON(a).uuid),
this.alphaMap&&this.alphaMap.isTexture&&(d.alphaMap=this.alphaMap.toJSON(a).uuid),this.lightMap&&this.lightMap.isTexture&&(d.lightMap=this.lightMap.toJSON(a).uuid,d.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(d.aoMap=this.aoMap.toJSON(a).uuid,d.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(d.bumpMap=this.bumpMap.toJSON(a).uuid,d.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(d.normalMap=this.normalMap.toJSON(a).uuid,
d.normalMapType=this.normalMapType,d.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(d.displacementMap=this.displacementMap.toJSON(a).uuid,d.displacementScale=this.displacementScale,d.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(d.roughnessMap=this.roughnessMap.toJSON(a).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(d.metalnessMap=this.metalnessMap.toJSON(a).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&
(d.emissiveMap=this.emissiveMap.toJSON(a).uuid),this.specularMap&&this.specularMap.isTexture&&(d.specularMap=this.specularMap.toJSON(a).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(d.specularIntensityMap=this.specularIntensityMap.toJSON(a).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(d.specularColorMap=this.specularColorMap.toJSON(a).uuid),this.envMap&&this.envMap.isTexture&&(d.envMap=this.envMap.toJSON(a).uuid,void 0!==this.combine&&(d.combine=this.combine)),
void 0!==this.envMapIntensity&&(d.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(d.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(d.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(d.gradientMap=this.gradientMap.toJSON(a).uuid),void 0!==this.transmission&&(d.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(d.transmissionMap=this.transmissionMap.toJSON(a).uuid),void 0!==this.thickness&&(d.thickness=
this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(d.thicknessMap=this.thicknessMap.toJSON(a).uuid),void 0!==this.attenuationDistance&&(d.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationColor&&(d.attenuationColor=this.attenuationColor.getHex()),void 0!==this.size&&(d.size=this.size),null!==this.shadowSide&&(d.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(d.sizeAttenuation=this.sizeAttenuation),1!==this.blending&&(d.blending=this.blending),0!==this.side&&
(d.side=this.side),this.vertexColors&&(d.vertexColors=!0),1>this.opacity&&(d.opacity=this.opacity),1023!==this.format&&(d.format=this.format),!0===this.transparent&&(d.transparent=this.transparent),d.depthFunc=this.depthFunc,d.depthTest=this.depthTest,d.depthWrite=this.depthWrite,d.colorWrite=this.colorWrite,d.stencilWrite=this.stencilWrite,d.stencilWriteMask=this.stencilWriteMask,d.stencilFunc=this.stencilFunc,d.stencilRef=this.stencilRef,d.stencilFuncMask=this.stencilFuncMask,d.stencilFail=this.stencilFail,
d.stencilZFail=this.stencilZFail,d.stencilZPass=this.stencilZPass,this.rotation&&0!==this.rotation&&(d.rotation=this.rotation),!0===this.polygonOffset&&(d.polygonOffset=!0),0!==this.polygonOffsetFactor&&(d.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(d.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth&&1!==this.linewidth&&(d.linewidth=this.linewidth),void 0!==this.dashSize&&(d.dashSize=this.dashSize),void 0!==this.gapSize&&(d.gapSize=this.gapSize),void 0!==
this.scale&&(d.scale=this.scale),!0===this.dithering&&(d.dithering=!0),0<this.alphaTest&&(d.alphaTest=this.alphaTest),!0===this.alphaToCoverage&&(d.alphaToCoverage=this.alphaToCoverage),!0===this.premultipliedAlpha&&(d.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(d.wireframe=this.wireframe),1<this.wireframeLinewidth&&(d.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(d.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(d.wireframeLinejoin=
this.wireframeLinejoin),!0===this.flatShading&&(d.flatShading=this.flatShading),!1===this.visible&&(d.visible=!1),!1===this.toneMapped&&(d.toneMapped=!1),"{}"!==JSON.stringify(this.userData)&&(d.userData=this.userData),c)c=b(a.textures),a=b(a.images),0<c.length&&(d.textures=c),0<a.length&&(d.images=a);return d};Oa.prototype.clone=function(){return(new this.constructor).copy(this)};Oa.prototype.copy=function(a){this.name=a.name;this.fog=a.fog;this.blending=a.blending;this.side=a.side;this.vertexColors=
a.vertexColors;this.opacity=a.opacity;this.format=a.format;this.transparent=a.transparent;this.blendSrc=a.blendSrc;this.blendDst=a.blendDst;this.blendEquation=a.blendEquation;this.blendSrcAlpha=a.blendSrcAlpha;this.blendDstAlpha=a.blendDstAlpha;this.blendEquationAlpha=a.blendEquationAlpha;this.depthFunc=a.depthFunc;this.depthTest=a.depthTest;this.depthWrite=a.depthWrite;this.stencilWriteMask=a.stencilWriteMask;this.stencilFunc=a.stencilFunc;this.stencilRef=a.stencilRef;this.stencilFuncMask=a.stencilFuncMask;
this.stencilFail=a.stencilFail;this.stencilZFail=a.stencilZFail;this.stencilZPass=a.stencilZPass;this.stencilWrite=a.stencilWrite;var b=a.clippingPlanes,c=null;if(null!==b){var d=b.length;c=Array(d);for(var e=0;e!==d;++e)c[e]=b[e].clone()}return this.clippingPlanes=c,this.clipIntersection=a.clipIntersection,this.clipShadows=a.clipShadows,this.shadowSide=a.shadowSide,this.colorWrite=a.colorWrite,this.precision=a.precision,this.polygonOffset=a.polygonOffset,this.polygonOffsetFactor=a.polygonOffsetFactor,
this.polygonOffsetUnits=a.polygonOffsetUnits,this.dithering=a.dithering,this.alphaTest=a.alphaTest,this.alphaToCoverage=a.alphaToCoverage,this.premultipliedAlpha=a.premultipliedAlpha,this.visible=a.visible,this.toneMapped=a.toneMapped,this.userData=JSON.parse(JSON.stringify(a.userData)),this};Oa.prototype.dispose=function(){this.dispatchEvent({type:"dispose"})};$jscomp.global.Object.defineProperties(Oa.prototype,{alphaTest:{configurable:!0,enumerable:!0,get:function(){return this._alphaTest},set:function(a){0<
this._alphaTest!=0<a&&this.version++;this._alphaTest=a}},needsUpdate:{configurable:!0,enumerable:!0,set:function(a){!0===a&&this.version++}}});Oa.prototype.isMaterial=!0;var ok={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,
crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,
floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,
lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,
moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,
sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},yc={h:0,s:0,l:0},jh={h:0,s:0,l:0},ma=function(a,b,c){return void 0===b&&void 0===c?this.set(a):this.setRGB(a,b,c)};ma.prototype.set=function(a){return a&&a.isColor?this.copy(a):
"number"==typeof a?this.setHex(a):"string"==typeof a&&this.setStyle(a),this};ma.prototype.setScalar=function(a){return this.r=a,this.g=a,this.b=a,this};ma.prototype.setHex=function(a){return a=Math.floor(a),this.r=(a>>16&255)/255,this.g=(a>>8&255)/255,this.b=(255&a)/255,this};ma.prototype.setRGB=function(a,b,c){return this.r=a,this.g=b,this.b=c,this};ma.prototype.setHSL=function(a,b,c){(a=fa(a,1),b=R(b,0,1),c=R(c,0,1),0===b)?this.r=this.g=this.b=c:(b=.5>=c?c*(1+b):c+b-c*b,c=2*c-b,this.r=Ua(c,b,a+
1/3),this.g=Ua(c,b,a),this.b=Ua(c,b,a-1/3));return this};ma.prototype.setStyle=function(a){function b(h){void 0!==h&&1>parseFloat(h)&&console.warn("THREE.Color: Alpha component of "+a+" will be ignored.")}var c;if(c=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(a)){var d=c[2];switch(c[1]){case "rgb":case "rgba":if(c=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(d))return this.r=Math.min(255,parseInt(c[1],10))/255,this.g=Math.min(255,parseInt(c[2],10))/255,this.b=Math.min(255,parseInt(c[3],
10))/255,b(c[4]),this;if(c=/^\s*(\d+)%\s*,\s*(\d+)%\s*,\s*(\d+)%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(d))return this.r=Math.min(100,parseInt(c[1],10))/100,this.g=Math.min(100,parseInt(c[2],10))/100,this.b=Math.min(100,parseInt(c[3],10))/100,b(c[4]),this;break;case "hsl":case "hsla":if(c=/^\s*(\d*\.?\d+)\s*,\s*(\d+)%\s*,\s*(\d+)%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(d)){d=parseFloat(c[1])/360;var e=parseInt(c[2],10)/100,g=parseInt(c[3],10)/100;return b(c[4]),this.setHSL(d,e,g)}}}else if(c=/^#([A-Fa-f\d]+)$/.exec(a)){c=
c[1];d=c.length;if(3===d)return this.r=parseInt(c.charAt(0)+c.charAt(0),16)/255,this.g=parseInt(c.charAt(1)+c.charAt(1),16)/255,this.b=parseInt(c.charAt(2)+c.charAt(2),16)/255,this;if(6===d)return this.r=parseInt(c.charAt(0)+c.charAt(1),16)/255,this.g=parseInt(c.charAt(2)+c.charAt(3),16)/255,this.b=parseInt(c.charAt(4)+c.charAt(5),16)/255,this}return a&&0<a.length?this.setColorName(a):this};ma.prototype.setColorName=function(a){var b=ok[a.toLowerCase()];return void 0!==b?this.setHex(b):console.warn("THREE.Color: Unknown color "+
a),this};ma.prototype.clone=function(){return new this.constructor(this.r,this.g,this.b)};ma.prototype.copy=function(a){return this.r=a.r,this.g=a.g,this.b=a.b,this};ma.prototype.copyGammaToLinear=function(a,b){b=void 0===b?2:b;return this.r=Math.pow(a.r,b),this.g=Math.pow(a.g,b),this.b=Math.pow(a.b,b),this};ma.prototype.copyLinearToGamma=function(a,b){b=void 0===b?2:b;b=0<b?1/b:1;return this.r=Math.pow(a.r,b),this.g=Math.pow(a.g,b),this.b=Math.pow(a.b,b),this};ma.prototype.convertGammaToLinear=function(a){return this.copyGammaToLinear(this,
a),this};ma.prototype.convertLinearToGamma=function(a){return this.copyLinearToGamma(this,a),this};ma.prototype.copySRGBToLinear=function(a){return this.r=Hc(a.r),this.g=Hc(a.g),this.b=Hc(a.b),this};ma.prototype.copyLinearToSRGB=function(a){return this.r=Pc(a.r),this.g=Pc(a.g),this.b=Pc(a.b),this};ma.prototype.convertSRGBToLinear=function(){return this.copySRGBToLinear(this),this};ma.prototype.convertLinearToSRGB=function(){return this.copyLinearToSRGB(this),this};ma.prototype.getHex=function(){return 255*
this.r<<16^255*this.g<<8^255*this.b<<0};ma.prototype.getHexString=function(){return("000000"+this.getHex().toString(16)).slice(-6)};ma.prototype.getHSL=function(a){var b=this.r,c=this.g,d=this.b,e=Math.max(b,c,d),g=Math.min(b,c,d),h,m=(g+e)/2;if(g===e)g=h=0;else{var n=e-g;switch(g=.5>=m?n/(e+g):n/(2-e-g),e){case b:h=(c-d)/n+(c<d?6:0);break;case c:h=(d-b)/n+2;break;case d:h=(b-c)/n+4}h/=6}return a.h=h,a.s=g,a.l=m,a};ma.prototype.getStyle=function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+
(255*this.b|0)+")"};ma.prototype.offsetHSL=function(a,b,c){return this.getHSL(yc),yc.h+=a,yc.s+=b,yc.l+=c,this.setHSL(yc.h,yc.s,yc.l),this};ma.prototype.add=function(a){return this.r+=a.r,this.g+=a.g,this.b+=a.b,this};ma.prototype.addColors=function(a,b){return this.r=a.r+b.r,this.g=a.g+b.g,this.b=a.b+b.b,this};ma.prototype.addScalar=function(a){return this.r+=a,this.g+=a,this.b+=a,this};ma.prototype.sub=function(a){return this.r=Math.max(0,this.r-a.r),this.g=Math.max(0,this.g-a.g),this.b=Math.max(0,
this.b-a.b),this};ma.prototype.multiply=function(a){return this.r*=a.r,this.g*=a.g,this.b*=a.b,this};ma.prototype.multiplyScalar=function(a){return this.r*=a,this.g*=a,this.b*=a,this};ma.prototype.lerp=function(a,b){return this.r+=(a.r-this.r)*b,this.g+=(a.g-this.g)*b,this.b+=(a.b-this.b)*b,this};ma.prototype.lerpColors=function(a,b,c){return this.r=a.r+(b.r-a.r)*c,this.g=a.g+(b.g-a.g)*c,this.b=a.b+(b.b-a.b)*c,this};ma.prototype.lerpHSL=function(a,b){this.getHSL(yc);a.getHSL(jh);a=ka(yc.h,jh.h,b);
var c=ka(yc.s,jh.s,b);b=ka(yc.l,jh.l,b);return this.setHSL(a,c,b),this};ma.prototype.equals=function(a){return a.r===this.r&&a.g===this.g&&a.b===this.b};ma.prototype.fromArray=function(a,b){b=void 0===b?0:b;return this.r=a[b],this.g=a[b+1],this.b=a[b+2],this};ma.prototype.toArray=function(a,b){a=void 0===a?[]:a;b=void 0===b?0:b;return a[b]=this.r,a[b+1]=this.g,a[b+2]=this.b,a};ma.prototype.fromBufferAttribute=function(a,b){return this.r=a.getX(b),this.g=a.getY(b),this.b=a.getZ(b),!0===a.normalized&&
(this.r/=255,this.g/=255,this.b/=255),this};ma.prototype.toJSON=function(){return this.getHex()};ma.NAMES=ok;ma.prototype.isColor=!0;ma.prototype.r=1;ma.prototype.g=1;ma.prototype.b=1;var Vc=function(a){var b=Oa.call(this)||this;b.type="MeshBasicMaterial";b.color=new ma(16777215);b.map=null;b.lightMap=null;b.lightMapIntensity=1;b.aoMap=null;b.aoMapIntensity=1;b.specularMap=null;b.alphaMap=null;b.envMap=null;b.combine=0;b.reflectivity=1;b.refractionRatio=.98;b.wireframe=!1;b.wireframeLinewidth=1;b.wireframeLinecap=
"round";b.wireframeLinejoin="round";b.setValues(a);return b};$jscomp.inherits(Vc,Oa);Vc.prototype.copy=function(a){return Oa.prototype.copy.call(this,a),this.color.copy(a.color),this.map=a.map,this.lightMap=a.lightMap,this.lightMapIntensity=a.lightMapIntensity,this.aoMap=a.aoMap,this.aoMapIntensity=a.aoMapIntensity,this.specularMap=a.specularMap,this.alphaMap=a.alphaMap,this.envMap=a.envMap,this.combine=a.combine,this.reflectivity=a.reflectivity,this.refractionRatio=a.refractionRatio,this.wireframe=
a.wireframe,this.wireframeLinewidth=a.wireframeLinewidth,this.wireframeLinecap=a.wireframeLinecap,this.wireframeLinejoin=a.wireframeLinejoin,this};Vc.prototype.isMeshBasicMaterial=!0;var Gb=new B,kh=new T,Ba=function(a,b,c){if(Array.isArray(a))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="";this.array=a;this.itemSize=b;this.count=void 0!==a?a.length/b:0;this.normalized=!0===c;this.usage=35044;this.updateRange={offset:0,count:-1};this.version=0};Ba.prototype.onUploadCallback=
function(){};Ba.prototype.setUsage=function(a){return this.usage=a,this};Ba.prototype.copy=function(a){return this.name=a.name,this.array=new a.array.constructor(a.array),this.itemSize=a.itemSize,this.count=a.count,this.normalized=a.normalized,this.usage=a.usage,this};Ba.prototype.copyAt=function(a,b,c){a*=this.itemSize;c*=b.itemSize;for(var d=0,e=this.itemSize;d<e;d++)this.array[a+d]=b.array[c+d];return this};Ba.prototype.copyArray=function(a){return this.array.set(a),this};Ba.prototype.copyColorsArray=
function(a){for(var b=this.array,c=0,d=0,e=a.length;d<e;d++){var g=a[d];void 0===g&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",d),g=new ma);b[c++]=g.r;b[c++]=g.g;b[c++]=g.b}return this};Ba.prototype.copyVector2sArray=function(a){for(var b=this.array,c=0,d=0,e=a.length;d<e;d++){var g=a[d];void 0===g&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",d),g=new T);b[c++]=g.x;b[c++]=g.y}return this};Ba.prototype.copyVector3sArray=function(a){for(var b=
this.array,c=0,d=0,e=a.length;d<e;d++){var g=a[d];void 0===g&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",d),g=new B);b[c++]=g.x;b[c++]=g.y;b[c++]=g.z}return this};Ba.prototype.copyVector4sArray=function(a){for(var b=this.array,c=0,d=0,e=a.length;d<e;d++){var g=a[d];void 0===g&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",d),g=new za);b[c++]=g.x;b[c++]=g.y;b[c++]=g.z;b[c++]=g.w}return this};Ba.prototype.applyMatrix3=function(a){if(2===
this.itemSize)for(var b=0,c=this.count;b<c;b++)kh.fromBufferAttribute(this,b),kh.applyMatrix3(a),this.setXY(b,kh.x,kh.y);else if(3===this.itemSize)for(b=0,c=this.count;b<c;b++)Gb.fromBufferAttribute(this,b),Gb.applyMatrix3(a),this.setXYZ(b,Gb.x,Gb.y,Gb.z);return this};Ba.prototype.applyMatrix4=function(a){for(var b=0,c=this.count;b<c;b++)Gb.x=this.getX(b),Gb.y=this.getY(b),Gb.z=this.getZ(b),Gb.applyMatrix4(a),this.setXYZ(b,Gb.x,Gb.y,Gb.z);return this};Ba.prototype.applyNormalMatrix=function(a){for(var b=
0,c=this.count;b<c;b++)Gb.x=this.getX(b),Gb.y=this.getY(b),Gb.z=this.getZ(b),Gb.applyNormalMatrix(a),this.setXYZ(b,Gb.x,Gb.y,Gb.z);return this};Ba.prototype.transformDirection=function(a){for(var b=0,c=this.count;b<c;b++)Gb.x=this.getX(b),Gb.y=this.getY(b),Gb.z=this.getZ(b),Gb.transformDirection(a),this.setXYZ(b,Gb.x,Gb.y,Gb.z);return this};Ba.prototype.set=function(a,b){return this.array.set(a,void 0===b?0:b),this};Ba.prototype.getX=function(a){return this.array[a*this.itemSize]};Ba.prototype.setX=
function(a,b){return this.array[a*this.itemSize]=b,this};Ba.prototype.getY=function(a){return this.array[a*this.itemSize+1]};Ba.prototype.setY=function(a,b){return this.array[a*this.itemSize+1]=b,this};Ba.prototype.getZ=function(a){return this.array[a*this.itemSize+2]};Ba.prototype.setZ=function(a,b){return this.array[a*this.itemSize+2]=b,this};Ba.prototype.getW=function(a){return this.array[a*this.itemSize+3]};Ba.prototype.setW=function(a,b){return this.array[a*this.itemSize+3]=b,this};Ba.prototype.setXY=
function(a,b,c){return a*=this.itemSize,this.array[a+0]=b,this.array[a+1]=c,this};Ba.prototype.setXYZ=function(a,b,c,d){return a*=this.itemSize,this.array[a+0]=b,this.array[a+1]=c,this.array[a+2]=d,this};Ba.prototype.setXYZW=function(a,b,c,d,e){return a*=this.itemSize,this.array[a+0]=b,this.array[a+1]=c,this.array[a+2]=d,this.array[a+3]=e,this};Ba.prototype.onUpload=function(a){return this.onUploadCallback=a,this};Ba.prototype.clone=function(){return(new this.constructor(this.array,this.itemSize)).copy(this)};
Ba.prototype.toJSON=function(){var a={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized};return""!==this.name&&(a.name=this.name),35044!==this.usage&&(a.usage=this.usage),0===this.updateRange.offset&&-1===this.updateRange.count||(a.updateRange=this.updateRange),a};$jscomp.global.Object.defineProperties(Ba.prototype,{needsUpdate:{configurable:!0,enumerable:!0,set:function(a){!0===a&&this.version++}}});Ba.prototype.isBufferAttribute=
!0;var Gi=function(a,b,c){return Ba.call(this,new Int8Array(a),b,c)||this};$jscomp.inherits(Gi,Ba);var Hi=function(a,b,c){return Ba.call(this,new Uint8Array(a),b,c)||this};$jscomp.inherits(Hi,Ba);var Ii=function(a,b,c){return Ba.call(this,new Uint8ClampedArray(a),b,c)||this};$jscomp.inherits(Ii,Ba);var Ji=function(a,b,c){return Ba.call(this,new Int16Array(a),b,c)||this};$jscomp.inherits(Ji,Ba);var Lf=function(a,b,c){return Ba.call(this,new Uint16Array(a),b,c)||this};$jscomp.inherits(Lf,Ba);var Ki=
function(a,b,c){return Ba.call(this,new Int32Array(a),b,c)||this};$jscomp.inherits(Ki,Ba);var Kf=function(a,b,c){return Ba.call(this,new Uint32Array(a),b,c)||this};$jscomp.inherits(Kf,Ba);var Li=function(a,b,c){return Ba.call(this,new Uint16Array(a),b,c)||this};$jscomp.inherits(Li,Ba);Li.prototype.isFloat16BufferAttribute=!0;var Ma=function(a,b,c){return Ba.call(this,new Float32Array(a),b,c)||this};$jscomp.inherits(Ma,Ba);var Mi=function(a,b,c){return Ba.call(this,new Float64Array(a),b,c)||this};
$jscomp.inherits(Mi,Ba);var Wl=0,Kc=new ua,Ni=new la,kf=new B,Ec=new ab,fg=new ab,cc=new B,ra=function(){Object.defineProperty(this,"id",{value:Wl++});this.uuid=N();this.name="";this.type="BufferGeometry";this.index=null;this.attributes={};this.morphAttributes={};this.morphTargetsRelative=!1;this.groups=[];this.boundingSphere=this.boundingBox=null;this.drawRange={start:0,count:1/0};this.userData={};return this};$jscomp.inherits(ra,Jc);ra.prototype.getIndex=function(){return this.index};ra.prototype.setIndex=
function(a){return Array.isArray(a)?this.index=new (65535<oa(a)?Kf:Lf)(a,1):this.index=a,this};ra.prototype.getAttribute=function(a){return this.attributes[a]};ra.prototype.setAttribute=function(a,b){return this.attributes[a]=b,this};ra.prototype.deleteAttribute=function(a){return delete this.attributes[a],this};ra.prototype.hasAttribute=function(a){return void 0!==this.attributes[a]};ra.prototype.addGroup=function(a,b,c){this.groups.push({start:a,count:b,materialIndex:void 0===c?0:c})};ra.prototype.clearGroups=
function(){this.groups=[]};ra.prototype.setDrawRange=function(a,b){this.drawRange.start=a;this.drawRange.count=b};ra.prototype.applyMatrix4=function(a){var b=this.attributes.position;void 0!==b&&(b.applyMatrix4(a),b.needsUpdate=!0);b=this.attributes.normal;if(void 0!==b){var c=(new fb).getNormalMatrix(a);b.applyNormalMatrix(c);b.needsUpdate=!0}b=this.attributes.tangent;return void 0!==b&&(b.transformDirection(a),b.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&
this.computeBoundingSphere(),this};ra.prototype.applyQuaternion=function(a){return Kc.makeRotationFromQuaternion(a),this.applyMatrix4(Kc),this};ra.prototype.rotateX=function(a){return Kc.makeRotationX(a),this.applyMatrix4(Kc),this};ra.prototype.rotateY=function(a){return Kc.makeRotationY(a),this.applyMatrix4(Kc),this};ra.prototype.rotateZ=function(a){return Kc.makeRotationZ(a),this.applyMatrix4(Kc),this};ra.prototype.translate=function(a,b,c){return Kc.makeTranslation(a,b,c),this.applyMatrix4(Kc),
this};ra.prototype.scale=function(a,b,c){return Kc.makeScale(a,b,c),this.applyMatrix4(Kc),this};ra.prototype.lookAt=function(a){return Ni.lookAt(a),Ni.updateMatrix(),this.applyMatrix4(Ni.matrix),this};ra.prototype.center=function(){return this.computeBoundingBox(),this.boundingBox.getCenter(kf).negate(),this.translate(kf.x,kf.y,kf.z),this};ra.prototype.setFromPoints=function(a){for(var b=[],c=0,d=a.length;c<d;c++){var e=a[c];b.push(e.x,e.y,e.z||0)}return this.setAttribute("position",new Ma(b,3)),
this};ra.prototype.computeBoundingBox=function(){null===this.boundingBox&&(this.boundingBox=new ab);var a=this.attributes.position,b=this.morphAttributes.position;if(a&&a.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingBox.set(new B(-1/0,-1/0,-1/0),new B(1/0,1/0,1/0));if(void 0!==a){if(this.boundingBox.setFromBufferAttribute(a),b){a=0;for(var c=
b.length;a<c;a++)Ec.setFromBufferAttribute(b[a]),this.morphTargetsRelative?(cc.addVectors(this.boundingBox.min,Ec.min),this.boundingBox.expandByPoint(cc),cc.addVectors(this.boundingBox.max,Ec.max),this.boundingBox.expandByPoint(cc)):(this.boundingBox.expandByPoint(Ec.min),this.boundingBox.expandByPoint(Ec.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',
this)};ra.prototype.computeBoundingSphere=function(){null===this.boundingSphere&&(this.boundingSphere=new Fb);var a=this.attributes.position,b=this.morphAttributes.position;if(a&&a.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingSphere.set(new B,1/0);if(a){var c=this.boundingSphere.center;if(Ec.setFromBufferAttribute(a),b)for(var d=
0,e=b.length;d<e;d++)fg.setFromBufferAttribute(b[d]),this.morphTargetsRelative?(cc.addVectors(Ec.min,fg.min),Ec.expandByPoint(cc),cc.addVectors(Ec.max,fg.max),Ec.expandByPoint(cc)):(Ec.expandByPoint(fg.min),Ec.expandByPoint(fg.max));Ec.getCenter(c);e=d=0;for(var g=a.count;e<g;e++)cc.fromBufferAttribute(a,e),d=Math.max(d,c.distanceToSquared(cc));if(b)for(e=0,g=b.length;e<g;e++)for(var h=b[e],m=this.morphTargetsRelative,n=0,q=h.count;n<q;n++)cc.fromBufferAttribute(h,n),m&&(kf.fromBufferAttribute(a,
n),cc.add(kf)),d=Math.max(d,c.distanceToSquared(cc));this.boundingSphere.radius=Math.sqrt(d);isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}};ra.prototype.computeTangents=function(){function a(Ha,ya,ja){r.fromArray(e,3*Ha);u.fromArray(e,3*ya);A.fromArray(e,3*ja);w.fromArray(h,2*Ha);x.fromArray(h,2*ya);C.fromArray(h,2*ja);u.sub(r);A.sub(r);x.sub(w);C.sub(w);var Ja=
1/(x.x*C.y-C.x*x.y);isFinite(Ja)&&(G.copy(u).multiplyScalar(C.y).addScaledVector(A,-x.y).multiplyScalar(Ja),I.copy(A).multiplyScalar(x.x).addScaledVector(u,-C.x).multiplyScalar(Ja),q[Ha].add(G),q[ya].add(G),q[ja].add(G),t[Ha].add(I),t[ya].add(I),t[ja].add(I))}function b(Ha){Y.fromArray(g,3*Ha);Z.copy(Y);var ya=q[Ha];V.copy(ya);V.sub(Y.multiplyScalar(Y.dot(ya))).normalize();ba.crossVectors(Z,ya);ya=0>ba.dot(t[Ha])?-1:1;n[4*Ha]=V.x;n[4*Ha+1]=V.y;n[4*Ha+2]=V.z;n[4*Ha+3]=ya}var c=this.index,d=this.attributes;
if(null===c||void 0===d.position||void 0===d.normal||void 0===d.uv)return void console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");c=c.array;var e=d.position.array,g=d.normal.array,h=d.uv.array,m=e.length/3;void 0===d.tangent&&this.setAttribute("tangent",new Ba(new Float32Array(4*m),4));var n=d.tangent.array,q=[],t=[];for(d=0;d<m;d++)q[d]=new B,t[d]=new B;var r=new B,u=new B,A=new B,w=new T,x=new T,C=new T,G=new B,I=new B;d=
this.groups;0===d.length&&(d=[{start:0,count:c.length}]);m=0;for(var P=d.length;m<P;++m){var O=d[m],M=O.start,S=M;for(O=M+O.count;S<O;S+=3)a(c[S+0],c[S+1],c[S+2])}var V=new B,ba=new B,Y=new B,Z=new B;m=0;for(P=d.length;m<P;++m)for(O=d[m],S=M=O.start,O=M+O.count;S<O;S+=3)b(c[S+0]),b(c[S+1]),b(c[S+2])};ra.prototype.computeVertexNormals=function(){var a=this.index,b=this.getAttribute("position");if(void 0!==b){var c=this.getAttribute("normal");if(void 0===c)c=new Ba(new Float32Array(3*b.count),3),this.setAttribute("normal",
c);else for(var d=0,e=c.count;d<e;d++)c.setXYZ(d,0,0,0);d=new B;e=new B;var g=new B,h=new B,m=new B,n=new B,q=new B,t=new B;if(a)for(var r=0,u=a.count;r<u;r+=3){var A=a.getX(r+0),w=a.getX(r+1),x=a.getX(r+2);d.fromBufferAttribute(b,A);e.fromBufferAttribute(b,w);g.fromBufferAttribute(b,x);q.subVectors(g,e);t.subVectors(d,e);q.cross(t);h.fromBufferAttribute(c,A);m.fromBufferAttribute(c,w);n.fromBufferAttribute(c,x);h.add(q);m.add(q);n.add(q);c.setXYZ(A,h.x,h.y,h.z);c.setXYZ(w,m.x,m.y,m.z);c.setXYZ(x,
n.x,n.y,n.z)}else for(a=0,h=b.count;a<h;a+=3)d.fromBufferAttribute(b,a+0),e.fromBufferAttribute(b,a+1),g.fromBufferAttribute(b,a+2),q.subVectors(g,e),t.subVectors(d,e),q.cross(t),c.setXYZ(a+0,q.x,q.y,q.z),c.setXYZ(a+1,q.x,q.y,q.z),c.setXYZ(a+2,q.x,q.y,q.z);this.normalizeNormals();c.needsUpdate=!0}};ra.prototype.merge=function(a,b){if(!a||!a.isBufferGeometry)return void console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",a);void 0===b&&(b=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));
var c=this.attributes,d;for(d in c)if(void 0!==a.attributes[d]){var e=c[d].array,g=a.attributes[d],h=g.array,m=g.itemSize*b;g=Math.min(h.length,e.length-m);for(var n=0;n<g;n++,m++)e[m]=h[n]}return this};ra.prototype.normalizeNormals=function(){for(var a=this.attributes.normal,b=0,c=a.count;b<c;b++)cc.fromBufferAttribute(a,b),cc.normalize(),a.setXYZ(b,cc.x,cc.y,cc.z)};ra.prototype.toNonIndexed=function(){function a(t,r){for(var u=t.array,A=t.itemSize,w=t.normalized,x=new u.constructor(r.length*A),
C,G=0,I=0,P=r.length;I<P;I++){C=t.isInterleavedBufferAttribute?r[I]*t.data.stride+t.offset:r[I]*A;for(var O=0;O<A;O++)x[G++]=u[C++]}return new Ba(x,A,w)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;var b=new ra,c=this.index.array,d=this.attributes;for(h in d){var e=a(d[h],c);b.setAttribute(h,e)}d=this.morphAttributes;for(var g in d){var h=[];e=d[g];for(var m=0,n=e.length;m<n;m++){var q=a(e[m],c);h.push(q)}b.morphAttributes[g]=
h}b.morphTargetsRelative=this.morphTargetsRelative;c=this.groups;g=0;for(d=c.length;g<d;g++)h=c[g],b.addGroup(h.start,h.count,h.materialIndex);return b};ra.prototype.toJSON=function(){var a={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(a.uuid=this.uuid,a.type=this.type,""!==this.name&&(a.name=this.name),0<Object.keys(this.userData).length&&(a.userData=this.userData),void 0!==this.parameters){var b=this.parameters;for(c in b)void 0!==b[c]&&(a[c]=b[c]);return a}a.data=
{attributes:{}};var c=this.index;null!==c&&(a.data.index={type:c.array.constructor.name,array:Array.prototype.slice.call(c.array)});c=this.attributes;for(var d in c)a.data.attributes[d]=c[d].toJSON(a.data);d={};c=!1;for(b in this.morphAttributes){for(var e=this.morphAttributes[b],g=[],h=0,m=e.length;h<m;h++)g.push(e[h].toJSON(a.data));0<g.length&&(d[b]=g,c=!0)}c&&(a.data.morphAttributes=d,a.data.morphTargetsRelative=this.morphTargetsRelative);b=this.groups;0<b.length&&(a.data.groups=JSON.parse(JSON.stringify(b)));
b=this.boundingSphere;return null!==b&&(a.data.boundingSphere={center:b.center.toArray(),radius:b.radius}),a};ra.prototype.clone=function(){return(new this.constructor).copy(this)};ra.prototype.copy=function(a){this.index=null;this.attributes={};this.morphAttributes={};this.groups=[];this.boundingSphere=this.boundingBox=null;var b={};this.name=a.name;var c=a.index;null!==c&&this.setIndex(c.clone(b));c=a.attributes;for(var d in c)this.setAttribute(d,c[d].clone(b));d=a.morphAttributes;for(var e in d){c=
[];for(var g=d[e],h=0,m=g.length;h<m;h++)c.push(g[h].clone(b));this.morphAttributes[e]=c}this.morphTargetsRelative=a.morphTargetsRelative;b=a.groups;e=0;for(d=b.length;e<d;e++)c=b[e],this.addGroup(c.start,c.count,c.materialIndex);b=a.boundingBox;null!==b&&(this.boundingBox=b.clone());b=a.boundingSphere;return null!==b&&(this.boundingSphere=b.clone()),this.drawRange.start=a.drawRange.start,this.drawRange.count=a.drawRange.count,this.userData=a.userData,void 0!==a.parameters&&(this.parameters=Object.assign({},
a.parameters)),this};ra.prototype.dispose=function(){this.dispatchEvent({type:"dispose"})};ra.prototype.isBufferGeometry=!0;var pk=new ua,lf=new Bb,Oi=new Fb,jd=new B,kd=new B,ld=new B,$h=new B,ai=new B,bi=new B,Fg=new B,Gg=new B,Hg=new B,Jg=new T,Kg=new T,Lg=new T,Df=new B,Ig=new B,vb=function(a,b){a=void 0===a?new ra:a;b=void 0===b?new Vc:b;var c=la.call(this)||this;c.type="Mesh";c.geometry=a;c.material=b;c.updateMorphTargets();return c};$jscomp.inherits(vb,la);vb.prototype.copy=function(a){return la.prototype.copy.call(this,
a),void 0!==a.morphTargetInfluences&&(this.morphTargetInfluences=a.morphTargetInfluences.slice()),void 0!==a.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},a.morphTargetDictionary)),this.material=a.material,this.geometry=a.geometry,this};vb.prototype.updateMorphTargets=function(){var a=this.geometry;if(a.isBufferGeometry){a=a.morphAttributes;var b=Object.keys(a);if(0<b.length&&(a=a[b[0]],void 0!==a)){this.morphTargetInfluences=[];this.morphTargetDictionary={};b=0;for(var c=a.length;b<
c;b++){var d=a[b].name||String(b);this.morphTargetInfluences.push(0);this.morphTargetDictionary[d]=b}}}else a=a.morphTargets,void 0!==a&&0<a.length&&console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")};vb.prototype.raycast=function(a,b){var c=this.geometry,d=this.material,e=this.matrixWorld;if(void 0!==d&&(null===c.boundingSphere&&c.computeBoundingSphere(),Oi.copy(c.boundingSphere),Oi.applyMatrix4(e),!1!==a.ray.intersectsSphere(Oi))&&
(pk.copy(e).invert(),lf.copy(a.ray).applyMatrix4(pk),null===c.boundingBox||!1!==lf.intersectsBox(c.boundingBox)))if(c.isBufferGeometry){var g=c.index;e=c.attributes.position;var h=c.morphAttributes.position,m=c.morphTargetsRelative,n=c.attributes.uv,q=c.attributes.uv2,t=c.groups;c=c.drawRange;if(null!==g)if(Array.isArray(d))for(var r=0,u=t.length;r<u;r++)for(var A=t[r],w=d[A.materialIndex],x=Math.max(A.start,c.start),C=Math.min(g.count,Math.min(A.start+A.count,c.start+c.count));x<C;x+=3){var G=g.getX(x);
var I=g.getX(x+1),P=g.getX(x+2);(G=Fd(this,w,a,lf,e,h,m,n,q,G,I,P))&&(G.faceIndex=Math.floor(x/3),G.face.materialIndex=A.materialIndex,b.push(G))}else for(t=Math.max(0,c.start),c=Math.min(g.count,c.start+c.count);t<c;t+=3)G=g.getX(t),r=g.getX(t+1),u=g.getX(t+2),(G=Fd(this,d,a,lf,e,h,m,n,q,G,r,u))&&(G.faceIndex=Math.floor(t/3),b.push(G));else if(void 0!==e)if(Array.isArray(d))for(g=0,r=t.length;g<r;g++)for(u=t[g],A=d[u.materialIndex],w=Math.max(u.start,c.start),x=Math.min(e.count,Math.min(u.start+
u.count,c.start+c.count));w<x;w+=3)(G=Fd(this,A,a,lf,e,h,m,n,q,w,w+1,w+2))&&(G.faceIndex=Math.floor(w/3),G.face.materialIndex=u.materialIndex,b.push(G));else for(t=Math.max(0,c.start),c=Math.min(e.count,c.start+c.count);t<c;t+=3)(G=Fd(this,d,a,lf,e,h,m,n,q,t,t+1,t+2))&&(G.faceIndex=Math.floor(t/3),b.push(G))}else c.isGeometry&&console.error("THREE.Mesh.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")};vb.prototype.isMesh=!0;var ad=function(a,b,c,d,e,g){function h(x,
C,G,I,P,O,M,S,V,ba,Y){var Z=O/V,Ha=M/ba,ya=O/2,ja=M/2,Ja=S/2;O=V+1;for(var Va=ba+1,db=M=0,Xa=new B,Qa=0;Qa<Va;Qa++)for(var D=Qa*Ha-ja,E=0;E<O;E++)Xa[x]=(E*Z-ya)*I,Xa[C]=D*P,Xa[G]=Ja,t.push(Xa.x,Xa.y,Xa.z),Xa[x]=0,Xa[C]=0,Xa[G]=0<S?1:-1,r.push(Xa.x,Xa.y,Xa.z),u.push(E/V),u.push(1-Qa/ba),M+=1;for(x=0;x<ba;x++)for(C=0;C<V;C++)G=A+C+O*(x+1),I=A+(C+1)+O*(x+1),P=A+(C+1)+O*x,q.push(A+C+O*x,G,P),q.push(G,I,P),db+=6;n.addGroup(w,db,Y);w+=db;A+=M}a=void 0===a?1:a;b=void 0===b?1:b;c=void 0===c?1:c;d=void 0===
d?1:d;e=void 0===e?1:e;g=void 0===g?1:g;var m=ra.call(this)||this;m.type="BoxGeometry";m.parameters={width:a,height:b,depth:c,widthSegments:d,heightSegments:e,depthSegments:g};var n=m;d=Math.floor(d);e=Math.floor(e);g=Math.floor(g);var q=[],t=[],r=[],u=[],A=0,w=0;h("z","y","x",-1,-1,c,b,a,g,e,0);h("z","y","x",1,-1,c,b,-a,g,e,1);h("x","z","y",1,1,a,c,b,d,g,2);h("x","z","y",1,-1,a,c,-b,d,g,3);h("x","y","z",1,-1,a,b,c,d,e,4);h("x","y","z",-1,-1,a,b,-c,d,e,5);m.setIndex(q);m.setAttribute("position",new Ma(t,
3));m.setAttribute("normal",new Ma(r,3));m.setAttribute("uv",new Ma(u,2));return m};$jscomp.inherits(ad,ra);ad.fromJSON=function(a){return new ad(a.width,a.height,a.depth,a.widthSegments,a.heightSegments,a.depthSegments)};var Gj={clone:$c,merge:Ub},Bc=function(a){var b=Oa.call(this)||this;b.type="ShaderMaterial";b.defines={};b.uniforms={};b.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}";b.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}";
b.linewidth=1;b.wireframe=!1;b.wireframeLinewidth=1;b.fog=!1;b.lights=!1;b.clipping=!1;b.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1};b.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]};b.index0AttributeName=void 0;b.uniformsNeedUpdate=!1;b.glslVersion=null;void 0!==a&&(void 0!==a.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),b.setValues(a));return b};$jscomp.inherits(Bc,Oa);Bc.prototype.copy=
function(a){return Oa.prototype.copy.call(this,a),this.fragmentShader=a.fragmentShader,this.vertexShader=a.vertexShader,this.uniforms=$c(a.uniforms),this.defines=Object.assign({},a.defines),this.wireframe=a.wireframe,this.wireframeLinewidth=a.wireframeLinewidth,this.lights=a.lights,this.clipping=a.clipping,this.extensions=Object.assign({},a.extensions),this.glslVersion=a.glslVersion,this};Bc.prototype.toJSON=function(a){var b=Oa.prototype.toJSON.call(this,a);b.glslVersion=this.glslVersion;b.uniforms=
{};for(var c in this.uniforms){var d=this.uniforms[c].value;d&&d.isTexture?b.uniforms[c]={type:"t",value:d.toJSON(a).uuid}:d&&d.isColor?b.uniforms[c]={type:"c",value:d.getHex()}:d&&d.isVector2?b.uniforms[c]={type:"v2",value:d.toArray()}:d&&d.isVector3?b.uniforms[c]={type:"v3",value:d.toArray()}:d&&d.isVector4?b.uniforms[c]={type:"v4",value:d.toArray()}:d&&d.isMatrix3?b.uniforms[c]={type:"m3",value:d.toArray()}:d&&d.isMatrix4?b.uniforms[c]={type:"m4",value:d.toArray()}:b.uniforms[c]={value:d}}0<Object.keys(this.defines).length&&
(b.defines=this.defines);b.vertexShader=this.vertexShader;b.fragmentShader=this.fragmentShader;a={};for(var e in this.extensions)!0===this.extensions[e]&&(a[e]=!0);return 0<Object.keys(a).length&&(b.extensions=a),b};Bc.prototype.isShaderMaterial=!0;var hc=function(){var a=la.call(this)||this;a.type="Camera";a.matrixWorldInverse=new ua;a.projectionMatrix=new ua;a.projectionMatrixInverse=new ua;return a};$jscomp.inherits(hc,la);hc.prototype.copy=function(a,b){return la.prototype.copy.call(this,a,b),
this.matrixWorldInverse.copy(a.matrixWorldInverse),this.projectionMatrix.copy(a.projectionMatrix),this.projectionMatrixInverse.copy(a.projectionMatrixInverse),this};hc.prototype.getWorldDirection=function(a){this.updateWorldMatrix(!0,!1);var b=this.matrixWorld.elements;return a.set(-b[8],-b[9],-b[10]).normalize()};hc.prototype.updateMatrixWorld=function(a){la.prototype.updateMatrixWorld.call(this,a);this.matrixWorldInverse.copy(this.matrixWorld).invert()};hc.prototype.updateWorldMatrix=function(a,
b){la.prototype.updateWorldMatrix.call(this,a,b);this.matrixWorldInverse.copy(this.matrixWorld).invert()};hc.prototype.clone=function(){return(new this.constructor).copy(this)};hc.prototype.isCamera=!0;var xb=function(a,b,c,d){a=void 0===a?50:a;b=void 0===b?1:b;c=void 0===c?.1:c;d=void 0===d?2E3:d;var e=hc.call(this)||this;e.type="PerspectiveCamera";e.fov=a;e.zoom=1;e.near=c;e.far=d;e.focus=10;e.aspect=b;e.view=null;e.filmGauge=35;e.filmOffset=0;e.updateProjectionMatrix();return e};$jscomp.inherits(xb,
hc);xb.prototype.copy=function(a,b){return hc.prototype.copy.call(this,a,b),this.fov=a.fov,this.zoom=a.zoom,this.near=a.near,this.far=a.far,this.focus=a.focus,this.aspect=a.aspect,this.view=null===a.view?null:Object.assign({},a.view),this.filmGauge=a.filmGauge,this.filmOffset=a.filmOffset,this};xb.prototype.setFocalLength=function(a){a=.5*this.getFilmHeight()/a;this.fov=2*$f*Math.atan(a);this.updateProjectionMatrix()};xb.prototype.getFocalLength=function(){var a=Math.tan(.5*qe*this.fov);return.5*
this.getFilmHeight()/a};xb.prototype.getEffectiveFOV=function(){return 2*$f*Math.atan(Math.tan(.5*qe*this.fov)/this.zoom)};xb.prototype.getFilmWidth=function(){return this.filmGauge*Math.min(this.aspect,1)};xb.prototype.getFilmHeight=function(){return this.filmGauge/Math.max(this.aspect,1)};xb.prototype.setViewOffset=function(a,b,c,d,e,g){this.aspect=a/b;null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1});this.view.enabled=!0;this.view.fullWidth=
a;this.view.fullHeight=b;this.view.offsetX=c;this.view.offsetY=d;this.view.width=e;this.view.height=g;this.updateProjectionMatrix()};xb.prototype.clearViewOffset=function(){null!==this.view&&(this.view.enabled=!1);this.updateProjectionMatrix()};xb.prototype.updateProjectionMatrix=function(){var a=this.near,b=a*Math.tan(.5*qe*this.fov)/this.zoom,c=2*b,d=this.aspect*c,e=-.5*d,g=this.view;if(null!==this.view&&this.view.enabled){var h=g.fullWidth,m=g.fullHeight;e+=g.offsetX*d/h;b-=g.offsetY*c/m;d*=g.width/
h;c*=g.height/m}g=this.filmOffset;0!==g&&(e+=a*g/this.getFilmWidth());this.projectionMatrix.makePerspective(e,e+d,b,b-c,a,this.far);this.projectionMatrixInverse.copy(this.projectionMatrix).invert()};xb.prototype.toJSON=function(a){a=hc.prototype.toJSON.call(this,a);return a.object.fov=this.fov,a.object.zoom=this.zoom,a.object.near=this.near,a.object.far=this.far,a.object.focus=this.focus,a.object.aspect=this.aspect,null!==this.view&&(a.object.view=Object.assign({},this.view)),a.object.filmGauge=this.filmGauge,
a.object.filmOffset=this.filmOffset,a};xb.prototype.isPerspectiveCamera=!0;var mf=function(a,b,c){var d;if(d=la.call(this)||this,d.type="CubeCamera",!0!==c.isWebGLCubeRenderTarget)return void console.error("THREE.CubeCamera: The constructor now expects an instance of WebGLCubeRenderTarget as third parameter.");d.renderTarget=c;c=new xb(90,1,a,b);c.layers=d.layers;c.up.set(0,-1,0);c.lookAt(new B(1,0,0));d.add(c);c=new xb(90,1,a,b);c.layers=d.layers;c.up.set(0,-1,0);c.lookAt(new B(-1,0,0));d.add(c);
c=new xb(90,1,a,b);c.layers=d.layers;c.up.set(0,0,1);c.lookAt(new B(0,1,0));d.add(c);c=new xb(90,1,a,b);c.layers=d.layers;c.up.set(0,0,-1);c.lookAt(new B(0,-1,0));d.add(c);c=new xb(90,1,a,b);c.layers=d.layers;c.up.set(0,-1,0);c.lookAt(new B(0,0,1));d.add(c);a=new xb(90,1,a,b);a.layers=d.layers;a.up.set(0,-1,0);a.lookAt(new B(0,0,-1));d.add(a);return d};$jscomp.inherits(mf,la);mf.prototype.update=function(a,b){null===this.parent&&this.updateMatrixWorld();var c=this.renderTarget,d=$jscomp.makeIterator(this.children),
e=d.next().value,g=d.next().value,h=d.next().value,m=d.next().value,n=d.next().value;d=d.next().value;var q=a.xr.enabled,t=a.getRenderTarget();a.xr.enabled=!1;var r=c.texture.generateMipmaps;c.texture.generateMipmaps=!1;a.setRenderTarget(c,0);a.render(b,e);a.setRenderTarget(c,1);a.render(b,g);a.setRenderTarget(c,2);a.render(b,h);a.setRenderTarget(c,3);a.render(b,m);a.setRenderTarget(c,4);a.render(b,n);c.texture.generateMipmaps=r;a.setRenderTarget(c,5);a.render(b,d);a.setRenderTarget(t);a.xr.enabled=
q};var Ud=function(a,b,c,d,e,g,h,m,n,q){a=mb.call(this,void 0!==a?a:[],void 0!==b?b:301,c,d,e,g,h,m,n,q)||this;a.flipY=!1;return a};$jscomp.inherits(Ud,mb);$jscomp.global.Object.defineProperties(Ud.prototype,{images:{configurable:!0,enumerable:!0,get:function(){return this.image},set:function(a){this.image=a}}});Ud.prototype.isCubeTexture=!0;var ge=function(a,b,c){Number.isInteger(b)&&(console.warn("THREE.WebGLCubeRenderTarget: constructor signature is now WebGLCubeRenderTarget( size, options )"),
b=c);a=Rb.call(this,a,a,b)||this;b=b||{};a.texture=new Ud(void 0,b.mapping,b.wrapS,b.wrapT,b.magFilter,b.minFilter,b.format,b.type,b.anisotropy,b.encoding);a.texture.isRenderTargetTexture=!0;a.texture.generateMipmaps=void 0!==b.generateMipmaps&&b.generateMipmaps;a.texture.minFilter=void 0!==b.minFilter?b.minFilter:1006;a.texture._needsFlipEnvMap=!1;return a};$jscomp.inherits(ge,Rb);ge.prototype.fromEquirectangularTexture=function(a,b){this.texture.type=b.type;this.texture.format=1023;this.texture.encoding=
b.encoding;this.texture.generateMipmaps=b.generateMipmaps;this.texture.minFilter=b.minFilter;this.texture.magFilter=b.magFilter;var c=new ad(5,5,5),d=new Bc({name:"CubemapFromEquirect",uniforms:$c({tEquirect:{value:null}}),vertexShader:"\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",
fragmentShader:"\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t",side:1,blending:0});d.uniforms.tEquirect.value=b;c=new vb(c,d);d=b.minFilter;1008===b.minFilter&&(b.minFilter=1006);return(new mf(1,10,this)).update(a,
c),b.minFilter=d,c.geometry.dispose(),c.material.dispose(),this};ge.prototype.clear=function(a,b,c,d){for(var e=a.getRenderTarget(),g=0;6>g;g++)a.setRenderTarget(this,g),a.clear(b,c,d);a.setRenderTarget(e)};ge.prototype.isWebGLCubeRenderTarget=!0;var Pi=new B,Xl=new B,Yl=new fb,zb=function(a,b){this.normal=a=void 0===a?new B(1,0,0):a;this.constant=void 0===b?0:b};zb.prototype.set=function(a,b){return this.normal.copy(a),this.constant=b,this};zb.prototype.setComponents=function(a,b,c,d){return this.normal.set(a,
b,c),this.constant=d,this};zb.prototype.setFromNormalAndCoplanarPoint=function(a,b){return this.normal.copy(a),this.constant=-b.dot(this.normal),this};zb.prototype.setFromCoplanarPoints=function(a,b,c){b=Pi.subVectors(c,b).cross(Xl.subVectors(a,b)).normalize();return this.setFromNormalAndCoplanarPoint(b,a),this};zb.prototype.copy=function(a){return this.normal.copy(a.normal),this.constant=a.constant,this};zb.prototype.normalize=function(){var a=1/this.normal.length();return this.normal.multiplyScalar(a),
this.constant*=a,this};zb.prototype.negate=function(){return this.constant*=-1,this.normal.negate(),this};zb.prototype.distanceToPoint=function(a){return this.normal.dot(a)+this.constant};zb.prototype.distanceToSphere=function(a){return this.distanceToPoint(a.center)-a.radius};zb.prototype.projectPoint=function(a,b){return b.copy(this.normal).multiplyScalar(-this.distanceToPoint(a)).add(a)};zb.prototype.intersectLine=function(a,b){var c=a.delta(Pi),d=this.normal.dot(c);if(0===d)return 0===this.distanceToPoint(a.start)?
b.copy(a.start):null;d=-(a.start.dot(this.normal)+this.constant)/d;return 0>d||1<d?null:b.copy(c).multiplyScalar(d).add(a.start)};zb.prototype.intersectsLine=function(a){var b=this.distanceToPoint(a.start);a=this.distanceToPoint(a.end);return 0>b&&0<a||0>a&&0<b};zb.prototype.intersectsBox=function(a){return a.intersectsPlane(this)};zb.prototype.intersectsSphere=function(a){return a.intersectsPlane(this)};zb.prototype.coplanarPoint=function(a){return a.copy(this.normal).multiplyScalar(-this.constant)};
zb.prototype.applyMatrix4=function(a,b){b=b||Yl.getNormalMatrix(a);a=this.coplanarPoint(Pi).applyMatrix4(a);b=this.normal.applyMatrix3(b).normalize();return this.constant=-a.dot(b),this};zb.prototype.translate=function(a){return this.constant-=a.dot(this.normal),this};zb.prototype.equals=function(a){return a.normal.equals(this.normal)&&a.constant===this.constant};zb.prototype.clone=function(){return(new this.constructor).copy(this)};zb.prototype.isPlane=!0;var nf=new Fb,lh=new B,wc=function(a,b,c,
d,e,g){a=void 0===a?new zb:a;b=void 0===b?new zb:b;c=void 0===c?new zb:c;d=void 0===d?new zb:d;e=void 0===e?new zb:e;g=void 0===g?new zb:g;this.planes=[a,b,c,d,e,g]};wc.prototype.set=function(a,b,c,d,e,g){var h=this.planes;return h[0].copy(a),h[1].copy(b),h[2].copy(c),h[3].copy(d),h[4].copy(e),h[5].copy(g),this};wc.prototype.copy=function(a){for(var b=this.planes,c=0;6>c;c++)b[c].copy(a.planes[c]);return this};wc.prototype.setFromProjectionMatrix=function(a){var b=this.planes,c=a.elements;a=c[0];
var d=c[1],e=c[2],g=c[3],h=c[4],m=c[5],n=c[6],q=c[7],t=c[8],r=c[9],u=c[10],A=c[11],w=c[12],x=c[13],C=c[14];c=c[15];return b[0].setComponents(g-a,q-h,A-t,c-w).normalize(),b[1].setComponents(g+a,q+h,A+t,c+w).normalize(),b[2].setComponents(g+d,q+m,A+r,c+x).normalize(),b[3].setComponents(g-d,q-m,A-r,c-x).normalize(),b[4].setComponents(g-e,q-n,A-u,c-C).normalize(),b[5].setComponents(g+e,q+n,A+u,c+C).normalize(),this};wc.prototype.intersectsObject=function(a){var b=a.geometry;return null===b.boundingSphere&&
b.computeBoundingSphere(),nf.copy(b.boundingSphere).applyMatrix4(a.matrixWorld),this.intersectsSphere(nf)};wc.prototype.intersectsSprite=function(a){return nf.center.set(0,0,0),nf.radius=.7071067811865476,nf.applyMatrix4(a.matrixWorld),this.intersectsSphere(nf)};wc.prototype.intersectsSphere=function(a){var b=this.planes,c=a.center;a=-a.radius;for(var d=0;6>d;d++)if(b[d].distanceToPoint(c)<a)return!1;return!0};wc.prototype.intersectsBox=function(a){for(var b=this.planes,c=0;6>c;c++){var d=b[c];if(lh.x=
0<d.normal.x?a.max.x:a.min.x,lh.y=0<d.normal.y?a.max.y:a.min.y,lh.z=0<d.normal.z?a.max.z:a.min.z,0>d.distanceToPoint(lh))return!1}return!0};wc.prototype.containsPoint=function(a){for(var b=this.planes,c=0;6>c;c++)if(0>b[c].distanceToPoint(a))return!1;return!0};wc.prototype.clone=function(){return(new this.constructor).copy(this)};var Gd=function(a,b,c,d){a=void 0===a?1:a;b=void 0===b?1:b;c=void 0===c?1:c;d=void 0===d?1:d;var e=ra.call(this)||this;e.type="PlaneGeometry";e.parameters={width:a,height:b,
widthSegments:c,heightSegments:d};var g=a/2,h=b/2;c=Math.floor(c);d=Math.floor(d);var m=c+1,n=d+1,q=a/c,t=b/d;b=[];a=[];for(var r=[],u=[],A=0;A<n;A++)for(var w=A*t-h,x=0;x<m;x++)a.push(x*q-g,-w,0),r.push(0,0,1),u.push(x/c),u.push(1-A/d);for(g=0;g<d;g++)for(h=0;h<c;h++)n=h+m*(g+1),q=h+1+m*(g+1),t=h+1+m*g,b.push(h+m*g,n,t),b.push(n,q,t);e.setIndex(b);e.setAttribute("position",new Ma(a,3));e.setAttribute("normal",new Ma(r,3));e.setAttribute("uv",new Ma(u,2));return e};$jscomp.inherits(Gd,ra);Gd.fromJSON=
function(a){return new Gd(a.width,a.height,a.widthSegments,a.heightSegments)};var jb={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef USE_ALPHATEST\n\tif ( diffuseColor.a < alphaTest ) discard;\n#endif",alphatest_pars_fragment:"#ifdef USE_ALPHATEST\n\tuniform float alphaTest;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );\n\t#endif\n#endif",
aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"vec3 transformed = vec3( position );",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"vec3 BRDF_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( f0, f90, dotVH );\n\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( V * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, 1.0, dotVH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie( float roughness, float dotNH ) {\n\tfloat alpha = pow2( roughness );\n\tfloat invAlpha = 1.0 / alpha;\n\tfloat cos2h = dotNH * dotNH;\n\tfloat sin2h = max( 1.0 - cos2h, 0.0078125 );\n\treturn ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\n}\nfloat V_Neubelt( float dotNV, float dotNL ) {\n\treturn saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );\n}\nvec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat D = D_Charlie( sheenRoughness, dotNH );\n\tfloat V = V_Neubelt( dotNV, dotNL );\n\treturn sheenColor * ( D * V );\n}\n#endif",
bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",
clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#pragma unroll_loop_end\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",
clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#if defined( USE_COLOR_ALPHA )\n\tdiffuseColor *= vColor;\n#elif defined( USE_COLOR )\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR )\n\tvarying vec3 vColor;\n#endif",
color_pars_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement( a ) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract( sin( sn ) * c );\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal;\n#endif\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat linearToRelativeLuminance( const in vec3 color ) {\n\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\n\treturn dot( weights, color.rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}",
cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_maxMipLevel 8.0\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_maxTileSize 256.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\tfloat texelSize = 1.0 / ( 3.0 * cubeUV_maxTileSize );\n\t\tvec2 uv = getUV( direction, face ) * ( faceSize - 1.0 );\n\t\tvec2 f = fract( uv );\n\t\tuv += 0.5 - f;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tif ( mipInt < cubeUV_maxMipLevel ) {\n\t\t\tuv.y += 2.0 * cubeUV_maxTileSize;\n\t\t}\n\t\tuv.y += filterInt * 2.0 * cubeUV_minTileSize;\n\t\tuv.x += 3.0 * max( 0.0, cubeUV_maxTileSize - 2.0 * faceSize );\n\t\tuv *= texelSize;\n\t\tvec3 tl = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n\t\tuv.x += texelSize;\n\t\tvec3 tr = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n\t\tuv.y += texelSize;\n\t\tvec3 br = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n\t\tuv.x -= texelSize;\n\t\tvec3 bl = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n\t\tvec3 tm = mix( tl, tr, f.x );\n\t\tvec3 bm = mix( bl, br, f.x );\n\t\treturn mix( tm, bm, f.y );\n\t}\n\t#define r0 1.0\n\t#define v0 0.339\n\t#define m0 - 2.0\n\t#define r1 0.8\n\t#define v1 0.276\n\t#define m1 - 1.0\n\t#define r4 0.4\n\t#define v4 0.046\n\t#define m4 2.0\n\t#define r5 0.305\n\t#define v5 0.016\n\t#define m5 3.0\n\t#define r6 0.21\n\t#define v6 0.0038\n\t#define m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= r1 ) {\n\t\t\tmip = ( r0 - roughness ) * ( m1 - m0 ) / ( r0 - r1 ) + m0;\n\t\t} else if ( roughness >= r4 ) {\n\t\t\tmip = ( r1 - roughness ) * ( m4 - m1 ) / ( r1 - r4 ) + m1;\n\t\t} else if ( roughness >= r5 ) {\n\t\t\tmip = ( r4 - roughness ) * ( m5 - m4 ) / ( r4 - r5 ) + m4;\n\t\t} else if ( roughness >= r6 ) {\n\t\t\tmip = ( r5 - roughness ) * ( m6 - m5 ) / ( r5 - r6 ) + m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), m0, cubeUV_maxMipLevel );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",
defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_INSTANCING\n\tmat3 m = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n\ttransformedNormal = m * transformedNormal;\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",
displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\temissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",
emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",encodings_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment:"\nvec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( gammaFactor ) ), value.a );\n}\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( 1.0 / gammaFactor ) ), value.a );\n}\nvec4 sRGBToLinear( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}\nvec4 RGBEToLinear( in vec4 value ) {\n\treturn vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\n}\nvec4 LinearToRGBE( in vec4 value ) {\n\tfloat maxComponent = max( max( value.r, value.g ), value.b );\n\tfloat fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\n\treturn vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\n}\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * value.a * maxRange, 1.0 );\n}\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat M = clamp( maxRGB / maxRange, 0.0, 1.0 );\n\tM = ceil( M * 255.0 ) / 255.0;\n\treturn vec4( value.rgb / ( M * maxRange ), M );\n}\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\n}\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat D = max( maxRange / maxRGB, 1.0 );\n\tD = clamp( floor( D ) / 255.0, 0.0, 1.0 );\n\treturn vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\n}\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\nvec4 LinearToLogLuv( in vec4 value ) {\n\tvec3 Xp_Y_XYZp = cLogLuvM * value.rgb;\n\tXp_Y_XYZp = max( Xp_Y_XYZp, vec3( 1e-6, 1e-6, 1e-6 ) );\n\tvec4 vResult;\n\tvResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\n\tfloat Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\n\tvResult.w = fract( Le );\n\tvResult.z = ( Le - ( floor( vResult.w * 255.0 ) ) / 255.0 ) / 255.0;\n\treturn vResult;\n}\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\nvec4 LogLuvToLinear( in vec4 value ) {\n\tfloat Le = value.z * 255.0 + value.w;\n\tvec3 Xp_Y_XYZp;\n\tXp_Y_XYZp.y = exp2( ( Le - 127.0 ) / 2.0 );\n\tXp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\n\tXp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\n\tvec3 vRGB = cLogLuvInverseM * Xp_Y_XYZp.rgb;\n\treturn vec4( max( vRGB, 0.0 ), 1.0 );\n}",
envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t\tenvColor = envMapTexelToLinear( envColor );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",
envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\tuniform int maxMipLevel;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",
envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#if defined( USE_ENVMAP )\n\t#ifdef ENVMAP_MODE_REFRACTION\n\t\tuniform float refractionRatio;\n\t#endif\n\tvec3 getIBLIrradiance( const in vec3 normal ) {\n\t\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\t\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\tvec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {\n\t\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 reflectVec;\n\t\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\t\treflectVec = reflect( - viewDir, normal );\n\t\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t\t#else\n\t\t\t\treflectVec = refract( - viewDir, normal, refractionRatio );\n\t\t\t#endif\n\t\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\t\t\treturn envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n#endif",
envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",
fog_vertex:"#ifdef USE_FOG\n\tvFogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float vFogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, vFogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float vFogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",
gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn texture2D( gradientMap, coord ).rgb;\n\t#else\n\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t#endif\n}",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\tvec3 lightMapIrradiance = lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tlightMapIrradiance *= PI;\n\t#endif\n\treflectedLight.indirectDiffuse += lightMapIrradiance;\n#endif",
lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_vertex:"vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\nvIndirectFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n\tvIndirectBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\nvIndirectFront += getAmbientLightIrradiance( ambientLightColor );\nvIndirectFront += getLightProbeIrradiance( lightProbe, geometry.normal );\n#ifdef DOUBLE_SIDED\n\tvIndirectBack += getAmbientLightIrradiance( ambientLightColor );\n\tvIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry.normal );\n#endif\n#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointLightInfo( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( - dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotLightInfo( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( - dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalLightInfo( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( - dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry.normal );\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif",
lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {\n\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\treturn irradiance;\n}\nfloat getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\t#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\tif ( cutoffDistance > 0.0 ) {\n\t\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\t}\n\t\treturn distanceFalloff;\n\t#else\n\t\tif ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\t\treturn pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t\t}\n\t\treturn 1.0;\n\t#endif\n}\nfloat getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {\n\treturn smoothstep( coneCosine, penumbraCosine, angleCosine );\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tlight.color = directionalLight.color;\n\t\tlight.direction = directionalLight.direction;\n\t\tlight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tlight.color = pointLight.color;\n\t\tlight.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );\n\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat angleCos = dot( light.direction, spotLight.direction );\n\t\tfloat spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\tif ( spotAttenuation > 0.0 ) {\n\t\t\tfloat lightDistance = length( lVector );\n\t\t\tlight.color = spotLight.color * spotAttenuation;\n\t\t\tlight.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t\t} else {\n\t\t\tlight.color = vec3( 0.0 );\n\t\t\tlight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {\n\t\tfloat dotNL = dot( normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\treturn irradiance;\n\t}\n#endif",
lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon\n#define Material_LightProbeLOD( material )\t(0)",
lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)",
lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;\nmaterial.roughness = min( material.roughness, 1.0 );\n#ifdef IOR\n\t#ifdef SPECULAR\n\t\tfloat specularIntensityFactor = specularIntensity;\n\t\tvec3 specularColorFactor = specularColor;\n\t\t#ifdef USE_SPECULARINTENSITYMAP\n\t\t\tspecularIntensityFactor *= texture2D( specularIntensityMap, vUv ).a;\n\t\t#endif\n\t\t#ifdef USE_SPECULARCOLORMAP\n\t\t\tspecularColorFactor *= specularColorMapTexelToLinear( texture2D( specularColorMap, vUv ) ).rgb;\n\t\t#endif\n\t\tmaterial.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );\n\t#else\n\t\tfloat specularIntensityFactor = 1.0;\n\t\tvec3 specularColorFactor = vec3( 1.0 );\n\t\tmaterial.specularF90 = 1.0;\n\t#endif\n\tmaterial.specularColor = mix( min( pow2( ( ior - 1.0 ) / ( ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.specularF90 = 1.0;\n#endif\n#ifdef USE_CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\tmaterial.clearcoatF0 = vec3( 0.04 );\n\tmaterial.clearcoatF90 = 1.0;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheenColor;\n\t#ifdef USE_SHEENCOLORMAP\n\t\tmaterial.sheenColor *= sheenColorMapTexelToLinear( texture2D( sheenColorMap, vUv ) ).rgb;\n\t#endif\n\tmaterial.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );\n\t#ifdef USE_SHEENROUGHNESSMAP\n\t\tmaterial.sheenRoughness *= texture2D( sheenRoughnessMap, vUv ).a;\n\t#endif\n#endif",
lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat roughness;\n\tvec3 specularColor;\n\tfloat specularF90;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat clearcoat;\n\t\tfloat clearcoatRoughness;\n\t\tvec3 clearcoatF0;\n\t\tfloat clearcoatF90;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tvec3 sheenColor;\n\t\tfloat sheenRoughness;\n\t#endif\n};\nvec3 clearcoatSpecular = vec3( 0.0 );\nvec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;\n\treturn fab;\n}\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\treturn specularColor * fab.x + specularF90 * fab.y;\n}\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\tvec3 FssEss = specularColor * fab.x + specularF90 * fab.y;\n\tfloat Ess = fab.x + fab.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.roughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(\t\t0, 1,\t\t0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = dotNLcc * directLight.color;\n\t\tclearcoatSpecular += ccIrradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\treflectedLight.directSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );\n\t#endif\n\treflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.roughness );\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\tcomputeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );\n\treflectedLight.indirectSpecular += radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",
lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\n#ifdef USE_CLEARCOAT\n\tgeometry.clearcoatNormal = clearcoatNormal;\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointLightInfo( pointLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotLightInfo( spotLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalLightInfo( directionalLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\tirradiance += getLightProbeIrradiance( lightProbe, geometry.normal );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",
lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\t\tvec3 lightMapIrradiance = lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tlightMapIrradiance *= PI;\n\t\t#endif\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getIBLIrradiance( geometry.normal );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );\n\t#endif\n#endif",
lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",
logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",
map_fragment:"#ifdef USE_MAP\n\tvec4 texelColor = texture2D( map, vUv );\n\ttexelColor = mapTexelToLinear( texelColor );\n\tdiffuseColor *= texelColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n#endif\n#ifdef USE_MAP\n\tvec4 mapTexel = texture2D( map, uv );\n\tdiffuseColor *= mapTexelToLinear( mapTexel );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",
map_particle_pars_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tuniform mat3 uvTransform;\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",
morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] > 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1, 2 ) * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\t\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\t\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\t\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n\t#endif\n#endif",
morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\tuniform float morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tuniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\t\tuniform sampler2DArray morphTargetsTexture;\n\t\tuniform vec2 morphTargetsTextureSize;\n\t\tvec3 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset, const in int stride ) {\n\t\t\tfloat texelIndex = float( vertexIndex * stride + offset );\n\t\t\tfloat y = floor( texelIndex / morphTargetsTextureSize.x );\n\t\t\tfloat x = texelIndex - y * morphTargetsTextureSize.x;\n\t\t\tvec3 morphUV = vec3( ( x + 0.5 ) / morphTargetsTextureSize.x, y / morphTargetsTextureSize.y, morphTargetIndex );\n\t\t\treturn texture( morphTargetsTexture, morphUV ).xyz;\n\t\t}\n\t#else\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\tuniform float morphTargetInfluences[ 8 ];\n\t\t#else\n\t\t\tuniform float morphTargetInfluences[ 4 ];\n\t\t#endif\n\t#endif\n#endif",
morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\t#ifndef USE_MORPHNORMALS\n\t\t\t\tif ( morphTargetInfluences[ i ] > 0.0 ) transformed += getMorph( gl_VertexID, i, 0, 1 ) * morphTargetInfluences[ i ];\n\t\t\t#else\n\t\t\t\tif ( morphTargetInfluences[ i ] > 0.0 ) transformed += getMorph( gl_VertexID, i, 0, 2 ) * morphTargetInfluences[ i ];\n\t\t\t#endif\n\t\t}\n\t#else\n\t\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\t\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\t\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\t\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\t\t\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\t\t\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\t\t\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t\t#endif\n\t#endif\n#endif",
normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\t#ifdef USE_TANGENT\n\t\tvec3 tangent = normalize( vTangent );\n\t\tvec3 bitangent = normalize( vBitangent );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\ttangent = tangent * faceDirection;\n\t\t\tbitangent = bitangent * faceDirection;\n\t\t#endif\n\t\t#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tmat3 vTBN = mat3( tangent, bitangent, normal );\n\t\t#endif\n\t#endif\n#endif\nvec3 geometryNormal = normal;",
normal_fragment_maps:"#ifdef OBJECTSPACE_NORMALMAP\n\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( TANGENTSPACE_NORMALMAP )\n\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\t#ifdef USE_TANGENT\n\t\tnormal = normalize( vTBN * mapN );\n\t#else\n\t\tnormal = perturbNormal2Arb( - vViewPosition, normal, mapN, faceDirection );\n\t#endif\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",
normal_pars_fragment:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_pars_vertex:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_vertex:"#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif",
normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef OBJECTSPACE_NORMALMAP\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {\n\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );\n\t\treturn normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );\n\t}\n#endif",
clearcoat_normal_fragment_begin:"#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal = geometryNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\t#ifdef USE_TANGENT\n\t\tclearcoatNormal = normalize( vTBN * clearcoatMapN );\n\t#else\n\t\tclearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );\n\t#endif\n#endif",
clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif",output_fragment:"#ifdef OPAQUE\ndiffuseColor.a = 1.0;\n#endif\n#ifdef USE_TRANSMISSION\ndiffuseColor.a *= transmissionAlpha + 0.1;\n#endif\ngl_FragColor = vec4( outgoingLight, diffuseColor.a );",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}",
premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",
roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t\tf.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), \n\t\t\t\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t\tf.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",
shadowmap_pars_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",
shadowmap_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0 || NUM_SPOT_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0\n\t\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\tvec4 shadowWorldPosition;\n\t#endif\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n#endif",
shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",
skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform highp sampler2D boneTexture;\n\t\tuniform int boneTextureSize;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif",
skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",
specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(\t1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,\t1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,\t1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",
transmission_fragment:"#ifdef USE_TRANSMISSION\n\tfloat transmissionAlpha = 1.0;\n\tfloat transmissionFactor = transmission;\n\tfloat thicknessFactor = thickness;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\ttransmissionFactor *= texture2D( transmissionMap, vUv ).r;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tthicknessFactor *= texture2D( thicknessMap, vUv ).g;\n\t#endif\n\tvec3 pos = vWorldPosition;\n\tvec3 v = normalize( cameraPosition - pos );\n\tvec3 n = inverseTransformDirection( normal, viewMatrix );\n\tvec4 transmission = getIBLVolumeRefraction(\n\t\tn, v, roughnessFactor, material.diffuseColor, material.specularColor, material.specularF90,\n\t\tpos, modelMatrix, viewMatrix, projectionMatrix, ior, thicknessFactor,\n\t\tattenuationColor, attenuationDistance );\n\ttotalDiffuse = mix( totalDiffuse, transmission.rgb, transmissionFactor );\n\ttransmissionAlpha = mix( transmissionAlpha, transmission.a, transmissionFactor );\n#endif",
transmission_pars_fragment:"#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform float attenuationDistance;\n\tuniform vec3 attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tuniform sampler2D transmissionMap;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tuniform sampler2D thicknessMap;\n\t#endif\n\tuniform vec2 transmissionSamplerSize;\n\tuniform sampler2D transmissionSamplerMap;\n\tuniform mat4 modelMatrix;\n\tuniform mat4 projectionMatrix;\n\tvarying vec3 vWorldPosition;\n\tvec3 getVolumeTransmissionRay( vec3 n, vec3 v, float thickness, float ior, mat4 modelMatrix ) {\n\t\tvec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n\t\tvec3 modelScale;\n\t\tmodelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n\t\tmodelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n\t\tmodelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n\t\treturn normalize( refractionVector ) * thickness * modelScale;\n\t}\n\tfloat applyIorToRoughness( float roughness, float ior ) {\n\t\treturn roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n\t}\n\tvec4 getTransmissionSample( vec2 fragCoord, float roughness, float ior ) {\n\t\tfloat framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\treturn texture2DLodEXT( transmissionSamplerMap, fragCoord.xy, framebufferLod );\n\t\t#else\n\t\t\treturn texture2D( transmissionSamplerMap, fragCoord.xy, framebufferLod );\n\t\t#endif\n\t}\n\tvec3 applyVolumeAttenuation( vec3 radiance, float transmissionDistance, vec3 attenuationColor, float attenuationDistance ) {\n\t\tif ( attenuationDistance == 0.0 ) {\n\t\t\treturn radiance;\n\t\t} else {\n\t\t\tvec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n\t\t\tvec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );\t\t\treturn transmittance * radiance;\n\t\t}\n\t}\n\tvec4 getIBLVolumeRefraction( vec3 n, vec3 v, float roughness, vec3 diffuseColor, vec3 specularColor, float specularF90,\n\t\tvec3 position, mat4 modelMatrix, mat4 viewMatrix, mat4 projMatrix, float ior, float thickness,\n\t\tvec3 attenuationColor, float attenuationDistance ) {\n\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\trefractionCoords += 1.0;\n\t\trefractionCoords /= 2.0;\n\t\tvec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n\t\tvec3 attenuatedColor = applyVolumeAttenuation( transmittedLight.rgb, length( transmissionRay ), attenuationColor, attenuationDistance );\n\t\tvec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n\t\treturn vec4( ( 1.0 - F ) * attenuatedColor * diffuseColor, transmittedLight.a );\n\t}\n#endif",
uv_pars_fragment:"#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#ifdef USE_UV\n\t#ifdef UVS_VERTEX_ONLY\n\t\tvec2 vUv;\n\t#else\n\t\tvarying vec2 vUv;\n\t#endif\n\tuniform mat3 uvTransform;\n#endif",uv_vertex:"#ifdef USE_UV\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n\tuniform mat3 uv2Transform;\n#endif",
uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION )\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",
background_frag:"uniform sampler2D t2D;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",cube_frag:"#include <envmap_common_pars_fragment>\nuniform float opacity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\tvec3 vReflect = vWorldDirection;\n\t#include <envmap_fragment>\n\tgl_FragColor = envColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",
depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",
depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",
distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",
distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",
equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tvec4 texColor = texture2D( tEquirect, sampleUV );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",
linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",
linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",
meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinbase_vertex>\n\t\t#include <skinnormal_vertex>\n\t\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",
meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\t\treflectedLight.indirectDiffuse += lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",
meshlambert_vert:"#define LAMBERT\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",
meshlambert_frag:"uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;\n\t#else\n\t\treflectedLight.indirectDiffuse += vIndirectFront;\n\t#endif\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",
meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",
meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t\tmatcapColor = matcapTexelToLinear( matcapColor );\n\t#else\n\t\tvec4 matcapColor = vec4( 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",
meshnormal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",
meshnormal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n}",
meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",
meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",
meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifdef USE_TRANSMISSION\n\tvarying vec3 vWorldPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n#ifdef USE_TRANSMISSION\n\tvWorldPosition = worldPosition.xyz;\n#endif\n}",
meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define IOR\n\t#define SPECULAR\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef IOR\n\tuniform float ior;\n#endif\n#ifdef SPECULAR\n\tuniform float specularIntensity;\n\tuniform vec3 specularColor;\n\t#ifdef USE_SPECULARINTENSITYMAP\n\t\tuniform sampler2D specularIntensityMap;\n\t#endif\n\t#ifdef USE_SPECULARCOLORMAP\n\t\tuniform sampler2D specularColorMap;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheenColor;\n\tuniform float sheenRoughness;\n\t#ifdef USE_SHEENCOLORMAP\n\t\tuniform sampler2D sheenColorMap;\n\t#endif\n\t#ifdef USE_SHEENROUGHNESSMAP\n\t\tuniform sampler2D sheenRoughnessMap;\n\t#endif\n#endif\nvarying vec3 vViewPosition;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_physical_pars_fragment>\n#include <transmission_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\tvec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\t#include <transmission_fragment>\n\tvec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );\n\t\tvec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\n\t\toutgoingLight = outgoingLight * ( 1.0 - clearcoat * Fcc ) + clearcoatSpecular * clearcoat;\n\t#endif\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",
meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",
meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",
points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",
points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",
shadow_vert:"#include <common>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",
shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",
sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}"},
Ca={common:{diffuse:{value:new ma(16777215)},opacity:{value:1},map:{value:null},uvTransform:{value:new fb},uv2Transform:{value:new fb},alphaMap:{value:null},alphaTest:{value:0}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98},maxMipLevel:{value:0}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},
bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new T(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:2.5E-4},fogNear:{value:1},fogFar:{value:2E3},fogColor:{value:new ma(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},
directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},
pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new ma(16777215)},
opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new fb}},sprite:{diffuse:{value:new ma(16777215)},opacity:{value:1},center:{value:new T(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new fb}}},Qc={basic:{uniforms:Ub([Ca.common,Ca.specularmap,Ca.envmap,Ca.aomap,Ca.lightmap,Ca.fog]),vertexShader:jb.meshbasic_vert,fragmentShader:jb.meshbasic_frag},lambert:{uniforms:Ub([Ca.common,
Ca.specularmap,Ca.envmap,Ca.aomap,Ca.lightmap,Ca.emissivemap,Ca.fog,Ca.lights,{emissive:{value:new ma(0)}}]),vertexShader:jb.meshlambert_vert,fragmentShader:jb.meshlambert_frag},phong:{uniforms:Ub([Ca.common,Ca.specularmap,Ca.envmap,Ca.aomap,Ca.lightmap,Ca.emissivemap,Ca.bumpmap,Ca.normalmap,Ca.displacementmap,Ca.fog,Ca.lights,{emissive:{value:new ma(0)},specular:{value:new ma(1118481)},shininess:{value:30}}]),vertexShader:jb.meshphong_vert,fragmentShader:jb.meshphong_frag},standard:{uniforms:Ub([Ca.common,
Ca.envmap,Ca.aomap,Ca.lightmap,Ca.emissivemap,Ca.bumpmap,Ca.normalmap,Ca.displacementmap,Ca.roughnessmap,Ca.metalnessmap,Ca.fog,Ca.lights,{emissive:{value:new ma(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:jb.meshphysical_vert,fragmentShader:jb.meshphysical_frag},toon:{uniforms:Ub([Ca.common,Ca.aomap,Ca.lightmap,Ca.emissivemap,Ca.bumpmap,Ca.normalmap,Ca.displacementmap,Ca.gradientmap,Ca.fog,Ca.lights,{emissive:{value:new ma(0)}}]),vertexShader:jb.meshtoon_vert,
fragmentShader:jb.meshtoon_frag},matcap:{uniforms:Ub([Ca.common,Ca.bumpmap,Ca.normalmap,Ca.displacementmap,Ca.fog,{matcap:{value:null}}]),vertexShader:jb.meshmatcap_vert,fragmentShader:jb.meshmatcap_frag},points:{uniforms:Ub([Ca.points,Ca.fog]),vertexShader:jb.points_vert,fragmentShader:jb.points_frag},dashed:{uniforms:Ub([Ca.common,Ca.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:jb.linedashed_vert,fragmentShader:jb.linedashed_frag},depth:{uniforms:Ub([Ca.common,Ca.displacementmap]),
vertexShader:jb.depth_vert,fragmentShader:jb.depth_frag},normal:{uniforms:Ub([Ca.common,Ca.bumpmap,Ca.normalmap,Ca.displacementmap,{opacity:{value:1}}]),vertexShader:jb.meshnormal_vert,fragmentShader:jb.meshnormal_frag},sprite:{uniforms:Ub([Ca.sprite,Ca.fog]),vertexShader:jb.sprite_vert,fragmentShader:jb.sprite_frag},background:{uniforms:{uvTransform:{value:new fb},t2D:{value:null}},vertexShader:jb.background_vert,fragmentShader:jb.background_frag},cube:{uniforms:Ub([Ca.envmap,{opacity:{value:1}}]),
vertexShader:jb.cube_vert,fragmentShader:jb.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:jb.equirect_vert,fragmentShader:jb.equirect_frag},distanceRGBA:{uniforms:Ub([Ca.common,Ca.displacementmap,{referencePosition:{value:new B},nearDistance:{value:1},farDistance:{value:1E3}}]),vertexShader:jb.distanceRGBA_vert,fragmentShader:jb.distanceRGBA_frag},shadow:{uniforms:Ub([Ca.lights,Ca.fog,{color:{value:new ma(0)},opacity:{value:1}}]),vertexShader:jb.shadow_vert,fragmentShader:jb.shadow_frag}};
Qc.physical={uniforms:Ub([Qc.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new T(1,1)},clearcoatNormalMap:{value:null},sheen:{value:0},sheenColor:{value:new ma(0)},sheenColorMap:{value:null},sheenRoughness:{value:0},sheenRoughnessMap:{value:null},transmission:{value:0},transmissionMap:{value:null},transmissionSamplerSize:{value:new T},transmissionSamplerMap:{value:null},thickness:{value:0},
thicknessMap:{value:null},attenuationDistance:{value:0},attenuationColor:{value:new ma(0)},specularIntensity:{value:0},specularIntensityMap:{value:null},specularColor:{value:new ma(1,1,1)},specularColorMap:{value:null}}]),vertexShader:jb.meshphysical_vert,fragmentShader:jb.meshphysical_frag};var Wc=function(a,b,c,d,e,g){a=void 0===a?-1:a;b=void 0===b?1:b;c=void 0===c?1:c;d=void 0===d?-1:d;e=void 0===e?.1:e;g=void 0===g?2E3:g;var h=hc.call(this)||this;h.type="OrthographicCamera";h.zoom=1;h.view=null;
h.left=a;h.right=b;h.top=c;h.bottom=d;h.near=e;h.far=g;h.updateProjectionMatrix();return h};$jscomp.inherits(Wc,hc);Wc.prototype.copy=function(a,b){return hc.prototype.copy.call(this,a,b),this.left=a.left,this.right=a.right,this.top=a.top,this.bottom=a.bottom,this.near=a.near,this.far=a.far,this.zoom=a.zoom,this.view=null===a.view?null:Object.assign({},a.view),this};Wc.prototype.setViewOffset=function(a,b,c,d,e,g){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,
width:1,height:1});this.view.enabled=!0;this.view.fullWidth=a;this.view.fullHeight=b;this.view.offsetX=c;this.view.offsetY=d;this.view.width=e;this.view.height=g;this.updateProjectionMatrix()};Wc.prototype.clearViewOffset=function(){null!==this.view&&(this.view.enabled=!1);this.updateProjectionMatrix()};Wc.prototype.updateProjectionMatrix=function(){var a=(this.right-this.left)/(2*this.zoom),b=(this.top-this.bottom)/(2*this.zoom),c=(this.right+this.left)/2,d=(this.top+this.bottom)/2,e=c-a;c+=a;a=
d+b;b=d-b;null!==this.view&&this.view.enabled&&(d=(this.right-this.left)/this.view.fullWidth/this.zoom,b=(this.top-this.bottom)/this.view.fullHeight/this.zoom,e+=d*this.view.offsetX,c=e+d*this.view.width,a-=b*this.view.offsetY,b=a-b*this.view.height);this.projectionMatrix.makeOrthographic(e,c,a,b,this.near,this.far);this.projectionMatrixInverse.copy(this.projectionMatrix).invert()};Wc.prototype.toJSON=function(a){a=hc.prototype.toJSON.call(this,a);return a.object.zoom=this.zoom,a.object.left=this.left,
a.object.right=this.right,a.object.top=this.top,a.object.bottom=this.bottom,a.object.near=this.near,a.object.far=this.far,null!==this.view&&(a.object.view=Object.assign({},this.view)),a};Wc.prototype.isOrthographicCamera=!0;var ie=function(a){a=Bc.call(this,a)||this;a.type="RawShaderMaterial";return a};$jscomp.inherits(ie,Bc);ie.prototype.isRawShaderMaterial=!0;var bd=Math.pow(2,8),qk=[.125,.215,.35,.446,.526,.582],rk=5+qk.length,Vd={},Hd=(Vd[3E3]=0,Vd[3001]=1,Vd[3002]=2,Vd[3004]=3,Vd[3005]=4,Vd[3006]=
5,Vd[3007]=6,Vd),Qi=new Wc,Ri=function(){for(var a=[],b=[],c=[],d=8,e=0;e<rk;e++){var g=Math.pow(2,d);b.push(g);var h=1/g;4<e?h=qk[e-8+4-1]:0==e&&(h=0);c.push(h);h=1/(g-1);g=-h/2;h=1+h/2;var m=[g,g,h,g,h,h,g,g,h,h,g,h];g=new Float32Array(108);h=new Float32Array(72);for(var n=new Float32Array(36),q=0;6>q;q++){var t=q%3*2/3-1,r=2<q?0:-1;g.set([t,r,0,t+2/3,r,0,t+2/3,r+1,0,t,r,0,t+2/3,r+1,0,t,r+1,0],18*q);h.set(m,12*q);n.set([q,q,q,q,q,q],6*q)}m=new ra;m.setAttribute("position",new Ba(g,3));m.setAttribute("uv",
new Ba(h,2));m.setAttribute("faceIndex",new Ba(n,1));a.push(m);4<d&&d--}return{_lodPlanes:a,_sizeLods:b,_sigmas:c}}(),gg=Ri._lodPlanes,sk=Ri._sizeLods,mh=Ri._sigmas,tk=new ma,Si=null,se=(1+Math.sqrt(5))/2,of=1/se,uk=[new B(1,1,1),new B(-1,1,1),new B(1,1,-1),new B(-1,1,-1),new B(0,se,of),new B(0,se,-of),new B(of,0,se),new B(-of,0,se),new B(se,of,0),new B(-se,of,0)],ac=function(a){this._renderer=a;this._pingPongRenderTarget=null;a=new Float32Array(20);var b=new B(0,1,0);this._blurMaterial=new ie({name:"SphericalGaussianBlur",
defines:{n:20},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:a},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:b},inputEncoding:{value:Hd[3E3]},outputEncoding:{value:Hd[3E3]}},vertexShader:qc(),fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t"+
If()+"\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t\tgl_FragColor = linearToOutputTexel( gl_FragColor );\n\n\t\t\t}\n\t\t",
blending:0,depthTest:!1,depthWrite:!1});this._cubemapShader=this._equirectShader=null;this._compileMaterial(this._blurMaterial)};ac.prototype.fromScene=function(a,b,c,d){b=void 0===b?0:b;c=void 0===c?.1:c;d=void 0===d?100:d;Si=this._renderer.getRenderTarget();var e=this._allocateTargets();return this._sceneToCubeUV(a,c,d,e),0<b&&this._blur(e,0,0,b),this._applyPMREM(e),this._cleanup(e),e};ac.prototype.fromEquirectangular=function(a){return this._fromTexture(a)};ac.prototype.fromCubemap=function(a){return this._fromTexture(a)};
ac.prototype.compileCubemapShader=function(){null===this._cubemapShader&&(this._cubemapShader=Pg(),this._compileMaterial(this._cubemapShader))};ac.prototype.compileEquirectangularShader=function(){null===this._equirectShader&&(this._equirectShader=he(),this._compileMaterial(this._equirectShader))};ac.prototype.dispose=function(){this._blurMaterial.dispose();null!==this._cubemapShader&&this._cubemapShader.dispose();null!==this._equirectShader&&this._equirectShader.dispose();for(var a=0;a<gg.length;a++)gg[a].dispose()};
ac.prototype._cleanup=function(a){this._pingPongRenderTarget.dispose();this._renderer.setRenderTarget(Si);a.scissorTest=!1;cd(a,0,0,a.width,a.height)};ac.prototype._fromTexture=function(a){Si=this._renderer.getRenderTarget();var b=this._allocateTargets(a);return this._textureToCubeUV(a,b),this._applyPMREM(b),this._cleanup(b),b};ac.prototype._allocateTargets=function(a){var b={magFilter:1003,minFilter:1003,generateMipmaps:!1,type:1009,format:1023,encoding:void 0===a||1009!==a.type||3E3!==a.encoding&&
3001!==a.encoding&&3007!==a.encoding?3002:a.encoding,depthBuffer:!1},c=Hf(b);return c.depthBuffer=!a,this._pingPongRenderTarget=Hf(b),c};ac.prototype._compileMaterial=function(a){a=new vb(gg[0],a);this._renderer.compile(a,Qi)};ac.prototype._sceneToCubeUV=function(a,b,c,d){b=new xb(90,1,b,c);c=[1,-1,1,1,1,1];var e=[1,1,1,-1,-1,-1],g=this._renderer,h=g.autoClear,m=g.outputEncoding,n=g.toneMapping;g.getClearColor(tk);g.toneMapping=0;g.outputEncoding=3E3;g.autoClear=!1;var q=new Vc({name:"PMREM.Background",
side:1,depthWrite:!1,depthTest:!1}),t=new vb(new ad,q),r=!1,u=a.background;u?u.isColor&&(q.color.copy(u),a.background=null,r=!0):(q.color.copy(tk),r=!0);for(q=0;6>q;q++){var A=q%3;0==A?(b.up.set(0,c[q],0),b.lookAt(e[q],0,0)):1==A?(b.up.set(0,0,c[q]),b.lookAt(0,e[q],0)):(b.up.set(0,c[q],0),b.lookAt(0,0,e[q]));cd(d,A*bd,2<q?bd:0,bd,bd);g.setRenderTarget(d);r&&g.render(t,b);g.render(a,b)}t.geometry.dispose();t.material.dispose();g.toneMapping=n;g.outputEncoding=m;g.autoClear=h;a.background=u};ac.prototype._setEncoding=
function(a,b){!0===this._renderer.capabilities.isWebGL2&&1023===b.format&&1009===b.type&&3001===b.encoding?a.value=Hd[3E3]:a.value=Hd[b.encoding]};ac.prototype._textureToCubeUV=function(a,b){var c=this._renderer,d=301===a.mapping||302===a.mapping;d?null==this._cubemapShader&&(this._cubemapShader=Pg()):null==this._equirectShader&&(this._equirectShader=he());var e=d?this._cubemapShader:this._equirectShader,g=new vb(gg[0],e);e=e.uniforms;e.envMap.value=a;d||e.texelSize.value.set(1/a.image.width,1/a.image.height);
this._setEncoding(e.inputEncoding,a);this._setEncoding(e.outputEncoding,b.texture);cd(b,0,0,3*bd,2*bd);c.setRenderTarget(b);c.render(g,Qi)};ac.prototype._applyPMREM=function(a){var b=this._renderer,c=b.autoClear;b.autoClear=!1;for(var d=1;d<rk;d++)this._blur(a,d-1,d,Math.sqrt(mh[d]*mh[d]-mh[d-1]*mh[d-1]),uk[(d-1)%uk.length]);b.autoClear=c};ac.prototype._blur=function(a,b,c,d,e){var g=this._pingPongRenderTarget;this._halfBlur(a,g,b,c,d,"latitudinal",e);this._halfBlur(g,a,c,c,d,"longitudinal",e)};ac.prototype._halfBlur=
function(a,b,c,d,e,g,h){var m=this._renderer,n=this._blurMaterial;"latitudinal"!==g&&"longitudinal"!==g&&console.error("blur direction must be either latitudinal or longitudinal!");var q=new vb(gg[d],n);n=n.uniforms;var t=sk[c]-1;t=isFinite(e)?Math.PI/(2*t):2*Math.PI/39;var r=e/t,u=isFinite(e)?1+Math.floor(3*r):20;20<u&&console.warn("sigmaRadians, "+e+", is too large and will clip, as it requested "+u+" samples when the maximum is set to 20");e=[];for(var A=0,w=0;20>w;++w){var x=w/r;x=Math.exp(-x*
x/2);e.push(x);0==w?A+=x:w<u&&(A+=2*x)}for(r=0;r<e.length;r++)e[r]/=A;n.envMap.value=a.texture;n.samples.value=u;n.weights.value=e;n.latitudinal.value="latitudinal"===g;h&&(n.poleAxis.value=h);n.dTheta.value=t;n.mipInt.value=8-c;this._setEncoding(n.inputEncoding,a.texture);this._setEncoding(n.outputEncoding,a.texture);a=sk[d];cd(b,3*Math.max(0,bd-2*a),(0===d?0:2*bd)+2*a*(4<d?d-8+4:0),3*a,2*a);m.setRenderTarget(b);m.render(q,Qi)};var Nf=function(a,b,c,d){a=void 0===a?null:a;b=void 0===b?1:b;c=void 0===
c?1:c;d=void 0===d?1:d;var e=mb.call(this,null)||this;e.image={data:a,width:b,height:c,depth:d};e.magFilter=1003;e.minFilter=1003;e.wrapR=1001;e.generateMipmaps=!1;e.flipY=!1;e.unpackAlignment=1;e.needsUpdate=!0;return e};$jscomp.inherits(Nf,mb);Nf.prototype.isDataTexture2DArray=!0;var nh=function(a,b,c,d){a=void 0===a?null:a;b=void 0===b?1:b;c=void 0===c?1:c;d=void 0===d?1:d;var e=mb.call(this,null)||this;e.image={data:a,width:b,height:c,depth:d};e.magFilter=1003;e.minFilter=1003;e.wrapR=1001;e.generateMipmaps=
!1;e.flipY=!1;e.unpackAlignment=1;e.needsUpdate=!0;return e};$jscomp.inherits(nh,mb);nh.prototype.isDataTexture3D=!0;var tj=new mb,kl=new Nf,jl=new nh,uj=new Ud,oj=[],pj=[],sj=new Float32Array(16),rj=new Float32Array(9),qj=new Float32Array(4);vj.prototype.updateCache=function(a){var b=this.cache;a instanceof Float32Array&&b.length!==a.length&&(this.cache=new Float32Array(a.length));y(b,a)};wj.prototype.setValue=function(a,b,c){for(var d=this.seq,e=0,g=d.length;e!==g;++e){var h=d[e];h.setValue(a,b[h.id],
c)}};var hi=/(\w+)(\])?(\[|\.)?/g;Kd.prototype.setValue=function(a,b,c,d){b=this.map[b];void 0!==b&&b.setValue(a,c,d)};Kd.prototype.setOptional=function(a,b,c){b=b[c];void 0!==b&&this.setValue(a,c,b)};Kd.upload=function(a,b,c,d){for(var e=0,g=b.length;e!==g;++e){var h=b[e],m=c[h.id];!1!==m.needsUpdate&&h.setValue(a,m.value,d)}};Kd.seqWithValue=function(a,b){for(var c=[],d=0,e=a.length;d!==e;++d){var g=a[d];g.id in b&&c.push(g)}return c};var wl=0,ji=/^[ \t]*#include +<([\w\d./]+)>/gm,Fj=/#pragma unroll_loop[\s]+?for \( int i = (\d+); i < (\d+); i \+\+ \) \{([\s\S]+?)(?=\})\}/g,
Ej=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g,El=0,Ve=function(a){var b=Oa.call(this)||this;b.type="MeshDepthMaterial";b.depthPacking=3200;b.map=null;b.alphaMap=null;b.displacementMap=null;b.displacementScale=1;b.displacementBias=0;b.wireframe=!1;b.wireframeLinewidth=1;b.fog=!1;b.setValues(a);return b};$jscomp.inherits(Ve,Oa);Ve.prototype.copy=function(a){return Oa.prototype.copy.call(this,a),this.depthPacking=
a.depthPacking,this.map=a.map,this.alphaMap=a.alphaMap,this.displacementMap=a.displacementMap,this.displacementScale=a.displacementScale,this.displacementBias=a.displacementBias,this.wireframe=a.wireframe,this.wireframeLinewidth=a.wireframeLinewidth,this};Ve.prototype.isMeshDepthMaterial=!0;var We=function(a){var b=Oa.call(this)||this;b.type="MeshDistanceMaterial";b.referencePosition=new B;b.nearDistance=1;b.farDistance=1E3;b.map=null;b.alphaMap=null;b.displacementMap=null;b.displacementScale=1;b.displacementBias=
0;b.fog=!1;b.setValues(a);return b};$jscomp.inherits(We,Oa);We.prototype.copy=function(a){return Oa.prototype.copy.call(this,a),this.referencePosition.copy(a.referencePosition),this.nearDistance=a.nearDistance,this.farDistance=a.farDistance,this.map=a.map,this.alphaMap=a.alphaMap,this.displacementMap=a.displacementMap,this.displacementScale=a.displacementScale,this.displacementBias=a.displacementBias,this};We.prototype.isMeshDistanceMaterial=!0;var oh=function(a){a=void 0===a?[]:a;var b=xb.call(this)||
this;b.cameras=a;return b};$jscomp.inherits(oh,xb);oh.prototype.isArrayCamera=!0;var Wd=function(){var a=la.call(this)||this;a.type="Group";return a};$jscomp.inherits(Wd,la);Wd.prototype.isGroup=!0;var Zl={type:"move"},ud=function(){this._hand=this._grip=this._targetRay=null};ud.prototype.getHandSpace=function(){return null===this._hand&&(this._hand=new Wd,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand};ud.prototype.getTargetRaySpace=
function(){return null===this._targetRay&&(this._targetRay=new Wd,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new B,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new B),this._targetRay};ud.prototype.getGripSpace=function(){return null===this._grip&&(this._grip=new Wd,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new B,this._grip.hasAngularVelocity=
!1,this._grip.angularVelocity=new B),this._grip};ud.prototype.dispatchEvent=function(a){return null!==this._targetRay&&this._targetRay.dispatchEvent(a),null!==this._grip&&this._grip.dispatchEvent(a),null!==this._hand&&this._hand.dispatchEvent(a),this};ud.prototype.disconnect=function(a){return this.dispatchEvent({type:"disconnected",data:a}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this};ud.prototype.update=
function(a,b,c){var d=null,e=null,g=null,h=this._targetRay,m=this._grip,n=this._hand;if(a&&"visible-blurred"!==b.session.visibilityState)if(null!==h&&(d=b.getPose(a.targetRaySpace,c),null!==d&&(h.matrix.fromArray(d.transform.matrix),h.matrix.decompose(h.position,h.rotation,h.scale),d.linearVelocity?(h.hasLinearVelocity=!0,h.linearVelocity.copy(d.linearVelocity)):h.hasLinearVelocity=!1,d.angularVelocity?(h.hasAngularVelocity=!0,h.angularVelocity.copy(d.angularVelocity)):h.hasAngularVelocity=!1,this.dispatchEvent(Zl))),
n&&a.hand){g=!0;for(var q=$jscomp.makeIterator(a.hand.values()),t=q.next();!t.done;t=q.next()){var r=t.value;t=b.getJointPose(r,c);if(void 0===n.joints[r.jointName]){var u=new Wd;u.matrixAutoUpdate=!1;u.visible=!1;n.joints[r.jointName]=u;n.add(u)}r=n.joints[r.jointName];null!==t&&(r.matrix.fromArray(t.transform.matrix),r.matrix.decompose(r.position,r.rotation,r.scale),r.jointRadius=t.radius);r.visible=null!==t}b=n.joints["index-finger-tip"].position.distanceTo(n.joints["thumb-tip"].position);n.inputState.pinching&&
.025<b?(n.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:a.handedness,target:this})):!n.inputState.pinching&&.015>=b&&(n.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:a.handedness,target:this}))}else null!==m&&a.gripSpace&&(e=b.getPose(a.gripSpace,c),null!==e&&(m.matrix.fromArray(e.transform.matrix),m.matrix.decompose(m.position,m.rotation,m.scale),e.linearVelocity?(m.hasLinearVelocity=!0,m.linearVelocity.copy(e.linearVelocity)):m.hasLinearVelocity=
!1,e.angularVelocity?(m.hasAngularVelocity=!0,m.angularVelocity.copy(e.angularVelocity)):m.hasAngularVelocity=!1));return null!==h&&(h.visible=null!==d),null!==m&&(m.visible=null!==e),null!==n&&(n.visible=null!==g),this};var Pj=function(a,b){function c(E){var J=Y.get(E.inputSource);J&&J.dispatchEvent({type:E.type,data:E.inputSource})}function d(){Y.forEach(function(E,J){E.disconnect(J)});Y.clear();Va=Ja=null;m.bindXRFramebuffer(null);a.setRenderTarget(a.getRenderTarget());w&&b.deleteFramebuffer(w);
I&&b.deleteFramebuffer(I);P&&b.deleteRenderbuffer(P);O&&b.deleteRenderbuffer(O);n=A=x=C=O=P=I=w=null;D.stop();h.isPresenting=!1;h.dispatchEvent({type:"sessionend"})}function e(E){for(var J=n.inputSources,W=0;W<ba.length;W++)Y.set(J[W],ba[W]);for(J=0;J<E.removed.length;J++){W=E.removed[J];var qa=Y.get(W);qa&&(qa.dispatchEvent({type:"disconnected",data:W}),Y.delete(W))}for(J=0;J<E.added.length;J++)W=E.added[J],(qa=Y.get(W))&&qa.dispatchEvent({type:"connected",data:W})}function g(E,J){null===J?E.matrixWorld.copy(E.matrix):
E.matrixWorld.multiplyMatrices(J.matrixWorld,E.matrix);E.matrixWorldInverse.copy(E.matrixWorld).invert()}var h=this,m=a.state,n=null,q=1,t=null,r="local-floor",u=null,A=null,w=null,x=null,C=null,G=!1,I=null,P=null,O=null,M=null,S=null,V=null,ba=[],Y=new Map,Z=new xb;Z.layers.enable(1);Z.viewport=new za;var Ha=new xb;Ha.layers.enable(2);Ha.viewport=new za;var ya=[Z,Ha],ja=new oh;ja.layers.enable(1);ja.layers.enable(2);var Ja=null,Va=null;this.cameraAutoUpdate=!0;this.isPresenting=this.enabled=!1;this.getController=
function(E){var J=ba[E];return void 0===J&&(J=new ud,ba[E]=J),J.getTargetRaySpace()};this.getControllerGrip=function(E){var J=ba[E];return void 0===J&&(J=new ud,ba[E]=J),J.getGripSpace()};this.getHand=function(E){var J=ba[E];return void 0===J&&(J=new ud,ba[E]=J),J.getHandSpace()};this.setFramebufferScaleFactor=function(E){q=E;!0===h.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")};this.setReferenceSpaceType=function(E){r=E;!0===h.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")};
this.getReferenceSpace=function(){return t};this.getBaseLayer=function(){return null!==x?x:C};this.getBinding=function(){return A};this.getFrame=function(){return M};this.getSession=function(){return n};this.setSession=function(E){var J,W,qa,K,ha;return $jscomp.asyncExecutePromiseGeneratorProgram(function(da){switch(da.nextAddress){case 1:if(n=E,null===n){da.jumpTo(0);break}n.addEventListener("select",c);n.addEventListener("selectstart",c);n.addEventListener("selectend",c);n.addEventListener("squeeze",
c);n.addEventListener("squeezestart",c);n.addEventListener("squeezeend",c);n.addEventListener("end",d);n.addEventListener("inputsourceschange",e);J=b.getContextAttributes();if(!0===J.xrCompatible){da.jumpTo(3);break}return da.yield(b.makeXRCompatible(),4);case 4:case 3:return void 0===n.renderState.layers?(W={antialias:J.antialias,alpha:J.alpha,depth:J.depth,stencil:J.stencil,framebufferScaleFactor:q},C=new XRWebGLLayer(n,b,W),n.updateRenderState({baseLayer:C})):b instanceof WebGLRenderingContext?
(qa={antialias:!0,alpha:J.alpha,depth:J.depth,stencil:J.stencil,framebufferScaleFactor:q},C=new XRWebGLLayer(n,b,qa),n.updateRenderState({layers:[C]})):(G=J.antialias,K=null,J.depth&&(V=256,J.stencil&&(V|=1024),S=J.stencil?33306:36096,K=J.stencil?35056:33190),ha={colorFormat:J.alpha?32856:32849,depthFormat:K,scaleFactor:q},A=new XRWebGLBinding(n,b),x=A.createProjectionLayer(ha),w=b.createFramebuffer(),n.updateRenderState({layers:[x]}),G&&(I=b.createFramebuffer(),P=b.createRenderbuffer(),b.bindRenderbuffer(36161,
P),b.renderbufferStorageMultisample(36161,4,32856,x.textureWidth,x.textureHeight),m.bindFramebuffer(36160,I),b.framebufferRenderbuffer(36160,36064,36161,P),b.bindRenderbuffer(36161,null),null!==K&&(O=b.createRenderbuffer(),b.bindRenderbuffer(36161,O),b.renderbufferStorageMultisample(36161,4,K,x.textureWidth,x.textureHeight),b.framebufferRenderbuffer(36160,S,36161,O),b.bindRenderbuffer(36161,null)),m.bindFramebuffer(36160,null))),da.yield(n.requestReferenceSpace(r),5);case 5:t=da.yieldResult,D.setContext(n),
D.start(),h.isPresenting=!0,h.dispatchEvent({type:"sessionstart"}),da.jumpToEnd()}})};var db=new B,Xa=new B;this.updateCamera=function(E){if(null!==n){ja.near=Ha.near=Z.near=E.near;ja.far=Ha.far=Z.far=E.far;Ja===ja.near&&Va===ja.far||(n.updateRenderState({depthNear:ja.near,depthFar:ja.far}),Ja=ja.near,Va=ja.far);var J=E.parent,W=ja.cameras;g(ja,J);for(var qa=0;qa<W.length;qa++)g(W[qa],J);ja.matrixWorld.decompose(ja.position,ja.quaternion,ja.scale);E.position.copy(ja.position);E.quaternion.copy(ja.quaternion);
E.scale.copy(ja.scale);E.matrix.copy(ja.matrix);E.matrixWorld.copy(ja.matrixWorld);E=E.children;J=0;for(qa=E.length;J<qa;J++)E[J].updateMatrixWorld(!0);if(2===W.length){db.setFromMatrixPosition(Z.matrixWorld);Xa.setFromMatrixPosition(Ha.matrixWorld);W=db.distanceTo(Xa);var K=Z.projectionMatrix.elements,ha=Ha.projectionMatrix.elements,da=K[14]/(K[10]-1);E=K[14]/(K[10]+1);J=(K[9]+1)/K[5];qa=(K[9]-1)/K[5];var wa=(K[8]-1)/K[0],na=(ha[8]+1)/ha[0];ha=da*wa;K=da*na;na=W/(-wa+na);wa=na*-wa;Z.matrixWorld.decompose(ja.position,
ja.quaternion,ja.scale);ja.translateX(wa);ja.translateZ(na);ja.matrixWorld.compose(ja.position,ja.quaternion,ja.scale);ja.matrixWorldInverse.copy(ja.matrixWorld).invert();da+=na;na=E+na;ja.projectionMatrix.makePerspective(ha-wa,K+(W-wa),J*E/na*da,qa*E/na*da,da,na)}else ja.projectionMatrix.copy(Z.projectionMatrix)}};this.getCamera=function(){return ja};this.getFoveation=function(){return null!==x?x.fixedFoveation:null!==C?C.fixedFoveation:void 0};this.setFoveation=function(E){null!==x&&(x.fixedFoveation=
E);null!==C&&void 0!==C.fixedFoveation&&(C.fixedFoveation=E)};var Qa=null,D=new Te;D.setAnimationLoop(function(E,J){if(u=J.getViewerPose(t),M=J,null!==u){var W=u.views;null!==C&&m.bindXRFramebuffer(C.framebuffer);var qa=!1;W.length!==ja.cameras.length&&(ja.cameras.length=0,qa=!0);for(var K=0;K<W.length;K++){var ha=W[K];if(null!==C)var da=C.getViewport(ha);else da=A.getViewSubImage(x,ha),m.bindXRFramebuffer(w),void 0!==da.depthStencilTexture&&b.framebufferTexture2D(36160,S,3553,da.depthStencilTexture,
0),b.framebufferTexture2D(36160,36064,3553,da.colorTexture,0),da=da.viewport;var wa=ya[K];wa.matrix.fromArray(ha.transform.matrix);wa.projectionMatrix.fromArray(ha.projectionMatrix);wa.viewport.set(da.x,da.y,da.width,da.height);0===K&&ja.matrix.copy(wa.matrix);!0===qa&&ja.cameras.push(wa)}G&&(m.bindXRFramebuffer(I),null!==V&&b.clear(V))}W=n.inputSources;for(qa=0;qa<ba.length;qa++)ba[qa].update(W[qa],J,t);if(Qa&&Qa(E,J),G)E=x.textureWidth,J=x.textureHeight,m.bindFramebuffer(36008,I),m.bindFramebuffer(36009,
w),b.invalidateFramebuffer(36008,[S]),b.invalidateFramebuffer(36009,[S]),b.blitFramebuffer(0,0,E,J,0,0,E,J,16384,9728),b.invalidateFramebuffer(36008,[36064]),m.bindFramebuffer(36008,null),m.bindFramebuffer(36009,null),m.bindFramebuffer(36160,I);M=null});this.setAnimationLoop=function(E){Qa=E};this.dispose=function(){};return this};$jscomp.inherits(Pj,Jc);wb.prototype.isWebGLRenderer=!0;var Ti=function(){return wb.apply(this,arguments)||this};$jscomp.inherits(Ti,wb);Ti.prototype.isWebGL1Renderer=!0;
var pf=function(a,b){b=void 0===b?2.5E-4:b;this.name="";this.color=new ma(a);this.density=b};pf.prototype.clone=function(){return new pf(this.color,this.density)};pf.prototype.toJSON=function(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}};pf.prototype.isFogExp2=!0;var qf=function(a,b,c){b=void 0===b?1:b;c=void 0===c?1E3:c;this.name="";this.color=new ma(a);this.near=b;this.far=c};qf.prototype.clone=function(){return new qf(this.color,this.near,this.far)};qf.prototype.toJSON=
function(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}};qf.prototype.isFog=!0;var te=function(){var a=la.call(this)||this;a.type="Scene";a.background=null;a.environment=null;a.fog=null;a.overrideMaterial=null;a.autoUpdate=!0;"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:a}));return a};$jscomp.inherits(te,la);te.prototype.copy=function(a,b){return la.prototype.copy.call(this,a,b),null!==a.background&&(this.background=
a.background.clone()),null!==a.environment&&(this.environment=a.environment.clone()),null!==a.fog&&(this.fog=a.fog.clone()),null!==a.overrideMaterial&&(this.overrideMaterial=a.overrideMaterial.clone()),this.autoUpdate=a.autoUpdate,this.matrixAutoUpdate=a.matrixAutoUpdate,this};te.prototype.toJSON=function(a){a=la.prototype.toJSON.call(this,a);return null!==this.fog&&(a.object.fog=this.fog.toJSON()),a};te.prototype.isScene=!0;var Xb=function(a,b){this.array=a;this.stride=b;this.count=void 0!==a?a.length/
b:0;this.usage=35044;this.updateRange={offset:0,count:-1};this.version=0;this.uuid=N()};Xb.prototype.onUploadCallback=function(){};Xb.prototype.setUsage=function(a){return this.usage=a,this};Xb.prototype.copy=function(a){return this.array=new a.array.constructor(a.array),this.count=a.count,this.stride=a.stride,this.usage=a.usage,this};Xb.prototype.copyAt=function(a,b,c){a*=this.stride;c*=b.stride;for(var d=0,e=this.stride;d<e;d++)this.array[a+d]=b.array[c+d];return this};Xb.prototype.set=function(a,
b){return this.array.set(a,void 0===b?0:b),this};Xb.prototype.clone=function(a){void 0===a.arrayBuffers&&(a.arrayBuffers={});void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=N());void 0===a.arrayBuffers[this.array.buffer._uuid]&&(a.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);a=new this.array.constructor(a.arrayBuffers[this.array.buffer._uuid]);a=new this.constructor(a,this.stride);return a.setUsage(this.usage),a};Xb.prototype.onUpload=function(a){return this.onUploadCallback=
a,this};Xb.prototype.toJSON=function(a){return void 0===a.arrayBuffers&&(a.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=N()),void 0===a.arrayBuffers[this.array.buffer._uuid]&&(a.arrayBuffers[this.array.buffer._uuid]=Array.prototype.slice.call(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}};$jscomp.global.Object.defineProperties(Xb.prototype,{needsUpdate:{configurable:!0,enumerable:!0,
set:function(a){!0===a&&this.version++}}});Xb.prototype.isInterleavedBuffer=!0;var Tb=new B,Kb=function(a,b,c,d){this.name="";this.data=a;this.itemSize=b;this.offset=c;this.normalized=!0===(void 0===d?!1:d)};Kb.prototype.applyMatrix4=function(a){for(var b=0,c=this.data.count;b<c;b++)Tb.x=this.getX(b),Tb.y=this.getY(b),Tb.z=this.getZ(b),Tb.applyMatrix4(a),this.setXYZ(b,Tb.x,Tb.y,Tb.z);return this};Kb.prototype.applyNormalMatrix=function(a){for(var b=0,c=this.count;b<c;b++)Tb.x=this.getX(b),Tb.y=this.getY(b),
Tb.z=this.getZ(b),Tb.applyNormalMatrix(a),this.setXYZ(b,Tb.x,Tb.y,Tb.z);return this};Kb.prototype.transformDirection=function(a){for(var b=0,c=this.count;b<c;b++)Tb.x=this.getX(b),Tb.y=this.getY(b),Tb.z=this.getZ(b),Tb.transformDirection(a),this.setXYZ(b,Tb.x,Tb.y,Tb.z);return this};Kb.prototype.setX=function(a,b){return this.data.array[a*this.data.stride+this.offset]=b,this};Kb.prototype.setY=function(a,b){return this.data.array[a*this.data.stride+this.offset+1]=b,this};Kb.prototype.setZ=function(a,
b){return this.data.array[a*this.data.stride+this.offset+2]=b,this};Kb.prototype.setW=function(a,b){return this.data.array[a*this.data.stride+this.offset+3]=b,this};Kb.prototype.getX=function(a){return this.data.array[a*this.data.stride+this.offset]};Kb.prototype.getY=function(a){return this.data.array[a*this.data.stride+this.offset+1]};Kb.prototype.getZ=function(a){return this.data.array[a*this.data.stride+this.offset+2]};Kb.prototype.getW=function(a){return this.data.array[a*this.data.stride+this.offset+
3]};Kb.prototype.setXY=function(a,b,c){return a=a*this.data.stride+this.offset,this.data.array[a+0]=b,this.data.array[a+1]=c,this};Kb.prototype.setXYZ=function(a,b,c,d){return a=a*this.data.stride+this.offset,this.data.array[a+0]=b,this.data.array[a+1]=c,this.data.array[a+2]=d,this};Kb.prototype.setXYZW=function(a,b,c,d,e){return a=a*this.data.stride+this.offset,this.data.array[a+0]=b,this.data.array[a+1]=c,this.data.array[a+2]=d,this.data.array[a+3]=e,this};Kb.prototype.clone=function(a){if(void 0===
a){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interlaved buffer attribute will deinterleave buffer data.");a=[];for(var b=0;b<this.count;b++)for(var c=b*this.data.stride+this.offset,d=0;d<this.itemSize;d++)a.push(this.data.array[c+d]);return new Ba(new this.array.constructor(a),this.itemSize,this.normalized)}return void 0===a.interleavedBuffers&&(a.interleavedBuffers={}),void 0===a.interleavedBuffers[this.data.uuid]&&(a.interleavedBuffers[this.data.uuid]=this.data.clone(a)),
new Kb(a.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)};Kb.prototype.toJSON=function(a){if(void 0===a){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interlaved buffer attribute will deinterleave buffer data.");a=[];for(var b=0;b<this.count;b++)for(var c=b*this.data.stride+this.offset,d=0;d<this.itemSize;d++)a.push(this.data.array[c+d]);return{itemSize:this.itemSize,type:this.array.constructor.name,array:a,normalized:this.normalized}}return void 0===
a.interleavedBuffers&&(a.interleavedBuffers={}),void 0===a.interleavedBuffers[this.data.uuid]&&(a.interleavedBuffers[this.data.uuid]=this.data.toJSON(a)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}};$jscomp.global.Object.defineProperties(Kb.prototype,{count:{configurable:!0,enumerable:!0,get:function(){return this.data.count}},array:{configurable:!0,enumerable:!0,get:function(){return this.data.array}},needsUpdate:{configurable:!0,
enumerable:!0,set:function(a){this.data.needsUpdate=a}}});Kb.prototype.isInterleavedBufferAttribute=!0;var rf=function(a){var b=Oa.call(this)||this;b.type="SpriteMaterial";b.color=new ma(16777215);b.map=null;b.alphaMap=null;b.rotation=0;b.sizeAttenuation=!0;b.transparent=!0;b.setValues(a);return b};$jscomp.inherits(rf,Oa);rf.prototype.copy=function(a){return Oa.prototype.copy.call(this,a),this.color.copy(a.color),this.map=a.map,this.alphaMap=a.alphaMap,this.rotation=a.rotation,this.sizeAttenuation=
a.sizeAttenuation,this};var sf;rf.prototype.isSpriteMaterial=!0;var hg=new B,tf=new B,uf=new B,Xe=new T,Uf=new T,Qj=new ua,ph=new B,ig=new B,qh=new B,vk=new T,Ui=new T,wk=new T,ue=function(a){var b;if(b=la.call(this)||this,b.type="Sprite",void 0===sf){sf=new ra;var c=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]);c=new Xb(c,5);sf.setIndex([0,1,2,0,2,3]);sf.setAttribute("position",new Kb(c,3,0,!1));sf.setAttribute("uv",new Kb(c,2,3,!1))}b.geometry=sf;b.material=void 0!==a?
a:new rf;b.center=new T(.5,.5);return b};$jscomp.inherits(ue,la);ue.prototype.raycast=function(a,b){null===a.camera&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.');tf.setFromMatrixScale(this.matrixWorld);Qj.copy(a.camera.matrixWorld);this.modelViewMatrix.multiplyMatrices(a.camera.matrixWorldInverse,this.matrixWorld);uf.setFromMatrixPosition(this.modelViewMatrix);a.camera.isPerspectiveCamera&&!1===this.material.sizeAttenuation&&tf.multiplyScalar(-uf.z);
var c=this.material.rotation,d,e;0!==c&&(e=Math.cos(c),d=Math.sin(c));c=this.center;Xg(ph.set(-.5,-.5,0),uf,c,tf,d,e);Xg(ig.set(.5,-.5,0),uf,c,tf,d,e);Xg(qh.set(.5,.5,0),uf,c,tf,d,e);vk.set(0,0);Ui.set(1,0);wk.set(1,1);var g=a.ray.intersectTriangle(ph,ig,qh,!1,hg);if(null!==g||(Xg(ig.set(-.5,.5,0),uf,c,tf,d,e),Ui.set(0,1),g=a.ray.intersectTriangle(ph,qh,ig,!1,hg),null!==g))d=a.ray.origin.distanceTo(hg),d<a.near||d>a.far||b.push({distance:d,point:hg.clone(),uv:eb.getUV(hg,ph,ig,qh,vk,Ui,wk,new T),
face:null,object:this})};ue.prototype.copy=function(a){return la.prototype.copy.call(this,a),void 0!==a.center&&this.center.copy(a.center),this.material=a.material,this};ue.prototype.isSprite=!0;var rh=new B,xk=new B,gd=function(){var a=la.call(this)||this;a._currentLevel=0;a.type="LOD";Object.defineProperties(a,{levels:{enumerable:!0,value:[]},isLOD:{value:!0}});a.autoUpdate=!0;return a};$jscomp.inherits(gd,la);gd.prototype.copy=function(a){la.prototype.copy.call(this,a,!1);for(var b=a.levels,c=
0,d=b.length;c<d;c++){var e=b[c];this.addLevel(e.object.clone(),e.distance)}return this.autoUpdate=a.autoUpdate,this};gd.prototype.addLevel=function(a,b){b=Math.abs(void 0===b?0:b);var c=this.levels,d;for(d=0;d<c.length&&!(b<c[d].distance);d++);return c.splice(d,0,{distance:b,object:a}),this.add(a),this};gd.prototype.getCurrentLevel=function(){return this._currentLevel};gd.prototype.getObjectForDistance=function(a){var b=this.levels;if(0<b.length){var c;var d=1;for(c=b.length;d<c&&!(a<b[d].distance);d++);
return b[d-1].object}return null};gd.prototype.raycast=function(a,b){if(0<this.levels.length){rh.setFromMatrixPosition(this.matrixWorld);var c=a.ray.origin.distanceTo(rh);this.getObjectForDistance(c).raycast(a,b)}};gd.prototype.update=function(a){var b=this.levels;if(1<b.length){rh.setFromMatrixPosition(a.matrixWorld);xk.setFromMatrixPosition(this.matrixWorld);a=rh.distanceTo(xk)/a.zoom;var c;b[0].object.visible=!0;var d=1;for(c=b.length;d<c&&a>=b[d].distance;d++)b[d-1].object.visible=!1,b[d].object.visible=
!0;for(this._currentLevel=d-1;d<c;d++)b[d].object.visible=!1}};gd.prototype.toJSON=function(a){a=la.prototype.toJSON.call(this,a);!1===this.autoUpdate&&(a.object.autoUpdate=!1);a.object.levels=[];for(var b=this.levels,c=0,d=b.length;c<d;c++){var e=b[c];a.object.levels.push({object:e.object.uuid,distance:e.distance})}return a};var yk=new B,zk=new za,Ak=new za,$l=new B,Bk=new ua,Xc=function(a,b){a=vb.call(this,a,b)||this;a.type="SkinnedMesh";a.bindMode="attached";a.bindMatrix=new ua;a.bindMatrixInverse=
new ua;return a};$jscomp.inherits(Xc,vb);Xc.prototype.copy=function(a){return vb.prototype.copy.call(this,a),this.bindMode=a.bindMode,this.bindMatrix.copy(a.bindMatrix),this.bindMatrixInverse.copy(a.bindMatrixInverse),this.skeleton=a.skeleton,this};Xc.prototype.bind=function(a,b){this.skeleton=a;void 0===b&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),b=this.matrixWorld);this.bindMatrix.copy(b);this.bindMatrixInverse.copy(b).invert()};Xc.prototype.pose=function(){this.skeleton.pose()};
Xc.prototype.normalizeSkinWeights=function(){for(var a=new za,b=this.geometry.attributes.skinWeight,c=0,d=b.count;c<d;c++){a.x=b.getX(c);a.y=b.getY(c);a.z=b.getZ(c);a.w=b.getW(c);var e=1/a.manhattanLength();e!==1/0?a.multiplyScalar(e):a.set(1,0,0,0);b.setXYZW(c,a.x,a.y,a.z,a.w)}};Xc.prototype.updateMatrixWorld=function(a){vb.prototype.updateMatrixWorld.call(this,a);"attached"===this.bindMode?this.bindMatrixInverse.copy(this.matrixWorld).invert():"detached"===this.bindMode?this.bindMatrixInverse.copy(this.bindMatrix).invert():
console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)};Xc.prototype.boneTransform=function(a,b){var c=this.skeleton,d=this.geometry;zk.fromBufferAttribute(d.attributes.skinIndex,a);Ak.fromBufferAttribute(d.attributes.skinWeight,a);yk.copy(b).applyMatrix4(this.bindMatrix);b.set(0,0,0);for(a=0;4>a;a++)if(d=Ak.getComponent(a),0!==d){var e=zk.getComponent(a);Bk.multiplyMatrices(c.bones[e].matrixWorld,c.boneInverses[e]);b.addScaledVector($l.copy(yk).applyMatrix4(Bk),d)}return b.applyMatrix4(this.bindMatrixInverse)};
Xc.prototype.isSkinnedMesh=!0;var jg=function(){var a=la.call(this)||this;a.type="Bone";return a};$jscomp.inherits(jg,la);jg.prototype.isBone=!0;var Xd=function(a,b,c,d,e,g,h,m,n,q,t,r){a=void 0===a?null:a;b=void 0===b?1:b;c=void 0===c?1:c;n=void 0===n?1003:n;q=void 0===q?1003:q;d=mb.call(this,null,g,h,m,n,q,d,e,t,r)||this;d.image={data:a,width:b,height:c};d.magFilter=n;d.minFilter=q;d.generateMipmaps=!1;d.flipY=!1;d.unpackAlignment=1;d.needsUpdate=!0;return d};$jscomp.inherits(Xd,mb);Xd.prototype.isDataTexture=
!0;var Ck=new ua,am=new ua,Fc=function(a,b){a=void 0===a?[]:a;b=void 0===b?[]:b;this.uuid=N();this.bones=a.slice(0);this.boneInverses=b;this.boneTexture=this.boneMatrices=null;this.boneTextureSize=0;this.frame=-1;this.init()};Fc.prototype.init=function(){var a=this.bones,b=this.boneInverses;if(this.boneMatrices=new Float32Array(16*a.length),0===b.length)this.calculateInverses();else if(a.length!==b.length)for(console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),
this.boneInverses=[],a=0,b=this.bones.length;a<b;a++)this.boneInverses.push(new ua)};Fc.prototype.calculateInverses=function(){for(var a=this.boneInverses.length=0,b=this.bones.length;a<b;a++){var c=new ua;this.bones[a]&&c.copy(this.bones[a].matrixWorld).invert();this.boneInverses.push(c)}};Fc.prototype.pose=function(){for(var a=0,b=this.bones.length;a<b;a++){var c=this.bones[a];c&&c.matrixWorld.copy(this.boneInverses[a]).invert()}a=0;for(b=this.bones.length;a<b;a++)(c=this.bones[a])&&(c.parent&&
c.parent.isBone?(c.matrix.copy(c.parent.matrixWorld).invert(),c.matrix.multiply(c.matrixWorld)):c.matrix.copy(c.matrixWorld),c.matrix.decompose(c.position,c.quaternion,c.scale))};Fc.prototype.update=function(){for(var a=this.bones,b=this.boneInverses,c=this.boneMatrices,d=this.boneTexture,e=0,g=a.length;e<g;e++)Ck.multiplyMatrices(a[e]?a[e].matrixWorld:am,b[e]),Ck.toArray(c,16*e);null!==d&&(d.needsUpdate=!0)};Fc.prototype.clone=function(){return new Fc(this.bones,this.boneInverses)};Fc.prototype.computeBoneTexture=
function(){var a=Math.sqrt(4*this.bones.length);a=ia(a);a=Math.max(a,4);var b=new Float32Array(a*a*4);b.set(this.boneMatrices);var c=new Xd(b,a,a,1023,1015);return this.boneMatrices=b,this.boneTexture=c,this.boneTextureSize=a,this};Fc.prototype.getBoneByName=function(a){for(var b=0,c=this.bones.length;b<c;b++){var d=this.bones[b];if(d.name===a)return d}};Fc.prototype.dispose=function(){null!==this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=null)};Fc.prototype.fromJSON=function(a,b){this.uuid=
a.uuid;for(var c=0,d=a.bones.length;c<d;c++){var e=a.bones[c],g=b[e];void 0===g&&(console.warn("THREE.Skeleton: No bone found with UUID:",e),g=new jg);this.bones.push(g);this.boneInverses.push((new ua).fromArray(a.boneInverses[c]))}return this.init(),this};Fc.prototype.toJSON=function(){var a={metadata:{version:4.5,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};a.uuid=this.uuid;for(var b=this.bones,c=this.boneInverses,d=0,e=b.length;d<e;d++)a.bones.push(b[d].uuid),a.boneInverses.push(c[d].toArray());
return a};var hd=function(a,b,c,d){d=void 0===d?1:d;"number"==typeof c&&(d=c,c=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument."));a=Ba.call(this,a,b,c)||this;a.meshPerAttribute=d;return a};$jscomp.inherits(hd,Ba);hd.prototype.copy=function(a){return Ba.prototype.copy.call(this,a),this.meshPerAttribute=a.meshPerAttribute,this};hd.prototype.toJSON=function(){var a=Ba.prototype.toJSON.call(this);return a.meshPerAttribute=this.meshPerAttribute,
a.isInstancedBufferAttribute=!0,a};hd.prototype.isInstancedBufferAttribute=!0;var Dk=new ua,Ek=new ua,sh=[],kg=new vb,Lc=function(a,b,c){a=vb.call(this,a,b)||this;a.instanceMatrix=new hd(new Float32Array(16*c),16);a.instanceColor=null;a.count=c;a.frustumCulled=!1;return a};$jscomp.inherits(Lc,vb);Lc.prototype.copy=function(a){return vb.prototype.copy.call(this,a),this.instanceMatrix.copy(a.instanceMatrix),null!==a.instanceColor&&(this.instanceColor=a.instanceColor.clone()),this.count=a.count,this};
Lc.prototype.getColorAt=function(a,b){b.fromArray(this.instanceColor.array,3*a)};Lc.prototype.getMatrixAt=function(a,b){b.fromArray(this.instanceMatrix.array,16*a)};Lc.prototype.raycast=function(a,b){var c=this.matrixWorld,d=this.count;if(kg.geometry=this.geometry,kg.material=this.material,void 0!==kg.material)for(var e=0;e<d;e++){this.getMatrixAt(e,Dk);Ek.multiplyMatrices(c,Dk);kg.matrixWorld=Ek;kg.raycast(a,sh);for(var g=0,h=sh.length;g<h;g++){var m=sh[g];m.instanceId=e;m.object=this;b.push(m)}sh.length=
0}};Lc.prototype.setColorAt=function(a,b){null===this.instanceColor&&(this.instanceColor=new hd(new Float32Array(3*this.instanceMatrix.count),3));b.toArray(this.instanceColor.array,3*a)};Lc.prototype.setMatrixAt=function(a,b){b.toArray(this.instanceMatrix.array,16*a)};Lc.prototype.updateMorphTargets=function(){};Lc.prototype.dispose=function(){this.dispatchEvent({type:"dispose"})};Lc.prototype.isInstancedMesh=!0;var Pb=function(a){var b=Oa.call(this)||this;b.type="LineBasicMaterial";b.color=new ma(16777215);
b.linewidth=1;b.linecap="round";b.linejoin="round";b.setValues(a);return b};$jscomp.inherits(Pb,Oa);Pb.prototype.copy=function(a){return Oa.prototype.copy.call(this,a),this.color.copy(a.color),this.linewidth=a.linewidth,this.linecap=a.linecap,this.linejoin=a.linejoin,this};Pb.prototype.isLineBasicMaterial=!0;var Fk=new B,Gk=new B,Hk=new ua,Vi=new Bb,lg=new Fb,dc=function(a,b){a=void 0===a?new ra:a;b=void 0===b?new Pb:b;var c=la.call(this)||this;c.type="Line";c.geometry=a;c.material=b;c.updateMorphTargets();
return c};$jscomp.inherits(dc,la);dc.prototype.copy=function(a){return la.prototype.copy.call(this,a),this.material=a.material,this.geometry=a.geometry,this};dc.prototype.computeLineDistances=function(){var a=this.geometry;if(a.isBufferGeometry)if(null===a.index){for(var b=a.attributes.position,c=[0],d=1,e=b.count;d<e;d++)Fk.fromBufferAttribute(b,d-1),Gk.fromBufferAttribute(b,d),c[d]=c[d-1],c[d]+=Fk.distanceTo(Gk);a.setAttribute("lineDistance",new Ma(c,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");
else a.isGeometry&&console.error("THREE.Line.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this};dc.prototype.raycast=function(a,b){var c=this.geometry,d=this.matrixWorld,e=a.params.Line.threshold,g=c.drawRange;if(null===c.boundingSphere&&c.computeBoundingSphere(),lg.copy(c.boundingSphere),lg.applyMatrix4(d),lg.radius+=e,!1!==a.ray.intersectsSphere(lg)){Hk.copy(d).invert();Vi.copy(a.ray).applyMatrix4(Hk);d=e/((this.scale.x+this.scale.y+this.scale.z)/
3);d*=d;e=new B;var h=new B,m=new B,n=new B,q=this.isLineSegments?2:1;if(c.isBufferGeometry){var t=c.index;c=c.attributes.position;if(null!==t){var r=Math.max(0,g.start);for(g=Math.min(t.count,g.start+g.count)-1;r<g;r+=q){var u=t.getX(r),A=t.getX(r+1);e.fromBufferAttribute(c,u);h.fromBufferAttribute(c,A);Vi.distanceSqToSegment(e,h,n,m)>d||(n.applyMatrix4(this.matrixWorld),u=a.ray.origin.distanceTo(n),u<a.near||u>a.far||b.push({distance:u,point:m.clone().applyMatrix4(this.matrixWorld),index:r,face:null,
faceIndex:null,object:this}))}}else for(t=Math.max(0,g.start),g=Math.min(c.count,g.start+g.count)-1;t<g;t+=q)e.fromBufferAttribute(c,t),h.fromBufferAttribute(c,t+1),Vi.distanceSqToSegment(e,h,n,m)>d||(n.applyMatrix4(this.matrixWorld),r=a.ray.origin.distanceTo(n),r<a.near||r>a.far||b.push({distance:r,point:m.clone().applyMatrix4(this.matrixWorld),index:t,face:null,faceIndex:null,object:this}))}else c.isGeometry&&console.error("THREE.Line.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}};
dc.prototype.updateMorphTargets=function(){var a=this.geometry;if(a.isBufferGeometry){a=a.morphAttributes;var b=Object.keys(a);if(0<b.length&&(a=a[b[0]],void 0!==a)){this.morphTargetInfluences=[];this.morphTargetDictionary={};b=0;for(var c=a.length;b<c;b++){var d=a[b].name||String(b);this.morphTargetInfluences.push(0);this.morphTargetDictionary[d]=b}}}else a=a.morphTargets,void 0!==a&&0<a.length&&console.error("THREE.Line.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")};
dc.prototype.isLine=!0;var Ik=new B,Jk=new B,Ib=function(a,b){a=dc.call(this,a,b)||this;a.type="LineSegments";return a};$jscomp.inherits(Ib,dc);Ib.prototype.computeLineDistances=function(){var a=this.geometry;if(a.isBufferGeometry)if(null===a.index){for(var b=a.attributes.position,c=[],d=0,e=b.count;d<e;d+=2)Ik.fromBufferAttribute(b,d),Jk.fromBufferAttribute(b,d+1),c[d]=0===d?0:c[d-1],c[d+1]=c[d]+Ik.distanceTo(Jk);a.setAttribute("lineDistance",new Ma(c,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");
else a.isGeometry&&console.error("THREE.LineSegments.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this};Ib.prototype.isLineSegments=!0;var th=function(a,b){a=dc.call(this,a,b)||this;a.type="LineLoop";return a};$jscomp.inherits(th,dc);th.prototype.isLineLoop=!0;var vd=function(a){var b=Oa.call(this)||this;b.type="PointsMaterial";b.color=new ma(16777215);b.map=null;b.alphaMap=null;b.size=1;b.sizeAttenuation=!0;b.setValues(a);return b};$jscomp.inherits(vd,
Oa);vd.prototype.copy=function(a){return Oa.prototype.copy.call(this,a),this.color.copy(a.color),this.map=a.map,this.alphaMap=a.alphaMap,this.size=a.size,this.sizeAttenuation=a.sizeAttenuation,this};vd.prototype.isPointsMaterial=!0;var Kk=new ua,qi=new Bb,mg=new Fb,uh=new B,wd=function(a,b){a=void 0===a?new ra:a;b=void 0===b?new vd:b;var c=la.call(this)||this;c.type="Points";c.geometry=a;c.material=b;c.updateMorphTargets();return c};$jscomp.inherits(wd,la);wd.prototype.copy=function(a){return la.prototype.copy.call(this,
a),this.material=a.material,this.geometry=a.geometry,this};wd.prototype.raycast=function(a,b){var c=this.geometry,d=this.matrixWorld,e=a.params.Points.threshold,g=c.drawRange;if(null===c.boundingSphere&&c.computeBoundingSphere(),mg.copy(c.boundingSphere),mg.applyMatrix4(d),mg.radius+=e,!1!==a.ray.intersectsSphere(mg))if(Kk.copy(d).invert(),qi.copy(a.ray).applyMatrix4(Kk),e/=(this.scale.x+this.scale.y+this.scale.z)/3,e*=e,c.isBufferGeometry){var h=c.index;c=c.attributes.position;if(null!==h){var m=
Math.max(0,g.start);for(g=Math.min(h.count,g.start+g.count);m<g;m++){var n=h.getX(m);uh.fromBufferAttribute(c,n);Rj(uh,n,e,d,a,b,this)}}else for(h=Math.max(0,g.start),g=Math.min(c.count,g.start+g.count);h<g;h++)uh.fromBufferAttribute(c,h),Rj(uh,h,e,d,a,b,this)}else console.error("THREE.Points.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")};wd.prototype.updateMorphTargets=function(){var a=this.geometry;if(a.isBufferGeometry){a=a.morphAttributes;var b=Object.keys(a);
if(0<b.length&&(a=a[b[0]],void 0!==a)){this.morphTargetInfluences=[];this.morphTargetDictionary={};b=0;for(var c=a.length;b<c;b++){var d=a[b].name||String(b);this.morphTargetInfluences.push(0);this.morphTargetDictionary[d]=b}}}else a=a.morphTargets,void 0!==a&&0<a.length&&console.error("THREE.Points.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")};wd.prototype.isPoints=!0;var ng=function(a,b,c,d,e,g,h,m,n){var q=mb.call(this,a,b,c,d,e,g,h,m,n)||this;q.format=
void 0!==h?h:1022;q.minFilter=void 0!==g?g:1006;q.magFilter=void 0!==e?e:1006;q.generateMipmaps=!1;"requestVideoFrameCallback"in a&&a.requestVideoFrameCallback(function r(){q.needsUpdate=!0;a.requestVideoFrameCallback(r)});return q};$jscomp.inherits(ng,mb);ng.prototype.clone=function(){return(new this.constructor(this.image)).copy(this)};ng.prototype.update=function(){var a=this.image;!1==="requestVideoFrameCallback"in a&&a.readyState>=a.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)};ng.prototype.isVideoTexture=
!0;var vh=function(a,b,c,d,e,g,h,m,n,q,t,r){d=mb.call(this,null,g,h,m,n,q,d,e,t,r)||this;d.image={width:b,height:c};d.mipmaps=a;d.flipY=!1;d.generateMipmaps=!1;return d};$jscomp.inherits(vh,mb);vh.prototype.isCompressedTexture=!0;var Wi=function(a,b,c,d,e,g,h,m,n){a=mb.call(this,a,b,c,d,e,g,h,m,n)||this;a.needsUpdate=!0;return a};$jscomp.inherits(Wi,mb);Wi.prototype.isCanvasTexture=!0;var Xi=function(a,b,c,d,e,g,h,m,n,q){if(1026!==(q=void 0!==q?q:1026)&&1027!==q)throw Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");
void 0===c&&1026===q&&(c=1012);void 0===c&&1027===q&&(c=1020);c=mb.call(this,null,d,e,g,h,m,q,c,n)||this;c.image={width:a,height:b};c.magFilter=void 0!==h?h:1003;c.minFilter=void 0!==m?m:1003;c.flipY=!1;c.generateMipmaps=!1;return c};$jscomp.inherits(Xi,mb);Xi.prototype.isDepthTexture=!0;var ve=function(a,b,c,d){a=void 0===a?1:a;b=void 0===b?8:b;c=void 0===c?0:c;d=void 0===d?2*Math.PI:d;var e=ra.call(this)||this;e.type="CircleGeometry";e.parameters={radius:a,segments:b,thetaStart:c,thetaLength:d};
b=Math.max(3,b);var g=[],h=[],m=[],n=[],q=new B,t=new T;h.push(0,0,0);m.push(0,0,1);n.push(.5,.5);for(var r=0,u=3;r<=b;r++,u+=3){var A=c+r/b*d;q.x=a*Math.cos(A);q.y=a*Math.sin(A);h.push(q.x,q.y,q.z);m.push(0,0,1);t.x=(h[u]/a+1)/2;t.y=(h[u+1]/a+1)/2;n.push(t.x,t.y)}for(a=1;a<=b;a++)g.push(a,a+1,0);e.setIndex(g);e.setAttribute("position",new Ma(h,3));e.setAttribute("normal",new Ma(m,3));e.setAttribute("uv",new Ma(n,2));return e};$jscomp.inherits(ve,ra);ve.fromJSON=function(a){return new ve(a.radius,
a.segments,a.thetaStart,a.thetaLength)};var id=function(a,b,c,d,e,g,h,m){function n(P){for(var O=x,M=new T,S=new B,V=0,ba=!0===P?a:b,Y=!0===P?1:-1,Z=1;Z<=d;Z++)u.push(0,G*Y,0),A.push(0,Y,0),w.push(.5,.5),x++;var Ha=x;for(Z=0;Z<=d;Z++){var ya=Z/d*m+h,ja=Math.cos(ya);ya=Math.sin(ya);S.x=ba*ya;S.y=G*Y;S.z=ba*ja;u.push(S.x,S.y,S.z);A.push(0,Y,0);M.x=.5*ja+.5;M.y=.5*ya*Y+.5;w.push(M.x,M.y);x++}for(M=0;M<d;M++)S=O+M,ba=Ha+M,!0===P?r.push(ba,ba+1,S):r.push(ba+1,ba,S),V+=3;t.addGroup(I,V,!0===P?1:2);I+=V}
a=void 0===a?1:a;b=void 0===b?1:b;c=void 0===c?1:c;d=void 0===d?8:d;e=void 0===e?1:e;g=void 0===g?!1:g;h=void 0===h?0:h;m=void 0===m?2*Math.PI:m;var q=ra.call(this)||this;q.type="CylinderGeometry";q.parameters={radiusTop:a,radiusBottom:b,height:c,radialSegments:d,heightSegments:e,openEnded:g,thetaStart:h,thetaLength:m};var t=q;d=Math.floor(d);e=Math.floor(e);var r=[],u=[],A=[],w=[],x=0,C=[],G=c/2,I=0;!function(){for(var P=new B,O=new B,M=0,S=(b-a)/c,V=0;V<=e;V++){for(var ba=[],Y=V/e,Z=Y*(b-a)+a,Ha=
0;Ha<=d;Ha++){var ya=Ha/d,ja=ya*m+h,Ja=Math.sin(ja);ja=Math.cos(ja);O.x=Z*Ja;O.y=-Y*c+G;O.z=Z*ja;u.push(O.x,O.y,O.z);P.set(Ja,S,ja).normalize();A.push(P.x,P.y,P.z);w.push(ya,1-Y);ba.push(x++)}C.push(ba)}for(P=0;P<d;P++)for(O=0;O<e;O++)S=C[O+1][P],V=C[O+1][P+1],ba=C[O][P+1],r.push(C[O][P],S,ba),r.push(S,V,ba),M+=6;t.addGroup(I,M,0);I+=M}();!1===g&&(0<a&&n(!0),0<b&&n(!1));q.setIndex(r);q.setAttribute("position",new Ma(u,3));q.setAttribute("normal",new Ma(A,3));q.setAttribute("uv",new Ma(w,2));return q};
$jscomp.inherits(id,ra);id.fromJSON=function(a){return new id(a.radiusTop,a.radiusBottom,a.height,a.radialSegments,a.heightSegments,a.openEnded,a.thetaStart,a.thetaLength)};var we=function(a,b,c,d,e,g,h){a=void 0===a?1:a;b=void 0===b?1:b;c=void 0===c?8:c;d=void 0===d?1:d;e=void 0===e?!1:e;g=void 0===g?0:g;h=void 0===h?2*Math.PI:h;var m=id.call(this,0,a,b,c,d,e,g,h)||this;m.type="ConeGeometry";m.parameters={radius:a,height:b,radialSegments:c,heightSegments:d,openEnded:e,thetaStart:g,thetaLength:h};
return m};$jscomp.inherits(we,id);we.fromJSON=function(a){return new we(a.radius,a.height,a.radialSegments,a.heightSegments,a.openEnded,a.thetaStart,a.thetaLength)};var uc=function(a,b,c,d){function e(t){n.push(t.x,t.y,t.z)}function g(t,r){t*=3;r.x=a[t+0];r.y=a[t+1];r.z=a[t+2]}function h(t,r,u,A){0>A&&1===t.x&&(q[r]=t.x-1);0===u.x&&0===u.z&&(q[r]=A/2/Math.PI+.5)}a=void 0===a?[]:a;b=void 0===b?[]:b;c=void 0===c?1:c;d=void 0===d?0:d;var m=ra.call(this)||this;m.type="PolyhedronGeometry";m.parameters=
{vertices:a,indices:b,radius:c,detail:d};var n=[],q=[];!function(t){for(var r=new B,u=new B,A=new B,w=0;w<b.length;w+=3){g(b[w+0],r);g(b[w+1],u);g(b[w+2],A);for(var x=t+1,C=[],G=0;G<=x;G++){C[G]=[];for(var I=r.clone().lerp(A,G/x),P=u.clone().lerp(A,G/x),O=x-G,M=0;M<=O;M++)C[G][M]=0===M&&G===x?I:I.clone().lerp(P,M/O)}for(G=0;G<x;G++)for(I=0;I<2*(x-G)-1;I++)P=Math.floor(I/2),0==I%2?(e(C[G][P+1]),e(C[G+1][P]),e(C[G][P])):(e(C[G][P+1]),e(C[G+1][P+1]),e(C[G+1][P]))}}(d);(function(t){for(var r=new B,u=
0;u<n.length;u+=3)r.x=n[u+0],r.y=n[u+1],r.z=n[u+2],r.normalize().multiplyScalar(t),n[u+0]=r.x,n[u+1]=r.y,n[u+2]=r.z})(c);(function(){for(var t=new B,r=0;r<n.length;r+=3){t.x=n[r+0];t.y=n[r+1];t.z=n[r+2];var u=Math.atan2(t.z,-t.x)/2/Math.PI+.5,A=(w=t,Math.atan2(-w.y,Math.sqrt(w.x*w.x+w.z*w.z))/Math.PI+.5);q.push(u,1-A)}var w;(function(){for(var x=new B,C=new B,G=new B,I=new B,P=new T,O=new T,M=new T,S=0,V=0;S<n.length;S+=9,V+=6){x.set(n[S+0],n[S+1],n[S+2]);C.set(n[S+3],n[S+4],n[S+5]);G.set(n[S+6],
n[S+7],n[S+8]);P.set(q[V+0],q[V+1]);O.set(q[V+2],q[V+3]);M.set(q[V+4],q[V+5]);I.copy(x).add(C).add(G).divideScalar(3);var ba=Math.atan2(I.z,-I.x);h(P,V+0,x,ba);h(O,V+2,C,ba);h(M,V+4,G,ba)}})();(function(){for(var x=0;x<q.length;x+=6){var C=q[x+0],G=q[x+2],I=q[x+4],P=Math.min(C,G,I);.9<Math.max(C,G,I)&&.1>P&&(.2>C&&(q[x+0]+=1),.2>G&&(q[x+2]+=1),.2>I&&(q[x+4]+=1))}})()})();m.setAttribute("position",new Ma(n,3));m.setAttribute("normal",new Ma(n.slice(),3));m.setAttribute("uv",new Ma(q,2));0===d?m.computeVertexNormals():
m.normalizeNormals();return m};$jscomp.inherits(uc,ra);uc.fromJSON=function(a){return new uc(a.vertices,a.indices,a.radius,a.details)};var xe=function(a,b){a=void 0===a?1:a;b=void 0===b?0:b;var c=(1+Math.sqrt(5))/2;var d=1/c;c=uc.call(this,[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-d,-c,0,-d,c,0,d,-c,0,d,c,-d,-c,0,-d,c,0,d,-c,0,d,c,0,-c,0,-d,c,0,-d,-c,0,d,c,0,d],[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,
2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],a,b)||this;c.type="DodecahedronGeometry";c.parameters={radius:a,detail:b};return c};$jscomp.inherits(xe,uc);xe.fromJSON=function(a){return new xe(a.radius,a.detail)};var wh=new B,xh=new B,Yi=new B,yh=new eb,zh=function(a,b){var c;a=void 0===a?null:a;b=void 0===b?1:b;if(c=ra.call(this)||this,c.type="EdgesGeometry",c.parameters={geometry:a,thresholdAngle:b},
null!==a){var d=Math.pow(10,4),e=Math.cos(qe*b),g=a.getIndex();a=a.getAttribute("position");var h=g?g.count:a.count,m=[0,0,0],n=["a","b","c"],q=Array(3);b={};for(var t=[],r=0;r<h;r+=3){g?(m[0]=g.getX(r),m[1]=g.getX(r+1),m[2]=g.getX(r+2)):(m[0]=r,m[1]=r+1,m[2]=r+2);var u=yh,A=u.a,w=u.b;u=u.c;if(A.fromBufferAttribute(a,m[0]),w.fromBufferAttribute(a,m[1]),u.fromBufferAttribute(a,m[2]),yh.getNormal(Yi),q[0]=Math.round(A.x*d)+","+Math.round(A.y*d)+","+Math.round(A.z*d),q[1]=Math.round(w.x*d)+","+Math.round(w.y*
d)+","+Math.round(w.z*d),q[2]=Math.round(u.x*d)+","+Math.round(u.y*d)+","+Math.round(u.z*d),q[0]!==q[1]&&q[1]!==q[2]&&q[2]!==q[0])for(A=0;3>A;A++){w=(A+1)%3;var x=q[A],C=q[w];u=yh[n[A]];var G=yh[n[w]],I=x+"_"+C;x=C+"_"+x;x in b&&b[x]?(Yi.dot(b[x].normal)<=e&&(t.push(u.x,u.y,u.z),t.push(G.x,G.y,G.z)),b[x]=null):I in b||(b[I]={index0:m[A],index1:m[w],normal:Yi.clone()})}}for(var P in b)b[P]&&(d=b[P],e=d.index1,wh.fromBufferAttribute(a,d.index0),xh.fromBufferAttribute(a,e),t.push(wh.x,wh.y,wh.z),t.push(xh.x,
xh.y,xh.z));c.setAttribute("position",new Ma(t,3))}return c};$jscomp.inherits(zh,ra);var Ga=function(){this.type="Curve";this.arcLengthDivisions=200};Ga.prototype.getPoint=function(){return console.warn("THREE.Curve: .getPoint() not implemented."),null};Ga.prototype.getPointAt=function(a,b){a=this.getUtoTmapping(a);return this.getPoint(a,b)};Ga.prototype.getPoints=function(a){a=void 0===a?5:a;for(var b=[],c=0;c<=a;c++)b.push(this.getPoint(c/a));return b};Ga.prototype.getSpacedPoints=function(a){a=
void 0===a?5:a;for(var b=[],c=0;c<=a;c++)b.push(this.getPointAt(c/a));return b};Ga.prototype.getLength=function(){var a=this.getLengths();return a[a.length-1]};Ga.prototype.getLengths=function(a){a=void 0===a?this.arcLengthDivisions:a;if(this.cacheArcLengths&&this.cacheArcLengths.length===a+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var b=[],c=this.getPoint(0),d=0;b.push(0);for(var e=1;e<=a;e++){var g=this.getPoint(e/a);d+=g.distanceTo(c);b.push(d);c=g}return this.cacheArcLengths=
b,b};Ga.prototype.updateArcLengths=function(){this.needsUpdate=!0;this.getLengths()};Ga.prototype.getUtoTmapping=function(a,b){var c=this.getLengths(),d=0,e=c.length;a=b||a*c[e-1];var g;b=0;for(var h=e-1;b<=h;)if(d=Math.floor(b+(h-b)/2),g=c[d]-a,0>g)b=d+1;else{if(!(0<g)){h=d;break}h=d-1}if(d=h,c[d]===a)return d/(e-1);g=c[d];return(d+(a-g)/(c[d+1]-g))/(e-1)};Ga.prototype.getTangent=function(a,b){var c=a-1E-4;a+=1E-4;0>c&&(c=0);1<a&&(a=1);c=this.getPoint(c);a=this.getPoint(a);b=b||(c.isVector2?new T:
new B);return b.copy(a).sub(c).normalize(),b};Ga.prototype.getTangentAt=function(a,b){a=this.getUtoTmapping(a);return this.getTangent(a,b)};Ga.prototype.computeFrenetFrames=function(a,b){for(var c=new B,d=[],e=[],g=[],h=new B,m=new ua,n=0;n<=a;n++)d[n]=this.getTangentAt(n/a,new B);e[0]=new B;g[0]=new B;n=Number.MAX_VALUE;var q=Math.abs(d[0].x),t=Math.abs(d[0].y),r=Math.abs(d[0].z);q<=n&&(n=q,c.set(1,0,0));t<=n&&(n=t,c.set(0,1,0));r<=n&&c.set(0,0,1);h.crossVectors(d[0],c).normalize();e[0].crossVectors(d[0],
h);g[0].crossVectors(d[0],e[0]);for(c=1;c<=a;c++){if(e[c]=e[c-1].clone(),g[c]=g[c-1].clone(),h.crossVectors(d[c-1],d[c]),h.length()>Number.EPSILON)h.normalize(),n=Math.acos(R(d[c-1].dot(d[c]),-1,1)),e[c].applyMatrix4(m.makeRotationAxis(h,n));g[c].crossVectors(d[c],e[c])}if(!0===b)for(b=Math.acos(R(e[0].dot(e[a]),-1,1)),b/=a,0<d[0].dot(h.crossVectors(e[0],e[a]))&&(b=-b),h=1;h<=a;h++)e[h].applyMatrix4(m.makeRotationAxis(d[h],b*h)),g[h].crossVectors(d[h],e[h]);return{tangents:d,normals:e,binormals:g}};
Ga.prototype.clone=function(){return(new this.constructor).copy(this)};Ga.prototype.copy=function(a){return this.arcLengthDivisions=a.arcLengthDivisions,this};Ga.prototype.toJSON=function(){var a={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return a.arcLengthDivisions=this.arcLengthDivisions,a.type=this.type,a};Ga.prototype.fromJSON=function(a){return this.arcLengthDivisions=a.arcLengthDivisions,this};var Yc=function(a,b,c,d,e,g,h,m){a=void 0===a?0:a;b=void 0===b?0:b;c=void 0===
c?1:c;d=void 0===d?1:d;e=void 0===e?0:e;g=void 0===g?2*Math.PI:g;h=void 0===h?!1:h;m=void 0===m?0:m;var n=Ga.call(this)||this;n.type="EllipseCurve";n.aX=a;n.aY=b;n.xRadius=c;n.yRadius=d;n.aStartAngle=e;n.aEndAngle=g;n.aClockwise=h;n.aRotation=m;return n};$jscomp.inherits(Yc,Ga);Yc.prototype.getPoint=function(a,b){b=b||new T;for(var c=2*Math.PI,d=this.aEndAngle-this.aStartAngle,e=Math.abs(d)<Number.EPSILON;0>d;)d+=c;for(;d>c;)d-=c;d<Number.EPSILON&&(d=e?0:c);!0!==this.aClockwise||e||(d===c?d=-c:d-=
c);c=this.aStartAngle+a*d;a=this.aX+this.xRadius*Math.cos(c);var g=this.aY+this.yRadius*Math.sin(c);0!==this.aRotation&&(c=Math.cos(this.aRotation),d=Math.sin(this.aRotation),e=a-this.aX,g-=this.aY,a=e*c-g*d+this.aX,g=e*d+g*c+this.aY);return b.set(a,g)};Yc.prototype.copy=function(a){return Ga.prototype.copy.call(this,a),this.aX=a.aX,this.aY=a.aY,this.xRadius=a.xRadius,this.yRadius=a.yRadius,this.aStartAngle=a.aStartAngle,this.aEndAngle=a.aEndAngle,this.aClockwise=a.aClockwise,this.aRotation=a.aRotation,
this};Yc.prototype.toJSON=function(){var a=Ga.prototype.toJSON.call(this);return a.aX=this.aX,a.aY=this.aY,a.xRadius=this.xRadius,a.yRadius=this.yRadius,a.aStartAngle=this.aStartAngle,a.aEndAngle=this.aEndAngle,a.aClockwise=this.aClockwise,a.aRotation=this.aRotation,a};Yc.prototype.fromJSON=function(a){return Ga.prototype.fromJSON.call(this,a),this.aX=a.aX,this.aY=a.aY,this.xRadius=a.xRadius,this.yRadius=a.yRadius,this.aStartAngle=a.aStartAngle,this.aEndAngle=a.aEndAngle,this.aClockwise=a.aClockwise,
this.aRotation=a.aRotation,this};Yc.prototype.isEllipseCurve=!0;var Ah=function(a,b,c,d,e,g){a=Yc.call(this,a,b,c,c,d,e,g)||this;a.type="ArcCurve";return a};$jscomp.inherits(Ah,Yc);Ah.prototype.isArcCurve=!0;var Bh=new B,Zi=new ri,$i=new ri,aj=new ri,Yd=function(a,b,c,d){a=void 0===a?[]:a;b=void 0===b?!1:b;c=void 0===c?"centripetal":c;d=void 0===d?.5:d;var e=Ga.call(this)||this;e.type="CatmullRomCurve3";e.points=a;e.closed=b;e.curveType=c;e.tension=d;return e};$jscomp.inherits(Yd,Ga);Yd.prototype.getPoint=
function(a,b){b=void 0===b?new B:b;var c=this.points,d=c.length;a*=d-(this.closed?0:1);var e,g,h=Math.floor(a);a-=h;this.closed?h+=0<h?0:(Math.floor(Math.abs(h)/d)+1)*d:0===a&&h===d-1&&(h=d-2,a=1);this.closed||0<h?e=c[(h-1)%d]:(Bh.subVectors(c[0],c[1]).add(c[0]),e=Bh);var m=c[h%d],n=c[(h+1)%d];(this.closed||h+2<d?g=c[(h+2)%d]:(Bh.subVectors(c[d-1],c[d-2]).add(c[d-1]),g=Bh),"centripetal"===this.curveType||"chordal"===this.curveType)?(h="chordal"===this.curveType?.5:.25,c=Math.pow(e.distanceToSquared(m),
h),d=Math.pow(m.distanceToSquared(n),h),h=Math.pow(n.distanceToSquared(g),h),1E-4>d&&(d=1),1E-4>c&&(c=d),1E-4>h&&(h=d),Zi.initNonuniformCatmullRom(e.x,m.x,n.x,g.x,c,d,h),$i.initNonuniformCatmullRom(e.y,m.y,n.y,g.y,c,d,h),aj.initNonuniformCatmullRom(e.z,m.z,n.z,g.z,c,d,h)):"catmullrom"===this.curveType&&(Zi.initCatmullRom(e.x,m.x,n.x,g.x,this.tension),$i.initCatmullRom(e.y,m.y,n.y,g.y,this.tension),aj.initCatmullRom(e.z,m.z,n.z,g.z,this.tension));return b.set(Zi.calc(a),$i.calc(a),aj.calc(a)),b};Yd.prototype.copy=
function(a){Ga.prototype.copy.call(this,a);this.points=[];for(var b=0,c=a.points.length;b<c;b++)this.points.push(a.points[b].clone());return this.closed=a.closed,this.curveType=a.curveType,this.tension=a.tension,this};Yd.prototype.toJSON=function(){var a=Ga.prototype.toJSON.call(this);a.points=[];for(var b=0,c=this.points.length;b<c;b++)a.points.push(this.points[b].toArray());return a.closed=this.closed,a.curveType=this.curveType,a.tension=this.tension,a};Yd.prototype.fromJSON=function(a){Ga.prototype.fromJSON.call(this,
a);this.points=[];for(var b=0,c=a.points.length;b<c;b++){var d=a.points[b];this.points.push((new B).fromArray(d))}return this.closed=a.closed,this.curveType=a.curveType,this.tension=a.tension,this};Yd.prototype.isCatmullRomCurve3=!0;var xd=function(a,b,c,d){a=void 0===a?new T:a;b=void 0===b?new T:b;c=void 0===c?new T:c;d=void 0===d?new T:d;var e=Ga.call(this)||this;e.type="CubicBezierCurve";e.v0=a;e.v1=b;e.v2=c;e.v3=d;return e};$jscomp.inherits(xd,Ga);xd.prototype.getPoint=function(a,b){b=void 0===
b?new T:b;var c=this.v0,d=this.v1,e=this.v2,g=this.v3;return b.set(Wf(a,c.x,d.x,e.x,g.x),Wf(a,c.y,d.y,e.y,g.y)),b};xd.prototype.copy=function(a){return Ga.prototype.copy.call(this,a),this.v0.copy(a.v0),this.v1.copy(a.v1),this.v2.copy(a.v2),this.v3.copy(a.v3),this};xd.prototype.toJSON=function(){var a=Ga.prototype.toJSON.call(this);return a.v0=this.v0.toArray(),a.v1=this.v1.toArray(),a.v2=this.v2.toArray(),a.v3=this.v3.toArray(),a};xd.prototype.fromJSON=function(a){return Ga.prototype.fromJSON.call(this,
a),this.v0.fromArray(a.v0),this.v1.fromArray(a.v1),this.v2.fromArray(a.v2),this.v3.fromArray(a.v3),this};xd.prototype.isCubicBezierCurve=!0;var Zd=function(a,b,c,d){a=void 0===a?new B:a;b=void 0===b?new B:b;c=void 0===c?new B:c;d=void 0===d?new B:d;var e=Ga.call(this)||this;e.type="CubicBezierCurve3";e.v0=a;e.v1=b;e.v2=c;e.v3=d;return e};$jscomp.inherits(Zd,Ga);Zd.prototype.getPoint=function(a,b){b=void 0===b?new B:b;var c=this.v0,d=this.v1,e=this.v2,g=this.v3;return b.set(Wf(a,c.x,d.x,e.x,g.x),Wf(a,
c.y,d.y,e.y,g.y),Wf(a,c.z,d.z,e.z,g.z)),b};Zd.prototype.copy=function(a){return Ga.prototype.copy.call(this,a),this.v0.copy(a.v0),this.v1.copy(a.v1),this.v2.copy(a.v2),this.v3.copy(a.v3),this};Zd.prototype.toJSON=function(){var a=Ga.prototype.toJSON.call(this);return a.v0=this.v0.toArray(),a.v1=this.v1.toArray(),a.v2=this.v2.toArray(),a.v3=this.v3.toArray(),a};Zd.prototype.fromJSON=function(a){return Ga.prototype.fromJSON.call(this,a),this.v0.fromArray(a.v0),this.v1.fromArray(a.v1),this.v2.fromArray(a.v2),
this.v3.fromArray(a.v3),this};Zd.prototype.isCubicBezierCurve3=!0;var Mc=function(a,b){a=void 0===a?new T:a;b=void 0===b?new T:b;var c=Ga.call(this)||this;c.type="LineCurve";c.v1=a;c.v2=b;return c};$jscomp.inherits(Mc,Ga);Mc.prototype.getPoint=function(a,b){b=void 0===b?new T:b;return 1===a?b.copy(this.v2):(b.copy(this.v2).sub(this.v1),b.multiplyScalar(a).add(this.v1)),b};Mc.prototype.getPointAt=function(a,b){return this.getPoint(a,b)};Mc.prototype.getTangent=function(a,b){a=b||new T;return a.copy(this.v2).sub(this.v1).normalize(),
a};Mc.prototype.copy=function(a){return Ga.prototype.copy.call(this,a),this.v1.copy(a.v1),this.v2.copy(a.v2),this};Mc.prototype.toJSON=function(){var a=Ga.prototype.toJSON.call(this);return a.v1=this.v1.toArray(),a.v2=this.v2.toArray(),a};Mc.prototype.fromJSON=function(a){return Ga.prototype.fromJSON.call(this,a),this.v1.fromArray(a.v1),this.v2.fromArray(a.v2),this};Mc.prototype.isLineCurve=!0;var $d=function(a,b){a=void 0===a?new B:a;b=void 0===b?new B:b;var c=Ga.call(this)||this;c.type="LineCurve3";
c.isLineCurve3=!0;c.v1=a;c.v2=b;return c};$jscomp.inherits($d,Ga);$d.prototype.getPoint=function(a,b){b=void 0===b?new B:b;return 1===a?b.copy(this.v2):(b.copy(this.v2).sub(this.v1),b.multiplyScalar(a).add(this.v1)),b};$d.prototype.getPointAt=function(a,b){return this.getPoint(a,b)};$d.prototype.copy=function(a){return Ga.prototype.copy.call(this,a),this.v1.copy(a.v1),this.v2.copy(a.v2),this};$d.prototype.toJSON=function(){var a=Ga.prototype.toJSON.call(this);return a.v1=this.v1.toArray(),a.v2=this.v2.toArray(),
a};$d.prototype.fromJSON=function(a){return Ga.prototype.fromJSON.call(this,a),this.v1.fromArray(a.v1),this.v2.fromArray(a.v2),this};var yd=function(a,b,c){a=void 0===a?new T:a;b=void 0===b?new T:b;c=void 0===c?new T:c;var d=Ga.call(this)||this;d.type="QuadraticBezierCurve";d.v0=a;d.v1=b;d.v2=c;return d};$jscomp.inherits(yd,Ga);yd.prototype.getPoint=function(a,b){b=void 0===b?new T:b;var c=this.v0,d=this.v1,e=this.v2;return b.set(Vf(a,c.x,d.x,e.x),Vf(a,c.y,d.y,e.y)),b};yd.prototype.copy=function(a){return Ga.prototype.copy.call(this,
a),this.v0.copy(a.v0),this.v1.copy(a.v1),this.v2.copy(a.v2),this};yd.prototype.toJSON=function(){var a=Ga.prototype.toJSON.call(this);return a.v0=this.v0.toArray(),a.v1=this.v1.toArray(),a.v2=this.v2.toArray(),a};yd.prototype.fromJSON=function(a){return Ga.prototype.fromJSON.call(this,a),this.v0.fromArray(a.v0),this.v1.fromArray(a.v1),this.v2.fromArray(a.v2),this};yd.prototype.isQuadraticBezierCurve=!0;var zd=function(a,b,c){a=void 0===a?new B:a;b=void 0===b?new B:b;c=void 0===c?new B:c;var d=Ga.call(this)||
this;d.type="QuadraticBezierCurve3";d.v0=a;d.v1=b;d.v2=c;return d};$jscomp.inherits(zd,Ga);zd.prototype.getPoint=function(a,b){b=void 0===b?new B:b;var c=this.v0,d=this.v1,e=this.v2;return b.set(Vf(a,c.x,d.x,e.x),Vf(a,c.y,d.y,e.y),Vf(a,c.z,d.z,e.z)),b};zd.prototype.copy=function(a){return Ga.prototype.copy.call(this,a),this.v0.copy(a.v0),this.v1.copy(a.v1),this.v2.copy(a.v2),this};zd.prototype.toJSON=function(){var a=Ga.prototype.toJSON.call(this);return a.v0=this.v0.toArray(),a.v1=this.v1.toArray(),
a.v2=this.v2.toArray(),a};zd.prototype.fromJSON=function(a){return Ga.prototype.fromJSON.call(this,a),this.v0.fromArray(a.v0),this.v1.fromArray(a.v1),this.v2.fromArray(a.v2),this};zd.prototype.isQuadraticBezierCurve3=!0;var Ad=function(a){a=void 0===a?[]:a;var b=Ga.call(this)||this;b.type="SplineCurve";b.points=a;return b};$jscomp.inherits(Ad,Ga);Ad.prototype.getPoint=function(a,b){b=void 0===b?new T:b;var c=this.points,d=(c.length-1)*a;a=Math.floor(d);d-=a;var e=c[0===a?a:a-1],g=c[a],h=c[a>c.length-
2?c.length-1:a+1];c=c[a>c.length-3?c.length-1:a+2];return b.set(Sj(d,e.x,g.x,h.x,c.x),Sj(d,e.y,g.y,h.y,c.y)),b};Ad.prototype.copy=function(a){Ga.prototype.copy.call(this,a);this.points=[];for(var b=0,c=a.points.length;b<c;b++)this.points.push(a.points[b].clone());return this};Ad.prototype.toJSON=function(){var a=Ga.prototype.toJSON.call(this);a.points=[];for(var b=0,c=this.points.length;b<c;b++)a.points.push(this.points[b].toArray());return a};Ad.prototype.fromJSON=function(a){Ga.prototype.fromJSON.call(this,
a);this.points=[];for(var b=0,c=a.points.length;b<c;b++){var d=a.points[b];this.points.push((new T).fromArray(d))}return this};Ad.prototype.isSplineCurve=!0;var bj=Object.freeze({__proto__:null,ArcCurve:Ah,CatmullRomCurve3:Yd,CubicBezierCurve:xd,CubicBezierCurve3:Zd,EllipseCurve:Yc,LineCurve:Mc,LineCurve3:$d,QuadraticBezierCurve:yd,QuadraticBezierCurve3:zd,SplineCurve:Ad}),ec=function(){var a=Ga.call(this)||this;a.type="CurvePath";a.curves=[];a.autoClose=!1;return a};$jscomp.inherits(ec,Ga);ec.prototype.add=
function(a){this.curves.push(a)};ec.prototype.closePath=function(){var a=this.curves[0].getPoint(0),b=this.curves[this.curves.length-1].getPoint(1);a.equals(b)||this.curves.push(new Mc(b,a))};ec.prototype.getPoint=function(a,b){var c=a*this.getLength(),d=this.getCurveLengths();for(a=0;a<d.length;){if(d[a]>=c)return c=d[a]-c,a=this.curves[a],d=a.getLength(),a.getPointAt(0===d?0:1-c/d,b);a++}return null};ec.prototype.getLength=function(){var a=this.getCurveLengths();return a[a.length-1]};ec.prototype.updateArcLengths=
function(){this.needsUpdate=!0;this.cacheLengths=null;this.getCurveLengths()};ec.prototype.getCurveLengths=function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;for(var a=[],b=0,c=0,d=this.curves.length;c<d;c++)b+=this.curves[c].getLength(),a.push(b);return this.cacheLengths=a,a};ec.prototype.getSpacedPoints=function(a){a=void 0===a?40:a;for(var b=[],c=0;c<=a;c++)b.push(this.getPoint(c/a));return this.autoClose&&b.push(b[0]),b};ec.prototype.getPoints=
function(a){a=void 0===a?12:a;for(var b=[],c,d=0,e=this.curves;d<e.length;d++){var g=e[d];g=g.getPoints(g&&g.isEllipseCurve?2*a:g&&(g.isLineCurve||g.isLineCurve3)?1:g&&g.isSplineCurve?a*g.points.length:a);for(var h=0;h<g.length;h++){var m=g[h];c&&c.equals(m)||(b.push(m),c=m)}}return this.autoClose&&1<b.length&&!b[b.length-1].equals(b[0])&&b.push(b[0]),b};ec.prototype.copy=function(a){Ga.prototype.copy.call(this,a);this.curves=[];for(var b=0,c=a.curves.length;b<c;b++)this.curves.push(a.curves[b].clone());
return this.autoClose=a.autoClose,this};ec.prototype.toJSON=function(){var a=Ga.prototype.toJSON.call(this);a.autoClose=this.autoClose;a.curves=[];for(var b=0,c=this.curves.length;b<c;b++)a.curves.push(this.curves[b].toJSON());return a};ec.prototype.fromJSON=function(a){Ga.prototype.fromJSON.call(this,a);this.autoClose=a.autoClose;this.curves=[];for(var b=0,c=a.curves.length;b<c;b++){var d=a.curves[b];this.curves.push((new bj[d.type]).fromJSON(d))}return this};var Ob=function(a){var b=ec.call(this)||
this;b.type="Path";b.currentPoint=new T;a&&b.setFromPoints(a);return b};$jscomp.inherits(Ob,ec);Ob.prototype.setFromPoints=function(a){this.moveTo(a[0].x,a[0].y);for(var b=1,c=a.length;b<c;b++)this.lineTo(a[b].x,a[b].y);return this};Ob.prototype.moveTo=function(a,b){return this.currentPoint.set(a,b),this};Ob.prototype.lineTo=function(a,b){var c=new Mc(this.currentPoint.clone(),new T(a,b));return this.curves.push(c),this.currentPoint.set(a,b),this};Ob.prototype.quadraticCurveTo=function(a,b,c,d){a=
new yd(this.currentPoint.clone(),new T(a,b),new T(c,d));return this.curves.push(a),this.currentPoint.set(c,d),this};Ob.prototype.bezierCurveTo=function(a,b,c,d,e,g){a=new xd(this.currentPoint.clone(),new T(a,b),new T(c,d),new T(e,g));return this.curves.push(a),this.currentPoint.set(e,g),this};Ob.prototype.splineThru=function(a){var b=[this.currentPoint.clone()].concat(a);b=new Ad(b);return this.curves.push(b),this.currentPoint.copy(a[a.length-1]),this};Ob.prototype.arc=function(a,b,c,d,e,g){return this.absarc(a+
this.currentPoint.x,b+this.currentPoint.y,c,d,e,g),this};Ob.prototype.absarc=function(a,b,c,d,e,g){return this.absellipse(a,b,c,c,d,e,g),this};Ob.prototype.ellipse=function(a,b,c,d,e,g,h,m){return this.absellipse(a+this.currentPoint.x,b+this.currentPoint.y,c,d,e,g,h,m),this};Ob.prototype.absellipse=function(a,b,c,d,e,g,h,m){a=new Yc(a,b,c,d,e,g,h,m);0<this.curves.length&&(b=a.getPoint(0),b.equals(this.currentPoint)||this.lineTo(b.x,b.y));this.curves.push(a);a=a.getPoint(1);return this.currentPoint.copy(a),
this};Ob.prototype.copy=function(a){return ec.prototype.copy.call(this,a),this.currentPoint.copy(a.currentPoint),this};Ob.prototype.toJSON=function(){var a=ec.prototype.toJSON.call(this);return a.currentPoint=this.currentPoint.toArray(),a};Ob.prototype.fromJSON=function(a){return ec.prototype.fromJSON.call(this,a),this.currentPoint.fromArray(a.currentPoint),this};var pc=function(a){a=Ob.call(this,a)||this;a.uuid=N();a.type="Shape";a.holes=[];return a};$jscomp.inherits(pc,Ob);pc.prototype.getPointsHoles=
function(a){for(var b=[],c=0,d=this.holes.length;c<d;c++)b[c]=this.holes[c].getPoints(a);return b};pc.prototype.extractPoints=function(a){return{shape:this.getPoints(a),holes:this.getPointsHoles(a)}};pc.prototype.copy=function(a){Ob.prototype.copy.call(this,a);this.holes=[];for(var b=0,c=a.holes.length;b<c;b++)this.holes.push(a.holes[b].clone());return this};pc.prototype.toJSON=function(){var a=Ob.prototype.toJSON.call(this);a.uuid=this.uuid;a.holes=[];for(var b=0,c=this.holes.length;b<c;b++)a.holes.push(this.holes[b].toJSON());
return a};pc.prototype.fromJSON=function(a){Ob.prototype.fromJSON.call(this,a);this.uuid=a.uuid;this.holes=[];for(var b=0,c=a.holes.length;b<c;b++){var d=a.holes[b];this.holes.push((new Ob).fromJSON(d))}return this};var Nc=function(){};Nc.area=function(a){for(var b=a.length,c=0,d=b-1,e=0;e<b;d=e++)c+=a[d].x*a[e].y-a[e].x*a[d].y;return.5*c};Nc.isClockWise=function(a){return 0>Nc.area(a)};Nc.triangulateShape=function(a,b){var c=[],d=[],e=[];Xj(a);Yj(c,a);a=a.length;b.forEach(Xj);for(var g=0;g<b.length;g++)d.push(a),
a+=b[g].length,Yj(c,b[g]);b=void 0;b=void 0===b?2:b;var h=d&&d.length;a=h?d[0]*b:c.length;var m=Tj(c,0,a,b,!0);g=[];if(m&&m.next!==m.prev){var n;if(h){h=b;var q=[];var t;var r=0;for(t=d.length;r<t;r++){var u=d[r]*h;var A=r<t-1?d[r+1]*h:c.length;u=Tj(c,u,A,h,!1);u===u.next&&(u.steiner=!0);A=q;var w=A.push,x=u,C=u;do(x.x<C.x||x.x===C.x&&x.y<C.y)&&(C=x),x=x.next;while(x!==u);w.call(A,C)}q.sort(Kl);for(r=0;r<q.length;r++)Ll(q[r],m),m=Md(m,m.next)}if(c.length>80*b){var G=d=c[0];var I=n=c[1];for(r=b;r<
a;r+=b)h=c[r],q=c[r+1],h<G&&(G=h),q<I&&(I=q),h>d&&(d=h),q>n&&(n=q);n=Math.max(d-G,n-I);n=0!==n?1/n:0}c=(Yf(m,g,b,G,I,n),g)}else c=g;for(G=0;G<c.length;G+=3)e.push(c.slice(G,G+3));return e};var Oc=function(a,b){function c(q){function t(Fa,Da,La){return Da||console.error("THREE.ExtrudeGeometry: vec does not exist"),Da.clone().multiplyScalar(La).add(Fa)}function r(Fa,Da,La){var ib=Fa.x-Da.x,kb=Fa.y-Da.y,ob=La.x-Fa.x,nc=La.y-Fa.y,Jb=ib*ib+kb*kb;if(Math.abs(ib*nc-kb*ob)>Number.EPSILON){var Yb=Math.sqrt(Jb);
var oc=Math.sqrt(ob*ob+nc*nc);var bc=Da.x-kb/Yb;Da=Da.y+ib/Yb;ob=((La.x-nc/oc-bc)*nc-(La.y+ob/oc-Da)*ob)/(ib*nc-kb*ob);bc=bc+ib*ob-Fa.x;oc=Da+kb*ob-Fa.y;ib=bc*bc+oc*oc;if(2>=ib)return new T(bc,oc);Yb=Math.sqrt(ib/2)}else Fa=!1,ib>Number.EPSILON?ob>Number.EPSILON&&(Fa=!0):ib<-Number.EPSILON?ob<-Number.EPSILON&&(Fa=!0):Math.sign(kb)===Math.sign(nc)&&(Fa=!0),Fa?(bc=-kb,oc=ib,Yb=Math.sqrt(Jb)):(bc=ib,oc=kb,Yb=Math.sqrt(Jb/2));return new T(bc/Yb,oc/Yb)}function u(Fa,Da){for(var La=Fa.length;0<=--La;){var ib=
La,kb=La-1;0>kb&&(kb=Fa.length-1);for(var ob=0,nc=P+2*Y;ob<nc;ob++){var Jb=W*ob,Yb=W*(ob+1),oc=Da+kb+Jb,bc=Da+kb+Yb;Yb=Da+ib+Yb;x(Da+ib+Jb);x(oc);x(Yb);x(oc);x(bc);x(Yb);Jb=g.length/3;Jb=Ha.generateSideWallUV(e,g,Jb-6,Jb-3,Jb-2,Jb-1);C(Jb[0]);C(Jb[1]);C(Jb[3]);C(Jb[1]);C(Jb[2]);C(Jb[3])}}}function A(Fa,Da,La){G.push(Fa);G.push(Da);G.push(La)}function w(Fa,Da,La){x(Fa);x(Da);x(La);Fa=g.length/3;Fa=Ha.generateTopUV(e,g,Fa-3,Fa-2,Fa-1);C(Fa[0]);C(Fa[1]);C(Fa[2])}function x(Fa){g.push(G[3*Fa]);g.push(G[3*
Fa+1]);g.push(G[3*Fa+2])}function C(Fa){h.push(Fa.x);h.push(Fa.y)}var G=[],I=void 0!==b.curveSegments?b.curveSegments:12,P=void 0!==b.steps?b.steps:1,O=void 0!==b.depth?b.depth:1,M=void 0===b.bevelEnabled||b.bevelEnabled,S=void 0!==b.bevelThickness?b.bevelThickness:.2,V=void 0!==b.bevelSize?b.bevelSize:S-.1,ba=void 0!==b.bevelOffset?b.bevelOffset:0,Y=void 0!==b.bevelSegments?b.bevelSegments:3,Z=b.extrudePath,Ha=void 0!==b.UVGenerator?b.UVGenerator:bm;void 0!==b.amount&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),
O=b.amount);var ya,ja,Ja,Va,db,Xa=!1;Z&&(ya=Z.getSpacedPoints(P),Xa=!0,M=!1,ja=Z.computeFrenetFrames(P,!1),Ja=new B,Va=new B,db=new B);M||(Y=0,S=0,V=0,ba=0);q=q.extractPoints(I);Z=q.shape;var Qa=q.holes;if(!Nc.isClockWise(Z))for(Z=Z.reverse(),q=0,I=Qa.length;q<I;q++){var D=Qa[q];Nc.isClockWise(D)&&(Qa[q]=D.reverse())}var E=Nc.triangulateShape(Z,Qa),J=Z;q=0;for(I=Qa.length;q<I;q++)Z=Z.concat(Qa[q]);var W=Z.length,qa=E.length;q=[];I=0;D=J.length;for(var K=D-1,ha=I+1;I<D;I++,K++,ha++)K===D&&(K=0),ha===
D&&(ha=0),q[I]=r(J[I],J[K],J[ha]);I=[];D=q.concat();ha=0;for(var da=Qa.length;ha<da;ha++){var wa=Qa[ha];K=[];for(var na=0,Za=wa.length,Ka=Za-1,pb=na+1;na<Za;na++,Ka++,pb++)Ka===Za&&(Ka=0),pb===Za&&(pb=0),K[na]=r(wa[na],wa[Ka],wa[pb]);I.push(K);D=D.concat(K)}for(ha=0;ha<Y;ha++){K=ha/Y;da=S*Math.cos(K*Math.PI/2);wa=V*Math.sin(K*Math.PI/2)+ba;K=0;for(na=J.length;K<na;K++)Za=t(J[K],q[K],wa),A(Za.x,Za.y,-da);na=0;for(Za=Qa.length;na<Za;na++){Ka=Qa[na];K=I[na];pb=0;for(var xc=Ka.length;pb<xc;pb++){var Eb=
t(Ka[pb],K[pb],wa);A(Eb.x,Eb.y,-da)}}}K=V+ba;for(ha=0;ha<W;ha++)da=M?t(Z[ha],D[ha],K):Z[ha],Xa?(Va.copy(ja.normals[0]).multiplyScalar(da.x),Ja.copy(ja.binormals[0]).multiplyScalar(da.y),db.copy(ya[0]).add(Va).add(Ja),A(db.x,db.y,db.z)):A(da.x,da.y,0);for(ha=1;ha<=P;ha++)for(da=0;da<W;da++)wa=M?t(Z[da],D[da],K):Z[da],Xa?(Va.copy(ja.normals[ha]).multiplyScalar(wa.x),Ja.copy(ja.binormals[ha]).multiplyScalar(wa.y),db.copy(ya[ha]).add(Va).add(Ja),A(db.x,db.y,db.z)):A(wa.x,wa.y,O/P*ha);for(ja=Y-1;0<=ja;ja--){Va=
ja/Y;Ja=S*Math.cos(Va*Math.PI/2);Va=V*Math.sin(Va*Math.PI/2)+ba;Z=0;for(D=J.length;Z<D;Z++)K=t(J[Z],q[Z],Va),A(K.x,K.y,O+Ja);Z=0;for(D=Qa.length;Z<D;Z++)for(ha=Qa[Z],K=I[Z],da=0,wa=ha.length;da<wa;da++)na=t(ha[da],K[da],Va),Xa?A(na.x,na.y+ya[P-1].y,ya[P-1].x+Ja):A(na.x,na.y,O+Ja)}!function(){var Fa=g.length/3;if(M){for(var Da=0*W,La=0;La<qa;La++){var ib=E[La];w(ib[2]+Da,ib[1]+Da,ib[0]+Da)}Da=W*(P+2*Y);for(La=0;La<qa;La++)ib=E[La],w(ib[0]+Da,ib[1]+Da,ib[2]+Da)}else{for(Da=0;Da<qa;Da++)La=E[Da],w(La[2],
La[1],La[0]);for(Da=0;Da<qa;Da++)La=E[Da],w(La[0]+W*P,La[1]+W*P,La[2]+W*P)}e.addGroup(Fa,g.length/3-Fa,0)}();(function(){var Fa=g.length/3,Da=0;u(J,Da);Da+=J.length;for(var La=0,ib=Qa.length;La<ib;La++){var kb=Qa[La];u(kb,Da);Da+=kb.length}e.addGroup(Fa,g.length/3-Fa,1)})()}a=void 0===a?new pc([new T(.5,.5),new T(-.5,.5),new T(-.5,-.5),new T(.5,-.5)]):a;b=void 0===b?{}:b;var d=ra.call(this)||this;d.type="ExtrudeGeometry";d.parameters={shapes:a,options:b};a=Array.isArray(a)?a:[a];for(var e=d,g=[],
h=[],m=0,n=a.length;m<n;m++)c(a[m]);d.setAttribute("position",new Ma(g,3));d.setAttribute("uv",new Ma(h,2));d.computeVertexNormals();return d};$jscomp.inherits(Oc,ra);Oc.prototype.toJSON=function(){var a=ra.prototype.toJSON.call(this),b=this.parameters.shapes,c=this.parameters.options;if(a.shapes=[],Array.isArray(b))for(var d=0,e=b.length;d<e;d++)a.shapes.push(b[d].uuid);else a.shapes.push(b.uuid);void 0!==c.extrudePath&&(a.options.extrudePath=c.extrudePath.toJSON());return a};Oc.fromJSON=function(a,
b){for(var c=[],d=0,e=a.shapes.length;d<e;d++)c.push(b[a.shapes[d]]);b=a.options.extrudePath;return void 0!==b&&(a.options.extrudePath=(new bj[b.type]).fromJSON(b)),new Oc(c,a.options)};var bm={generateTopUV:function(a,b,c,d,e){a=b[3*d];d=b[3*d+1];var g=b[3*e];e=b[3*e+1];return[new T(b[3*c],b[3*c+1]),new T(a,d),new T(g,e)]},generateSideWallUV:function(a,b,c,d,e,g){a=b[3*c];var h=b[3*c+1];c=b[3*c+2];var m=b[3*d],n=b[3*d+1];d=b[3*d+2];var q=b[3*e],t=b[3*e+1];e=b[3*e+2];var r=b[3*g],u=b[3*g+1];b=b[3*
g+2];return Math.abs(h-n)<Math.abs(a-m)?[new T(a,1-c),new T(m,1-d),new T(q,1-e),new T(r,1-b)]:[new T(h,1-c),new T(n,1-d),new T(t,1-e),new T(u,1-b)]}},ye=function(a,b){a=void 0===a?1:a;b=void 0===b?0:b;var c=(1+Math.sqrt(5))/2;c=uc.call(this,[-1,c,0,1,c,0,-1,-c,0,1,-c,0,0,-1,c,0,1,c,0,-1,-c,0,1,-c,c,0,-1,c,0,1,-c,0,-1,-c,0,1],[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],a,b)||this;c.type="IcosahedronGeometry";c.parameters=
{radius:a,detail:b};return c};$jscomp.inherits(ye,uc);ye.fromJSON=function(a){return new ye(a.radius,a.detail)};var ze=function(a,b,c,d){a=void 0===a?[new T(0,.5),new T(.5,0),new T(0,-.5)]:a;b=void 0===b?12:b;c=void 0===c?0:c;d=void 0===d?2*Math.PI:d;var e=ra.call(this)||this;e.type="LatheGeometry";e.parameters={points:a,segments:b,phiStart:c,phiLength:d};b=Math.floor(b);d=R(d,0,2*Math.PI);for(var g=[],h=[],m=[],n=1/b,q=new B,t=new T,r=0;r<=b;r++){var u=c+r*n*d,A=Math.sin(u);u=Math.cos(u);for(var w=
0;w<=a.length-1;w++)q.x=a[w].x*A,q.y=a[w].y,q.z=a[w].x*u,h.push(q.x,q.y,q.z),t.x=r/b,t.y=w/(a.length-1),m.push(t.x,t.y)}for(c=0;c<b;c++)for(n=0;n<a.length-1;n++)q=n+c*a.length,t=q+a.length,r=q+a.length+1,A=q+1,g.push(q,t,A),g.push(t,r,A);if(e.setIndex(g),e.setAttribute("position",new Ma(h,3)),e.setAttribute("uv",new Ma(m,2)),e.computeVertexNormals(),d===2*Math.PI)for(d=e.attributes.normal.array,g=new B,h=new B,m=new B,b=b*a.length*3,n=c=0;c<a.length;c++,n+=3)g.x=d[n+0],g.y=d[n+1],g.z=d[n+2],h.x=d[b+
n+0],h.y=d[b+n+1],h.z=d[b+n+2],m.addVectors(g,h).normalize(),d[n+0]=d[b+n+0]=m.x,d[n+1]=d[b+n+1]=m.y,d[n+2]=d[b+n+2]=m.z;return e};$jscomp.inherits(ze,ra);ze.fromJSON=function(a){return new ze(a.points,a.segments,a.phiStart,a.phiLength)};var ae=function(a,b){a=void 0===a?1:a;b=void 0===b?0:b;var c=uc.call(this,[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],a,b)||this;c.type="OctahedronGeometry";c.parameters={radius:a,detail:b};return c};$jscomp.inherits(ae,
uc);ae.fromJSON=function(a){return new ae(a.radius,a.detail)};var Ae=function(a,b,c,d,e,g){a=void 0===a?.5:a;b=void 0===b?1:b;c=void 0===c?8:c;d=void 0===d?1:d;e=void 0===e?0:e;g=void 0===g?2*Math.PI:g;var h=ra.call(this)||this;h.type="RingGeometry";h.parameters={innerRadius:a,outerRadius:b,thetaSegments:c,phiSegments:d,thetaStart:e,thetaLength:g};c=Math.max(3,c);var m=[],n=[],q=[],t=[],r=a;a=(b-a)/(d=Math.max(1,d));for(var u=new B,A=new T,w=0;w<=d;w++){for(var x=0;x<=c;x++){var C=e+x/c*g;u.x=r*Math.cos(C);
u.y=r*Math.sin(C);n.push(u.x,u.y,u.z);q.push(0,0,1);A.x=(u.x/b+1)/2;A.y=(u.y/b+1)/2;t.push(A.x,A.y)}r+=a}for(b=0;b<d;b++)for(e=b*(c+1),g=0;g<c;g++)r=g+e,a=r+c+1,u=r+c+2,A=r+1,m.push(r,a,A),m.push(a,u,A);h.setIndex(m);h.setAttribute("position",new Ma(n,3));h.setAttribute("normal",new Ma(q,3));h.setAttribute("uv",new Ma(t,2));return h};$jscomp.inherits(Ae,ra);Ae.fromJSON=function(a){return new Ae(a.innerRadius,a.outerRadius,a.thetaSegments,a.phiSegments,a.thetaStart,a.thetaLength)};var Bd=function(a,
b){function c(r){var u=g.length/3,A=r.extractPoints(b);r=A.shape;var w=A.holes;!1===Nc.isClockWise(r)&&(r=r.reverse());A=0;for(var x=w.length;A<x;A++){var C=w[A];!0===Nc.isClockWise(C)&&(w[A]=C.reverse())}A=Nc.triangulateShape(r,w);x=0;for(C=w.length;x<C;x++)r=r.concat(w[x]);w=0;for(x=r.length;w<x;w++)C=r[w],g.push(C.x,C.y,0),h.push(0,0,1),m.push(C.x,C.y);r=0;for(w=A.length;r<w;r++)x=A[r],e.push(x[0]+u,x[1]+u,x[2]+u),q+=3}a=void 0===a?new pc([new T(0,.5),new T(-.5,-.5),new T(.5,-.5)]):a;b=void 0===
b?12:b;var d=ra.call(this)||this;d.type="ShapeGeometry";d.parameters={shapes:a,curveSegments:b};var e=[],g=[],h=[],m=[],n=0,q=0;if(!1===Array.isArray(a))c(a);else for(var t=0;t<a.length;t++)c(a[t]),d.addGroup(n,q,t),n+=q,q=0;d.setIndex(e);d.setAttribute("position",new Ma(g,3));d.setAttribute("normal",new Ma(h,3));d.setAttribute("uv",new Ma(m,2));return d};$jscomp.inherits(Bd,ra);Bd.prototype.toJSON=function(){var a=ra.prototype.toJSON.call(this),b=this.parameters.shapes;if(a.shapes=[],Array.isArray(b))for(var c=
0,d=b.length;c<d;c++)a.shapes.push(b[c].uuid);else a.shapes.push(b.uuid);return a};Bd.fromJSON=function(a,b){for(var c=[],d=0,e=a.shapes.length;d<e;d++)c.push(b[a.shapes[d]]);return new Bd(c,a.curveSegments)};var be=function(a,b,c,d,e,g,h){a=void 0===a?1:a;b=void 0===b?32:b;c=void 0===c?16:c;d=void 0===d?0:d;e=void 0===e?2*Math.PI:e;g=void 0===g?0:g;h=void 0===h?Math.PI:h;var m=ra.call(this)||this;m.type="SphereGeometry";m.parameters={radius:a,widthSegments:b,heightSegments:c,phiStart:d,phiLength:e,
thetaStart:g,thetaLength:h};b=Math.max(3,Math.floor(b));c=Math.max(2,Math.floor(c));for(var n=Math.min(g+h,Math.PI),q=0,t=[],r=new B,u=new B,A=[],w=[],x=[],C=[],G=0;G<=c;G++){var I=[],P=G/c,O=0;0==G&&0==g?O=.5/b:G==c&&n==Math.PI&&(O=-.5/b);for(var M=0;M<=b;M++){var S=M/b;r.x=-a*Math.cos(d+S*e)*Math.sin(g+P*h);r.y=a*Math.cos(g+P*h);r.z=a*Math.sin(d+S*e)*Math.sin(g+P*h);w.push(r.x,r.y,r.z);u.copy(r).normalize();x.push(u.x,u.y,u.z);C.push(S+O,1-P);I.push(q++)}t.push(I)}for(a=0;a<c;a++)for(d=0;d<b;d++)e=
t[a][d+1],h=t[a][d],q=t[a+1][d],r=t[a+1][d+1],(0!==a||0<g)&&A.push(e,h,r),(a!==c-1||n<Math.PI)&&A.push(h,q,r);m.setIndex(A);m.setAttribute("position",new Ma(w,3));m.setAttribute("normal",new Ma(x,3));m.setAttribute("uv",new Ma(C,2));return m};$jscomp.inherits(be,ra);be.fromJSON=function(a){return new be(a.radius,a.widthSegments,a.heightSegments,a.phiStart,a.phiLength,a.thetaStart,a.thetaLength)};var Be=function(a,b){a=void 0===a?1:a;b=void 0===b?0:b;var c=uc.call(this,[1,1,1,-1,-1,1,-1,1,-1,1,-1,
-1],[2,1,0,0,3,2,1,3,0,2,3,1],a,b)||this;c.type="TetrahedronGeometry";c.parameters={radius:a,detail:b};return c};$jscomp.inherits(Be,uc);Be.fromJSON=function(a){return new Be(a.radius,a.detail)};var Ce=function(a,b,c,d,e){a=void 0===a?1:a;b=void 0===b?.4:b;c=void 0===c?8:c;d=void 0===d?6:d;e=void 0===e?2*Math.PI:e;var g=ra.call(this)||this;g.type="TorusGeometry";g.parameters={radius:a,tube:b,radialSegments:c,tubularSegments:d,arc:e};c=Math.floor(c);d=Math.floor(d);for(var h=[],m=[],n=[],q=[],t=new B,
r=new B,u=new B,A=0;A<=c;A++)for(var w=0;w<=d;w++){var x=w/d*e,C=A/c*Math.PI*2;r.x=(a+b*Math.cos(C))*Math.cos(x);r.y=(a+b*Math.cos(C))*Math.sin(x);r.z=b*Math.sin(C);m.push(r.x,r.y,r.z);t.x=a*Math.cos(x);t.y=a*Math.sin(x);u.subVectors(r,t).normalize();n.push(u.x,u.y,u.z);q.push(w/d);q.push(A/c)}for(a=1;a<=c;a++)for(b=1;b<=d;b++)e=(d+1)*(a-1)+b-1,t=(d+1)*(a-1)+b,r=(d+1)*a+b,h.push((d+1)*a+b-1,e,r),h.push(e,t,r);g.setIndex(h);g.setAttribute("position",new Ma(m,3));g.setAttribute("normal",new Ma(n,3));
g.setAttribute("uv",new Ma(q,2));return g};$jscomp.inherits(Ce,ra);Ce.fromJSON=function(a){return new Ce(a.radius,a.tube,a.radialSegments,a.tubularSegments,a.arc)};var De=function(a,b,c,d,e,g){function h(V,ba,Y,Z,Ha){var ya=Math.sin(V);ba=Y/ba*V;Y=Math.cos(ba);Ha.x=Z*(2+Y)*.5*Math.cos(V);Ha.y=Z*(2+Y)*ya*.5;Ha.z=Z*Math.sin(ba)*.5}a=void 0===a?1:a;b=void 0===b?.4:b;c=void 0===c?64:c;d=void 0===d?8:d;e=void 0===e?2:e;g=void 0===g?3:g;var m=ra.call(this)||this;m.type="TorusKnotGeometry";m.parameters=
{radius:a,tube:b,tubularSegments:c,radialSegments:d,p:e,q:g};c=Math.floor(c);d=Math.floor(d);for(var n=[],q=[],t=[],r=[],u=new B,A=new B,w=new B,x=new B,C=new B,G=new B,I=new B,P=0;P<=c;++P){var O=P/c*e*Math.PI*2;h(O,e,g,a,w);h(O+.01,e,g,a,x);G.subVectors(x,w);I.addVectors(x,w);C.crossVectors(G,I);I.crossVectors(C,G);C.normalize();I.normalize();for(O=0;O<=d;++O){var M=O/d*Math.PI*2,S=-b*Math.cos(M);M=b*Math.sin(M);u.x=w.x+(S*I.x+M*C.x);u.y=w.y+(S*I.y+M*C.y);u.z=w.z+(S*I.z+M*C.z);q.push(u.x,u.y,u.z);
A.subVectors(u,w).normalize();t.push(A.x,A.y,A.z);r.push(P/c);r.push(O/d)}}for(a=1;a<=c;a++)for(b=1;b<=d;b++)e=(d+1)*a+(b-1),g=(d+1)*a+b,u=(d+1)*(a-1)+b,n.push((d+1)*(a-1)+(b-1),e,u),n.push(e,g,u);m.setIndex(n);m.setAttribute("position",new Ma(q,3));m.setAttribute("normal",new Ma(t,3));m.setAttribute("uv",new Ma(r,2));return m};$jscomp.inherits(De,ra);De.fromJSON=function(a){return new De(a.radius,a.tube,a.tubularSegments,a.radialSegments,a.p,a.q)};var ce=function(a,b,c,d,e){function g(C){r=a.getPointAt(C/
b,r);var G=m.normals[C];C=m.binormals[C];for(var I=0;I<=d;I++){var P=I/d*Math.PI*2,O=Math.sin(P);P=-Math.cos(P);q.x=P*G.x+O*C.x;q.y=P*G.y+O*C.y;q.z=P*G.z+O*C.z;q.normalize();A.push(q.x,q.y,q.z);n.x=r.x+c*q.x;n.y=r.y+c*q.y;n.z=r.z+c*q.z;u.push(n.x,n.y,n.z)}}a=void 0===a?new zd(new B(-1,-1,0),new B(-1,1,0),new B(1,1,0)):a;b=void 0===b?64:b;c=void 0===c?1:c;d=void 0===d?8:d;e=void 0===e?!1:e;var h=ra.call(this)||this;h.type="TubeGeometry";h.parameters={path:a,tubularSegments:b,radius:c,radialSegments:d,
closed:e};var m=a.computeFrenetFrames(b,e);h.tangents=m.tangents;h.normals=m.normals;h.binormals=m.binormals;var n=new B,q=new B,t=new T,r=new B,u=[],A=[],w=[],x=[];!function(){for(var C=0;C<b;C++)g(C);g(!1===e?b:0);(function(){for(var G=0;G<=b;G++)for(var I=0;I<=d;I++)t.x=G/b,t.y=I/d,w.push(t.x,t.y)})();(function(){for(var G=1;G<=b;G++)for(var I=1;I<=d;I++){var P=(d+1)*G+(I-1),O=(d+1)*G+I,M=(d+1)*(G-1)+I;x.push((d+1)*(G-1)+(I-1),P,M);x.push(P,O,M)}})()}();h.setIndex(x);h.setAttribute("position",
new Ma(u,3));h.setAttribute("normal",new Ma(A,3));h.setAttribute("uv",new Ma(w,2));return h};$jscomp.inherits(ce,ra);ce.prototype.toJSON=function(){var a=ra.prototype.toJSON.call(this);return a.path=this.parameters.path.toJSON(),a};ce.fromJSON=function(a){return new ce((new bj[a.path.type]).fromJSON(a.path),a.tubularSegments,a.radius,a.radialSegments,a.closed)};var Ch=function(a){var b;a=void 0===a?null:a;if(b=ra.call(this)||this,b.type="WireframeGeometry",b.parameters={geometry:a},null!==a){var c=
[],d=new Set,e=new B,g=new B;if(null!==a.index){var h=a.attributes.position,m=a.index;a=a.groups;0===a.length&&(a=[{start:0,count:m.count,materialIndex:0}]);for(var n=0,q=a.length;n<q;++n){var t=a[n],r=t.start,u=r;for(t=r+t.count;u<t;u+=3)for(r=0;3>r;r++){var A=m.getX(u+r),w=m.getX(u+(r+1)%3);e.fromBufferAttribute(h,A);g.fromBufferAttribute(h,w);!0===Zj(e,g,d)&&(c.push(e.x,e.y,e.z),c.push(g.x,g.y,g.z))}}}else for(h=a.attributes.position,m=0,a=h.count/3;m<a;m++)for(n=0;3>n;n++)q=3*m+(n+1)%3,e.fromBufferAttribute(h,
3*m+n),g.fromBufferAttribute(h,q),!0===Zj(e,g,d)&&(c.push(e.x,e.y,e.z),c.push(g.x,g.y,g.z));b.setAttribute("position",new Ma(c,3))}return b};$jscomp.inherits(Ch,ra);var Lk=Object.freeze({__proto__:null,BoxGeometry:ad,BoxBufferGeometry:ad,CircleGeometry:ve,CircleBufferGeometry:ve,ConeGeometry:we,ConeBufferGeometry:we,CylinderGeometry:id,CylinderBufferGeometry:id,DodecahedronGeometry:xe,DodecahedronBufferGeometry:xe,EdgesGeometry:zh,ExtrudeGeometry:Oc,ExtrudeBufferGeometry:Oc,IcosahedronGeometry:ye,
IcosahedronBufferGeometry:ye,LatheGeometry:ze,LatheBufferGeometry:ze,OctahedronGeometry:ae,OctahedronBufferGeometry:ae,PlaneGeometry:Gd,PlaneBufferGeometry:Gd,PolyhedronGeometry:uc,PolyhedronBufferGeometry:uc,RingGeometry:Ae,RingBufferGeometry:Ae,ShapeGeometry:Bd,ShapeBufferGeometry:Bd,SphereGeometry:be,SphereBufferGeometry:be,TetrahedronGeometry:Be,TetrahedronBufferGeometry:Be,TorusGeometry:Ce,TorusBufferGeometry:Ce,TorusKnotGeometry:De,TorusKnotBufferGeometry:De,TubeGeometry:ce,TubeBufferGeometry:ce,
WireframeGeometry:Ch}),og=function(a){var b=Oa.call(this)||this;b.type="ShadowMaterial";b.color=new ma(0);b.transparent=!0;b.setValues(a);return b};$jscomp.inherits(og,Oa);og.prototype.copy=function(a){return Oa.prototype.copy.call(this,a),this.color.copy(a.color),this};og.prototype.isShadowMaterial=!0;var de=function(a){var b=Oa.call(this)||this;b.defines={STANDARD:""};b.type="MeshStandardMaterial";b.color=new ma(16777215);b.roughness=1;b.metalness=0;b.map=null;b.lightMap=null;b.lightMapIntensity=
1;b.aoMap=null;b.aoMapIntensity=1;b.emissive=new ma(0);b.emissiveIntensity=1;b.emissiveMap=null;b.bumpMap=null;b.bumpScale=1;b.normalMap=null;b.normalMapType=0;b.normalScale=new T(1,1);b.displacementMap=null;b.displacementScale=1;b.displacementBias=0;b.roughnessMap=null;b.metalnessMap=null;b.alphaMap=null;b.envMap=null;b.envMapIntensity=1;b.refractionRatio=.98;b.wireframe=!1;b.wireframeLinewidth=1;b.wireframeLinecap="round";b.wireframeLinejoin="round";b.flatShading=!1;b.setValues(a);return b};$jscomp.inherits(de,
Oa);de.prototype.copy=function(a){return Oa.prototype.copy.call(this,a),this.defines={STANDARD:""},this.color.copy(a.color),this.roughness=a.roughness,this.metalness=a.metalness,this.map=a.map,this.lightMap=a.lightMap,this.lightMapIntensity=a.lightMapIntensity,this.aoMap=a.aoMap,this.aoMapIntensity=a.aoMapIntensity,this.emissive.copy(a.emissive),this.emissiveMap=a.emissiveMap,this.emissiveIntensity=a.emissiveIntensity,this.bumpMap=a.bumpMap,this.bumpScale=a.bumpScale,this.normalMap=a.normalMap,this.normalMapType=
a.normalMapType,this.normalScale.copy(a.normalScale),this.displacementMap=a.displacementMap,this.displacementScale=a.displacementScale,this.displacementBias=a.displacementBias,this.roughnessMap=a.roughnessMap,this.metalnessMap=a.metalnessMap,this.alphaMap=a.alphaMap,this.envMap=a.envMap,this.envMapIntensity=a.envMapIntensity,this.refractionRatio=a.refractionRatio,this.wireframe=a.wireframe,this.wireframeLinewidth=a.wireframeLinewidth,this.wireframeLinecap=a.wireframeLinecap,this.wireframeLinejoin=
a.wireframeLinejoin,this.flatShading=a.flatShading,this};de.prototype.isMeshStandardMaterial=!0;var vf=function(a){var b=de.call(this)||this;b.defines={STANDARD:"",PHYSICAL:""};b.type="MeshPhysicalMaterial";b.clearcoatMap=null;b.clearcoatRoughness=0;b.clearcoatRoughnessMap=null;b.clearcoatNormalScale=new T(1,1);b.clearcoatNormalMap=null;b.ior=1.5;Object.defineProperty(b,"reflectivity",{get:function(){return R(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(c){this.ior=(1+.4*c)/(1-.4*c)}});b.sheenColor=
new ma(0);b.sheenColorMap=null;b.sheenRoughness=1;b.sheenRoughnessMap=null;b.transmissionMap=null;b.thickness=.01;b.thicknessMap=null;b.attenuationDistance=0;b.attenuationColor=new ma(1,1,1);b.specularIntensity=1;b.specularIntensityMap=null;b.specularColor=new ma(1,1,1);b.specularColorMap=null;b._sheen=0;b._clearcoat=0;b._transmission=0;b.setValues(a);return b};$jscomp.inherits(vf,de);vf.prototype.copy=function(a){return de.prototype.copy.call(this,a),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=
a.clearcoat,this.clearcoatMap=a.clearcoatMap,this.clearcoatRoughness=a.clearcoatRoughness,this.clearcoatRoughnessMap=a.clearcoatRoughnessMap,this.clearcoatNormalMap=a.clearcoatNormalMap,this.clearcoatNormalScale.copy(a.clearcoatNormalScale),this.ior=a.ior,this.sheen=a.sheen,this.sheenColor.copy(a.sheenColor),this.sheenColorMap=a.sheenColorMap,this.sheenRoughness=a.sheenRoughness,this.sheenRoughnessMap=a.sheenRoughnessMap,this.transmission=a.transmission,this.transmissionMap=a.transmissionMap,this.thickness=
a.thickness,this.thicknessMap=a.thicknessMap,this.attenuationDistance=a.attenuationDistance,this.attenuationColor.copy(a.attenuationColor),this.specularIntensity=a.specularIntensity,this.specularIntensityMap=a.specularIntensityMap,this.specularColor.copy(a.specularColor),this.specularColorMap=a.specularColorMap,this};$jscomp.global.Object.defineProperties(vf.prototype,{sheen:{configurable:!0,enumerable:!0,get:function(){return this._sheen},set:function(a){0<this._sheen!=0<a&&this.version++;this._sheen=
a}},clearcoat:{configurable:!0,enumerable:!0,get:function(){return this._clearcoat},set:function(a){0<this._clearcoat!=0<a&&this.version++;this._clearcoat=a}},transmission:{configurable:!0,enumerable:!0,get:function(){return this._transmission},set:function(a){0<this._transmission!=0<a&&this.version++;this._transmission=a}}});vf.prototype.isMeshPhysicalMaterial=!0;var pg=function(a){var b=Oa.call(this)||this;b.type="MeshPhongMaterial";b.color=new ma(16777215);b.specular=new ma(1118481);b.shininess=
30;b.map=null;b.lightMap=null;b.lightMapIntensity=1;b.aoMap=null;b.aoMapIntensity=1;b.emissive=new ma(0);b.emissiveIntensity=1;b.emissiveMap=null;b.bumpMap=null;b.bumpScale=1;b.normalMap=null;b.normalMapType=0;b.normalScale=new T(1,1);b.displacementMap=null;b.displacementScale=1;b.displacementBias=0;b.specularMap=null;b.alphaMap=null;b.envMap=null;b.combine=0;b.reflectivity=1;b.refractionRatio=.98;b.wireframe=!1;b.wireframeLinewidth=1;b.wireframeLinecap="round";b.wireframeLinejoin="round";b.flatShading=
!1;b.setValues(a);return b};$jscomp.inherits(pg,Oa);pg.prototype.copy=function(a){return Oa.prototype.copy.call(this,a),this.color.copy(a.color),this.specular.copy(a.specular),this.shininess=a.shininess,this.map=a.map,this.lightMap=a.lightMap,this.lightMapIntensity=a.lightMapIntensity,this.aoMap=a.aoMap,this.aoMapIntensity=a.aoMapIntensity,this.emissive.copy(a.emissive),this.emissiveMap=a.emissiveMap,this.emissiveIntensity=a.emissiveIntensity,this.bumpMap=a.bumpMap,this.bumpScale=a.bumpScale,this.normalMap=
a.normalMap,this.normalMapType=a.normalMapType,this.normalScale.copy(a.normalScale),this.displacementMap=a.displacementMap,this.displacementScale=a.displacementScale,this.displacementBias=a.displacementBias,this.specularMap=a.specularMap,this.alphaMap=a.alphaMap,this.envMap=a.envMap,this.combine=a.combine,this.reflectivity=a.reflectivity,this.refractionRatio=a.refractionRatio,this.wireframe=a.wireframe,this.wireframeLinewidth=a.wireframeLinewidth,this.wireframeLinecap=a.wireframeLinecap,this.wireframeLinejoin=
a.wireframeLinejoin,this.flatShading=a.flatShading,this};pg.prototype.isMeshPhongMaterial=!0;var qg=function(a){var b=Oa.call(this)||this;b.defines={TOON:""};b.type="MeshToonMaterial";b.color=new ma(16777215);b.map=null;b.gradientMap=null;b.lightMap=null;b.lightMapIntensity=1;b.aoMap=null;b.aoMapIntensity=1;b.emissive=new ma(0);b.emissiveIntensity=1;b.emissiveMap=null;b.bumpMap=null;b.bumpScale=1;b.normalMap=null;b.normalMapType=0;b.normalScale=new T(1,1);b.displacementMap=null;b.displacementScale=
1;b.displacementBias=0;b.alphaMap=null;b.wireframe=!1;b.wireframeLinewidth=1;b.wireframeLinecap="round";b.wireframeLinejoin="round";b.setValues(a);return b};$jscomp.inherits(qg,Oa);qg.prototype.copy=function(a){return Oa.prototype.copy.call(this,a),this.color.copy(a.color),this.map=a.map,this.gradientMap=a.gradientMap,this.lightMap=a.lightMap,this.lightMapIntensity=a.lightMapIntensity,this.aoMap=a.aoMap,this.aoMapIntensity=a.aoMapIntensity,this.emissive.copy(a.emissive),this.emissiveMap=a.emissiveMap,
this.emissiveIntensity=a.emissiveIntensity,this.bumpMap=a.bumpMap,this.bumpScale=a.bumpScale,this.normalMap=a.normalMap,this.normalMapType=a.normalMapType,this.normalScale.copy(a.normalScale),this.displacementMap=a.displacementMap,this.displacementScale=a.displacementScale,this.displacementBias=a.displacementBias,this.alphaMap=a.alphaMap,this.wireframe=a.wireframe,this.wireframeLinewidth=a.wireframeLinewidth,this.wireframeLinecap=a.wireframeLinecap,this.wireframeLinejoin=a.wireframeLinejoin,this};
qg.prototype.isMeshToonMaterial=!0;var rg=function(a){var b=Oa.call(this)||this;b.type="MeshNormalMaterial";b.bumpMap=null;b.bumpScale=1;b.normalMap=null;b.normalMapType=0;b.normalScale=new T(1,1);b.displacementMap=null;b.displacementScale=1;b.displacementBias=0;b.wireframe=!1;b.wireframeLinewidth=1;b.fog=!1;b.flatShading=!1;b.setValues(a);return b};$jscomp.inherits(rg,Oa);rg.prototype.copy=function(a){return Oa.prototype.copy.call(this,a),this.bumpMap=a.bumpMap,this.bumpScale=a.bumpScale,this.normalMap=
a.normalMap,this.normalMapType=a.normalMapType,this.normalScale.copy(a.normalScale),this.displacementMap=a.displacementMap,this.displacementScale=a.displacementScale,this.displacementBias=a.displacementBias,this.wireframe=a.wireframe,this.wireframeLinewidth=a.wireframeLinewidth,this.flatShading=a.flatShading,this};rg.prototype.isMeshNormalMaterial=!0;var sg=function(a){var b=Oa.call(this)||this;b.type="MeshLambertMaterial";b.color=new ma(16777215);b.map=null;b.lightMap=null;b.lightMapIntensity=1;
b.aoMap=null;b.aoMapIntensity=1;b.emissive=new ma(0);b.emissiveIntensity=1;b.emissiveMap=null;b.specularMap=null;b.alphaMap=null;b.envMap=null;b.combine=0;b.reflectivity=1;b.refractionRatio=.98;b.wireframe=!1;b.wireframeLinewidth=1;b.wireframeLinecap="round";b.wireframeLinejoin="round";b.setValues(a);return b};$jscomp.inherits(sg,Oa);sg.prototype.copy=function(a){return Oa.prototype.copy.call(this,a),this.color.copy(a.color),this.map=a.map,this.lightMap=a.lightMap,this.lightMapIntensity=a.lightMapIntensity,
this.aoMap=a.aoMap,this.aoMapIntensity=a.aoMapIntensity,this.emissive.copy(a.emissive),this.emissiveMap=a.emissiveMap,this.emissiveIntensity=a.emissiveIntensity,this.specularMap=a.specularMap,this.alphaMap=a.alphaMap,this.envMap=a.envMap,this.combine=a.combine,this.reflectivity=a.reflectivity,this.refractionRatio=a.refractionRatio,this.wireframe=a.wireframe,this.wireframeLinewidth=a.wireframeLinewidth,this.wireframeLinecap=a.wireframeLinecap,this.wireframeLinejoin=a.wireframeLinejoin,this};sg.prototype.isMeshLambertMaterial=
!0;var tg=function(a){var b=Oa.call(this)||this;b.defines={MATCAP:""};b.type="MeshMatcapMaterial";b.color=new ma(16777215);b.matcap=null;b.map=null;b.bumpMap=null;b.bumpScale=1;b.normalMap=null;b.normalMapType=0;b.normalScale=new T(1,1);b.displacementMap=null;b.displacementScale=1;b.displacementBias=0;b.alphaMap=null;b.flatShading=!1;b.setValues(a);return b};$jscomp.inherits(tg,Oa);tg.prototype.copy=function(a){return Oa.prototype.copy.call(this,a),this.defines={MATCAP:""},this.color.copy(a.color),
this.matcap=a.matcap,this.map=a.map,this.bumpMap=a.bumpMap,this.bumpScale=a.bumpScale,this.normalMap=a.normalMap,this.normalMapType=a.normalMapType,this.normalScale.copy(a.normalScale),this.displacementMap=a.displacementMap,this.displacementScale=a.displacementScale,this.displacementBias=a.displacementBias,this.alphaMap=a.alphaMap,this.flatShading=a.flatShading,this};tg.prototype.isMeshMatcapMaterial=!0;var ug=function(a){var b=Pb.call(this)||this;b.type="LineDashedMaterial";b.scale=1;b.dashSize=
3;b.gapSize=1;b.setValues(a);return b};$jscomp.inherits(ug,Pb);ug.prototype.copy=function(a){return Pb.prototype.copy.call(this,a),this.scale=a.scale,this.dashSize=a.dashSize,this.gapSize=a.gapSize,this};ug.prototype.isLineDashedMaterial=!0;var cm=Object.freeze({__proto__:null,ShadowMaterial:og,SpriteMaterial:rf,RawShaderMaterial:ie,ShaderMaterial:Bc,PointsMaterial:vd,MeshPhysicalMaterial:vf,MeshStandardMaterial:de,MeshPhongMaterial:pg,MeshToonMaterial:qg,MeshNormalMaterial:rg,MeshLambertMaterial:sg,
MeshDepthMaterial:Ve,MeshDistanceMaterial:We,MeshBasicMaterial:Vc,MeshMatcapMaterial:tg,LineDashedMaterial:ug,LineBasicMaterial:Pb,Material:Oa}),Hb={arraySlice:function(a,b,c){return Hb.isTypedArray(a)?new a.constructor(a.subarray(b,void 0!==c?c:a.length)):a.slice(b,c)},convertArray:function(a,b,c){return!a||!c&&a.constructor===b?a:"number"==typeof b.BYTES_PER_ELEMENT?new b(a):Array.prototype.slice.call(a)},isTypedArray:function(a){return ArrayBuffer.isView(a)&&!(a instanceof DataView)},getKeyframeOrder:function(a){for(var b=
a.length,c=Array(b),d=0;d!==b;++d)c[d]=d;return c.sort(function(e,g){return a[e]-a[g]}),c},sortedArray:function(a,b,c){for(var d=a.length,e=new a.constructor(d),g=0,h=0;h!==d;++g)for(var m=c[g]*b,n=0;n!==b;++n)e[h++]=a[m+n];return e},flattenJSON:function(a,b,c,d){for(var e=1,g=a[0];void 0!==g&&void 0===g[d];)g=a[e++];if(void 0!==g){var h=g[d];if(void 0!==h)if(Array.isArray(h)){do h=g[d],void 0!==h&&(b.push(g.time),c.push.apply(c,h)),g=a[e++];while(void 0!==g)}else if(void 0!==h.toArray){do h=g[d],
void 0!==h&&(b.push(g.time),h.toArray(c,c.length)),g=a[e++];while(void 0!==g)}else{do h=g[d],void 0!==h&&(b.push(g.time),c.push(h)),g=a[e++];while(void 0!==g)}}},subclip:function(a,b,c,d,e){e=void 0===e?30:e;a=a.clone();a.name=b;b=[];for(var g=0;g<a.tracks.length;++g){for(var h=a.tracks[g],m=h.getValueSize(),n=[],q=[],t=0;t<h.times.length;++t){var r=h.times[t]*e;if(!(r<c||r>=d))for(n.push(h.times[t]),r=0;r<m;++r)q.push(h.values[t*m+r])}0!==n.length&&(h.times=Hb.convertArray(n,h.times.constructor),
h.values=Hb.convertArray(q,h.values.constructor),b.push(h))}a.tracks=b;c=1/0;for(d=0;d<a.tracks.length;++d)c>a.tracks[d].times[0]&&(c=a.tracks[d].times[0]);for(d=0;d<a.tracks.length;++d)a.tracks[d].shift(-1*c);return a.resetDuration(),a},makeClipAdditive:function(a,b,c,d){c=void 0===c?a:c;d=void 0===d?30:d;0>=d&&(d=30);var e=c.tracks.length;b=(void 0===b?0:b)/d;d={};for(var g=0;g<e;d={$jscomp$loop$prop$i$1274$1769:d.$jscomp$loop$prop$i$1274$1769,$jscomp$loop$prop$r$1275$1770:d.$jscomp$loop$prop$r$1275$1770},
++g)if(d.$jscomp$loop$prop$i$1274$1769=c.tracks[g],d.$jscomp$loop$prop$r$1275$1770=d.$jscomp$loop$prop$i$1274$1769.ValueTypeName,"bool"!==d.$jscomp$loop$prop$r$1275$1770&&"string"!==d.$jscomp$loop$prop$r$1275$1770){var h=a.tracks.find(function(x){return function(C){return C.name===x.$jscomp$loop$prop$i$1274$1769.name&&C.ValueTypeName===x.$jscomp$loop$prop$r$1275$1770}}(d));if(void 0!==h){var m=0,n=d.$jscomp$loop$prop$i$1274$1769.getValueSize();d.$jscomp$loop$prop$i$1274$1769.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&
(m=n/3);var q=0,t=h.getValueSize();h.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(q=t/3);var r=d.$jscomp$loop$prop$i$1274$1769.times.length-1,u=void 0;b<=d.$jscomp$loop$prop$i$1274$1769.times[0]?u=Hb.arraySlice(d.$jscomp$loop$prop$i$1274$1769.values,m,n-m):b>=d.$jscomp$loop$prop$i$1274$1769.times[r]?(u=r*n+m,u=Hb.arraySlice(d.$jscomp$loop$prop$i$1274$1769.values,u,u+n-m)):(u=d.$jscomp$loop$prop$i$1274$1769.createInterpolant(),r=m,m=n-m,u.evaluate(b),u=Hb.arraySlice(u.resultBuffer,
r,m));"quaternion"===d.$jscomp$loop$prop$r$1275$1770&&(new Sa).fromArray(u).normalize().conjugate().toArray(u);m=h.times.length;for(n=0;n<m;++n)if(r=n*t+q,"quaternion"===d.$jscomp$loop$prop$r$1275$1770)Sa.multiplyQuaternionsFlat(h.values,r,u,0,h.values,r);else for(var A=t-2*q,w=0;w<A;++w)h.values[r+w]-=u[w]}}return a.blendMode=2501,a}},fc=function(a,b,c,d){this.parameterPositions=a;this._cachedIndex=0;this.resultBuffer=void 0!==d?d:new b.constructor(c);this.sampleValues=b;this.valueSize=c;this.settings=
null;this.DefaultSettings_={}};fc.prototype.evaluate=function(a){var b=this.parameterPositions,c=this._cachedIndex,d=b[c],e=b[c-1];a:{b:{c:{d:if(!(a<d)){for(var g=c+2;;){if(void 0===d){if(a<e)break d;return c=b.length,this._cachedIndex=c,this.afterEnd_(c-1,a,e)}if(c===g)break;if(e=d,d=b[++c],a<d)break b}d=b.length;break c}if(a>=e)break a;g=b[1];a<g&&(c=2,e=g);for(g=c-2;;){if(void 0===e)return this._cachedIndex=0,this.beforeStart_(0,a,d);if(c===g)break;if(d=e,e=b[--c-1],a>=e)break b}d=c;c=0}for(;c<
d;)g=c+d>>>1,a<b[g]?d=g:c=g+1;if(d=b[c],e=b[c-1],void 0===e)return this._cachedIndex=0,this.beforeStart_(0,a,d);if(void 0===d)return c=b.length,this._cachedIndex=c,this.afterEnd_(c-1,e,a)}this._cachedIndex=c;this.intervalChanged_(c,e,d)}return this.interpolate_(c,e,a,d)};fc.prototype.getSettings_=function(){return this.settings||this.DefaultSettings_};fc.prototype.copySampleValue_=function(a){var b=this.resultBuffer,c=this.sampleValues,d=this.valueSize;a*=d;for(var e=0;e!==d;++e)b[e]=c[a+e];return b};
fc.prototype.interpolate_=function(){throw Error("call to abstract method");};fc.prototype.intervalChanged_=function(){};fc.prototype.beforeStart_=fc.prototype.copySampleValue_;fc.prototype.afterEnd_=fc.prototype.copySampleValue_;var vg=function(a,b,c,d){a=fc.call(this,a,b,c,d)||this;a._weightPrev=-0;a._offsetPrev=-0;a._weightNext=-0;a._offsetNext=-0;a.DefaultSettings_={endingStart:2400,endingEnd:2400};return a};$jscomp.inherits(vg,fc);vg.prototype.intervalChanged_=function(a,b,c){var d=this.parameterPositions,
e=a-2,g=a+1,h=d[e],m=d[g];if(void 0===h)switch(this.getSettings_().endingStart){case 2401:e=a;h=2*b-c;break;case 2402:e=d.length-2;h=b+d[e]-d[e+1];break;default:e=a,h=c}if(void 0===m)switch(this.getSettings_().endingEnd){case 2401:g=a;m=2*c-b;break;case 2402:g=1;m=c+d[1]-d[0];break;default:g=a-1,m=b}a=.5*(c-b);d=this.valueSize;this._weightPrev=a/(b-h);this._weightNext=a/(m-c);this._offsetPrev=e*d;this._offsetNext=g*d};vg.prototype.interpolate_=function(a,b,c,d){var e=this.resultBuffer,g=this.sampleValues,
h=this.valueSize;a*=h;var m=a-h,n=this._offsetPrev,q=this._offsetNext,t=this._weightPrev,r=this._weightNext,u=(c-b)/(d-b);c=u*u;d=c*u;b=-t*d+2*t*c-t*u;t=(1+t)*d+(-1.5-2*t)*c+(-.5+t)*u+1;u=(-1-r)*d+(1.5+r)*c+.5*u;r=r*d-r*c;for(c=0;c!==h;++c)e[c]=b*g[n+c]+t*g[m+c]+u*g[a+c]+r*g[q+c];return e};var wg=function(a,b,c,d){return fc.call(this,a,b,c,d)||this};$jscomp.inherits(wg,fc);wg.prototype.interpolate_=function(a,b,c,d){var e=this.resultBuffer,g=this.sampleValues,h=this.valueSize;a*=h;var m=a-h;b=(c-
b)/(d-b);c=1-b;for(d=0;d!==h;++d)e[d]=g[m+d]*c+g[a+d]*b;return e};var Dh=function(a,b,c,d){return fc.call(this,a,b,c,d)||this};$jscomp.inherits(Dh,fc);Dh.prototype.interpolate_=function(a){return this.copySampleValue_(a-1)};var yb=function(a,b,c,d){if(void 0===a)throw Error("THREE.KeyframeTrack: track name is undefined");if(void 0===b||0===b.length)throw Error("THREE.KeyframeTrack: no keyframes in track named "+a);this.name=a;this.times=Hb.convertArray(b,this.TimeBufferType);this.values=Hb.convertArray(c,
this.ValueBufferType);this.setInterpolation(d||this.DefaultInterpolation)};yb.toJSON=function(a){var b=a.constructor;if(b.toJSON!==this.toJSON)b=b.toJSON(a);else{b={name:a.name,times:Hb.convertArray(a.times,Array),values:Hb.convertArray(a.values,Array)};var c=a.getInterpolation();c!==a.DefaultInterpolation&&(b.interpolation=c)}return b.type=a.ValueTypeName,b};yb.prototype.InterpolantFactoryMethodDiscrete=function(a){return new Dh(this.times,this.values,this.getValueSize(),a)};yb.prototype.InterpolantFactoryMethodLinear=
function(a){return new wg(this.times,this.values,this.getValueSize(),a)};yb.prototype.InterpolantFactoryMethodSmooth=function(a){return new vg(this.times,this.values,this.getValueSize(),a)};yb.prototype.setInterpolation=function(a){switch(a){case 2300:var b=this.InterpolantFactoryMethodDiscrete;break;case 2301:b=this.InterpolantFactoryMethodLinear;break;case 2302:b=this.InterpolantFactoryMethodSmooth}if(void 0===b){b="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;
if(void 0===this.createInterpolant){if(a===this.DefaultInterpolation)throw Error(b);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",b),this}return this.createInterpolant=b,this};yb.prototype.getInterpolation=function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return 2300;case this.InterpolantFactoryMethodLinear:return 2301;case this.InterpolantFactoryMethodSmooth:return 2302}};yb.prototype.getValueSize=function(){return this.values.length/
this.times.length};yb.prototype.shift=function(a){if(0!==a)for(var b=this.times,c=0,d=b.length;c!==d;++c)b[c]+=a;return this};yb.prototype.scale=function(a){if(1!==a)for(var b=this.times,c=0,d=b.length;c!==d;++c)b[c]*=a;return this};yb.prototype.trim=function(a,b){for(var c=this.times,d=c.length,e=0,g=d-1;e!==d&&c[e]<a;)++e;for(;-1!==g&&c[g]>b;)--g;if(++g,0!==e||g!==d)e>=g&&(g=Math.max(g,1),e=g-1),a=this.getValueSize(),this.times=Hb.arraySlice(c,e,g),this.values=Hb.arraySlice(this.values,e*a,g*a);
return this};yb.prototype.validate=function(){var a=!0,b=this.getValueSize();0!=b-Math.floor(b)&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),a=!1);var c=this.times;b=this.values;var d=c.length;0===d&&(console.error("THREE.KeyframeTrack: Track is empty.",this),a=!1);for(var e=null,g=0;g!==d;g++){var h=c[g];if("number"==typeof h&&isNaN(h)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,g,h);a=!1;break}if(null!==e&&e>h){console.error("THREE.KeyframeTrack: Out of order keys.",
this,g,h,e);a=!1;break}e=h}if(void 0!==b&&Hb.isTypedArray(b))for(c=0,d=b.length;c!==d;++c)if(e=b[c],isNaN(e)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,c,e);a=!1;break}return a};yb.prototype.optimize=function(){for(var a=Hb.arraySlice(this.times),b=Hb.arraySlice(this.values),c=this.getValueSize(),d=2302===this.getInterpolation(),e=a.length-1,g=1,h=1;h<e;++h){var m=!1,n=a[h];if(n!==a[h+1]&&(1!==h||n!==a[0]))if(d)m=!0;else{n=h*c;for(var q=n-c,t=n+c,r=0;r!==c;++r){var u=
b[n+r];if(u!==b[q+r]||u!==b[t+r]){m=!0;break}}}if(m){if(h!==g)for(a[g]=a[h],m=h*c,n=g*c,q=0;q!==c;++q)b[n+q]=b[m+q];++g}}if(0<e){a[g]=a[e];d=e*c;e=g*c;for(h=0;h!==c;++h)b[e+h]=b[d+h];++g}return g!==a.length?(this.times=Hb.arraySlice(a,0,g),this.values=Hb.arraySlice(b,0,g*c)):(this.times=a,this.values=b),this};yb.prototype.clone=function(){var a=Hb.arraySlice(this.times,0),b=Hb.arraySlice(this.values,0);a=new (0,this.constructor)(this.name,a,b);return a.createInterpolant=this.createInterpolant,a};
yb.prototype.TimeBufferType=Float32Array;yb.prototype.ValueBufferType=Float32Array;yb.prototype.DefaultInterpolation=2301;var Od=function(){return yb.apply(this,arguments)||this};$jscomp.inherits(Od,yb);Od.prototype.ValueTypeName="bool";Od.prototype.ValueBufferType=Array;Od.prototype.DefaultInterpolation=2300;Od.prototype.InterpolantFactoryMethodLinear=void 0;Od.prototype.InterpolantFactoryMethodSmooth=void 0;var ah=function(){return yb.apply(this,arguments)||this};$jscomp.inherits(ah,yb);ah.prototype.ValueTypeName=
"color";var Ze=function(){return yb.apply(this,arguments)||this};$jscomp.inherits(Ze,yb);Ze.prototype.ValueTypeName="number";var Eh=function(a,b,c,d){return fc.call(this,a,b,c,d)||this};$jscomp.inherits(Eh,fc);Eh.prototype.interpolate_=function(a,b,c,d){var e=this.resultBuffer,g=this.sampleValues,h=this.valueSize;b=(c-b)/(d-b);a*=h;for(c=a+h;a!==c;a+=4)Sa.slerpFlat(e,0,g,a-h,g,a,b);return e};var Nd=function(){return yb.apply(this,arguments)||this};$jscomp.inherits(Nd,yb);Nd.prototype.InterpolantFactoryMethodLinear=
function(a){return new Eh(this.times,this.values,this.getValueSize(),a)};Nd.prototype.ValueTypeName="quaternion";Nd.prototype.DefaultInterpolation=2301;Nd.prototype.InterpolantFactoryMethodSmooth=void 0;var Pd=function(){return yb.apply(this,arguments)||this};$jscomp.inherits(Pd,yb);Pd.prototype.ValueTypeName="string";Pd.prototype.ValueBufferType=Array;Pd.prototype.DefaultInterpolation=2300;Pd.prototype.InterpolantFactoryMethodLinear=void 0;Pd.prototype.InterpolantFactoryMethodSmooth=void 0;var $e=
function(){return yb.apply(this,arguments)||this};$jscomp.inherits($e,yb);$e.prototype.ValueTypeName="vector";var ic=function(a,b,c,d){this.name=a;this.tracks=c;this.duration=void 0===b?-1:b;this.blendMode=void 0===d?2500:d;this.uuid=N();0>this.duration&&this.resetDuration()};ic.parse=function(a){for(var b=[],c=a.tracks,d=1/(a.fps||1),e=0,g=c.length;e!==g;++e)b.push(Ml(c[e]).scale(d));b=new this(a.name,a.duration,b,a.blendMode);return b.uuid=a.uuid,b};ic.toJSON=function(a){var b=[],c=a.tracks;a={name:a.name,
duration:a.duration,tracks:b,uuid:a.uuid,blendMode:a.blendMode};for(var d=0,e=c.length;d!==e;++d)b.push(yb.toJSON(c[d]));return a};ic.CreateFromMorphTargetSequence=function(a,b,c,d){for(var e=b.length,g=[],h=0;h<e;h++){var m=[],n=[];m.push((h+e-1)%e,h,(h+1)%e);n.push(0,1,0);var q=Hb.getKeyframeOrder(m);m=Hb.sortedArray(m,1,q);n=Hb.sortedArray(n,1,q);d||0!==m[0]||(m.push(e),n.push(n[0]));g.push((new Ze(".morphTargetInfluences["+b[h].name+"]",m,n)).scale(1/c))}return new this(a,-1,g)};ic.findByName=
function(a,b){var c=a;Array.isArray(a)||(c=a.geometry&&a.geometry.animations||a.animations);for(a=0;a<c.length;a++)if(c[a].name===b)return c[a];return null};ic.CreateClipsFromMorphTargetSequences=function(a,b,c){for(var d={},e=/^([\w-]*?)([\d]+)$/,g=0,h=a.length;g<h;g++){var m=a[g],n=m.name.match(e);if(n&&1<n.length){n=n[1];var q=d[n];q||(d[n]=q=[]);q.push(m)}}a=[];for(var t in d)a.push(this.CreateFromMorphTargetSequence(t,d[t],b,c));return a};ic.parseAnimation=function(a,b){if(!a)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),
null;var c=function(C,G,I,P,O){if(0!==I.length){var M=[],S=[];Hb.flattenJSON(I,M,S,P);0!==M.length&&O.push(new C(G,M,S))}},d=[],e=a.name||"default",g=a.fps||30,h=a.blendMode,m=a.length||-1;a=a.hierarchy||[];for(var n=0;n<a.length;n++){var q=a[n].keys;if(q&&0!==q.length)if(q[0].morphTargets){m={};var t=void 0;for(t=0;t<q.length;t++)if(q[t].morphTargets)for(var r=0;r<q[t].morphTargets.length;r++)m[q[t].morphTargets[r]]=-1;for(var u in m){r=[];for(var A=[],w=0;w!==q[t].morphTargets.length;++w){var x=
q[t];r.push(x.time);A.push(x.morphTarget===u?1:0)}d.push(new Ze(".morphTargetInfluence["+u+"]",r,A))}m=m.length*(g||1)}else t=".bones["+b[n].name+"]",c($e,t+".position",q,"pos",d),c(Nd,t+".quaternion",q,"rot",d),c($e,t+".scale",q,"scl",d)}return 0===d.length?null:new this(e,m,d,h)};ic.prototype.resetDuration=function(){for(var a=0,b=0,c=this.tracks.length;b!==c;++b){var d=this.tracks[b];a=Math.max(a,d.times[d.times.length-1])}return this.duration=a,this};ic.prototype.trim=function(){for(var a=0;a<
this.tracks.length;a++)this.tracks[a].trim(0,this.duration);return this};ic.prototype.validate=function(){for(var a=!0,b=0;b<this.tracks.length;b++)a=a&&this.tracks[b].validate();return a};ic.prototype.optimize=function(){for(var a=0;a<this.tracks.length;a++)this.tracks[a].optimize();return this};ic.prototype.clone=function(){for(var a=[],b=0;b<this.tracks.length;b++)a.push(this.tracks[b].clone());return new this.constructor(this.name,this.duration,a,this.blendMode)};ic.prototype.toJSON=function(){return this.constructor.toJSON(this)};
var Ee={enabled:!1,files:{},add:function(a,b){!1!==this.enabled&&(this.files[a]=b)},get:function(a){if(!1!==this.enabled)return this.files[a]},remove:function(a){delete this.files[a]},clear:function(){this.files={}}},cj=function(a,b,c){var d=this,e,g=!1,h=0,m=0,n=[];this.onStart=void 0;this.onLoad=a;this.onProgress=b;this.onError=c;this.itemStart=function(q){m++;!1===g&&void 0!==d.onStart&&d.onStart(q,h,m);g=!0};this.itemEnd=function(q){h++;void 0!==d.onProgress&&d.onProgress(q,h,m);h===m&&(g=!1,
void 0!==d.onLoad&&d.onLoad())};this.itemError=function(q){void 0!==d.onError&&d.onError(q)};this.resolveURL=function(q){return e?e(q):q};this.setURLModifier=function(q){return e=q,this};this.addHandler=function(q,t){return n.push(q,t),this};this.removeHandler=function(q){q=n.indexOf(q);return-1!==q&&n.splice(q,2),this};this.getHandler=function(q){for(var t=0,r=n.length;t<r;t+=2){var u=n[t],A=n[t+1];if(u.global&&(u.lastIndex=0),u.test(q))return A}return null}},Mk=new cj,lb=function(a){this.manager=
void 0!==a?a:Mk;this.crossOrigin="anonymous";this.withCredentials=!1;this.resourcePath=this.path="";this.requestHeader={}};lb.prototype.load=function(){};lb.prototype.loadAsync=function(a,b){var c=this;return new Promise(function(d,e){c.load(a,d,b,e)})};lb.prototype.parse=function(){};lb.prototype.setCrossOrigin=function(a){return this.crossOrigin=a,this};lb.prototype.setWithCredentials=function(a){return this.withCredentials=a,this};lb.prototype.setPath=function(a){return this.path=a,this};lb.prototype.setResourcePath=
function(a){return this.resourcePath=a,this};lb.prototype.setRequestHeader=function(a){return this.requestHeader=a,this};var Cd={},zc=function(a){return lb.call(this,a)||this};$jscomp.inherits(zc,lb);zc.prototype.load=function(a,b,c,d){var e=this;void 0===a&&(a="");void 0!==this.path&&(a=this.path+a);a=this.manager.resolveURL(a);var g=Ee.get(a);if(void 0!==g)return this.manager.itemStart(a),setTimeout(function(){b&&b(g);e.manager.itemEnd(a)},0),g;if(void 0!==Cd[a])return void Cd[a].push({onLoad:b,
onProgress:c,onError:d});Cd[a]=[];Cd[a].push({onLoad:b,onProgress:c,onError:d});c=new Request(a,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"});fetch(c).then(function(h){if(200===h.status||0===h.status){0===h.status&&console.warn("THREE.FileLoader: HTTP Status 0 received.");var m=Cd[a],n=h.body.getReader(),q=(h=h.headers.get("Content-Length"))?parseInt(h):0,t=0!==q,r=0;return new ReadableStream({start:function(u){!function w(){n.read().then(function(x){var C=
x.value;if(x.done)u.close();else{r+=C.byteLength;x=new ProgressEvent("progress",{lengthComputable:t,loaded:r,total:q});for(var G=0,I=m.length;G<I;G++){var P=m[G];P.onProgress&&P.onProgress(x)}u.enqueue(C);w()}})}()}})}throw Error('fetch for "'+h.url+'" responded with '+h.status+": "+h.statusText);}).then(function(h){h=new Response(h);switch(e.responseType){case "arraybuffer":return h.arrayBuffer();case "blob":return h.blob();case "document":return h.text().then(function(m){return(new DOMParser).parseFromString(m,
e.mimeType)});case "json":return h.json();default:return h.text()}}).then(function(h){Ee.add(a,h);var m=Cd[a];delete Cd[a];for(var n=0,q=m.length;n<q;n++){var t=m[n];t.onLoad&&t.onLoad(h)}e.manager.itemEnd(a)}).catch(function(h){var m=Cd[a];delete Cd[a];for(var n=0,q=m.length;n<q;n++){var t=m[n];t.onError&&t.onError(h)}e.manager.itemError(a);e.manager.itemEnd(a)});this.manager.itemStart(a)};zc.prototype.setResponseType=function(a){return this.responseType=a,this};zc.prototype.setMimeType=function(a){return this.mimeType=
a,this};var Fe=function(a){return lb.call(this,a)||this};$jscomp.inherits(Fe,lb);Fe.prototype.load=function(a,b,c,d){function e(){h();Ee.add(a,this);b&&b(this);m.manager.itemEnd(a)}function g(t){h();d&&d(t);m.manager.itemError(a);m.manager.itemEnd(a)}function h(){q.removeEventListener("load",e,!1);q.removeEventListener("error",g,!1)}void 0!==this.path&&(a=this.path+a);a=this.manager.resolveURL(a);var m=this,n=Ee.get(a);if(void 0!==n)return m.manager.itemStart(a),setTimeout(function(){b&&b(n);m.manager.itemEnd(a)},
0),n;var q=sa("img");return q.addEventListener("load",e,!1),q.addEventListener("error",g,!1),"data:"!==a.substr(0,5)&&void 0!==this.crossOrigin&&(q.crossOrigin=this.crossOrigin),m.manager.itemStart(a),q.src=a,q};var Fh=function(a){return lb.call(this,a)||this};$jscomp.inherits(Fh,lb);Fh.prototype.load=function(a,b,c,d){function e(n){h.load(a[n],function(q){g.images[n]=q;m++;6===m&&(g.needsUpdate=!0,b&&b(g))},void 0,d)}var g=new Ud,h=new Fe(this.manager);h.setCrossOrigin(this.crossOrigin);h.setPath(this.path);
var m=0;for(c=0;c<a.length;++c)e(c);return g};var Gh=function(a){return lb.call(this,a)||this};$jscomp.inherits(Gh,lb);Gh.prototype.load=function(a,b,c,d){var e=this,g=new Xd,h=new zc(this.manager);return h.setResponseType("arraybuffer"),h.setRequestHeader(this.requestHeader),h.setPath(this.path),h.setWithCredentials(e.withCredentials),h.load(a,function(m){(m=e.parse(m))&&(void 0!==m.image?g.image=m.image:void 0!==m.data&&(g.image.width=m.width,g.image.height=m.height,g.image.data=m.data),g.wrapS=
void 0!==m.wrapS?m.wrapS:1001,g.wrapT=void 0!==m.wrapT?m.wrapT:1001,g.magFilter=void 0!==m.magFilter?m.magFilter:1006,g.minFilter=void 0!==m.minFilter?m.minFilter:1006,g.anisotropy=void 0!==m.anisotropy?m.anisotropy:1,void 0!==m.encoding&&(g.encoding=m.encoding),void 0!==m.flipY&&(g.flipY=m.flipY),void 0!==m.format&&(g.format=m.format),void 0!==m.type&&(g.type=m.type),void 0!==m.mipmaps&&(g.mipmaps=m.mipmaps,g.minFilter=1008),1===m.mipmapCount&&(g.minFilter=1006),void 0!==m.generateMipmaps&&(g.generateMipmaps=
m.generateMipmaps),g.needsUpdate=!0,b&&b(g,m))},c,d),g};var Hh=function(a){return lb.call(this,a)||this};$jscomp.inherits(Hh,lb);Hh.prototype.load=function(a,b,c,d){var e=new mb,g=new Fe(this.manager);return g.setCrossOrigin(this.crossOrigin),g.setPath(this.path),g.load(a,function(h){e.image=h;e.needsUpdate=!0;void 0!==b&&b(e)},c,d),e};var Ab=function(a,b){b=void 0===b?1:b;var c=la.call(this)||this;c.type="Light";c.color=new ma(a);c.intensity=b;return c};$jscomp.inherits(Ab,la);Ab.prototype.dispose=
function(){};Ab.prototype.copy=function(a){return la.prototype.copy.call(this,a),this.color.copy(a.color),this.intensity=a.intensity,this};Ab.prototype.toJSON=function(a){a=la.prototype.toJSON.call(this,a);return a.object.color=this.color.getHex(),a.object.intensity=this.intensity,void 0!==this.groundColor&&(a.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(a.object.distance=this.distance),void 0!==this.angle&&(a.object.angle=this.angle),void 0!==this.decay&&(a.object.decay=
this.decay),void 0!==this.penumbra&&(a.object.penumbra=this.penumbra),void 0!==this.shadow&&(a.object.shadow=this.shadow.toJSON()),a};Ab.prototype.isLight=!0;var xg=function(a,b,c){a=Ab.call(this,a,c)||this;a.type="HemisphereLight";a.position.copy(la.DefaultUp);a.updateMatrix();a.groundColor=new ma(b);return a};$jscomp.inherits(xg,Ab);xg.prototype.copy=function(a){return Ab.prototype.copy.call(this,a),this.groundColor.copy(a.groundColor),this};xg.prototype.isHemisphereLight=!0;var Nk=new ua,Ok=new B,
Pk=new B,jc=function(a){this.camera=a;this.normalBias=this.bias=0;this.radius=1;this.blurSamples=8;this.mapSize=new T(512,512);this.mapPass=this.map=null;this.matrix=new ua;this.autoUpdate=!0;this.needsUpdate=!1;this._frustum=new wc;this._frameExtents=new T(1,1);this._viewportCount=1;this._viewports=[new za(0,0,1,1)]};jc.prototype.getViewportCount=function(){return this._viewportCount};jc.prototype.getFrustum=function(){return this._frustum};jc.prototype.updateMatrices=function(a){var b=this.camera,
c=this.matrix;Ok.setFromMatrixPosition(a.matrixWorld);b.position.copy(Ok);Pk.setFromMatrixPosition(a.target.matrixWorld);b.lookAt(Pk);b.updateMatrixWorld();Nk.multiplyMatrices(b.projectionMatrix,b.matrixWorldInverse);this._frustum.setFromProjectionMatrix(Nk);c.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1);c.multiply(b.projectionMatrix);c.multiply(b.matrixWorldInverse)};jc.prototype.getViewport=function(a){return this._viewports[a]};jc.prototype.getFrameExtents=function(){return this._frameExtents};jc.prototype.dispose=
function(){this.map&&this.map.dispose();this.mapPass&&this.mapPass.dispose()};jc.prototype.copy=function(a){return this.camera=a.camera.clone(),this.bias=a.bias,this.radius=a.radius,this.mapSize.copy(a.mapSize),this};jc.prototype.clone=function(){return(new this.constructor).copy(this)};jc.prototype.toJSON=function(){var a={};return 0!==this.bias&&(a.bias=this.bias),0!==this.normalBias&&(a.normalBias=this.normalBias),1!==this.radius&&(a.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||
(a.mapSize=this.mapSize.toArray()),a.camera=this.camera.toJSON(!1).object,delete a.camera.matrix,a};var yg=function(){var a=jc.call(this,new xb(50,1,.5,500))||this;a.focus=1;return a};$jscomp.inherits(yg,jc);yg.prototype.updateMatrices=function(a){var b=this.camera,c=2*$f*a.angle*this.focus,d=this.mapSize.width/this.mapSize.height,e=a.distance||b.far;c===b.fov&&d===b.aspect&&e===b.far||(b.fov=c,b.aspect=d,b.far=e,b.updateProjectionMatrix());jc.prototype.updateMatrices.call(this,a)};yg.prototype.copy=
function(a){return jc.prototype.copy.call(this,a),this.focus=a.focus,this};yg.prototype.isSpotLightShadow=!0;var Ge=function(a,b,c,d,e,g){c=void 0===c?0:c;d=void 0===d?Math.PI/3:d;e=void 0===e?0:e;g=void 0===g?1:g;a=Ab.call(this,a,b)||this;a.type="SpotLight";a.position.copy(la.DefaultUp);a.updateMatrix();a.target=new la;a.distance=c;a.angle=d;a.penumbra=e;a.decay=g;a.shadow=new yg;return a};$jscomp.inherits(Ge,Ab);Ge.prototype.dispose=function(){this.shadow.dispose()};Ge.prototype.copy=function(a){return Ab.prototype.copy.call(this,
a),this.distance=a.distance,this.angle=a.angle,this.penumbra=a.penumbra,this.decay=a.decay,this.target=a.target.clone(),this.shadow=a.shadow.clone(),this};$jscomp.global.Object.defineProperties(Ge.prototype,{power:{configurable:!0,enumerable:!0,get:function(){return this.intensity*Math.PI},set:function(a){this.intensity=a/Math.PI}}});Ge.prototype.isSpotLight=!0;var Qk=new ua,zg=new B,dj=new B,Ih=function(){var a=jc.call(this,new xb(90,1,.5,500))||this;a._frameExtents=new T(4,2);a._viewportCount=6;
a._viewports=[new za(2,1,1,1),new za(0,1,1,1),new za(3,1,1,1),new za(1,1,1,1),new za(3,0,1,1),new za(1,0,1,1)];a._cubeDirections=[new B(1,0,0),new B(-1,0,0),new B(0,0,1),new B(0,0,-1),new B(0,1,0),new B(0,-1,0)];a._cubeUps=[new B(0,1,0),new B(0,1,0),new B(0,1,0),new B(0,1,0),new B(0,0,1),new B(0,0,-1)];return a};$jscomp.inherits(Ih,jc);Ih.prototype.updateMatrices=function(a,b){b=void 0===b?0:b;var c=this.camera,d=this.matrix,e=a.distance||c.far;e!==c.far&&(c.far=e,c.updateProjectionMatrix());zg.setFromMatrixPosition(a.matrixWorld);
c.position.copy(zg);dj.copy(c.position);dj.add(this._cubeDirections[b]);c.up.copy(this._cubeUps[b]);c.lookAt(dj);c.updateMatrixWorld();d.makeTranslation(-zg.x,-zg.y,-zg.z);Qk.multiplyMatrices(c.projectionMatrix,c.matrixWorldInverse);this._frustum.setFromProjectionMatrix(Qk)};Ih.prototype.isPointLightShadow=!0;var He=function(a,b,c,d){c=void 0===c?0:c;d=void 0===d?1:d;a=Ab.call(this,a,b)||this;a.type="PointLight";a.distance=c;a.decay=d;a.shadow=new Ih;return a};$jscomp.inherits(He,Ab);He.prototype.dispose=
function(){this.shadow.dispose()};He.prototype.copy=function(a){return Ab.prototype.copy.call(this,a),this.distance=a.distance,this.decay=a.decay,this.shadow=a.shadow.clone(),this};$jscomp.global.Object.defineProperties(He.prototype,{power:{configurable:!0,enumerable:!0,get:function(){return 4*this.intensity*Math.PI},set:function(a){this.intensity=a/(4*Math.PI)}}});He.prototype.isPointLight=!0;var ej=function(){return jc.call(this,new Wc(-5,5,5,-5,.5,500))||this};$jscomp.inherits(ej,jc);ej.prototype.isDirectionalLightShadow=
!0;var wf=function(a,b){a=Ab.call(this,a,b)||this;a.type="DirectionalLight";a.position.copy(la.DefaultUp);a.updateMatrix();a.target=new la;a.shadow=new ej;return a};$jscomp.inherits(wf,Ab);wf.prototype.dispose=function(){this.shadow.dispose()};wf.prototype.copy=function(a){return Ab.prototype.copy.call(this,a),this.target=a.target.clone(),this.shadow=a.shadow.clone(),this};wf.prototype.isDirectionalLight=!0;var Jh=function(a,b){a=Ab.call(this,a,b)||this;a.type="AmbientLight";return a};$jscomp.inherits(Jh,
Ab);Jh.prototype.isAmbientLight=!0;var Ie=function(a,b,c,d){c=void 0===c?10:c;d=void 0===d?10:d;a=Ab.call(this,a,b)||this;a.type="RectAreaLight";a.width=c;a.height=d;return a};$jscomp.inherits(Ie,Ab);Ie.prototype.copy=function(a){return Ab.prototype.copy.call(this,a),this.width=a.width,this.height=a.height,this};Ie.prototype.toJSON=function(a){a=Ab.prototype.toJSON.call(this,a);return a.object.width=this.width,a.object.height=this.height,a};$jscomp.global.Object.defineProperties(Ie.prototype,{power:{configurable:!0,
enumerable:!0,get:function(){return this.intensity*this.width*this.height*Math.PI},set:function(a){this.intensity=a/(this.width*this.height*Math.PI)}}});Ie.prototype.isRectAreaLight=!0;var kc=function(){this.coefficients=[];for(var a=0;9>a;a++)this.coefficients.push(new B)};kc.prototype.set=function(a){for(var b=0;9>b;b++)this.coefficients[b].copy(a[b]);return this};kc.prototype.zero=function(){for(var a=0;9>a;a++)this.coefficients[a].set(0,0,0);return this};kc.prototype.getAt=function(a,b){var c=
a.x,d=a.y;a=a.z;var e=this.coefficients;return b.copy(e[0]).multiplyScalar(.282095),b.addScaledVector(e[1],.488603*d),b.addScaledVector(e[2],.488603*a),b.addScaledVector(e[3],.488603*c),b.addScaledVector(e[4],c*d*1.092548),b.addScaledVector(e[5],d*a*1.092548),b.addScaledVector(e[6],.315392*(3*a*a-1)),b.addScaledVector(e[7],c*a*1.092548),b.addScaledVector(e[8],.546274*(c*c-d*d)),b};kc.prototype.getIrradianceAt=function(a,b){var c=a.x,d=a.y;a=a.z;var e=this.coefficients;return b.copy(e[0]).multiplyScalar(.886227),
b.addScaledVector(e[1],1.023328*d),b.addScaledVector(e[2],1.023328*a),b.addScaledVector(e[3],1.023328*c),b.addScaledVector(e[4],.858086*c*d),b.addScaledVector(e[5],.858086*d*a),b.addScaledVector(e[6],.743125*a*a-.247708),b.addScaledVector(e[7],.858086*c*a),b.addScaledVector(e[8],.429043*(c*c-d*d)),b};kc.prototype.add=function(a){for(var b=0;9>b;b++)this.coefficients[b].add(a.coefficients[b]);return this};kc.prototype.addScaledSH=function(a,b){for(var c=0;9>c;c++)this.coefficients[c].addScaledVector(a.coefficients[c],
b);return this};kc.prototype.scale=function(a){for(var b=0;9>b;b++)this.coefficients[b].multiplyScalar(a);return this};kc.prototype.lerp=function(a,b){for(var c=0;9>c;c++)this.coefficients[c].lerp(a.coefficients[c],b);return this};kc.prototype.equals=function(a){for(var b=0;9>b;b++)if(!this.coefficients[b].equals(a.coefficients[b]))return!1;return!0};kc.prototype.copy=function(a){return this.set(a.coefficients)};kc.prototype.clone=function(){return(new this.constructor).copy(this)};kc.prototype.fromArray=
function(a,b){b=void 0===b?0:b;for(var c=this.coefficients,d=0;9>d;d++)c[d].fromArray(a,b+3*d);return this};kc.prototype.toArray=function(a,b){a=void 0===a?[]:a;b=void 0===b?0:b;for(var c=this.coefficients,d=0;9>d;d++)c[d].toArray(a,b+3*d);return a};kc.getBasisAt=function(a,b){var c=a.x,d=a.y;a=a.z;b[0]=.282095;b[1]=.488603*d;b[2]=.488603*a;b[3]=.488603*c;b[4]=1.092548*c*d;b[5]=1.092548*d*a;b[6]=.315392*(3*a*a-1);b[7]=1.092548*c*a;b[8]=.546274*(c*c-d*d)};kc.prototype.isSphericalHarmonics3=!0;var Zc=
function(a,b){a=void 0===a?new kc:a;b=Ab.call(this,void 0,void 0===b?1:b)||this;b.sh=a;return b};$jscomp.inherits(Zc,Ab);Zc.prototype.copy=function(a){return Ab.prototype.copy.call(this,a),this.sh.copy(a.sh),this};Zc.prototype.fromJSON=function(a){return this.intensity=a.intensity,this.sh.fromArray(a.sh),this};Zc.prototype.toJSON=function(a){a=Ab.prototype.toJSON.call(this,a);return a.object.sh=this.sh.toArray(),a};Zc.prototype.isLightProbe=!0;var xf=function(a){a=lb.call(this,a)||this;a.textures=
{};return a};$jscomp.inherits(xf,lb);xf.prototype.load=function(a,b,c,d){var e=this,g=new zc(e.manager);g.setPath(e.path);g.setRequestHeader(e.requestHeader);g.setWithCredentials(e.withCredentials);g.load(a,function(h){try{b(e.parse(JSON.parse(h)))}catch(m){d?d(m):console.error(m),e.manager.itemError(a)}},c,d)};xf.prototype.parse=function(a){function b(m){return void 0===c[m]&&console.warn("THREE.MaterialLoader: Undefined texture",m),c[m]}var c=this.textures,d=new cm[a.type];if(void 0!==a.uuid&&(d.uuid=
a.uuid),void 0!==a.name&&(d.name=a.name),void 0!==a.color&&void 0!==d.color&&d.color.setHex(a.color),void 0!==a.roughness&&(d.roughness=a.roughness),void 0!==a.metalness&&(d.metalness=a.metalness),void 0!==a.sheen&&(d.sheen=a.sheen),void 0!==a.sheenColor&&(d.sheenColor=(new ma).setHex(a.sheenColor)),void 0!==a.sheenRoughness&&(d.sheenRoughness=a.sheenRoughness),void 0!==a.emissive&&void 0!==d.emissive&&d.emissive.setHex(a.emissive),void 0!==a.specular&&void 0!==d.specular&&d.specular.setHex(a.specular),
void 0!==a.specularIntensity&&(d.specularIntensity=a.specularIntensity),void 0!==a.specularColor&&void 0!==d.specularColor&&d.specularColor.setHex(a.specularColor),void 0!==a.shininess&&(d.shininess=a.shininess),void 0!==a.clearcoat&&(d.clearcoat=a.clearcoat),void 0!==a.clearcoatRoughness&&(d.clearcoatRoughness=a.clearcoatRoughness),void 0!==a.transmission&&(d.transmission=a.transmission),void 0!==a.thickness&&(d.thickness=a.thickness),void 0!==a.attenuationDistance&&(d.attenuationDistance=a.attenuationDistance),
void 0!==a.attenuationColor&&void 0!==d.attenuationColor&&d.attenuationColor.setHex(a.attenuationColor),void 0!==a.fog&&(d.fog=a.fog),void 0!==a.flatShading&&(d.flatShading=a.flatShading),void 0!==a.blending&&(d.blending=a.blending),void 0!==a.combine&&(d.combine=a.combine),void 0!==a.side&&(d.side=a.side),void 0!==a.shadowSide&&(d.shadowSide=a.shadowSide),void 0!==a.opacity&&(d.opacity=a.opacity),void 0!==a.format&&(d.format=a.format),void 0!==a.transparent&&(d.transparent=a.transparent),void 0!==
a.alphaTest&&(d.alphaTest=a.alphaTest),void 0!==a.depthTest&&(d.depthTest=a.depthTest),void 0!==a.depthWrite&&(d.depthWrite=a.depthWrite),void 0!==a.colorWrite&&(d.colorWrite=a.colorWrite),void 0!==a.stencilWrite&&(d.stencilWrite=a.stencilWrite),void 0!==a.stencilWriteMask&&(d.stencilWriteMask=a.stencilWriteMask),void 0!==a.stencilFunc&&(d.stencilFunc=a.stencilFunc),void 0!==a.stencilRef&&(d.stencilRef=a.stencilRef),void 0!==a.stencilFuncMask&&(d.stencilFuncMask=a.stencilFuncMask),void 0!==a.stencilFail&&
(d.stencilFail=a.stencilFail),void 0!==a.stencilZFail&&(d.stencilZFail=a.stencilZFail),void 0!==a.stencilZPass&&(d.stencilZPass=a.stencilZPass),void 0!==a.wireframe&&(d.wireframe=a.wireframe),void 0!==a.wireframeLinewidth&&(d.wireframeLinewidth=a.wireframeLinewidth),void 0!==a.wireframeLinecap&&(d.wireframeLinecap=a.wireframeLinecap),void 0!==a.wireframeLinejoin&&(d.wireframeLinejoin=a.wireframeLinejoin),void 0!==a.rotation&&(d.rotation=a.rotation),1!==a.linewidth&&(d.linewidth=a.linewidth),void 0!==
a.dashSize&&(d.dashSize=a.dashSize),void 0!==a.gapSize&&(d.gapSize=a.gapSize),void 0!==a.scale&&(d.scale=a.scale),void 0!==a.polygonOffset&&(d.polygonOffset=a.polygonOffset),void 0!==a.polygonOffsetFactor&&(d.polygonOffsetFactor=a.polygonOffsetFactor),void 0!==a.polygonOffsetUnits&&(d.polygonOffsetUnits=a.polygonOffsetUnits),void 0!==a.dithering&&(d.dithering=a.dithering),void 0!==a.alphaToCoverage&&(d.alphaToCoverage=a.alphaToCoverage),void 0!==a.premultipliedAlpha&&(d.premultipliedAlpha=a.premultipliedAlpha),
void 0!==a.visible&&(d.visible=a.visible),void 0!==a.toneMapped&&(d.toneMapped=a.toneMapped),void 0!==a.userData&&(d.userData=a.userData),void 0!==a.vertexColors&&("number"==typeof a.vertexColors?d.vertexColors=0<a.vertexColors:d.vertexColors=a.vertexColors),void 0!==a.uniforms)for(var e in a.uniforms){var g=a.uniforms[e];switch(d.uniforms[e]={},g.type){case "t":d.uniforms[e].value=b(g.value);break;case "c":d.uniforms[e].value=(new ma).setHex(g.value);break;case "v2":d.uniforms[e].value=(new T).fromArray(g.value);
break;case "v3":d.uniforms[e].value=(new B).fromArray(g.value);break;case "v4":d.uniforms[e].value=(new za).fromArray(g.value);break;case "m3":d.uniforms[e].value=(new fb).fromArray(g.value);break;case "m4":d.uniforms[e].value=(new ua).fromArray(g.value);break;default:d.uniforms[e].value=g.value}}if(void 0!==a.defines&&(d.defines=a.defines),void 0!==a.vertexShader&&(d.vertexShader=a.vertexShader),void 0!==a.fragmentShader&&(d.fragmentShader=a.fragmentShader),void 0!==a.extensions)for(var h in a.extensions)d.extensions[h]=
a.extensions[h];if(void 0!==a.shading&&(d.flatShading=1===a.shading),void 0!==a.size&&(d.size=a.size),void 0!==a.sizeAttenuation&&(d.sizeAttenuation=a.sizeAttenuation),void 0!==a.map&&(d.map=b(a.map)),void 0!==a.matcap&&(d.matcap=b(a.matcap)),void 0!==a.alphaMap&&(d.alphaMap=b(a.alphaMap)),void 0!==a.bumpMap&&(d.bumpMap=b(a.bumpMap)),void 0!==a.bumpScale&&(d.bumpScale=a.bumpScale),void 0!==a.normalMap&&(d.normalMap=b(a.normalMap)),void 0!==a.normalMapType&&(d.normalMapType=a.normalMapType),void 0!==
a.normalScale)e=a.normalScale,!1===Array.isArray(e)&&(e=[e,e]),d.normalScale=(new T).fromArray(e);return void 0!==a.displacementMap&&(d.displacementMap=b(a.displacementMap)),void 0!==a.displacementScale&&(d.displacementScale=a.displacementScale),void 0!==a.displacementBias&&(d.displacementBias=a.displacementBias),void 0!==a.roughnessMap&&(d.roughnessMap=b(a.roughnessMap)),void 0!==a.metalnessMap&&(d.metalnessMap=b(a.metalnessMap)),void 0!==a.emissiveMap&&(d.emissiveMap=b(a.emissiveMap)),void 0!==
a.emissiveIntensity&&(d.emissiveIntensity=a.emissiveIntensity),void 0!==a.specularMap&&(d.specularMap=b(a.specularMap)),void 0!==a.specularIntensityMap&&(d.specularIntensityMap=b(a.specularIntensityMap)),void 0!==a.specularColorMap&&(d.specularColorMap=b(a.specularColorMap)),void 0!==a.envMap&&(d.envMap=b(a.envMap)),void 0!==a.envMapIntensity&&(d.envMapIntensity=a.envMapIntensity),void 0!==a.reflectivity&&(d.reflectivity=a.reflectivity),void 0!==a.refractionRatio&&(d.refractionRatio=a.refractionRatio),
void 0!==a.lightMap&&(d.lightMap=b(a.lightMap)),void 0!==a.lightMapIntensity&&(d.lightMapIntensity=a.lightMapIntensity),void 0!==a.aoMap&&(d.aoMap=b(a.aoMap)),void 0!==a.aoMapIntensity&&(d.aoMapIntensity=a.aoMapIntensity),void 0!==a.gradientMap&&(d.gradientMap=b(a.gradientMap)),void 0!==a.clearcoatMap&&(d.clearcoatMap=b(a.clearcoatMap)),void 0!==a.clearcoatRoughnessMap&&(d.clearcoatRoughnessMap=b(a.clearcoatRoughnessMap)),void 0!==a.clearcoatNormalMap&&(d.clearcoatNormalMap=b(a.clearcoatNormalMap)),
void 0!==a.clearcoatNormalScale&&(d.clearcoatNormalScale=(new T).fromArray(a.clearcoatNormalScale)),void 0!==a.transmissionMap&&(d.transmissionMap=b(a.transmissionMap)),void 0!==a.thicknessMap&&(d.thicknessMap=b(a.thicknessMap)),void 0!==a.sheenColorMap&&(d.sheenColorMap=b(a.sheenColorMap)),void 0!==a.sheenRoughnessMap&&(d.sheenRoughnessMap=b(a.sheenRoughnessMap)),d};xf.prototype.setTextures=function(a){return this.textures=a,this};var Je=function(){};Je.decodeText=function(a){if("undefined"!=typeof TextDecoder)return(new TextDecoder).decode(a);
for(var b="",c=0,d=a.length;c<d;c++)b+=String.fromCharCode(a[c]);try{return decodeURIComponent(escape(b))}catch(e){return b}};Je.extractUrlBase=function(a){var b=a.lastIndexOf("/");return-1===b?"./":a.substr(0,b+1)};Je.resolveURL=function(a,b){return"string"!=typeof a||""===a?"":(/^https?:\/\//i.test(b)&&/^\//.test(a)&&(b=b.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(a)||/^data:.*,.*$/i.test(a)||/^blob:.*$/i.test(a)?a:b+a)};var Ke=function(){var a=ra.call(this)||this;a.type="InstancedBufferGeometry";
a.instanceCount=1/0;return a};$jscomp.inherits(Ke,ra);Ke.prototype.copy=function(a){return ra.prototype.copy.call(this,a),this.instanceCount=a.instanceCount,this};Ke.prototype.clone=function(){return(new this.constructor).copy(this)};Ke.prototype.toJSON=function(){var a=ra.prototype.toJSON.call(this,this);return a.instanceCount=this.instanceCount,a.isInstancedBufferGeometry=!0,a};Ke.prototype.isInstancedBufferGeometry=!0;var Ag=function(a){return lb.call(this,a)||this};$jscomp.inherits(Ag,lb);Ag.prototype.load=
function(a,b,c,d){var e=this,g=new zc(e.manager);g.setPath(e.path);g.setRequestHeader(e.requestHeader);g.setWithCredentials(e.withCredentials);g.load(a,function(h){try{b(e.parse(JSON.parse(h)))}catch(m){d?d(m):console.error(m),e.manager.itemError(a)}},c,d)};Ag.prototype.parse=function(a){function b(A,w){if(void 0!==c[w])return c[w];var x=A.interleavedBuffers[w];var C=x.buffer;void 0!==d[C]?C=d[C]:(A=(new Uint32Array(A.arrayBuffers[C])).buffer,C=(d[C]=A,A));C=new af[x.type](C);C=new Xb(C,x.stride);
return C.uuid=x.uuid,c[w]=C,C}var c={},d={},e=a.isInstancedBufferGeometry?new Ke:new ra,g=a.data.index;void 0!==g&&(g=new af[g.type](g.array),e.setIndex(new Ba(g,1)));g=a.data.attributes;for(var h in g){var m=g[h],n=void 0;m.isInterleavedBufferAttribute?(n=b(a.data,m.data),n=new Kb(n,m.itemSize,m.offset,m.normalized)):(n=new af[m.type](m.array),n=new (m.isInstancedBufferAttribute?hd:Ba)(n,m.itemSize,m.normalized));void 0!==m.name&&(n.name=m.name);void 0!==m.usage&&n.setUsage(m.usage);void 0!==m.updateRange&&
(n.updateRange.offset=m.updateRange.offset,n.updateRange.count=m.updateRange.count);e.setAttribute(h,n)}if(h=a.data.morphAttributes)for(var q in h){g=h[q];m=[];n=0;for(var t=g.length;n<t;n++){var r=g[n],u=void 0;r.isInterleavedBufferAttribute?(u=b(a.data,r.data),u=new Kb(u,r.itemSize,r.offset,r.normalized)):(u=new af[r.type](r.array),u=new Ba(u,r.itemSize,r.normalized));void 0!==r.name&&(u.name=r.name);m.push(u)}e.morphAttributes[q]=m}a.data.morphTargetsRelative&&(e.morphTargetsRelative=!0);q=a.data.groups||
a.data.drawcalls||a.data.offsets;if(void 0!==q)for(h=0,g=q.length;h!==g;++h)m=q[h],e.addGroup(m.start,m.count,m.materialIndex);q=a.data.boundingSphere;void 0!==q&&(h=new B,void 0!==q.center&&h.fromArray(q.center),e.boundingSphere=new Fb(h,q.radius));return a.name&&(e.name=a.name),a.userData&&(e.userData=a.userData),e};var dm={UVMapping:300,CubeReflectionMapping:301,CubeRefractionMapping:302,EquirectangularReflectionMapping:303,EquirectangularRefractionMapping:304,CubeUVReflectionMapping:306,CubeUVRefractionMapping:307},
Rk={RepeatWrapping:1E3,ClampToEdgeWrapping:1001,MirroredRepeatWrapping:1002},Sk={NearestFilter:1003,NearestMipmapNearestFilter:1004,NearestMipmapLinearFilter:1005,LinearFilter:1006,LinearMipmapNearestFilter:1007,LinearMipmapLinearFilter:1008},Bg=function(a){a=lb.call(this,a)||this;"undefined"==typeof createImageBitmap&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported.");"undefined"==typeof fetch&&console.warn("THREE.ImageBitmapLoader: fetch() not supported.");a.options={premultiplyAlpha:"none"};
return a};$jscomp.inherits(Bg,lb);Bg.prototype.setOptions=function(a){return this.options=a,this};Bg.prototype.load=function(a,b,c,d){void 0===a&&(a="");void 0!==this.path&&(a=this.path+a);a=this.manager.resolveURL(a);var e=this,g=Ee.get(a);if(void 0!==g)return e.manager.itemStart(a),setTimeout(function(){b&&b(g);e.manager.itemEnd(a)},0),g;c={};c.credentials="anonymous"===this.crossOrigin?"same-origin":"include";c.headers=this.requestHeader;fetch(a,c).then(function(h){return h.blob()}).then(function(h){return createImageBitmap(h,
Object.assign(e.options,{colorSpaceConversion:"none"}))}).then(function(h){Ee.add(a,h);b&&b(h);e.manager.itemEnd(a)}).catch(function(h){d&&d(h);e.manager.itemError(a);e.manager.itemEnd(a)});e.manager.itemStart(a)};var Kh;Bg.prototype.isImageBitmapLoader=!0;var fj={getContext:function(){return void 0===Kh&&(Kh=new (window.AudioContext||window.webkitAudioContext)),Kh},setContext:function(a){Kh=a}},Lh=function(a){return lb.call(this,a)||this};$jscomp.inherits(Lh,lb);Lh.prototype.load=function(a,b,c,
d){var e=this,g=new zc(this.manager);g.setResponseType("arraybuffer");g.setPath(this.path);g.setRequestHeader(this.requestHeader);g.setWithCredentials(this.withCredentials);g.load(a,function(h){try{var m=h.slice(0);fj.getContext().decodeAudioData(m,function(n){b(n)})}catch(n){d?d(n):console.error(n),e.manager.itemError(a)}},c,d)};var gj=function(a,b,c){c=Zc.call(this,void 0,void 0===c?1:c)||this;a=(new ma).set(a);var d=(new ma).set(b);b=new B(a.r,a.g,a.b);a=new B(d.r,d.g,d.b);d=Math.sqrt(Math.PI);
var e=d*Math.sqrt(.75);c.sh.coefficients[0].copy(b).add(a).multiplyScalar(d);c.sh.coefficients[1].copy(b).sub(a).multiplyScalar(e);return c};$jscomp.inherits(gj,Zc);gj.prototype.isHemisphereLightProbe=!0;var hj=function(a,b){b=Zc.call(this,void 0,void 0===b?1:b)||this;a=(new ma).set(a);b.sh.coefficients[0].set(a.r,a.g,a.b).multiplyScalar(2*Math.sqrt(Math.PI));return b};$jscomp.inherits(hj,Zc);hj.prototype.isAmbientLightProbe=!0;var Tk=new ua,Uk=new ua,yf=function(a){this.autoStart=void 0===a?!0:a;
this.elapsedTime=this.oldTime=this.startTime=0;this.running=!1};yf.prototype.start=function(){this.oldTime=this.startTime=ak();this.elapsedTime=0;this.running=!0};yf.prototype.stop=function(){this.getElapsedTime();this.autoStart=this.running=!1};yf.prototype.getElapsedTime=function(){return this.getDelta(),this.elapsedTime};yf.prototype.getDelta=function(){var a=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){var b=ak();a=(b-this.oldTime)/1E3;this.oldTime=b;this.elapsedTime+=
a}return a};var Le=new B,Vk=new Sa,em=new B,Me=new B,tb=function(a){var b=la.call(this)||this;b.type="Audio";b.listener=a;b.context=a.context;b.gain=b.context.createGain();b.gain.connect(a.getInput());b.autoplay=!1;b.buffer=null;b.detune=0;b.loop=!1;b.loopStart=0;b.loopEnd=0;b.offset=0;b.duration=void 0;b.playbackRate=1;b.isPlaying=!1;b.hasPlaybackControl=!0;b.source=null;b.sourceType="empty";b._startedAt=0;b._progress=0;b._connected=!1;b.filters=[];return b};$jscomp.inherits(tb,la);tb.prototype.getOutput=
function(){return this.gain};tb.prototype.setNodeSource=function(a){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=a,this.connect(),this};tb.prototype.setMediaElementSource=function(a){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(a),this.connect(),this};tb.prototype.setMediaStreamSource=function(a){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(a),
this.connect(),this};tb.prototype.setBuffer=function(a){return this.buffer=a,this.sourceType="buffer",this.autoplay&&this.play(),this};tb.prototype.play=function(a){a=void 0===a?0:a;if(!0===this.isPlaying)return void console.warn("THREE.Audio: Audio is already playing.");if(!1===this.hasPlaybackControl)return void console.warn("THREE.Audio: this Audio has no playback control.");this._startedAt=this.context.currentTime+a;a=this.context.createBufferSource();return a.buffer=this.buffer,a.loop=this.loop,
a.loopStart=this.loopStart,a.loopEnd=this.loopEnd,a.onended=this.onEnded.bind(this),a.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=a,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()};tb.prototype.pause=function(){if(!1!==this.hasPlaybackControl)return!0===this.isPlaying&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,!0===this.loop&&(this._progress%=this.duration||this.buffer.duration),
this.source.stop(),this.source.onended=null,this.isPlaying=!1),this;console.warn("THREE.Audio: this Audio has no playback control.")};tb.prototype.stop=function(){if(!1!==this.hasPlaybackControl)return this._progress=0,this.source.stop(),this.source.onended=null,this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")};tb.prototype.connect=function(){if(0<this.filters.length){this.source.connect(this.filters[0]);for(var a=1,b=this.filters.length;a<b;a++)this.filters[a-
1].connect(this.filters[a]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this};tb.prototype.disconnect=function(){if(0<this.filters.length){this.source.disconnect(this.filters[0]);for(var a=1,b=this.filters.length;a<b;a++)this.filters[a-1].disconnect(this.filters[a]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this};tb.prototype.getFilters=
function(){return this.filters};tb.prototype.setFilters=function(a){return a||(a=[]),!0===this._connected?(this.disconnect(),this.filters=a.slice(),this.connect()):this.filters=a.slice(),this};tb.prototype.setDetune=function(a){if(this.detune=a,void 0!==this.source.detune)return!0===this.isPlaying&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this};tb.prototype.getDetune=function(){return this.detune};tb.prototype.getFilter=function(){return this.getFilters()[0]};tb.prototype.setFilter=
function(a){return this.setFilters(a?[a]:[])};tb.prototype.setPlaybackRate=function(a){if(!1!==this.hasPlaybackControl)return this.playbackRate=a,!0===this.isPlaying&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this;console.warn("THREE.Audio: this Audio has no playback control.")};tb.prototype.getPlaybackRate=function(){return this.playbackRate};tb.prototype.onEnded=function(){this.isPlaying=!1};tb.prototype.getLoop=function(){return!1===this.hasPlaybackControl?
(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop};tb.prototype.setLoop=function(a){if(!1!==this.hasPlaybackControl)return this.loop=a,!0===this.isPlaying&&(this.source.loop=this.loop),this;console.warn("THREE.Audio: this Audio has no playback control.")};tb.prototype.setLoopStart=function(a){return this.loopStart=a,this};tb.prototype.setLoopEnd=function(a){return this.loopEnd=a,this};tb.prototype.getVolume=function(){return this.gain.gain.value};tb.prototype.setVolume=
function(a){return this.gain.gain.setTargetAtTime(a,this.context.currentTime,.01),this};var Ne=new B,Wk=new Sa,fm=new B,Oe=new B,Mh=function(a,b){b=void 0===b?2048:b;this.analyser=a.context.createAnalyser();this.analyser.fftSize=b;this.data=new Uint8Array(this.analyser.frequencyBinCount);a.getOutput().connect(this.analyser)};Mh.prototype.getFrequencyData=function(){return this.analyser.getByteFrequencyData(this.data),this.data};Mh.prototype.getAverageFrequency=function(){for(var a=0,b=this.getFrequencyData(),
c=0;c<b.length;c++)a+=b[c];return a/b.length};var vc=function(a,b,c){switch(this.binding=a,this.valueSize=c,b){case "quaternion":a=this._slerp;b=this._slerpAdditive;var d=this._setAdditiveIdentityQuaternion;this.buffer=new Float64Array(6*c);this._workIndex=5;break;case "string":case "bool":b=a=this._select;d=this._setAdditiveIdentityOther;this.buffer=Array(5*c);break;default:a=this._lerp,b=this._lerpAdditive,d=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(5*c)}this._mixBufferRegion=
a;this._mixBufferRegionAdditive=b;this._setIdentity=d;this._origIndex=3;this._addIndex=4;this.referenceCount=this.useCount=this.cumulativeWeightAdditive=this.cumulativeWeight=0};vc.prototype.accumulate=function(a,b){var c=this.buffer,d=this.valueSize;a=a*d+d;var e=this.cumulativeWeight;if(0===e){for(e=0;e!==d;++e)c[a+e]=c[e];e=b}else e+=b,this._mixBufferRegion(c,a,0,b/e,d);this.cumulativeWeight=e};vc.prototype.accumulateAdditive=function(a){var b=this.buffer,c=this.valueSize,d=c*this._addIndex;0===
this.cumulativeWeightAdditive&&this._setIdentity();this._mixBufferRegionAdditive(b,d,0,a,c);this.cumulativeWeightAdditive+=a};vc.prototype.apply=function(a){var b=this.valueSize,c=this.buffer;a=a*b+b;var d=this.cumulativeWeight,e=this.cumulativeWeightAdditive,g=this.binding;(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,1>d)&&this._mixBufferRegion(c,a,b*this._origIndex,1-d,b);0<e&&this._mixBufferRegionAdditive(c,a,this._addIndex*b,1,b);d=b;for(e=b+b;d!==e;++d)if(c[d]!==c[d+b]){g.setValue(c,
a);break}};vc.prototype.saveOriginalState=function(){var a=this.buffer,b=this.valueSize,c=b*this._origIndex;this.binding.getValue(a,c);for(var d=b;d!==c;++d)a[d]=a[c+d%b];this._setIdentity();this.cumulativeWeightAdditive=this.cumulativeWeight=0};vc.prototype.restoreOriginalState=function(){this.binding.setValue(this.buffer,3*this.valueSize)};vc.prototype._setAdditiveIdentityNumeric=function(){for(var a=this._addIndex*this.valueSize,b=a+this.valueSize;a<b;a++)this.buffer[a]=0};vc.prototype._setAdditiveIdentityQuaternion=
function(){this._setAdditiveIdentityNumeric();this.buffer[this._addIndex*this.valueSize+3]=1};vc.prototype._setAdditiveIdentityOther=function(){for(var a=this._origIndex*this.valueSize,b=this._addIndex*this.valueSize,c=0;c<this.valueSize;c++)this.buffer[b+c]=this.buffer[a+c]};vc.prototype._select=function(a,b,c,d,e){if(.5<=d)for(d=0;d!==e;++d)a[b+d]=a[c+d]};vc.prototype._slerp=function(a,b,c,d){Sa.slerpFlat(a,b,a,b,a,c,d)};vc.prototype._slerpAdditive=function(a,b,c,d,e){e*=this._workIndex;Sa.multiplyQuaternionsFlat(a,
e,a,b,a,c);Sa.slerpFlat(a,b,a,b,a,e,d)};vc.prototype._lerp=function(a,b,c,d,e){for(var g=1-d,h=0;h!==e;++h){var m=b+h;a[m]=a[m]*g+a[c+h]*d}};vc.prototype._lerpAdditive=function(a,b,c,d,e){for(var g=0;g!==e;++g){var h=b+g;a[h]+=a[c+g]*d}};var gm=RegExp("[\\[\\]\\.:\\/]","g"),hm=/((?:WC+[\/:])*)/.source.replace("WC","[^\\[\\]\\.:\\/]"),im=/(WCOD+)?/.source.replace("WCOD","[^\\[\\]:\\/]"),jm=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC","[^\\[\\]\\.:\\/]"),km=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",
"[^\\[\\]\\.:\\/]"),lm=new RegExp("^"+hm+im+jm+km+"$"),mm=["material","materials","bones"],Pa=function(a,b,c){this.path=b;this.parsedPath=c||Pa.parseTrackName(b);this.node=Pa.findNode(a,this.parsedPath.nodeName)||a;this.rootNode=a;this.getValue=this._getValue_unbound;this.setValue=this._setValue_unbound};Pa.create=function(a,b,c){return a&&a.isAnimationObjectGroup?new Pa.Composite(a,b,c):new Pa(a,b,c)};Pa.sanitizeNodeName=function(a){return a.replace(/\s/g,"_").replace(gm,"")};Pa.parseTrackName=function(a){var b=
lm.exec(a);if(!b)throw Error("PropertyBinding: Cannot parse trackName: "+a);b={nodeName:b[2],objectName:b[3],objectIndex:b[4],propertyName:b[5],propertyIndex:b[6]};var c=b.nodeName&&b.nodeName.lastIndexOf(".");if(void 0!==c&&-1!==c){var d=b.nodeName.substring(c+1);-1!==mm.indexOf(d)&&(b.nodeName=b.nodeName.substring(0,c),b.objectName=d)}if(null===b.propertyName||0===b.propertyName.length)throw Error("PropertyBinding: can not parse propertyName from trackName: "+a);return b};Pa.findNode=function(a,
b){if(!b||""===b||"."===b||-1===b||b===a.name||b===a.uuid)return a;if(a.skeleton){var c=a.skeleton.getBoneByName(b);if(void 0!==c)return c}if(a.children){var d=function(e){for(var g=0;g<e.length;g++){var h=e[g];if(h.name===b||h.uuid===b||(h=d(h.children)))return h}return null};if(a=d(a.children))return a}return null};Pa.prototype._getValue_unavailable=function(){};Pa.prototype._setValue_unavailable=function(){};Pa.prototype._getValue_direct=function(a,b){a[b]=this.targetObject[this.propertyName]};
Pa.prototype._getValue_array=function(a,b){for(var c=this.resolvedProperty,d=0,e=c.length;d!==e;++d)a[b++]=c[d]};Pa.prototype._getValue_arrayElement=function(a,b){a[b]=this.resolvedProperty[this.propertyIndex]};Pa.prototype._getValue_toArray=function(a,b){this.resolvedProperty.toArray(a,b)};Pa.prototype._setValue_direct=function(a,b){this.targetObject[this.propertyName]=a[b]};Pa.prototype._setValue_direct_setNeedsUpdate=function(a,b){this.targetObject[this.propertyName]=a[b];this.targetObject.needsUpdate=
!0};Pa.prototype._setValue_direct_setMatrixWorldNeedsUpdate=function(a,b){this.targetObject[this.propertyName]=a[b];this.targetObject.matrixWorldNeedsUpdate=!0};Pa.prototype._setValue_array=function(a,b){for(var c=this.resolvedProperty,d=0,e=c.length;d!==e;++d)c[d]=a[b++]};Pa.prototype._setValue_array_setNeedsUpdate=function(a,b){for(var c=this.resolvedProperty,d=0,e=c.length;d!==e;++d)c[d]=a[b++];this.targetObject.needsUpdate=!0};Pa.prototype._setValue_array_setMatrixWorldNeedsUpdate=function(a,
b){for(var c=this.resolvedProperty,d=0,e=c.length;d!==e;++d)c[d]=a[b++];this.targetObject.matrixWorldNeedsUpdate=!0};Pa.prototype._setValue_arrayElement=function(a,b){this.resolvedProperty[this.propertyIndex]=a[b]};Pa.prototype._setValue_arrayElement_setNeedsUpdate=function(a,b){this.resolvedProperty[this.propertyIndex]=a[b];this.targetObject.needsUpdate=!0};Pa.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate=function(a,b){this.resolvedProperty[this.propertyIndex]=a[b];this.targetObject.matrixWorldNeedsUpdate=
!0};Pa.prototype._setValue_fromArray=function(a,b){this.resolvedProperty.fromArray(a,b)};Pa.prototype._setValue_fromArray_setNeedsUpdate=function(a,b){this.resolvedProperty.fromArray(a,b);this.targetObject.needsUpdate=!0};Pa.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate=function(a,b){this.resolvedProperty.fromArray(a,b);this.targetObject.matrixWorldNeedsUpdate=!0};Pa.prototype._getValue_unbound=function(a,b){this.bind();this.getValue(a,b)};Pa.prototype._setValue_unbound=function(a,b){this.bind();
this.setValue(a,b)};Pa.prototype.bind=function(){var a=this.node,b=this.parsedPath,c=b.objectName,d=b.propertyName,e=b.propertyIndex;if(a||(a=Pa.findNode(this.rootNode,b.nodeName)||this.rootNode,this.node=a),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!a)return void console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");if(c){var g=b.objectIndex;switch(c){case "materials":if(!a.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",
this);if(!a.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);a=a.material.materials;break;case "bones":if(!a.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);a=a.skeleton.bones;for(c=0;c<a.length;c++)if(a[c].name===g){g=c;break}break;default:if(void 0===a[c])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",
this);a=a[c]}if(void 0!==g){if(void 0===a[g])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,a);a=a[g]}}g=a[d];if(void 0===g)return void console.error("THREE.PropertyBinding: Trying to update property for track: "+b.nodeName+"."+d+" but it wasn't found.",a);b=this.Versioning.None;this.targetObject=a;void 0!==a.needsUpdate?b=this.Versioning.NeedsUpdate:void 0!==a.matrixWorldNeedsUpdate&&(b=this.Versioning.MatrixWorldNeedsUpdate);
c=this.BindingType.Direct;if(void 0!==e){if("morphTargetInfluences"===d){if(!a.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!a.geometry.isBufferGeometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences on THREE.Geometry. Use THREE.BufferGeometry instead.",this);if(!a.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",
this);void 0!==a.morphTargetDictionary[e]&&(e=a.morphTargetDictionary[e])}c=this.BindingType.ArrayElement;this.resolvedProperty=g;this.propertyIndex=e}else void 0!==g.fromArray&&void 0!==g.toArray?(c=this.BindingType.HasFromToArray,this.resolvedProperty=g):Array.isArray(g)?(c=this.BindingType.EntireArray,this.resolvedProperty=g):this.propertyName=d;this.getValue=this.GetterByBindingType[c];this.setValue=this.SetterByBindingTypeAndVersioning[c][b]};Pa.prototype.unbind=function(){this.node=null;this.getValue=
this._getValue_unbound;this.setValue=this._setValue_unbound};var Cg=function(a,b,c){c=c||Pa.parseTrackName(b);this._targetGroup=a;this._bindings=a.subscribe_(b,c)};Cg.prototype.getValue=function(a,b){this.bind();var c=this._bindings[this._targetGroup.nCachedObjects_];void 0!==c&&c.getValue(a,b)};Cg.prototype.setValue=function(a,b){for(var c=this._bindings,d=this._targetGroup.nCachedObjects_,e=c.length;d!==e;++d)c[d].setValue(a,b)};Cg.prototype.bind=function(){for(var a=this._bindings,b=this._targetGroup.nCachedObjects_,
c=a.length;b!==c;++b)a[b].bind()};Cg.prototype.unbind=function(){for(var a=this._bindings,b=this._targetGroup.nCachedObjects_,c=a.length;b!==c;++b)a[b].unbind()};Pa.Composite=Cg;Pa.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};Pa.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};Pa.prototype.GetterByBindingType=[Pa.prototype._getValue_direct,Pa.prototype._getValue_array,Pa.prototype._getValue_arrayElement,Pa.prototype._getValue_toArray];Pa.prototype.SetterByBindingTypeAndVersioning=
[[Pa.prototype._setValue_direct,Pa.prototype._setValue_direct_setNeedsUpdate,Pa.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[Pa.prototype._setValue_array,Pa.prototype._setValue_array_setNeedsUpdate,Pa.prototype._setValue_array_setMatrixWorldNeedsUpdate],[Pa.prototype._setValue_arrayElement,Pa.prototype._setValue_arrayElement_setNeedsUpdate,Pa.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[Pa.prototype._setValue_fromArray,Pa.prototype._setValue_fromArray_setNeedsUpdate,Pa.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];
var Pe=function(){this.uuid=N();this._objects=Array.prototype.slice.call(arguments);this.nCachedObjects_=0;var a={};this._indicesByUUID=a;for(var b=0,c=arguments.length;b!==c;++b)a[arguments[b].uuid]=b;this._paths=[];this._parsedPaths=[];this._bindings=[];this._bindingsIndicesByPath={};var d=this;this.stats={objects:{get total(){return d._objects.length},get inUse(){return this.total-d.nCachedObjects_}},get bindingsPerObject(){return d._bindings.length}}};Pe.prototype.add=function(){for(var a=this._objects,
b=this._indicesByUUID,c=this._paths,d=this._parsedPaths,e=this._bindings,g=e.length,h,m=a.length,n=this.nCachedObjects_,q=0,t=arguments.length;q!==t;++q){var r=arguments[q],u=r.uuid,A=b[u];if(void 0===A){A=m++;b[u]=A;a.push(r);A=0;for(var w=g;A!==w;++A)e[A].push(new Pa(r,c[A],d[A]))}else if(A<n){h=a[A];w=--n;var x=a[w];b[x.uuid]=A;a[A]=x;b[u]=w;a[w]=r;u=0;for(x=g;u!==x;++u){var C=e[u],G=C[A];C[A]=C[w];void 0===G&&(G=new Pa(r,c[u],d[u]));C[w]=G}}else a[A]!==h&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=
n};Pe.prototype.remove=function(){for(var a=this._objects,b=this._indicesByUUID,c=this._bindings,d=c.length,e=this.nCachedObjects_,g=0,h=arguments.length;g!==h;++g){var m=arguments[g],n=m.uuid,q=b[n];if(void 0!==q&&q>=e){var t=e++,r=a[t];b[r.uuid]=q;a[q]=r;b[n]=t;a[t]=m;m=0;for(n=d;m!==n;++m){r=c[m];var u=r[q];r[q]=r[t];r[t]=u}}}this.nCachedObjects_=e};Pe.prototype.uncache=function(){for(var a=this._objects,b=this._indicesByUUID,c=this._bindings,d=c.length,e=this.nCachedObjects_,g=a.length,h=0,m=
arguments.length;h!==m;++h){var n=arguments[h].uuid,q=b[n];if(void 0!==q)if(delete b[n],q<e){n=--e;var t=a[n],r=--g,u=a[r];b[t.uuid]=q;a[q]=t;b[u.uuid]=n;a[n]=u;a.pop();t=0;for(u=d;t!==u;++t){var A=c[t],w=A[r];A[q]=A[n];A[n]=w;A.pop()}}else for(n=--g,r=a[n],0<n&&(b[r.uuid]=q),a[q]=r,a.pop(),r=0,t=d;r!==t;++r)u=c[r],u[q]=u[n],u.pop()}this.nCachedObjects_=e};Pe.prototype.subscribe_=function(a,b){var c=this._bindingsIndicesByPath,d=c[a],e=this._bindings;if(void 0!==d)return e[d];var g=this._paths,h=
this._parsedPaths,m=this._objects,n=this.nCachedObjects_,q=Array(m.length);d=e.length;c[a]=d;g.push(a);h.push(b);e.push(q);c=n;for(d=m.length;c!==d;++c)q[c]=new Pa(m[c],a,b);return q};Pe.prototype.unsubscribe_=function(a){var b=this._bindingsIndicesByPath,c=b[a];if(void 0!==c){var d=this._paths,e=this._parsedPaths,g=this._bindings,h=g.length-1,m=g[h];b[a[h]]=c;g[c]=m;g.pop();e[c]=e[h];e.pop();d[c]=d[h];d.pop()}};Pe.prototype.isAnimationObjectGroup=!0;var ub=function(a,b,c,d){d=void 0===d?b.blendMode:
d;this._mixer=a;this._clip=b;this._localRoot=void 0===c?null:c;this.blendMode=d;a=b.tracks;b=a.length;c=Array(b);d={endingStart:2400,endingEnd:2400};for(var e=0;e!==b;++e){var g=a[e].createInterpolant(null);c[e]=g;g.settings=d}this._interpolantSettings=d;this._interpolants=c;this._propertyBindings=Array(b);this._weightInterpolant=this._timeScaleInterpolant=this._byClipCacheIndex=this._cacheIndex=null;this.loop=2201;this._loopCount=-1;this._startTime=null;this.time=0;this._effectiveWeight=this.weight=
this._effectiveTimeScale=this.timeScale=1;this.repetitions=1/0;this.paused=!1;this.enabled=!0;this.clampWhenFinished=!1;this.zeroSlopeAtEnd=this.zeroSlopeAtStart=!0};ub.prototype.play=function(){return this._mixer._activateAction(this),this};ub.prototype.stop=function(){return this._mixer._deactivateAction(this),this.reset()};ub.prototype.reset=function(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()};ub.prototype.isRunning=
function(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)};ub.prototype.isScheduled=function(){return this._mixer._isActiveAction(this)};ub.prototype.startAt=function(a){return this._startTime=a,this};ub.prototype.setLoop=function(a,b){return this.loop=a,this.repetitions=b,this};ub.prototype.setEffectiveWeight=function(a){return this.weight=a,this._effectiveWeight=this.enabled?a:0,this.stopFading()};ub.prototype.getEffectiveWeight=
function(){return this._effectiveWeight};ub.prototype.fadeIn=function(a){return this._scheduleFading(a,0,1)};ub.prototype.fadeOut=function(a){return this._scheduleFading(a,1,0)};ub.prototype.crossFadeFrom=function(a,b,c){if(a.fadeOut(b),this.fadeIn(b),c){c=this._clip.duration;var d=a._clip.duration,e=c/d;a.warp(1,d/c,b);this.warp(e,1,b)}return this};ub.prototype.crossFadeTo=function(a,b,c){return a.crossFadeFrom(this,b,c)};ub.prototype.stopFading=function(){var a=this._weightInterpolant;return null!==
a&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(a)),this};ub.prototype.setEffectiveTimeScale=function(a){return this.timeScale=a,this._effectiveTimeScale=this.paused?0:a,this.stopWarping()};ub.prototype.getEffectiveTimeScale=function(){return this._effectiveTimeScale};ub.prototype.setDuration=function(a){return this.timeScale=this._clip.duration/a,this.stopWarping()};ub.prototype.syncWith=function(a){return this.time=a.time,this.timeScale=a.timeScale,this.stopWarping()};ub.prototype.halt=
function(a){return this.warp(this._effectiveTimeScale,0,a)};ub.prototype.warp=function(a,b,c){var d=this._mixer,e=d.time,g=this.timeScale,h=this._timeScaleInterpolant;null===h&&(h=d._lendControlInterpolant(),this._timeScaleInterpolant=h);d=h.parameterPositions;h=h.sampleValues;return d[0]=e,d[1]=e+c,h[0]=a/g,h[1]=b/g,this};ub.prototype.stopWarping=function(){var a=this._timeScaleInterpolant;return null!==a&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(a)),this};ub.prototype.getMixer=
function(){return this._mixer};ub.prototype.getClip=function(){return this._clip};ub.prototype.getRoot=function(){return this._localRoot||this._mixer._root};ub.prototype._update=function(a,b,c,d){if(!this.enabled)return void this._updateWeight(a);var e=this._startTime;if(null!==e){b=(a-e)*c;if(0>b||0===c)return;this._startTime=null;b*=c}b*=this._updateTimeScale(a);c=this._updateTime(b);a=this._updateWeight(a);if(0<a)if(b=this._interpolants,e=this._propertyBindings,2501===this.blendMode){d=0;for(var g=
b.length;d!==g;++d)b[d].evaluate(c),e[d].accumulateAdditive(a)}else{g=0;for(var h=b.length;g!==h;++g)b[g].evaluate(c),e[g].accumulate(d,a)}};ub.prototype._updateWeight=function(a){var b=0;if(this.enabled){b=this.weight;var c=this._weightInterpolant;if(null!==c){var d=c.evaluate(a)[0];b*=d;a>c.parameterPositions[1]&&(this.stopFading(),0===d&&(this.enabled=!1))}}return this._effectiveWeight=b,b};ub.prototype._updateTimeScale=function(a){var b=0;if(!this.paused){b=this.timeScale;var c=this._timeScaleInterpolant;
null!==c&&(b*=c.evaluate(a)[0],a>c.parameterPositions[1]&&(this.stopWarping(),0===b?this.paused=!0:this.timeScale=b))}return this._effectiveTimeScale=b,b};ub.prototype._updateTime=function(a){var b=this._clip.duration,c=this.loop,d=this.time+a,e=this._loopCount,g=2202===c;if(0===a)return-1===e?d:g&&1==(1&e)?b-d:d;if(2200===c)a:{if(-1===e&&(this._loopCount=0,this._setEndings(!0,!0,!1)),d>=b)d=b;else{if(!(0>d)){this.time=d;break a}d=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1;this.time=
d;this._mixer.dispatchEvent({type:"finished",action:this,direction:0>a?-1:1})}else{if(-1===e&&(0<=a?(e=0,this._setEndings(!0,0===this.repetitions,g)):this._setEndings(0===this.repetitions,!0,g)),d>=b||0>d){c=Math.floor(d/b);d-=b*c;e+=Math.abs(c);var h=this.repetitions-e;0>=h?(this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=d=0<a?b:0,this._mixer.dispatchEvent({type:"finished",action:this,direction:0<a?1:-1})):(1===h?(a=0>a,this._setEndings(a,!a,g)):this._setEndings(!1,!1,g),this._loopCount=
e,this.time=d,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:c}))}else this.time=d;if(g&&1==(1&e))return b-d}return d};ub.prototype._setEndings=function(a,b,c){var d=this._interpolantSettings;c?(d.endingStart=2401,d.endingEnd=2401):(d.endingStart=a?this.zeroSlopeAtStart?2401:2400:2402,d.endingEnd=b?this.zeroSlopeAtEnd?2401:2400:2402)};ub.prototype._scheduleFading=function(a,b,c){var d=this._mixer,e=d.time,g=this._weightInterpolant;null===g&&(g=d._lendControlInterpolant(),this._weightInterpolant=
g);d=g.parameterPositions;g=g.sampleValues;return d[0]=e,g[0]=b,d[1]=e+a,g[1]=c,this};var Cb=function(a){this._root=a;this._initMemoryManager();this.time=this._accuIndex=0;this.timeScale=1;return this};$jscomp.inherits(Cb,Jc);Cb.prototype._bindAction=function(a,b){var c=a._localRoot||this._root,d=a._clip.tracks,e=d.length,g=a._propertyBindings;a=a._interpolants;var h=c.uuid,m=this._bindingsByRootAndName,n=m[h];void 0===n&&(n={},m[h]=n);for(m=0;m!==e;++m){var q=d[m],t=q.name,r=n[t];if(void 0===r){if(r=
g[m],void 0!==r){null===r._cacheIndex&&(++r.referenceCount,this._addInactiveBinding(r,h,t));continue}r=new vc(Pa.create(c,t,b&&b._propertyBindings[m].binding.parsedPath),q.ValueTypeName,q.getValueSize());++r.referenceCount;this._addInactiveBinding(r,h,t)}g[m]=r;a[m].resultBuffer=r.buffer}};Cb.prototype._activateAction=function(a){if(!this._isActiveAction(a)){if(null===a._cacheIndex){var b=(a._localRoot||this._root).uuid,c=a._clip.uuid,d=this._actionsByClip[c];this._bindAction(a,d&&d.knownActions[0]);
this._addInactiveAction(a,c,b)}b=a._propertyBindings;c=0;for(d=b.length;c!==d;++c){var e=b[c];0==e.useCount++&&(this._lendBinding(e),e.saveOriginalState())}this._lendAction(a)}};Cb.prototype._deactivateAction=function(a){if(this._isActiveAction(a)){for(var b=a._propertyBindings,c=0,d=b.length;c!==d;++c){var e=b[c];0==--e.useCount&&(e.restoreOriginalState(),this._takeBackBinding(e))}this._takeBackAction(a)}};Cb.prototype._initMemoryManager=function(){this._actions=[];this._nActiveActions=0;this._actionsByClip=
{};this._bindings=[];this._nActiveBindings=0;this._bindingsByRootAndName={};this._controlInterpolants=[];this._nActiveControlInterpolants=0;var a=this;this.stats={actions:{get total(){return a._actions.length},get inUse(){return a._nActiveActions}},bindings:{get total(){return a._bindings.length},get inUse(){return a._nActiveBindings}},controlInterpolants:{get total(){return a._controlInterpolants.length},get inUse(){return a._nActiveControlInterpolants}}}};Cb.prototype._isActiveAction=function(a){a=
a._cacheIndex;return null!==a&&a<this._nActiveActions};Cb.prototype._addInactiveAction=function(a,b,c){var d=this._actions,e=this._actionsByClip,g=e[b];void 0===g?(g={knownActions:[a],actionByRoot:{}},a._byClipCacheIndex=0,e[b]=g):(b=g.knownActions,a._byClipCacheIndex=b.length,b.push(a));a._cacheIndex=d.length;d.push(a);g.actionByRoot[c]=a};Cb.prototype._removeInactiveAction=function(a){var b=this._actions,c=b[b.length-1],d=a._cacheIndex;c._cacheIndex=d;b[d]=c;b.pop();a._cacheIndex=null;b=a._clip.uuid;
c=this._actionsByClip;d=c[b];var e=d.knownActions,g=e[e.length-1],h=a._byClipCacheIndex;g._byClipCacheIndex=h;e[h]=g;e.pop();a._byClipCacheIndex=null;delete d.actionByRoot[(a._localRoot||this._root).uuid];0===e.length&&delete c[b];this._removeInactiveBindingsForAction(a)};Cb.prototype._removeInactiveBindingsForAction=function(a){a=a._propertyBindings;for(var b=0,c=a.length;b!==c;++b){var d=a[b];0==--d.referenceCount&&this._removeInactiveBinding(d)}};Cb.prototype._lendAction=function(a){var b=this._actions,
c=a._cacheIndex,d=this._nActiveActions++,e=b[d];a._cacheIndex=d;b[d]=a;e._cacheIndex=c;b[c]=e};Cb.prototype._takeBackAction=function(a){var b=this._actions,c=a._cacheIndex,d=--this._nActiveActions,e=b[d];a._cacheIndex=d;b[d]=a;e._cacheIndex=c;b[c]=e};Cb.prototype._addInactiveBinding=function(a,b,c){var d=this._bindingsByRootAndName,e=this._bindings,g=d[b];void 0===g&&(g={},d[b]=g);g[c]=a;a._cacheIndex=e.length;e.push(a)};Cb.prototype._removeInactiveBinding=function(a){var b=this._bindings,c=a.binding,
d=c.rootNode.uuid;c=c.path;var e=this._bindingsByRootAndName,g=e[d],h=b[b.length-1];a=a._cacheIndex;h._cacheIndex=a;b[a]=h;b.pop();delete g[c];0===Object.keys(g).length&&delete e[d]};Cb.prototype._lendBinding=function(a){var b=this._bindings,c=a._cacheIndex,d=this._nActiveBindings++,e=b[d];a._cacheIndex=d;b[d]=a;e._cacheIndex=c;b[c]=e};Cb.prototype._takeBackBinding=function(a){var b=this._bindings,c=a._cacheIndex,d=--this._nActiveBindings,e=b[d];a._cacheIndex=d;b[d]=a;e._cacheIndex=c;b[c]=e};Cb.prototype._lendControlInterpolant=
function(){var a=this._controlInterpolants,b=this._nActiveControlInterpolants++,c=a[b];return void 0===c&&(c=new wg(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer),c.__cacheIndex=b,a[b]=c),c};Cb.prototype._takeBackControlInterpolant=function(a){var b=this._controlInterpolants,c=a.__cacheIndex,d=--this._nActiveControlInterpolants,e=b[d];a.__cacheIndex=d;b[d]=a;e.__cacheIndex=c;b[c]=e};Cb.prototype.clipAction=function(a,b,c){var d=b||this._root,e=d.uuid;d="string"==
typeof a?ic.findByName(d,a):a;a=null!==d?d.uuid:a;var g=this._actionsByClip[a],h=null;if(void 0===c&&(c=null!==d?d.blendMode:2500),void 0!==g){h=g.actionByRoot[e];if(void 0!==h&&h.blendMode===c)return h;h=g.knownActions[0];null===d&&(d=h._clip)}if(null===d)return null;b=new ub(this,d,b,c);return this._bindAction(b,h),this._addInactiveAction(b,a,e),b};Cb.prototype.existingAction=function(a,b){var c=b||this._root;b=c.uuid;c="string"==typeof a?ic.findByName(c,a):a;a=this._actionsByClip[c?c.uuid:a];return void 0!==
a&&a.actionByRoot[b]||null};Cb.prototype.stopAllAction=function(){for(var a=this._actions,b=this._nActiveActions-1;0<=b;--b)a[b].stop();return this};Cb.prototype.update=function(a){a*=this.timeScale;for(var b=this._actions,c=this._nActiveActions,d=this.time+=a,e=Math.sign(a),g=this._accuIndex^=1,h=0;h!==c;++h)b[h]._update(d,a,e,g);a=this._bindings;b=this._nActiveBindings;for(c=0;c!==b;++c)a[c].apply(g);return this};Cb.prototype.setTime=function(a){for(var b=this.time=0;b<this._actions.length;b++)this._actions[b].time=
0;return this.update(a)};Cb.prototype.getRoot=function(){return this._root};Cb.prototype.uncacheClip=function(a){var b=this._actions;a=a.uuid;var c=this._actionsByClip,d=c[a];if(void 0!==d){d=d.knownActions;for(var e=0,g=d.length;e!==g;++e){var h=d[e];this._deactivateAction(h);var m=h._cacheIndex,n=b[b.length-1];h._cacheIndex=null;h._byClipCacheIndex=null;n._cacheIndex=m;b[m]=n;b.pop();this._removeInactiveBindingsForAction(h)}delete c[a]}};Cb.prototype.uncacheRoot=function(a){a=a.uuid;var b=this._actionsByClip;
for(d in b){var c=b[d].actionByRoot[a];void 0!==c&&(this._deactivateAction(c),this._removeInactiveAction(c))}var d=this._bindingsByRootAndName[a];if(void 0!==d)for(var e in d)a=d[e],a.restoreOriginalState(),this._removeInactiveBinding(a)};Cb.prototype.uncacheAction=function(a,b){a=this.existingAction(a,b);null!==a&&(this._deactivateAction(a),this._removeInactiveAction(a))};Cb.prototype._controlInterpolantsResultBuffer=new Float32Array(1);var Nh=function(a,b){"string"==typeof a&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),
a=b);this.value=a};Nh.prototype.clone=function(){return new Nh(void 0===this.value.clone?this.value:this.value.clone())};var zf=function(a,b,c){c=void 0===c?1:c;a=Xb.call(this,a,b)||this;a.meshPerAttribute=c;return a};$jscomp.inherits(zf,Xb);zf.prototype.copy=function(a){return Xb.prototype.copy.call(this,a),this.meshPerAttribute=a.meshPerAttribute,this};zf.prototype.clone=function(a){a=Xb.prototype.clone.call(this,a);return a.meshPerAttribute=this.meshPerAttribute,a};zf.prototype.toJSON=function(a){a=
Xb.prototype.toJSON.call(this,a);return a.isInstancedInterleavedBuffer=!0,a.meshPerAttribute=this.meshPerAttribute,a};zf.prototype.isInstancedInterleavedBuffer=!0;var Qe=function(a,b,c,d,e){this.buffer=a;this.type=b;this.itemSize=c;this.elementSize=d;this.count=e;this.version=0};Qe.prototype.setBuffer=function(a){return this.buffer=a,this};Qe.prototype.setType=function(a,b){return this.type=a,this.elementSize=b,this};Qe.prototype.setItemSize=function(a){return this.itemSize=a,this};Qe.prototype.setCount=
function(a){return this.count=a,this};$jscomp.global.Object.defineProperties(Qe.prototype,{needsUpdate:{configurable:!0,enumerable:!0,set:function(a){!0===a&&this.version++}}});Qe.prototype.isGLBufferAttribute=!0;var Xk=new T,Db=function(a,b){a=void 0===a?new T(1/0,1/0):a;b=void 0===b?new T(-1/0,-1/0):b;this.min=a;this.max=b};Db.prototype.set=function(a,b){return this.min.copy(a),this.max.copy(b),this};Db.prototype.setFromPoints=function(a){this.makeEmpty();for(var b=0,c=a.length;b<c;b++)this.expandByPoint(a[b]);
return this};Db.prototype.setFromCenterAndSize=function(a,b){b=Xk.copy(b).multiplyScalar(.5);return this.min.copy(a).sub(b),this.max.copy(a).add(b),this};Db.prototype.clone=function(){return(new this.constructor).copy(this)};Db.prototype.copy=function(a){return this.min.copy(a.min),this.max.copy(a.max),this};Db.prototype.makeEmpty=function(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this};Db.prototype.isEmpty=function(){return this.max.x<this.min.x||this.max.y<this.min.y};Db.prototype.getCenter=
function(a){return this.isEmpty()?a.set(0,0):a.addVectors(this.min,this.max).multiplyScalar(.5)};Db.prototype.getSize=function(a){return this.isEmpty()?a.set(0,0):a.subVectors(this.max,this.min)};Db.prototype.expandByPoint=function(a){return this.min.min(a),this.max.max(a),this};Db.prototype.expandByVector=function(a){return this.min.sub(a),this.max.add(a),this};Db.prototype.expandByScalar=function(a){return this.min.addScalar(-a),this.max.addScalar(a),this};Db.prototype.containsPoint=function(a){return!(a.x<
this.min.x||a.x>this.max.x||a.y<this.min.y||a.y>this.max.y)};Db.prototype.containsBox=function(a){return this.min.x<=a.min.x&&a.max.x<=this.max.x&&this.min.y<=a.min.y&&a.max.y<=this.max.y};Db.prototype.getParameter=function(a,b){return b.set((a.x-this.min.x)/(this.max.x-this.min.x),(a.y-this.min.y)/(this.max.y-this.min.y))};Db.prototype.intersectsBox=function(a){return!(a.max.x<this.min.x||a.min.x>this.max.x||a.max.y<this.min.y||a.min.y>this.max.y)};Db.prototype.clampPoint=function(a,b){return b.copy(a).clamp(this.min,
this.max)};Db.prototype.distanceToPoint=function(a){return Xk.copy(a).clamp(this.min,this.max).sub(a).length()};Db.prototype.intersect=function(a){return this.min.max(a.min),this.max.min(a.max),this};Db.prototype.union=function(a){return this.min.min(a.min),this.max.max(a.max),this};Db.prototype.translate=function(a){return this.min.add(a),this.max.add(a),this};Db.prototype.equals=function(a){return a.min.equals(this.min)&&a.max.equals(this.max)};Db.prototype.isBox2=!0;var Yk=new B,Oh=new B,Ac=function(a,
b){a=void 0===a?new B:a;b=void 0===b?new B:b;this.start=a;this.end=b};Ac.prototype.set=function(a,b){return this.start.copy(a),this.end.copy(b),this};Ac.prototype.copy=function(a){return this.start.copy(a.start),this.end.copy(a.end),this};Ac.prototype.getCenter=function(a){return a.addVectors(this.start,this.end).multiplyScalar(.5)};Ac.prototype.delta=function(a){return a.subVectors(this.end,this.start)};Ac.prototype.distanceSq=function(){return this.start.distanceToSquared(this.end)};Ac.prototype.distance=
function(){return this.start.distanceTo(this.end)};Ac.prototype.at=function(a,b){return this.delta(b).multiplyScalar(a).add(this.start)};Ac.prototype.closestPointToPointParameter=function(a,b){Yk.subVectors(a,this.start);Oh.subVectors(this.end,this.start);a=Oh.dot(Oh);a=Oh.dot(Yk)/a;return b&&(a=R(a,0,1)),a};Ac.prototype.closestPointToPoint=function(a,b,c){a=this.closestPointToPointParameter(a,b);return this.delta(c).multiplyScalar(a).add(this.start)};Ac.prototype.applyMatrix4=function(a){return this.start.applyMatrix4(a),
this.end.applyMatrix4(a),this};Ac.prototype.equals=function(a){return a.start.equals(this.start)&&a.end.equals(this.end)};Ac.prototype.clone=function(){return(new this.constructor).copy(this)};var Zk=new B,ee=new B,Ph=new ua,ij=new ua,Qh=function(a){var b=ck(a);var c=new ra;for(var d=[],e=[],g=new ma(0,0,1),h=new ma(0,1,0),m=0;m<b.length;m++){var n=b[m];n.parent&&n.parent.isBone&&(d.push(0,0,0),d.push(0,0,0),e.push(g.r,g.g,g.b),e.push(h.r,h.g,h.b))}c.setAttribute("position",new Ma(d,3));c.setAttribute("color",
new Ma(e,3));c=Ib.call(this,c,new Pb({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0}))||this;c.type="SkeletonHelper";c.isSkeletonHelper=!0;c.root=a;c.bones=b;c.matrix=a.matrixWorld;c.matrixAutoUpdate=!1;return c};$jscomp.inherits(Qh,Ib);Qh.prototype.updateMatrixWorld=function(a){var b=this.bones,c=this.geometry,d=c.getAttribute("position");ij.copy(this.root.matrixWorld).invert();for(var e=0,g=0;e<b.length;e++){var h=b[e];h.parent&&h.parent.isBone&&(Ph.multiplyMatrices(ij,
h.matrixWorld),ee.setFromMatrixPosition(Ph),d.setXYZ(g,ee.x,ee.y,ee.z),Ph.multiplyMatrices(ij,h.parent.matrixWorld),ee.setFromMatrixPosition(Ph),d.setXYZ(g+1,ee.x,ee.y,ee.z),g+=2)}c.getAttribute("position").needsUpdate=!0;Ib.prototype.updateMatrixWorld.call(this,a)};var nm=new B,$k=new ma,al=new ma,jj=function(a,b,c,d){a=void 0===a?10:a;b=void 0===b?10:b;d=void 0===d?8947848:d;c=new ma(void 0===c?4473924:c);d=new ma(d);var e=b/2,g=a/b,h=a/2;a=[];for(var m=[],n=0,q=0,t=-h;n<=b;n++,t+=g){a.push(-h,
0,t,h,0,t);a.push(t,0,-h,t,0,h);var r=n===e?c:d;r.toArray(m,q);q+=3;r.toArray(m,q);q+=3;r.toArray(m,q);q+=3;r.toArray(m,q);q+=3}b=new ra;b.setAttribute("position",new Ma(a,3));b.setAttribute("color",new Ma(m,3));b=Ib.call(this,b,new Pb({vertexColors:!0,toneMapped:!1}))||this;b.type="GridHelper";return b};$jscomp.inherits(jj,Ib);var bl=new B,Rh=new B,cl=new B,bh=new B,Qb=new hc,Sh=new ab,Af=function(a,b){b=void 0===b?16776960:b;var c=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),
d=new Float32Array(24),e=new ra;e.setIndex(new Ba(c,1));e.setAttribute("position",new Ba(d,3));b=Ib.call(this,e,new Pb({color:b,toneMapped:!1}))||this;b.object=a;b.type="BoxHelper";b.matrixAutoUpdate=!1;b.update();return b};$jscomp.inherits(Af,Ib);Af.prototype.update=function(a){if(void 0!==a&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),void 0!==this.object&&Sh.setFromObject(this.object),!Sh.isEmpty()){a=Sh.min;var b=Sh.max,c=this.geometry.attributes.position,d=c.array;d[0]=
b.x;d[1]=b.y;d[2]=b.z;d[3]=a.x;d[4]=b.y;d[5]=b.z;d[6]=a.x;d[7]=a.y;d[8]=b.z;d[9]=b.x;d[10]=a.y;d[11]=b.z;d[12]=b.x;d[13]=b.y;d[14]=a.z;d[15]=a.x;d[16]=b.y;d[17]=a.z;d[18]=a.x;d[19]=a.y;d[20]=a.z;d[21]=b.x;d[22]=a.y;d[23]=a.z;c.needsUpdate=!0;this.geometry.computeBoundingSphere()}};Af.prototype.setFromObject=function(a){return this.object=a,this.update(),this};Af.prototype.copy=function(a){return Ib.prototype.copy.call(this,a),this.object=a.object,this};var dl=new B,Th,kj,Dg=function(a){a=void 0===
a?1:a;a=[0,0,0,a,0,0,0,0,0,0,a,0,0,0,0,0,0,a];var b=new ra;b.setAttribute("position",new Ma(a,3));b.setAttribute("color",new Ma([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3));a=Ib.call(this,b,new Pb({vertexColors:!0,toneMapped:!1}))||this;a.type="AxesHelper";return a};$jscomp.inherits(Dg,Ib);Dg.prototype.setColors=function(a,b,c){var d=new ma,e=this.geometry.attributes.color.array;return d.set(a),d.toArray(e,0),d.toArray(e,3),d.set(b),d.toArray(e,6),d.toArray(e,9),d.set(c),d.toArray(e,12),d.toArray(e,
15),this.geometry.attributes.color.needsUpdate=!0,this};Dg.prototype.dispose=function(){this.geometry.dispose();this.material.dispose()};var el=new Float32Array(1),om=new Int32Array(el.buffer);Ga.create=function(a,b){return console.log("THREE.Curve.create() has been deprecated"),a.prototype=Object.create(Ga.prototype),a.prototype.constructor=a,a.prototype.getPoint=b,a};Ob.prototype.fromPoints=function(a){return console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(a)};
jj.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")};Qh.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")};lb.prototype.extractUrlBase=function(a){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),Je.extractUrlBase(a)};lb.Handlers={add:function(){console.error("THREE.Loader: Handlers.add() has been removed. Use LoadingManager.addHandler() instead.")},
get:function(){console.error("THREE.Loader: Handlers.get() has been removed. Use LoadingManager.getHandler() instead.")}};Db.prototype.center=function(a){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(a)};Db.prototype.empty=function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()};Db.prototype.isIntersectionBox=function(a){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),
this.intersectsBox(a)};Db.prototype.size=function(a){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(a)};ab.prototype.center=function(a){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(a)};ab.prototype.empty=function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()};ab.prototype.isIntersectionBox=function(a){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),
this.intersectsBox(a)};ab.prototype.isIntersectionSphere=function(a){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(a)};ab.prototype.size=function(a){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(a)};Fb.prototype.empty=function(){return console.warn("THREE.Sphere: .empty() has been renamed to .isEmpty()."),this.isEmpty()};wc.prototype.setFromMatrix=function(a){return console.warn("THREE.Frustum: .setFromMatrix() has been renamed to .setFromProjectionMatrix()."),
this.setFromProjectionMatrix(a)};Ac.prototype.center=function(a){return console.warn("THREE.Line3: .center() has been renamed to .getCenter()."),this.getCenter(a)};fb.prototype.flattenToArrayOffset=function(a,b){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(a,b)};fb.prototype.multiplyVector3=function(a){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),a.applyMatrix3(this)};
fb.prototype.multiplyVector3Array=function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")};fb.prototype.applyToBufferAttribute=function(a){return console.warn("THREE.Matrix3: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix3( matrix ) instead."),a.applyMatrix3(this)};fb.prototype.applyToVector3Array=function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")};fb.prototype.getInverse=function(a){return console.warn("THREE.Matrix3: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),
this.copy(a).invert()};ua.prototype.extractPosition=function(a){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(a)};ua.prototype.flattenToArrayOffset=function(a,b){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(a,b)};ua.prototype.getPosition=function(){return console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),
(new B).setFromMatrixColumn(this,3)};ua.prototype.setRotationFromQuaternion=function(a){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(a)};ua.prototype.multiplyToArray=function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")};ua.prototype.multiplyVector3=function(a){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),
a.applyMatrix4(this)};ua.prototype.multiplyVector4=function(a){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),a.applyMatrix4(this)};ua.prototype.multiplyVector3Array=function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")};ua.prototype.rotateAxis=function(a){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead.");a.transformDirection(this)};ua.prototype.crossVector=
function(a){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),a.applyMatrix4(this)};ua.prototype.translate=function(){console.error("THREE.Matrix4: .translate() has been removed.")};ua.prototype.rotateX=function(){console.error("THREE.Matrix4: .rotateX() has been removed.")};ua.prototype.rotateY=function(){console.error("THREE.Matrix4: .rotateY() has been removed.")};ua.prototype.rotateZ=function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")};
ua.prototype.rotateByAxis=function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")};ua.prototype.applyToBufferAttribute=function(a){return console.warn("THREE.Matrix4: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix4( matrix ) instead."),a.applyMatrix4(this)};ua.prototype.applyToVector3Array=function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")};ua.prototype.makeFrustum=function(a,b,c,d,e,g){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),
this.makePerspective(a,b,d,c,e,g)};ua.prototype.getInverse=function(a){return console.warn("THREE.Matrix4: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(a).invert()};zb.prototype.isIntersectionLine=function(a){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(a)};Sa.prototype.multiplyVector3=function(a){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),
a.applyQuaternion(this)};Sa.prototype.inverse=function(){return console.warn("THREE.Quaternion: .inverse() has been renamed to invert()."),this.invert()};Bb.prototype.isIntersectionBox=function(a){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(a)};Bb.prototype.isIntersectionPlane=function(a){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(a)};Bb.prototype.isIntersectionSphere=
function(a){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(a)};eb.prototype.area=function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()};eb.prototype.barycoordFromPoint=function(a,b){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord(a,b)};eb.prototype.midpoint=function(a){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),
this.getMidpoint(a)};eb.prototypenormal=function(a){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal(a)};eb.prototype.plane=function(a){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane(a)};eb.barycoordFromPoint=function(a,b,c,d,e){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),eb.getBarycoord(a,b,c,d,e)};eb.normal=function(a,b,c,d){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),
eb.getNormal(a,b,c,d)};pc.prototype.extractAllPoints=function(a){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(a)};pc.prototype.extrude=function(a){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new Oc(this,a)};pc.prototype.makeGeometry=function(a){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new Bd(this,a)};T.prototype.fromAttribute=
function(a,b,c){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(a,b,c)};T.prototype.distanceToManhattan=function(a){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(a)};T.prototype.lengthManhattan=function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()};B.prototype.setEulerFromRotationMatrix=
function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")};B.prototype.setEulerFromQuaternion=function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")};B.prototype.getPositionFromMatrix=function(a){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(a)};B.prototype.getScaleFromMatrix=
function(a){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(a)};B.prototype.getColumnFromMatrix=function(a,b){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(b,a)};B.prototype.applyProjection=function(a){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(a)};B.prototype.fromAttribute=
function(a,b,c){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(a,b,c)};B.prototype.distanceToManhattan=function(a){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(a)};B.prototype.lengthManhattan=function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()};za.prototype.fromAttribute=
function(a,b,c){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(a,b,c)};za.prototype.lengthManhattan=function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()};la.prototype.getChildByName=function(a){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(a)};la.prototype.renderDepth=function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")};
la.prototype.translate=function(a,b){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(b,a)};la.prototype.getWorldRotation=function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")};la.prototype.applyMatrix=function(a){return console.warn("THREE.Object3D: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(a)};
Object.defineProperties(la.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(a){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order.");this.rotation.order=a}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}});
vb.prototype.setDrawMode=function(){console.error("THREE.Mesh: .setDrawMode() has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")};Object.defineProperties(vb.prototype,{drawMode:{get:function(){return console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode."),0},set:function(){console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}});
Xc.prototype.initBones=function(){console.error("THREE.SkinnedMesh: initBones() has been removed.")};xb.prototype.setLens=function(a,b){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup.");void 0!==b&&(this.filmGauge=b);this.setFocalLength(a)};Object.defineProperties(Ab.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(a){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov.");
this.shadow.camera.fov=a}},shadowCameraLeft:{set:function(a){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left.");this.shadow.camera.left=a}},shadowCameraRight:{set:function(a){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right.");this.shadow.camera.right=a}},shadowCameraTop:{set:function(a){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top.");this.shadow.camera.top=a}},shadowCameraBottom:{set:function(a){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom.");
this.shadow.camera.bottom=a}},shadowCameraNear:{set:function(a){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near.");this.shadow.camera.near=a}},shadowCameraFar:{set:function(a){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far.");this.shadow.camera.far=a}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(a){console.warn("THREE.Light: .shadowBias is now .shadow.bias.");
this.shadow.bias=a}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(a){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width.");this.shadow.mapSize.width=a}},shadowMapHeight:{set:function(a){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height.");this.shadow.mapSize.height=a}}});Object.defineProperties(Ba.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),
this.array.length}},dynamic:{get:function(){return console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),35048===this.usage},set:function(){console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead.");this.setUsage(35048)}}});Ba.prototype.setDynamic=function(a){return console.warn("THREE.BufferAttribute: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===a?35048:35044),this};Ba.prototype.copyIndicesArray=
function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")};Ba.prototype.setArray=function(){console.error("THREE.BufferAttribute: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")};ra.prototype.addIndex=function(a){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex().");this.setIndex(a)};ra.prototype.addAttribute=function(a,b,c){return console.warn("THREE.BufferGeometry: .addAttribute() has been renamed to .setAttribute()."),
b&&b.isBufferAttribute||b&&b.isInterleavedBufferAttribute?"index"===a?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(b),this):this.setAttribute(a,b):(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.setAttribute(a,new Ba(b,c)))};ra.prototype.addDrawCall=function(a,b,c){void 0!==c&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset.");console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup().");
this.addGroup(a,b)};ra.prototype.clearDrawCalls=function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups().");this.clearGroups()};ra.prototype.computeOffsets=function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")};ra.prototype.removeAttribute=function(a){return console.warn("THREE.BufferGeometry: .removeAttribute() has been renamed to .deleteAttribute()."),this.deleteAttribute(a)};ra.prototype.applyMatrix=function(a){return console.warn("THREE.BufferGeometry: .applyMatrix() has been renamed to .applyMatrix4()."),
this.applyMatrix4(a)};Object.defineProperties(ra.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}});Xb.prototype.setDynamic=function(a){return console.warn("THREE.InterleavedBuffer: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===a?35048:35044),this};Xb.prototype.setArray=
function(){console.error("THREE.InterleavedBuffer: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")};Oc.prototype.getArrays=function(){console.error("THREE.ExtrudeGeometry: .getArrays() has been removed.")};Oc.prototype.addShapeList=function(){console.error("THREE.ExtrudeGeometry: .addShapeList() has been removed.")};Oc.prototype.addShape=function(){console.error("THREE.ExtrudeGeometry: .addShape() has been removed.")};te.prototype.dispose=function(){console.error("THREE.Scene: .dispose() has been removed.")};
Nh.prototype.onUpdate=function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this};Object.defineProperties(Oa.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},overdraw:{get:function(){console.warn("THREE.Material: .overdraw has been removed.")},set:function(){console.warn("THREE.Material: .overdraw has been removed.")}},
wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new ma}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(a){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.");this.flatShading=1===a}},stencilMask:{get:function(){return console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),
this.stencilFuncMask},set:function(a){console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead.");this.stencilFuncMask=a}},vertexTangents:{get:function(){console.warn("THREE."+this.type+": .vertexTangents has been removed.")},set:function(){console.warn("THREE."+this.type+": .vertexTangents has been removed.")}}});Object.defineProperties(Bc.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),
this.extensions.derivatives},set:function(a){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives.");this.extensions.derivatives=a}}});wb.prototype.clearTarget=function(a,b,c,d){console.warn("THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead.");this.setRenderTarget(a);this.clear(b,c,d)};wb.prototype.animate=function(a){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop().");this.setAnimationLoop(a)};
wb.prototype.getCurrentRenderTarget=function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()};wb.prototype.getMaxAnisotropy=function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()};wb.prototype.getPrecision=function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision};
wb.prototype.resetGLState=function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()};wb.prototype.supportsFloatTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")};wb.prototype.supportsHalfFloatTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),
this.extensions.get("OES_texture_half_float")};wb.prototype.supportsStandardDerivatives=function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")};wb.prototype.supportsCompressedTextureS3TC=function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")};
wb.prototype.supportsCompressedTexturePVRTC=function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")};wb.prototype.supportsBlendMinMax=function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")};wb.prototype.supportsVertexTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),
this.capabilities.vertexTextures};wb.prototype.supportsInstancedArrays=function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")};wb.prototype.enableScissorTest=function(a){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest().");this.setScissorTest(a)};wb.prototype.initMaterial=function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")};
wb.prototype.addPrePlugin=function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")};wb.prototype.addPostPlugin=function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")};wb.prototype.updateShadowMap=function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")};wb.prototype.setFaceCulling=function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")};wb.prototype.allocTextureUnit=function(){console.warn("THREE.WebGLRenderer: .allocTextureUnit() has been removed.")};
wb.prototype.setTexture=function(){console.warn("THREE.WebGLRenderer: .setTexture() has been removed.")};wb.prototype.setTexture2D=function(){console.warn("THREE.WebGLRenderer: .setTexture2D() has been removed.")};wb.prototype.setTextureCube=function(){console.warn("THREE.WebGLRenderer: .setTextureCube() has been removed.")};wb.prototype.getActiveMipMapLevel=function(){return console.warn("THREE.WebGLRenderer: .getActiveMipMapLevel() is now .getActiveMipmapLevel()."),this.getActiveMipmapLevel()};
Object.defineProperties(wb.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(a){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled.");this.shadowMap.enabled=a}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(a){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type.");this.shadowMap.type=a}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},
set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}},context:{get:function(){return console.warn("THREE.WebGLRenderer: .context has been removed. Use .getContext() instead."),this.getContext()}},vr:{get:function(){return console.warn("THREE.WebGLRenderer: .vr has been renamed to .xr"),this.xr}},gammaInput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead."),
!1},set:function(){console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead.")}},gammaOutput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),!1},set:function(a){console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead.");this.outputEncoding=!0===a?3001:3E3}},toneMappingWhitePoint:{get:function(){return console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed."),
1},set:function(){console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed.")}}});Object.defineProperties(Kj.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},
set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}});Object.defineProperties(Rb.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),
this.texture.wrapS},set:function(a){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS.");this.texture.wrapS=a}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(a){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT.");this.texture.wrapT=a}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(a){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter.");
this.texture.magFilter=a}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(a){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter.");this.texture.minFilter=a}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(a){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy.");
this.texture.anisotropy=a}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(a){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset.");this.texture.offset=a}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(a){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat.");this.texture.repeat=a}},
format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(a){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format.");this.texture.format=a}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(a){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type.");this.texture.type=a}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),
this.texture.generateMipmaps},set:function(a){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps.");this.texture.generateMipmaps=a}}});tb.prototype.load=function(a){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");var b=this;return(new Lh).load(a,function(c){b.setBuffer(c)}),this};Mh.prototype.getData=function(){return console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData()."),this.getFrequencyData()};mf.prototype.updateCubeMap=
function(a,b){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(a,b)};mf.prototype.clear=function(a,b,c,d){return console.warn("THREE.CubeCamera: .clear() is now .renderTarget.clear()."),this.renderTarget.clear(a,b,c,d)};Ed.crossOrigin=void 0;Ed.loadTexture=function(a,b,c,d){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");var e=new Hh;e.setCrossOrigin(this.crossOrigin);a=e.load(a,c,void 0,d);return b&&(a.mapping=
b),a};Ed.loadTextureCube=function(a,b,c,d){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");var e=new Fh;e.setCrossOrigin(this.crossOrigin);a=e.load(a,c,void 0,d);return b&&(a.mapping=b),a};Ed.loadCompressedTexture=function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")};Ed.loadCompressedTextureCube=function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")};
"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:"134"}}));"undefined"!=typeof window&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__="134");p.ACESFilmicToneMapping=4;p.AddEquation=100;p.AddOperation=2;p.AdditiveAnimationBlendMode=2501;p.AdditiveBlending=2;p.AlphaFormat=1021;p.AlwaysDepth=1;p.AlwaysStencilFunc=519;p.AmbientLight=Jh;p.AmbientLightProbe=hj;p.AnimationClip=
ic;var Uh=function(a){return lb.call(this,a)||this};$jscomp.inherits(Uh,lb);Uh.prototype.load=function(a,b,c,d){var e=this,g=new zc(this.manager);g.setPath(this.path);g.setRequestHeader(this.requestHeader);g.setWithCredentials(this.withCredentials);g.load(a,function(h){try{b(e.parse(JSON.parse(h)))}catch(m){d?d(m):console.error(m),e.manager.itemError(a)}},c,d)};Uh.prototype.parse=function(a){for(var b=[],c=0;c<a.length;c++){var d=ic.parse(a[c]);b.push(d)}return b};p.AnimationLoader=Uh;p.AnimationMixer=
Cb;p.AnimationObjectGroup=Pe;p.AnimationUtils=Hb;p.ArcCurve=Ah;p.ArrayCamera=oh;var Bf=function(a,b,c,d,e,g){a=void 0===a?new B(0,0,1):a;b=void 0===b?new B(0,0,0):b;c=void 0===c?1:c;d=void 0===d?16776960:d;e=void 0===e?.2*c:e;g=void 0===g?.2*e:g;var h=la.call(this)||this;h.type="ArrowHelper";void 0===Th&&(Th=new ra,Th.setAttribute("position",new Ma([0,0,0,0,1,0],3)),kj=new id(0,.5,1,5,1),kj.translate(0,-.5,0));h.position.copy(b);h.line=new dc(Th,new Pb({color:d,toneMapped:!1}));h.line.matrixAutoUpdate=
!1;h.add(h.line);h.cone=new vb(kj,new Vc({color:d,toneMapped:!1}));h.cone.matrixAutoUpdate=!1;h.add(h.cone);h.setDirection(a);h.setLength(c,e,g);return h};$jscomp.inherits(Bf,la);Bf.prototype.setDirection=function(a){.99999<a.y?this.quaternion.set(0,0,0,1):-.99999>a.y?this.quaternion.set(1,0,0,0):(dl.set(a.z,0,-a.x).normalize(),this.quaternion.setFromAxisAngle(dl,Math.acos(a.y)))};Bf.prototype.setLength=function(a,b,c){b=void 0===b?.2*a:b;c=void 0===c?.2*b:c;this.line.scale.set(1,Math.max(1E-4,a-
b),1);this.line.updateMatrix();this.cone.scale.set(c,b,c);this.cone.position.y=a;this.cone.updateMatrix()};Bf.prototype.setColor=function(a){this.line.material.color.set(a);this.cone.material.color.set(a)};Bf.prototype.copy=function(a){return la.prototype.copy.call(this,a,!1),this.line.copy(a.line),this.cone.copy(a.cone),this};p.ArrowHelper=Bf;p.Audio=tb;p.AudioAnalyser=Mh;p.AudioContext=fj;var Dd=function(){var a=la.call(this)||this;a.type="AudioListener";a.context=fj.getContext();a.gain=a.context.createGain();
a.gain.connect(a.context.destination);a.filter=null;a.timeDelta=0;a._clock=new yf;return a};$jscomp.inherits(Dd,la);Dd.prototype.getInput=function(){return this.gain};Dd.prototype.removeFilter=function(){return null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this};Dd.prototype.getFilter=function(){return this.filter};Dd.prototype.setFilter=function(a){return null!==this.filter?(this.gain.disconnect(this.filter),
this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=a,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this};Dd.prototype.getMasterVolume=function(){return this.gain.gain.value};Dd.prototype.setMasterVolume=function(a){return this.gain.gain.setTargetAtTime(a,this.context.currentTime,.01),this};Dd.prototype.updateMatrixWorld=function(a){la.prototype.updateMatrixWorld.call(this,a);a=this.context.listener;var b=this.up;
if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(Le,Vk,em),Me.set(0,0,-1).applyQuaternion(Vk),a.positionX){var c=this.context.currentTime+this.timeDelta;a.positionX.linearRampToValueAtTime(Le.x,c);a.positionY.linearRampToValueAtTime(Le.y,c);a.positionZ.linearRampToValueAtTime(Le.z,c);a.forwardX.linearRampToValueAtTime(Me.x,c);a.forwardY.linearRampToValueAtTime(Me.y,c);a.forwardZ.linearRampToValueAtTime(Me.z,c);a.upX.linearRampToValueAtTime(b.x,c);a.upY.linearRampToValueAtTime(b.y,
c);a.upZ.linearRampToValueAtTime(b.z,c)}else a.setPosition(Le.x,Le.y,Le.z),a.setOrientation(Me.x,Me.y,Me.z,b.x,b.y,b.z)};p.AudioListener=Dd;p.AudioLoader=Lh;p.AxesHelper=Dg;p.AxisHelper=function(a){return console.warn("THREE.AxisHelper has been renamed to THREE.AxesHelper."),new Dg(a)};p.BackSide=1;p.BasicDepthPacking=3200;p.BasicShadowMap=0;p.BinaryTextureLoader=function(a){return console.warn("THREE.BinaryTextureLoader has been renamed to THREE.DataTextureLoader."),new Gh(a)};p.Bone=jg;p.BooleanKeyframeTrack=
Od;p.BoundingBoxHelper=function(a,b){return console.warn("THREE.BoundingBoxHelper has been deprecated. Creating a THREE.BoxHelper instead."),new Af(a,b)};p.Box2=Db;p.Box3=ab;var lj=function(a,b){b=void 0===b?16776960:b;var c=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),d=new ra;d.setIndex(new Ba(c,1));d.setAttribute("position",new Ma([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3));b=Ib.call(this,d,new Pb({color:b,toneMapped:!1}))||this;b.box=a;b.type="Box3Helper";
b.geometry.computeBoundingSphere();return b};$jscomp.inherits(lj,Ib);lj.prototype.updateMatrixWorld=function(a){var b=this.box;b.isEmpty()||(b.getCenter(this.position),b.getSize(this.scale),this.scale.multiplyScalar(.5),Ib.prototype.updateMatrixWorld.call(this,a))};p.Box3Helper=lj;p.BoxBufferGeometry=ad;p.BoxGeometry=ad;p.BoxHelper=Af;p.BufferAttribute=Ba;p.BufferGeometry=ra;p.BufferGeometryLoader=Ag;p.ByteType=1010;p.Cache=Ee;p.Camera=hc;var Vh=function(a){function b(A,w,x){c(A,x);c(w,x)}function c(A,
w){g.push(0,0,0);h.push(w.r,w.g,w.b);void 0===m[A]&&(m[A]=[]);m[A].push(g.length/3-1)}var d=new ra;var e=new Pb({color:16777215,vertexColors:!0,toneMapped:!1}),g=[],h=[],m={},n=new ma(16755200),q=new ma(16711680),t=new ma(43775),r=new ma(16777215),u=new ma(3355443);b("n1","n2",n);b("n2","n4",n);b("n4","n3",n);b("n3","n1",n);b("f1","f2",n);b("f2","f4",n);b("f4","f3",n);b("f3","f1",n);b("n1","f1",n);b("n2","f2",n);b("n3","f3",n);b("n4","f4",n);b("p","n1",q);b("p","n2",q);b("p","n3",q);b("p","n4",q);
b("u1","u2",t);b("u2","u3",t);b("u3","u1",t);b("c","t",r);b("p","c",u);b("cn1","cn2",u);b("cn3","cn4",u);b("cf1","cf2",u);b("cf3","cf4",u);d.setAttribute("position",new Ma(g,3));d.setAttribute("color",new Ma(h,3));d=Ib.call(this,d,e)||this;d.type="CameraHelper";d.camera=a;d.camera.updateProjectionMatrix&&d.camera.updateProjectionMatrix();d.matrix=a.matrixWorld;d.matrixAutoUpdate=!1;d.pointMap=m;d.update();return d};$jscomp.inherits(Vh,Ib);Vh.prototype.update=function(){var a=this.geometry,b=this.pointMap;
Qb.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse);Sb("c",b,a,Qb,0,0,-1);Sb("t",b,a,Qb,0,0,1);Sb("n1",b,a,Qb,-1,-1,-1);Sb("n2",b,a,Qb,1,-1,-1);Sb("n3",b,a,Qb,-1,1,-1);Sb("n4",b,a,Qb,1,1,-1);Sb("f1",b,a,Qb,-1,-1,1);Sb("f2",b,a,Qb,1,-1,1);Sb("f3",b,a,Qb,-1,1,1);Sb("f4",b,a,Qb,1,1,1);Sb("u1",b,a,Qb,.7,1.1,-1);Sb("u2",b,a,Qb,-.7,1.1,-1);Sb("u3",b,a,Qb,0,2,-1);Sb("cf1",b,a,Qb,-1,0,1);Sb("cf2",b,a,Qb,1,0,1);Sb("cf3",b,a,Qb,0,-1,1);Sb("cf4",b,a,Qb,0,1,1);Sb("cn1",b,a,Qb,-1,0,-1);Sb("cn2",
b,a,Qb,1,0,-1);Sb("cn3",b,a,Qb,0,-1,-1);Sb("cn4",b,a,Qb,0,1,-1);a.getAttribute("position").needsUpdate=!0};Vh.prototype.dispose=function(){this.geometry.dispose();this.material.dispose()};p.CameraHelper=Vh;p.CanvasRenderer=function(){console.error("THREE.CanvasRenderer has been removed")};p.CanvasTexture=Wi;p.CatmullRomCurve3=Yd;p.CineonToneMapping=3;p.CircleBufferGeometry=ve;p.CircleGeometry=ve;p.ClampToEdgeWrapping=1001;p.Clock=yf;p.Color=ma;p.ColorKeyframeTrack=ah;p.CompressedTexture=vh;var mj=
function(a){return lb.call(this,a)||this};$jscomp.inherits(mj,lb);mj.prototype.load=function(a,b,c,d){function e(u){n.load(a[u],function(A){A=g.parse(A,!0);h[u]={width:A.width,height:A.height,format:A.format,mipmaps:A.mipmaps};q+=1;6===q&&(1===A.mipmapCount&&(m.minFilter=1006),m.image=h,m.format=A.format,m.needsUpdate=!0,b&&b(m))},c,d)}var g=this,h=[],m=new vh,n=new zc(this.manager);n.setPath(this.path);n.setResponseType("arraybuffer");n.setRequestHeader(this.requestHeader);n.setWithCredentials(g.withCredentials);
var q=0;if(Array.isArray(a))for(var t=0,r=a.length;t<r;++t)e(t);else n.load(a,function(u){u=g.parse(u,!0);if(u.isCubemap){for(var A=u.mipmaps.length/u.mipmapCount,w=0;w<A;w++){h[w]={mipmaps:[]};for(var x=0;x<u.mipmapCount;x++)h[w].mipmaps.push(u.mipmaps[w*u.mipmapCount+x]),h[w].format=u.format,h[w].width=u.width,h[w].height=u.height}m.image=h}else m.image.width=u.width,m.image.height=u.height,m.mipmaps=u.mipmaps;1===u.mipmapCount&&(m.minFilter=1006);m.format=u.format;m.needsUpdate=!0;b&&b(m)},c,d);
return m};p.CompressedTextureLoader=mj;p.ConeBufferGeometry=we;p.ConeGeometry=we;p.CubeCamera=mf;p.CubeReflectionMapping=301;p.CubeRefractionMapping=302;p.CubeTexture=Ud;p.CubeTextureLoader=Fh;p.CubeUVReflectionMapping=306;p.CubeUVRefractionMapping=307;p.CubicBezierCurve=xd;p.CubicBezierCurve3=Zd;p.CubicInterpolant=vg;p.CullFaceBack=1;p.CullFaceFront=2;p.CullFaceFrontBack=3;p.CullFaceNone=0;p.Curve=Ga;p.CurvePath=ec;p.CustomBlending=5;p.CustomToneMapping=5;p.CylinderBufferGeometry=id;p.CylinderGeometry=
id;var Cf=function(a,b,c){return this.radius=void 0===a?1:a,this.theta=void 0===b?0:b,this.y=void 0===c?0:c,this};Cf.prototype.set=function(a,b,c){return this.radius=a,this.theta=b,this.y=c,this};Cf.prototype.copy=function(a){return this.radius=a.radius,this.theta=a.theta,this.y=a.y,this};Cf.prototype.setFromVector3=function(a){return this.setFromCartesianCoords(a.x,a.y,a.z)};Cf.prototype.setFromCartesianCoords=function(a,b,c){return this.radius=Math.sqrt(a*a+c*c),this.theta=Math.atan2(a,c),this.y=
b,this};Cf.prototype.clone=function(){return(new this.constructor).copy(this)};p.Cylindrical=Cf;p.DataTexture=Xd;p.DataTexture2DArray=Nf;p.DataTexture3D=nh;p.DataTextureLoader=Gh;var fl=function(){};fl.toHalfFloat=function(a){65504<a&&(console.warn("THREE.DataUtils.toHalfFloat(): value exceeds 65504."),a=65504);el[0]=a;a=om[0];var b=a>>16&32768,c=a>>12&2047,d=a>>23&255;return 103>d?b:142<d?(b|=31744,b|=(255==d?0:1)&&8388607&a,b):113>d?(c|=2048,b|=(c>>114-d)+(c>>113-d&1),b):(b|=d-112<<10|c>>1,b+=1&
c,b)};p.DataUtils=fl;p.DecrementStencilOp=7683;p.DecrementWrapStencilOp=34056;p.DefaultLoadingManager=Mk;p.DepthFormat=1026;p.DepthStencilFormat=1027;p.DepthTexture=Xi;p.DirectionalLight=wf;var Wh=function(a,b,c){var d=la.call(this)||this;d.light=a;d.light.updateMatrixWorld();d.matrix=a.matrixWorld;d.matrixAutoUpdate=!1;d.color=c;void 0===b&&(b=1);a=new ra;a.setAttribute("position",new Ma([-b,b,0,b,b,0,b,-b,0,-b,-b,0,-b,b,0],3));b=new Pb({fog:!1,toneMapped:!1});d.lightPlane=new dc(a,b);d.add(d.lightPlane);
a=new ra;a.setAttribute("position",new Ma([0,0,0,0,0,1],3));d.targetLine=new dc(a,b);d.add(d.targetLine);d.update();return d};$jscomp.inherits(Wh,la);Wh.prototype.dispose=function(){this.lightPlane.geometry.dispose();this.lightPlane.material.dispose();this.targetLine.geometry.dispose();this.targetLine.material.dispose()};Wh.prototype.update=function(){bl.setFromMatrixPosition(this.light.matrixWorld);Rh.setFromMatrixPosition(this.light.target.matrixWorld);cl.subVectors(Rh,bl);this.lightPlane.lookAt(Rh);
void 0!==this.color?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color));this.targetLine.lookAt(Rh);this.targetLine.scale.z=cl.length()};p.DirectionalLightHelper=Wh;p.DiscreteInterpolant=Dh;p.DodecahedronBufferGeometry=xe;p.DodecahedronGeometry=xe;p.DoubleSide=2;p.DstAlphaFactor=206;p.DstColorFactor=208;p.DynamicBufferAttribute=function(a,b){return console.warn("THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setUsage( THREE.DynamicDrawUsage ) instead."),
(new Ba(a,b)).setUsage(35048)};p.DynamicCopyUsage=35050;p.DynamicDrawUsage=35048;p.DynamicReadUsage=35049;p.EdgesGeometry=zh;p.EdgesHelper=function(a,b){return console.warn("THREE.EdgesHelper has been removed. Use THREE.EdgesGeometry instead."),new Ib(new zh(a.geometry),new Pb({color:void 0!==b?b:16777215}))};p.EllipseCurve=Yc;p.EqualDepth=4;p.EqualStencilFunc=514;p.EquirectangularReflectionMapping=303;p.EquirectangularRefractionMapping=304;p.Euler=Wb;p.EventDispatcher=Jc;p.ExtrudeBufferGeometry=
Oc;p.ExtrudeGeometry=Oc;p.FaceColors=1;p.FileLoader=zc;p.FlatShading=1;p.Float16BufferAttribute=Li;p.Float32Attribute=function(a,b){return console.warn("THREE.Float32Attribute has been removed. Use new THREE.Float32BufferAttribute() instead."),new Ma(a,b)};p.Float32BufferAttribute=Ma;p.Float64Attribute=function(a,b){return console.warn("THREE.Float64Attribute has been removed. Use new THREE.Float64BufferAttribute() instead."),new Mi(a,b)};p.Float64BufferAttribute=Mi;p.FloatType=1015;p.Fog=qf;p.FogExp2=
pf;p.Font=function(){console.error("THREE.Font has been moved to /examples/jsm/loaders/FontLoader.js")};p.FontLoader=function(){console.error("THREE.FontLoader has been moved to /examples/jsm/loaders/FontLoader.js")};p.FrontSide=0;p.Frustum=wc;p.GLBufferAttribute=Qe;p.GLSL1="100";p.GLSL3="300 es";p.GammaEncoding=3007;p.GreaterDepth=6;p.GreaterEqualDepth=5;p.GreaterEqualStencilFunc=518;p.GreaterStencilFunc=516;p.GridHelper=jj;p.Group=Wd;p.HalfFloatType=1016;p.HemisphereLight=xg;var Xh=function(a,b,
c){var d=la.call(this)||this;d.light=a;d.light.updateMatrixWorld();d.matrix=a.matrixWorld;d.matrixAutoUpdate=!1;d.color=c;a=new ae(b);a.rotateY(.5*Math.PI);d.material=new Vc({wireframe:!0,fog:!1,toneMapped:!1});void 0===d.color&&(d.material.vertexColors=!0);b=a.getAttribute("position");b=new Float32Array(3*b.count);a.setAttribute("color",new Ba(b,3));d.add(new vb(a,d.material));d.update();return d};$jscomp.inherits(Xh,la);Xh.prototype.dispose=function(){this.children[0].geometry.dispose();this.children[0].material.dispose()};
Xh.prototype.update=function(){var a=this.children[0];if(void 0!==this.color)this.material.color.set(this.color);else{var b=a.geometry.getAttribute("color");$k.copy(this.light.color);al.copy(this.light.groundColor);for(var c=0,d=b.count;c<d;c++){var e=c<d/2?$k:al;b.setXYZ(c,e.r,e.g,e.b)}b.needsUpdate=!0}a.lookAt(nm.setFromMatrixPosition(this.light.matrixWorld).negate())};p.HemisphereLightHelper=Xh;p.HemisphereLightProbe=gj;p.IcosahedronBufferGeometry=ye;p.IcosahedronGeometry=ye;p.ImageBitmapLoader=
Bg;p.ImageLoader=Fe;p.ImageUtils=Ed;p.ImmediateRenderObject=function(){console.error("THREE.ImmediateRenderObject has been removed.")};p.IncrementStencilOp=7682;p.IncrementWrapStencilOp=34055;p.InstancedBufferAttribute=hd;p.InstancedBufferGeometry=Ke;p.InstancedInterleavedBuffer=zf;p.InstancedMesh=Lc;p.Int16Attribute=function(a,b){return console.warn("THREE.Int16Attribute has been removed. Use new THREE.Int16BufferAttribute() instead."),new Ji(a,b)};p.Int16BufferAttribute=Ji;p.Int32Attribute=function(a,
b){return console.warn("THREE.Int32Attribute has been removed. Use new THREE.Int32BufferAttribute() instead."),new Ki(a,b)};p.Int32BufferAttribute=Ki;p.Int8Attribute=function(a,b){return console.warn("THREE.Int8Attribute has been removed. Use new THREE.Int8BufferAttribute() instead."),new Gi(a,b)};p.Int8BufferAttribute=Gi;p.IntType=1013;p.InterleavedBuffer=Xb;p.InterleavedBufferAttribute=Kb;p.Interpolant=fc;p.InterpolateDiscrete=2300;p.InterpolateLinear=2301;p.InterpolateSmooth=2302;p.InvertStencilOp=
5386;p.JSONLoader=function(){console.error("THREE.JSONLoader has been removed.")};p.KeepStencilOp=7680;p.KeyframeTrack=yb;p.LOD=gd;p.LatheBufferGeometry=ze;p.LatheGeometry=ze;p.Layers=fd;p.LensFlare=function(){console.error("THREE.LensFlare has been moved to /examples/jsm/objects/Lensflare.js")};p.LessDepth=2;p.LessEqualDepth=3;p.LessEqualStencilFunc=515;p.LessStencilFunc=513;p.Light=Ab;p.LightProbe=Zc;p.Line=dc;p.Line3=Ac;p.LineBasicMaterial=Pb;p.LineCurve=Mc;p.LineCurve3=$d;p.LineDashedMaterial=
ug;p.LineLoop=th;p.LinePieces=1;p.LineSegments=Ib;p.LineStrip=0;p.LinearEncoding=3E3;p.LinearFilter=1006;p.LinearInterpolant=wg;p.LinearMipMapLinearFilter=1008;p.LinearMipMapNearestFilter=1007;p.LinearMipmapLinearFilter=1008;p.LinearMipmapNearestFilter=1007;p.LinearToneMapping=1;p.Loader=lb;p.LoaderUtils=Je;p.LoadingManager=cj;p.LogLuvEncoding=3003;p.LoopOnce=2200;p.LoopPingPong=2202;p.LoopRepeat=2201;p.LuminanceAlphaFormat=1025;p.LuminanceFormat=1024;p.MOUSE={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,
PAN:2};p.Material=Oa;p.MaterialLoader=xf;p.Math=dk;p.MathUtils=dk;p.Matrix3=fb;p.Matrix4=ua;p.MaxEquation=104;p.Mesh=vb;p.MeshBasicMaterial=Vc;p.MeshDepthMaterial=Ve;p.MeshDistanceMaterial=We;p.MeshFaceMaterial=function(a){return console.warn("THREE.MeshFaceMaterial has been removed. Use an Array instead."),a};p.MeshLambertMaterial=sg;p.MeshMatcapMaterial=tg;p.MeshNormalMaterial=rg;p.MeshPhongMaterial=pg;p.MeshPhysicalMaterial=vf;p.MeshStandardMaterial=de;p.MeshToonMaterial=qg;p.MinEquation=103;p.MirroredRepeatWrapping=
1002;p.MixOperation=1;p.MultiMaterial=function(a){a=void 0===a?[]:a;return console.warn("THREE.MultiMaterial has been removed. Use an Array instead."),a.isMultiMaterial=!0,a.materials=a,a.clone=function(){return a.slice()},a};p.MultiplyBlending=4;p.MultiplyOperation=0;p.NearestFilter=1003;p.NearestMipMapLinearFilter=1005;p.NearestMipMapNearestFilter=1004;p.NearestMipmapLinearFilter=1005;p.NearestMipmapNearestFilter=1004;p.NeverDepth=0;p.NeverStencilFunc=512;p.NoBlending=0;p.NoColors=0;p.NoToneMapping=
0;p.NormalAnimationBlendMode=2500;p.NormalBlending=1;p.NotEqualDepth=7;p.NotEqualStencilFunc=517;p.NumberKeyframeTrack=Ze;p.Object3D=la;var lc=function(a){return lb.call(this,a)||this};$jscomp.inherits(lc,lb);lc.prototype.load=function(a,b,c,d){var e=this,g=""===this.path?Je.extractUrlBase(a):this.path;this.resourcePath=this.resourcePath||g;g=new zc(this.manager);g.setPath(this.path);g.setRequestHeader(this.requestHeader);g.setWithCredentials(this.withCredentials);g.load(a,function(h){var m=null;
try{m=JSON.parse(h)}catch(n){return void 0!==d&&d(n),void console.error("THREE:ObjectLoader: Can't parse "+a+".",n.message)}h=m.metadata;void 0!==h&&void 0!==h.type&&"geometry"!==h.type.toLowerCase()?e.parse(m,b):console.error("THREE.ObjectLoader: Can't load "+a)},c,d)};lc.prototype.loadAsync=function(a,b){var c=this,d,e,g,h,m;return $jscomp.asyncExecutePromiseGeneratorProgram(function(n){if(1==n.nextAddress)return d=""===c.path?Je.extractUrlBase(a):c.path,c.resourcePath=c.resourcePath||d,e=new zc(c.manager),
e.setPath(c.path),e.setRequestHeader(c.requestHeader),e.setWithCredentials(c.withCredentials),n.yield(e.loadAsync(a,b),2);if(3!=n.nextAddress){g=n.yieldResult;h=JSON.parse(g);m=h.metadata;if(void 0===m||void 0===m.type||"geometry"===m.type.toLowerCase())throw Error("THREE.ObjectLoader: Can't load "+a);return n.yield(c.parseAsync(h),3)}return n.return(n.yieldResult)})};lc.prototype.parse=function(a,b){var c=this.parseAnimations(a.animations),d=this.parseShapes(a.shapes),e=this.parseGeometries(a.geometries,
d);d=this.parseImages(a.images,function(){void 0!==b&&b(m)});var g=this.parseTextures(a.textures,d),h=this.parseMaterials(a.materials,g),m=this.parseObject(a.object,e,h,g,c);a=this.parseSkeletons(a.skeletons,m);if(this.bindSkeletons(m,a),void 0!==b){a=!1;for(var n in d)if(d[n]instanceof HTMLImageElement){a=!0;break}!1===a&&b(m)}return m};lc.prototype.parseAsync=function(a){var b=this,c,d,e,g,h,m,n,q;return $jscomp.asyncExecutePromiseGeneratorProgram(function(t){if(1==t.nextAddress)return c=b.parseAnimations(a.animations),
d=b.parseShapes(a.shapes),e=b.parseGeometries(a.geometries,d),t.yield(b.parseImagesAsync(a.images),2);g=t.yieldResult;h=b.parseTextures(a.textures,g);m=b.parseMaterials(a.materials,h);n=b.parseObject(a.object,e,m,h,c);q=b.parseSkeletons(a.skeletons,n);return t.return((b.bindSkeletons(n,q),n))})};lc.prototype.parseShapes=function(a){var b={};if(void 0!==a)for(var c=0,d=a.length;c<d;c++){var e=(new pc).fromJSON(a[c]);b[e.uuid]=e}return b};lc.prototype.parseSkeletons=function(a,b){var c={},d={};if(b.traverse(function(h){h.isBone&&
(d[h.uuid]=h)}),void 0!==a){b=0;for(var e=a.length;b<e;b++){var g=(new Fc).fromJSON(a[b],d);c[g.uuid]=g}}return c};lc.prototype.parseGeometries=function(a,b){var c={};if(void 0!==a)for(var d=new Ag,e=0,g=a.length;e<g;e++){var h=void 0,m=a[e];switch(m.type){case "BufferGeometry":case "InstancedBufferGeometry":h=d.parse(m);break;case "Geometry":console.error("THREE.ObjectLoader: The legacy Geometry type is no longer supported.");break;default:m.type in Lk?h=Lk[m.type].fromJSON(m,b):console.warn('THREE.ObjectLoader: Unsupported geometry type "'+
m.type+'"')}h.uuid=m.uuid;void 0!==m.name&&(h.name=m.name);!0===h.isBufferGeometry&&void 0!==m.userData&&(h.userData=m.userData);c[m.uuid]=h}return c};lc.prototype.parseMaterials=function(a,b){var c={},d={};if(void 0!==a){var e=new xf;e.setTextures(b);b=0;for(var g=a.length;b<g;b++){var h=a[b];if("MultiMaterial"===h.type){for(var m=[],n=0;n<h.materials.length;n++){var q=h.materials[n];void 0===c[q.uuid]&&(c[q.uuid]=e.parse(q));m.push(c[q.uuid])}d[h.uuid]=m}else void 0===c[h.uuid]&&(c[h.uuid]=e.parse(h)),
d[h.uuid]=c[h.uuid]}}return d};lc.prototype.parseAnimations=function(a){var b={};if(void 0!==a)for(var c=0;c<a.length;c++){var d=ic.parse(a[c]);b[d.uuid]=d}return b};lc.prototype.parseImages=function(a,b){function c(u){return"string"==typeof u?function(A){return d.manager.itemStart(A),g.load(A,function(){d.manager.itemEnd(A)},void 0,function(){d.manager.itemError(A);d.manager.itemEnd(A)})}(/^(\/\/)|([a-z]+:(\/\/)?)/i.test(u)?u:d.resourcePath+u):u.data?{data:new af[u.type](u.data),width:u.width,height:u.height}:
null}var d=this,e={};if(void 0!==a&&0<a.length){b=new cj(b);var g=new Fe(b);g.setCrossOrigin(this.crossOrigin);b=0;for(var h=a.length;b<h;b++){var m=a[b],n=m.url;if(Array.isArray(n)){e[m.uuid]=[];for(var q=0,t=n.length;q<t;q++){var r=c(n[q]);null!==r&&(r instanceof HTMLImageElement?e[m.uuid].push(r):e[m.uuid].push(new Xd(r.data,r.width,r.height)))}}else n=c(m.url),null!==n&&(e[m.uuid]=n)}}return e};lc.prototype.parseImagesAsync=function(a){function b(x){var C,G;return $jscomp.asyncExecutePromiseGeneratorProgram(function(I){if(1==
I.nextAddress){if("string"!=typeof x)return I.jumpTo(2);C=x;G=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(C)?C:d.resourcePath+C;return I.yield(g.loadAsync(G),3)}return 2!=I.nextAddress?I.return(I.yieldResult):I.return(x.data?{data:new af[x.type](x.data),width:x.width,height:x.height}:null)})}var c=this,d,e,g,h,m,n,q,t,r,u,A,w;return $jscomp.asyncExecutePromiseGeneratorProgram(function(x){switch(x.nextAddress){case 1:d=c;e={};if(!(void 0!==a&&0<a.length)){x.jumpTo(2);break}g=new Fe(c.manager);g.setCrossOrigin(c.crossOrigin);
h=0;m=a.length;case 3:if(!(h<m)){x.jumpTo(2);break}n=a[h];q=n.url;if(Array.isArray(q)){x.jumpTo(6);break}return x.yield(b(n.url),8);case 8:t=x.yieldResult;null!==t&&(e[n.uuid]=t);x.jumpTo(4);break;case 6:e[n.uuid]=[],r=0,u=q.length;case 9:if(!(r<u)){x.jumpTo(4);break}A=q[r];return x.yield(b(A),12);case 12:w=x.yieldResult;null!==w&&(w instanceof HTMLImageElement?e[n.uuid].push(w):e[n.uuid].push(new Xd(w.data,w.width,w.height)));r++;x.jumpTo(9);break;case 4:h++;x.jumpTo(3);break;case 2:return x.return(e)}})};
lc.prototype.parseTextures=function(a,b){function c(q,t){return"number"==typeof q?q:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",q),t[q])}var d={};if(void 0!==a)for(var e=0,g=a.length;e<g;e++){var h=a[e],m=void 0;void 0===h.image&&console.warn('THREE.ObjectLoader: No "image" specified for',h.uuid);void 0===b[h.image]&&console.warn("THREE.ObjectLoader: Undefined image",h.image);var n=b[h.image];Array.isArray(n)?(m=new Ud(n),6===n.length&&(m.needsUpdate=!0)):
(m=n&&n.data?new Xd(n.data,n.width,n.height):new mb(n),n&&(m.needsUpdate=!0));m.uuid=h.uuid;void 0!==h.name&&(m.name=h.name);void 0!==h.mapping&&(m.mapping=c(h.mapping,dm));void 0!==h.offset&&m.offset.fromArray(h.offset);void 0!==h.repeat&&m.repeat.fromArray(h.repeat);void 0!==h.center&&m.center.fromArray(h.center);void 0!==h.rotation&&(m.rotation=h.rotation);void 0!==h.wrap&&(m.wrapS=c(h.wrap[0],Rk),m.wrapT=c(h.wrap[1],Rk));void 0!==h.format&&(m.format=h.format);void 0!==h.type&&(m.type=h.type);
void 0!==h.encoding&&(m.encoding=h.encoding);void 0!==h.minFilter&&(m.minFilter=c(h.minFilter,Sk));void 0!==h.magFilter&&(m.magFilter=c(h.magFilter,Sk));void 0!==h.anisotropy&&(m.anisotropy=h.anisotropy);void 0!==h.flipY&&(m.flipY=h.flipY);void 0!==h.premultiplyAlpha&&(m.premultiplyAlpha=h.premultiplyAlpha);void 0!==h.unpackAlignment&&(m.unpackAlignment=h.unpackAlignment);void 0!==h.userData&&(m.userData=h.userData);d[h.uuid]=m}return d};lc.prototype.parseObject=function(a,b,c,d,e){function g(u){return void 0===
b[u]&&console.warn("THREE.ObjectLoader: Undefined geometry",u),b[u]}function h(u){if(void 0!==u){if(Array.isArray(u)){for(var A=[],w=0,x=u.length;w<x;w++){var C=u[w];void 0===c[C]&&console.warn("THREE.ObjectLoader: Undefined material",C);A.push(c[C])}return A}return void 0===c[u]&&console.warn("THREE.ObjectLoader: Undefined material",u),c[u]}}function m(u){return void 0===d[u]&&console.warn("THREE.ObjectLoader: Undefined texture",u),d[u]}switch(a.type){case "Scene":var n=new te;void 0!==a.background&&
(Number.isInteger(a.background)?n.background=new ma(a.background):n.background=m(a.background));void 0!==a.environment&&(n.environment=m(a.environment));void 0!==a.fog&&("Fog"===a.fog.type?n.fog=new qf(a.fog.color,a.fog.near,a.fog.far):"FogExp2"===a.fog.type&&(n.fog=new pf(a.fog.color,a.fog.density)));break;case "PerspectiveCamera":n=new xb(a.fov,a.aspect,a.near,a.far);void 0!==a.focus&&(n.focus=a.focus);void 0!==a.zoom&&(n.zoom=a.zoom);void 0!==a.filmGauge&&(n.filmGauge=a.filmGauge);void 0!==a.filmOffset&&
(n.filmOffset=a.filmOffset);void 0!==a.view&&(n.view=Object.assign({},a.view));break;case "OrthographicCamera":n=new Wc(a.left,a.right,a.top,a.bottom,a.near,a.far);void 0!==a.zoom&&(n.zoom=a.zoom);void 0!==a.view&&(n.view=Object.assign({},a.view));break;case "AmbientLight":n=new Jh(a.color,a.intensity);break;case "DirectionalLight":n=new wf(a.color,a.intensity);break;case "PointLight":n=new He(a.color,a.intensity,a.distance,a.decay);break;case "RectAreaLight":n=new Ie(a.color,a.intensity,a.width,
a.height);break;case "SpotLight":n=new Ge(a.color,a.intensity,a.distance,a.angle,a.penumbra,a.decay);break;case "HemisphereLight":n=new xg(a.color,a.groundColor,a.intensity);break;case "LightProbe":n=(new Zc).fromJSON(a);break;case "SkinnedMesh":n=g(a.geometry);var q=h(a.material);n=new Xc(n,q);void 0!==a.bindMode&&(n.bindMode=a.bindMode);void 0!==a.bindMatrix&&n.bindMatrix.fromArray(a.bindMatrix);void 0!==a.skeleton&&(n.skeleton=a.skeleton);break;case "Mesh":n=g(a.geometry);q=h(a.material);n=new vb(n,
q);break;case "InstancedMesh":n=g(a.geometry);q=h(a.material);var t=a.instanceMatrix,r=a.instanceColor;n=new Lc(n,q,a.count);n.instanceMatrix=new hd(new Float32Array(t.array),16);void 0!==r&&(n.instanceColor=new hd(new Float32Array(r.array),r.itemSize));break;case "LOD":n=new gd;break;case "Line":n=new dc(g(a.geometry),h(a.material));break;case "LineLoop":n=new th(g(a.geometry),h(a.material));break;case "LineSegments":n=new Ib(g(a.geometry),h(a.material));break;case "PointCloud":case "Points":n=new wd(g(a.geometry),
h(a.material));break;case "Sprite":n=new ue(h(a.material));break;case "Group":n=new Wd;break;case "Bone":n=new jg;break;default:n=new la}if(n.uuid=a.uuid,void 0!==a.name&&(n.name=a.name),void 0!==a.matrix?(n.matrix.fromArray(a.matrix),void 0!==a.matrixAutoUpdate&&(n.matrixAutoUpdate=a.matrixAutoUpdate),n.matrixAutoUpdate&&n.matrix.decompose(n.position,n.quaternion,n.scale)):(void 0!==a.position&&n.position.fromArray(a.position),void 0!==a.rotation&&n.rotation.fromArray(a.rotation),void 0!==a.quaternion&&
n.quaternion.fromArray(a.quaternion),void 0!==a.scale&&n.scale.fromArray(a.scale)),void 0!==a.castShadow&&(n.castShadow=a.castShadow),void 0!==a.receiveShadow&&(n.receiveShadow=a.receiveShadow),a.shadow&&(void 0!==a.shadow.bias&&(n.shadow.bias=a.shadow.bias),void 0!==a.shadow.normalBias&&(n.shadow.normalBias=a.shadow.normalBias),void 0!==a.shadow.radius&&(n.shadow.radius=a.shadow.radius),void 0!==a.shadow.mapSize&&n.shadow.mapSize.fromArray(a.shadow.mapSize),void 0!==a.shadow.camera&&(n.shadow.camera=
this.parseObject(a.shadow.camera))),void 0!==a.visible&&(n.visible=a.visible),void 0!==a.frustumCulled&&(n.frustumCulled=a.frustumCulled),void 0!==a.renderOrder&&(n.renderOrder=a.renderOrder),void 0!==a.userData&&(n.userData=a.userData),void 0!==a.layers&&(n.layers.mask=a.layers),void 0!==a.children)for(t=a.children,r=0;r<t.length;r++)n.add(this.parseObject(t[r],b,c,d,e));if(void 0!==a.animations)for(t=a.animations,r=0;r<t.length;r++)n.animations.push(e[t[r]]);if("LOD"===a.type)for(void 0!==a.autoUpdate&&
(n.autoUpdate=a.autoUpdate),a=a.levels,e=0;e<a.length;e++)t=a[e],r=n.getObjectByProperty("uuid",t.object),void 0!==r&&n.addLevel(r,t.distance);return n};lc.prototype.bindSkeletons=function(a,b){0!==Object.keys(b).length&&a.traverse(function(c){if(!0===c.isSkinnedMesh&&void 0!==c.skeleton){var d=b[c.skeleton];void 0===d?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",c.skeleton):c.bind(d,c.bindMatrix)}})};lc.prototype.setTexturePath=function(a){return console.warn("THREE.ObjectLoader: .setTexturePath() has been renamed to .setResourcePath()."),
this.setResourcePath(a)};p.ObjectLoader=lc;p.ObjectSpaceNormalMap=1;p.OctahedronBufferGeometry=ae;p.OctahedronGeometry=ae;p.OneFactor=201;p.OneMinusDstAlphaFactor=207;p.OneMinusDstColorFactor=209;p.OneMinusSrcAlphaFactor=205;p.OneMinusSrcColorFactor=203;p.OrthographicCamera=Wc;p.PCFShadowMap=1;p.PCFSoftShadowMap=2;p.PMREMGenerator=ac;p.ParametricGeometry=function(){return console.error("THREE.ParametricGeometry has been moved to /examples/jsm/geometries/ParametricGeometry.js"),new ra};p.Particle=
function(a){return console.warn("THREE.Particle has been renamed to THREE.Sprite."),new ue(a)};p.ParticleBasicMaterial=function(a){return console.warn("THREE.ParticleBasicMaterial has been renamed to THREE.PointsMaterial."),new vd(a)};p.ParticleSystem=function(a,b){return console.warn("THREE.ParticleSystem has been renamed to THREE.Points."),new wd(a,b)};p.ParticleSystemMaterial=function(a){return console.warn("THREE.ParticleSystemMaterial has been renamed to THREE.PointsMaterial."),new vd(a)};p.Path=
Ob;p.PerspectiveCamera=xb;p.Plane=zb;p.PlaneBufferGeometry=Gd;p.PlaneGeometry=Gd;var nj=function(a,b,c){b=void 0===b?1:b;c=void 0===c?16776960:c;var d=new ra;d.setAttribute("position",new Ma([1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0],3));d.computeBoundingSphere();d=dc.call(this,d,new Pb({color:c,toneMapped:!1}))||this;d.type="PlaneHelper";d.plane=a;d.size=b;a=new ra;a.setAttribute("position",new Ma([1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1],3));a.computeBoundingSphere();
d.add(new vb(a,new Vc({color:c,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})));return d};$jscomp.inherits(nj,dc);nj.prototype.updateMatrixWorld=function(a){var b=-this.plane.constant;1E-8>Math.abs(b)&&(b=1E-8);this.scale.set(.5*this.size,.5*this.size,b);this.children[0].material.side=0>b?1:0;this.lookAt(this.plane.normal);dc.prototype.updateMatrixWorld.call(this,a)};p.PlaneHelper=nj;p.PointCloud=function(a,b){return console.warn("THREE.PointCloud has been renamed to THREE.Points."),new wd(a,
b)};p.PointCloudMaterial=function(a){return console.warn("THREE.PointCloudMaterial has been renamed to THREE.PointsMaterial."),new vd(a)};p.PointLight=He;var Yh=function(a,b,c){b=vb.call(this,new be(b,4,2),new Vc({wireframe:!0,fog:!1,toneMapped:!1}))||this;b.light=a;b.light.updateMatrixWorld();b.color=c;b.type="PointLightHelper";b.matrix=b.light.matrixWorld;b.matrixAutoUpdate=!1;b.update();return b};$jscomp.inherits(Yh,vb);Yh.prototype.dispose=function(){this.geometry.dispose();this.material.dispose()};
Yh.prototype.update=function(){void 0!==this.color?this.material.color.set(this.color):this.material.color.copy(this.light.color)};p.PointLightHelper=Yh;p.Points=wd;p.PointsMaterial=vd;var gl=function(a,b,c,d,e,g){a=void 0===a?10:a;b=void 0===b?16:b;c=void 0===c?8:c;d=void 0===d?64:d;g=void 0===g?8947848:g;e=new ma(void 0===e?4473924:e);g=new ma(g);var h=[];for(var m=[],n=0;n<=b;n++){var q=n/b*2*Math.PI,t=Math.sin(q)*a;q=Math.cos(q)*a;h.push(0,0,0);h.push(t,0,q);t=1&n?e:g;m.push(t.r,t.g,t.b);m.push(t.r,
t.g,t.b)}for(b=0;b<=c;b++)for(n=1&b?e:g,t=a-a/c*b,q=0;q<d;q++){var r=q/d*2*Math.PI,u=Math.sin(r)*t;r=Math.cos(r)*t;h.push(u,0,r);m.push(n.r,n.g,n.b);r=(q+1)/d*2*Math.PI;u=Math.sin(r)*t;r=Math.cos(r)*t;h.push(u,0,r);m.push(n.r,n.g,n.b)}a=new ra;a.setAttribute("position",new Ma(h,3));a.setAttribute("color",new Ma(m,3));h=Ib.call(this,a,new Pb({vertexColors:!0,toneMapped:!1}))||this;h.type="PolarGridHelper";return h};$jscomp.inherits(gl,Ib);p.PolarGridHelper=gl;p.PolyhedronBufferGeometry=uc;p.PolyhedronGeometry=
uc;var Gc=function(a){a=tb.call(this,a)||this;a.panner=a.context.createPanner();a.panner.panningModel="HRTF";a.panner.connect(a.gain);return a};$jscomp.inherits(Gc,tb);Gc.prototype.getOutput=function(){return this.panner};Gc.prototype.getRefDistance=function(){return this.panner.refDistance};Gc.prototype.setRefDistance=function(a){return this.panner.refDistance=a,this};Gc.prototype.getRolloffFactor=function(){return this.panner.rolloffFactor};Gc.prototype.setRolloffFactor=function(a){return this.panner.rolloffFactor=
a,this};Gc.prototype.getDistanceModel=function(){return this.panner.distanceModel};Gc.prototype.setDistanceModel=function(a){return this.panner.distanceModel=a,this};Gc.prototype.getMaxDistance=function(){return this.panner.maxDistance};Gc.prototype.setMaxDistance=function(a){return this.panner.maxDistance=a,this};Gc.prototype.setDirectionalCone=function(a,b,c){return this.panner.coneInnerAngle=a,this.panner.coneOuterAngle=b,this.panner.coneOuterGain=c,this};Gc.prototype.updateMatrixWorld=function(a){if(tb.prototype.updateMatrixWorld.call(this,
a),!0!==this.hasPlaybackControl||!1!==this.isPlaying)if(this.matrixWorld.decompose(Ne,Wk,fm),Oe.set(0,0,1).applyQuaternion(Wk),a=this.panner,a.positionX){var b=this.context.currentTime+this.listener.timeDelta;a.positionX.linearRampToValueAtTime(Ne.x,b);a.positionY.linearRampToValueAtTime(Ne.y,b);a.positionZ.linearRampToValueAtTime(Ne.z,b);a.orientationX.linearRampToValueAtTime(Oe.x,b);a.orientationY.linearRampToValueAtTime(Oe.y,b);a.orientationZ.linearRampToValueAtTime(Oe.z,b)}else a.setPosition(Ne.x,
Ne.y,Ne.z),a.setOrientation(Oe.x,Oe.y,Oe.z)};p.PositionalAudio=Gc;p.PropertyBinding=Pa;p.PropertyMixer=vc;p.QuadraticBezierCurve=yd;p.QuadraticBezierCurve3=zd;p.Quaternion=Sa;p.QuaternionKeyframeTrack=Nd;p.QuaternionLinearInterpolant=Eh;p.REVISION="134";p.RGBADepthPacking=3201;p.RGBAFormat=1023;p.RGBAIntegerFormat=1033;p.RGBA_ASTC_10x10_Format=37819;p.RGBA_ASTC_10x5_Format=37816;p.RGBA_ASTC_10x6_Format=37817;p.RGBA_ASTC_10x8_Format=37818;p.RGBA_ASTC_12x10_Format=37820;p.RGBA_ASTC_12x12_Format=37821;
p.RGBA_ASTC_4x4_Format=37808;p.RGBA_ASTC_5x4_Format=37809;p.RGBA_ASTC_5x5_Format=37810;p.RGBA_ASTC_6x5_Format=37811;p.RGBA_ASTC_6x6_Format=37812;p.RGBA_ASTC_8x5_Format=37813;p.RGBA_ASTC_8x6_Format=37814;p.RGBA_ASTC_8x8_Format=37815;p.RGBA_BPTC_Format=36492;p.RGBA_ETC2_EAC_Format=37496;p.RGBA_PVRTC_2BPPV1_Format=35843;p.RGBA_PVRTC_4BPPV1_Format=35842;p.RGBA_S3TC_DXT1_Format=33777;p.RGBA_S3TC_DXT3_Format=33778;p.RGBA_S3TC_DXT5_Format=33779;p.RGBDEncoding=3006;p.RGBEEncoding=3002;p.RGBEFormat=1023;p.RGBFormat=
1022;p.RGBIntegerFormat=1032;p.RGBM16Encoding=3005;p.RGBM7Encoding=3004;p.RGB_ETC1_Format=36196;p.RGB_ETC2_Format=37492;p.RGB_PVRTC_2BPPV1_Format=35841;p.RGB_PVRTC_4BPPV1_Format=35840;p.RGB_S3TC_DXT1_Format=33776;p.RGFormat=1030;p.RGIntegerFormat=1031;p.RawShaderMaterial=ie;p.Ray=Bb;var Eg=function(a,b,c,d){c=void 0===c?0:c;d=void 0===d?1/0:d;this.ray=new Bb(a,b);this.near=c;this.far=d;this.camera=null;this.layers=new fd;this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}};
Eg.prototype.set=function(a,b){this.ray.set(a,b)};Eg.prototype.setFromCamera=function(a,b){b&&b.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(b.matrixWorld),this.ray.direction.set(a.x,a.y,.5).unproject(b).sub(this.ray.origin).normalize(),this.camera=b):b&&b.isOrthographicCamera?(this.ray.origin.set(a.x,a.y,(b.near+b.far)/(b.near-b.far)).unproject(b),this.ray.direction.set(0,0,-1).transformDirection(b.matrixWorld),this.camera=b):console.error("THREE.Raycaster: Unsupported camera type: "+
b.type)};Eg.prototype.intersectObject=function(a,b,c){c=void 0===c?[]:c;return ui(a,this,c,void 0===b?!0:b),c.sort(bk),c};Eg.prototype.intersectObjects=function(a,b,c){b=void 0===b?!0:b;c=void 0===c?[]:c;for(var d=0,e=a.length;d<e;d++)ui(a[d],this,c,b);return c.sort(bk),c};p.Raycaster=Eg;p.RectAreaLight=Ie;p.RedFormat=1028;p.RedIntegerFormat=1029;p.ReinhardToneMapping=2;p.RepeatWrapping=1E3;p.ReplaceStencilOp=7681;p.ReverseSubtractEquation=102;p.RingBufferGeometry=Ae;p.RingGeometry=Ae;p.SRGB8_ALPHA8_ASTC_10x10_Format=
37851;p.SRGB8_ALPHA8_ASTC_10x5_Format=37848;p.SRGB8_ALPHA8_ASTC_10x6_Format=37849;p.SRGB8_ALPHA8_ASTC_10x8_Format=37850;p.SRGB8_ALPHA8_ASTC_12x10_Format=37852;p.SRGB8_ALPHA8_ASTC_12x12_Format=37853;p.SRGB8_ALPHA8_ASTC_4x4_Format=37840;p.SRGB8_ALPHA8_ASTC_5x4_Format=37841;p.SRGB8_ALPHA8_ASTC_5x5_Format=37842;p.SRGB8_ALPHA8_ASTC_6x5_Format=37843;p.SRGB8_ALPHA8_ASTC_6x6_Format=37844;p.SRGB8_ALPHA8_ASTC_8x5_Format=37845;p.SRGB8_ALPHA8_ASTC_8x6_Format=37846;p.SRGB8_ALPHA8_ASTC_8x8_Format=37847;p.Scene=
te;p.SceneUtils={createMultiMaterialObject:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")},detach:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")},attach:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")}};p.ShaderChunk=jb;p.ShaderLib=Qc;p.ShaderMaterial=Bc;p.ShadowMaterial=og;p.Shape=pc;p.ShapeBufferGeometry=Bd;p.ShapeGeometry=Bd;var Re=function(){this.type=
"ShapePath";this.color=new ma;this.subPaths=[];this.currentPath=null};Re.prototype.moveTo=function(a,b){return this.currentPath=new Ob,this.subPaths.push(this.currentPath),this.currentPath.moveTo(a,b),this};Re.prototype.lineTo=function(a,b){return this.currentPath.lineTo(a,b),this};Re.prototype.quadraticCurveTo=function(a,b,c,d){return this.currentPath.quadraticCurveTo(a,b,c,d),this};Re.prototype.bezierCurveTo=function(a,b,c,d,e,g){return this.currentPath.bezierCurveTo(a,b,c,d,e,g),this};Re.prototype.splineThru=
function(a){return this.currentPath.splineThru(a),this};Re.prototype.toShapes=function(a,b){function c(C){for(var G=[],I=0,P=C.length;I<P;I++){var O=C[I],M=new pc;M.curves=O.curves;G.push(M)}return G}function d(C,G){for(var I=G.length,P=!1,O=I-1,M=0;M<I;O=M++){var S=G[O],V=G[M],ba=V.x-S.x,Y=V.y-S.y;if(Math.abs(Y)>Number.EPSILON){if(!(0>Y&&(S=G[M],ba=-ba,V=G[O],Y=-Y),C.y<S.y||C.y>V.y))if(C.y===S.y){if(C.x===S.x)return!0}else{O=Y*(C.x-S.x)-ba*(C.y-S.y);if(0===O)return!0;0>O||(P=!P)}}else if(C.y===S.y&&
(V.x<=C.x&&C.x<=S.x||S.x<=C.x&&C.x<=V.x))return!0}return P}var e=Nc.isClockWise,g=this.subPaths;if(0===g.length)return[];if(!0===b)return c(g);var h,m;b=[];if(1===g.length)return h=g[0],m=new pc,m.curves=h.curves,b.push(m),b;var n=!e(g[0].getPoints());n=a?!n:n;m=[];var q=[],t=[],r=0;q[r]=void 0;t[r]=[];for(var u=0,A=g.length;u<A;u++){h=g[u];var w=h.getPoints();var x=e(w);(x=a?!x:x)?(!n&&q[r]&&r++,q[r]={s:new pc,p:w},q[r].s.curves=h.curves,n&&r++,t[r]=[]):t[r].push({h:h,p:w[0]})}if(!q[0])return c(g);
if(1<q.length){a=!1;e=[];g=0;for(h=q.length;g<h;g++)m[g]=[];g=0;for(h=q.length;g<h;g++)for(x=t[g],n=0;n<x.length;n++){w=x[n];r=!0;for(u=0;u<q.length;u++)d(w.p,q[u].p)&&(g!==u&&e.push({froms:g,tos:u,hole:n}),r?(r=!1,m[u].push(w)):a=!0);r&&m[g].push(w)}0<e.length&&(a||(t=m))}e=0;for(g=q.length;e<g;e++)for(m=q[e].s,b.push(m),a=t[e],h=0,x=a.length;h<x;h++)m.holes.push(a[h].h);return b};p.ShapePath=Re;p.ShapeUtils=Nc;p.ShortType=1011;p.Skeleton=Fc;p.SkeletonHelper=Qh;p.SkinnedMesh=Xc;p.SmoothShading=2;
p.Sphere=Fb;p.SphereBufferGeometry=be;p.SphereGeometry=be;var Se=function(a,b,c){return this.radius=void 0===a?1:a,this.phi=void 0===b?0:b,this.theta=void 0===c?0:c,this};Se.prototype.set=function(a,b,c){return this.radius=a,this.phi=b,this.theta=c,this};Se.prototype.copy=function(a){return this.radius=a.radius,this.phi=a.phi,this.theta=a.theta,this};Se.prototype.makeSafe=function(){return this.phi=Math.max(1E-6,Math.min(Math.PI-1E-6,this.phi)),this};Se.prototype.setFromVector3=function(a){return this.setFromCartesianCoords(a.x,
a.y,a.z)};Se.prototype.setFromCartesianCoords=function(a,b,c){return this.radius=Math.sqrt(a*a+b*b+c*c),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(a,c),this.phi=Math.acos(R(b/this.radius,-1,1))),this};Se.prototype.clone=function(){return(new this.constructor).copy(this)};p.Spherical=Se;p.SphericalHarmonics3=kc;p.SplineCurve=Ad;p.SpotLight=Ge;var Zh=function(a,b){var c=la.call(this)||this;c.light=a;c.light.updateMatrixWorld();c.matrix=a.matrixWorld;c.matrixAutoUpdate=!1;c.color=
b;a=new ra;b=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(var d=0,e=1;32>d;d++,e++){var g=d/32*Math.PI*2,h=e/32*Math.PI*2;b.push(Math.cos(g),Math.sin(g),1,Math.cos(h),Math.sin(h),1)}a.setAttribute("position",new Ma(b,3));b=new Pb({fog:!1,toneMapped:!1});c.cone=new Ib(a,b);c.add(c.cone);c.update();return c};$jscomp.inherits(Zh,la);Zh.prototype.dispose=function(){this.cone.geometry.dispose();this.cone.material.dispose()};Zh.prototype.update=function(){this.light.updateMatrixWorld();
var a=this.light.distance?this.light.distance:1E3,b=a*Math.tan(this.light.angle);this.cone.scale.set(b,b,a);Zk.setFromMatrixPosition(this.light.target.matrixWorld);this.cone.lookAt(Zk);void 0!==this.color?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)};p.SpotLightHelper=Zh;p.Sprite=ue;p.SpriteMaterial=rf;p.SrcAlphaFactor=204;p.SrcAlphaSaturateFactor=210;p.SrcColorFactor=202;p.StaticCopyUsage=35046;p.StaticDrawUsage=35044;p.StaticReadUsage=35045;var hl=function(){this.type=
"StereoCamera";this.aspect=1;this.eyeSep=.064;this.cameraL=new xb;this.cameraL.layers.enable(1);this.cameraL.matrixAutoUpdate=!1;this.cameraR=new xb;this.cameraR.layers.enable(2);this.cameraR.matrixAutoUpdate=!1;this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}};hl.prototype.update=function(a){var b=this._cache;if(b.focus!==a.focus||b.fov!==a.fov||b.aspect!==a.aspect*this.aspect||b.near!==a.near||b.far!==a.far||b.zoom!==a.zoom||b.eyeSep!==this.eyeSep){b.focus=
a.focus;b.fov=a.fov;b.aspect=a.aspect*this.aspect;b.near=a.near;b.far=a.far;b.zoom=a.zoom;b.eyeSep=this.eyeSep;var c=a.projectionMatrix.clone(),d=b.eyeSep/2,e=d*b.near/b.focus,g=b.near*Math.tan(qe*b.fov*.5)/b.zoom;Uk.elements[12]=-d;Tk.elements[12]=d;d=-g*b.aspect+e;var h=g*b.aspect+e;c.elements[0]=2*b.near/(h-d);c.elements[8]=(h+d)/(h-d);this.cameraL.projectionMatrix.copy(c);d=-g*b.aspect-e;h=g*b.aspect-e;c.elements[0]=2*b.near/(h-d);c.elements[8]=(h+d)/(h-d);this.cameraR.projectionMatrix.copy(c)}this.cameraL.matrixWorld.copy(a.matrixWorld).multiply(Uk);
this.cameraR.matrixWorld.copy(a.matrixWorld).multiply(Tk)};p.StereoCamera=hl;p.StreamCopyUsage=35042;p.StreamDrawUsage=35040;p.StreamReadUsage=35041;p.StringKeyframeTrack=Pd;p.SubtractEquation=101;p.SubtractiveBlending=3;p.TOUCH={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3};p.TangentSpaceNormalMap=0;p.TetrahedronBufferGeometry=Be;p.TetrahedronGeometry=Be;p.TextGeometry=function(){return console.error("THREE.TextGeometry has been moved to /examples/jsm/geometries/TextGeometry.js"),new ra};p.Texture=
mb;p.TextureLoader=Hh;p.TorusBufferGeometry=Ce;p.TorusGeometry=Ce;p.TorusKnotBufferGeometry=De;p.TorusKnotGeometry=De;p.Triangle=eb;p.TriangleFanDrawMode=2;p.TriangleStripDrawMode=1;p.TrianglesDrawMode=0;p.TubeBufferGeometry=ce;p.TubeGeometry=ce;p.UVMapping=300;p.Uint16Attribute=function(a,b){return console.warn("THREE.Uint16Attribute has been removed. Use new THREE.Uint16BufferAttribute() instead."),new Lf(a,b)};p.Uint16BufferAttribute=Lf;p.Uint32Attribute=function(a,b){return console.warn("THREE.Uint32Attribute has been removed. Use new THREE.Uint32BufferAttribute() instead."),
new Kf(a,b)};p.Uint32BufferAttribute=Kf;p.Uint8Attribute=function(a,b){return console.warn("THREE.Uint8Attribute has been removed. Use new THREE.Uint8BufferAttribute() instead."),new Hi(a,b)};p.Uint8BufferAttribute=Hi;p.Uint8ClampedAttribute=function(a,b){return console.warn("THREE.Uint8ClampedAttribute has been removed. Use new THREE.Uint8ClampedBufferAttribute() instead."),new Ii(a,b)};p.Uint8ClampedBufferAttribute=Ii;p.Uniform=Nh;p.UniformsLib=Ca;p.UniformsUtils=Gj;p.UnsignedByteType=1009;p.UnsignedInt248Type=
1020;p.UnsignedIntType=1014;p.UnsignedShort4444Type=1017;p.UnsignedShort5551Type=1018;p.UnsignedShort565Type=1019;p.UnsignedShortType=1012;p.VSMShadowMap=3;p.Vector2=T;p.Vector3=B;p.Vector4=za;p.VectorKeyframeTrack=$e;p.Vertex=function(a,b,c){return console.warn("THREE.Vertex has been removed. Use THREE.Vector3 instead."),new B(a,b,c)};p.VertexColors=2;p.VideoTexture=ng;p.WebGL1Renderer=Ti;p.WebGLCubeRenderTarget=ge;p.WebGLMultipleRenderTargets=bg;p.WebGLMultisampleRenderTarget=Sf;p.WebGLRenderTarget=
Rb;p.WebGLRenderTargetCube=function(a,b,c){return console.warn("THREE.WebGLRenderTargetCube( width, height, options ) is now WebGLCubeRenderTarget( size, options )."),new ge(a,c)};p.WebGLRenderer=wb;p.WebGLUtils=Lj;p.WireframeGeometry=Ch;p.WireframeHelper=function(a,b){return console.warn("THREE.WireframeHelper has been removed. Use THREE.WireframeGeometry instead."),new Ib(new Ch(a.geometry),new Pb({color:void 0!==b?b:16777215}))};p.WrapAroundEnding=2402;p.XHRLoader=function(a){return console.warn("THREE.XHRLoader has been renamed to THREE.FileLoader."),
new zc(a)};p.ZeroCurvatureEnding=2400;p.ZeroFactor=200;p.ZeroSlopeEnding=2401;p.ZeroStencilOp=0;p.sRGBEncoding=3001;Object.defineProperty(p,"__esModule",{value:!0})});(function(){function p(){var v={};return{get:function(z){return v[z]},add:function(z,F){v[z]=F},remove:function(z){delete v[z]},removeAll:function(){v={}}}}function N(v){void 0===v.DefaultMaterial&&(v.DefaultMaterial=new THREE.MeshStandardMaterial({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:THREE.FrontSide}));return v.DefaultMaterial}function R(v,z,F){for(var y in F.extensions)void 0===v[y]&&(z.userData.gltfExtensions=z.userData.gltfExtensions||{},z.userData.gltfExtensions[y]=
F.extensions[y])}function fa(v,z){void 0!==z.extras&&("object"===typeof z.extras?Object.assign(v.userData,z.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+z.extras))}function ka(v,z,F){for(var y=!1,L=!1,Q=0,U=z.length;Q<U;Q++){var X=z[Q];void 0!==X.POSITION&&(y=!0);void 0!==X.NORMAL&&(L=!0);if(y&&L)break}if(!y&&!L)return Promise.resolve(v);Q=[];U=[];X=0;for(var ta=z.length;X<ta;X++){var pa=z[X];if(y){var Ea=void 0!==pa.POSITION?F.getDependency("accessor",pa.POSITION):v.attributes.position;
Q.push(Ea)}L&&(pa=void 0!==pa.NORMAL?F.getDependency("accessor",pa.NORMAL):v.attributes.normal,U.push(pa))}return Promise.all([Promise.all(Q),Promise.all(U)]).then(function(Ya){var $a=Ya[0];Ya=Ya[1];y&&(v.morphAttributes.position=$a);L&&(v.morphAttributes.normal=Ya);v.morphTargetsRelative=!0;return v})}function cb(v){var z=v.extensions&&v.extensions[Ua.KHR_DRACO_MESH_COMPRESSION];return z?"draco:"+z.bufferView+":"+z.indices+":"+ia(z.attributes):v.indices+":"+ia(v.attributes)+":"+v.mode}function ia(v){for(var z=
"",F=Object.keys(v).sort(),y=0,L=F.length;y<L;y++)z+=F[y]+":"+v[F[y]]+";";return z}function Na(v){switch(v){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw Error("THREE.GLTFLoader: Unsupported normalized accessor component type.");}}function oa(v,z,F,y){var L=F.nodes[v];return y.getDependency("node",v).then(function(Q){if(void 0===L.skin)return Q;var U;return y.getDependency("skin",L.skin).then(function(X){U=X;X=
[];for(var ta=0,pa=U.joints.length;ta<pa;ta++)X.push(y.getDependency("node",U.joints[ta]));return Promise.all(X)}).then(function(X){Q.traverse(function(ta){if(ta.isMesh){for(var pa=[],Ea=[],Ya=0,$a=X.length;Ya<$a;Ya++){var nb=X[Ya];nb?(pa.push(nb),nb=new THREE.Matrix4,void 0!==U.inverseBindMatrices&&nb.fromArray(U.inverseBindMatrices.array,16*Ya),Ea.push(nb)):console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',U.joints[Ya])}ta.bind(new THREE.Skeleton(pa,Ea),ta.matrixWorld)}});return Q})}).then(function(Q){z.add(Q);
var U=[];if(L.children)for(var X=L.children,ta=0,pa=X.length;ta<pa;ta++)U.push(oa(X[ta],Q,F,y));return Promise.all(U)})}function sa(v,z,F){var y=z.attributes,L=new THREE.Box3;if(void 0!==y.POSITION){y=F.json.accessors[y.POSITION];var Q=y.min,U=y.max;if(void 0!==Q&&void 0!==U){L.set(new THREE.Vector3(Q[0],Q[1],Q[2]),new THREE.Vector3(U[0],U[1],U[2]));y.normalized&&(y=Na(je[y.componentType]),L.min.multiplyScalar(y),L.max.multiplyScalar(y));z=z.targets;if(void 0!==z){y=new THREE.Vector3;Q=new THREE.Vector3;
U=0;for(var X=z.length;U<X;U++){var ta=z[U];if(void 0!==ta.POSITION){ta=F.json.accessors[ta.POSITION];var pa=ta.min,Ea=ta.max;void 0!==pa&&void 0!==Ea?(Q.setX(Math.max(Math.abs(pa[0]),Math.abs(Ea[0]))),Q.setY(Math.max(Math.abs(pa[1]),Math.abs(Ea[1]))),Q.setZ(Math.max(Math.abs(pa[2]),Math.abs(Ea[2]))),ta.normalized&&(ta=Na(je[ta.componentType]),Q.multiplyScalar(ta)),y.max(Q)):console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}L.expandByVector(y)}v.boundingBox=L;F=
new THREE.Sphere;L.getCenter(F.center);F.radius=L.min.distanceTo(L.max)/2;v.boundingSphere=F}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}function xa(v,z,F){function y(ta,pa){return F.getDependency("accessor",ta).then(function(Ea){v.setAttribute(pa,Ea)})}var L=z.attributes,Q=[],U;for(U in L){var X=Mf[U]||U.toLowerCase();X in v.attributes||Q.push(y(L[U],X))}void 0===z.indices||v.index||(L=F.getDependency("accessor",z.indices).then(function(ta){v.setIndex(ta)}),
Q.push(L));fa(v,z);sa(v,z,F);return Promise.all(Q).then(function(){return void 0!==z.targets?ka(v,z.targets,F):v})}function bb(v,z){var F=v.getIndex();if(null===F){var y=[];F=v.getAttribute("position");if(void 0!==F){for(var L=0;L<F.count;L++)y.push(L);v.setIndex(y);F=v.getIndex()}else return console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),v}L=F.count-2;y=[];if(z===THREE.TriangleFanDrawMode)for(z=1;z<=L;z++)y.push(F.getX(0)),y.push(F.getX(z)),
y.push(F.getX(z+1));else for(z=0;z<L;z++)0===z%2?(y.push(F.getX(z)),y.push(F.getX(z+1)),y.push(F.getX(z+2))):(y.push(F.getX(z+2)),y.push(F.getX(z+1)),y.push(F.getX(z)));y.length/3!==L&&console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");v=v.clone();v.setIndex(y);return v}var qb=function(v){v=THREE.Loader.call(this,v)||this;v.dracoLoader=null;v.ktx2Loader=null;v.meshoptDecoder=null;v.pluginCallbacks=[];v.register(function(z){return new Fd(z)});v.register(function(z){return new Mg(z)});
v.register(function(z){return new Gf(z)});v.register(function(z){return new $c(z)});v.register(function(z){return new Ub(z)});v.register(function(z){return new Te(z)});v.register(function(z){return new Ef(z)});v.register(function(z){return new Ff(z)});v.register(function(z){return new Hc(z)});v.register(function(z){return new Ng(z)});return v};$jscomp.inherits(qb,THREE.Loader);qb.prototype.load=function(v,z,F,y){var L=this;var Q=""!==this.resourcePath?this.resourcePath:""!==this.path?this.path:THREE.LoaderUtils.extractUrlBase(v);
this.manager.itemStart(v);var U=function(ta){y?y(ta):console.error(ta);L.manager.itemError(v);L.manager.itemEnd(v)},X=new THREE.FileLoader(this.manager);X.setPath(this.path);X.setResponseType("arraybuffer");X.setRequestHeader(this.requestHeader);X.setWithCredentials(this.withCredentials);X.load(v,function(ta){try{L.parse(ta,Q,function(pa){z(pa);L.manager.itemEnd(v)},U)}catch(pa){U(pa)}},F,U)};qb.prototype.setDRACOLoader=function(v){this.dracoLoader=v;return this};qb.prototype.setDDSLoader=function(){throw Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".');
};qb.prototype.setKTX2Loader=function(v){this.ktx2Loader=v;return this};qb.prototype.setMeshoptDecoder=function(v){this.meshoptDecoder=v;return this};qb.prototype.register=function(v){-1===this.pluginCallbacks.indexOf(v)&&this.pluginCallbacks.push(v);return this};qb.prototype.unregister=function(v){-1!==this.pluginCallbacks.indexOf(v)&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(v),1);return this};qb.prototype.parse=function(v,z,F,y){var L={},Q={};if("string"!==typeof v)if("glTF"===THREE.LoaderUtils.decodeText(new Uint8Array(v,
0,4))){try{L[Ua.KHR_BINARY_GLTF]=new ci(v)}catch(pa){y&&y(pa);return}v=L[Ua.KHR_BINARY_GLTF].content}else v=THREE.LoaderUtils.decodeText(new Uint8Array(v));v=JSON.parse(v);if(void 0===v.asset||2>v.asset.version[0])y&&y(Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));else{z=new rb(v,{path:z||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});z.fileLoader.setRequestHeader(this.requestHeader);
for(var U=0;U<this.pluginCallbacks.length;U++){var X=this.pluginCallbacks[U](z);Q[X.name]=X;L[X.name]=!0}if(v.extensionsUsed)for(U=0;U<v.extensionsUsed.length;++U){X=v.extensionsUsed[U];var ta=v.extensionsRequired||[];switch(X){case Ua.KHR_MATERIALS_UNLIT:L[X]=new Pc;break;case Ua.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:L[X]=new he;break;case Ua.KHR_DRACO_MESH_COMPRESSION:L[X]=new Og(v,this.dracoLoader);break;case Ua.KHR_TEXTURE_TRANSFORM:L[X]=new Hf;break;case Ua.KHR_MESH_QUANTIZATION:L[X]=new Pg;
break;default:0<=ta.indexOf(X)&&void 0===Q[X]&&console.warn('THREE.GLTFLoader: Unknown extension "'+X+'".')}}z.setExtensions(L);z.setPlugins(Q);z.parse(F,y)}};var Ua={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:"KHR_materials_pbrSpecularGlossiness",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",
KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression"},Hc=function(v){this.parser=v;this.name=Ua.KHR_LIGHTS_PUNCTUAL;this.cache={refs:{},uses:{}}};
Hc.prototype._markDefs=function(){for(var v=this.parser,z=this.parser.json.nodes||[],F=0,y=z.length;F<y;F++){var L=z[F];L.extensions&&L.extensions[this.name]&&void 0!==L.extensions[this.name].light&&v._addNodeRef(this.cache,L.extensions[this.name].light)}};Hc.prototype._loadLight=function(v){var z=this.parser,F="light:"+v,y=z.cache.get(F);if(y)return y;y=z.json;y=((y.extensions&&y.extensions[this.name]||{}).lights||[])[v];var L=new THREE.Color(16777215);void 0!==y.color&&L.fromArray(y.color);var Q=
void 0!==y.range?y.range:0;switch(y.type){case "directional":L=new THREE.DirectionalLight(L);L.target.position.set(0,0,-1);L.add(L.target);break;case "point":L=new THREE.PointLight(L);L.distance=Q;break;case "spot":L=new THREE.SpotLight(L);L.distance=Q;y.spot=y.spot||{};y.spot.innerConeAngle=void 0!==y.spot.innerConeAngle?y.spot.innerConeAngle:0;y.spot.outerConeAngle=void 0!==y.spot.outerConeAngle?y.spot.outerConeAngle:Math.PI/4;L.angle=y.spot.outerConeAngle;L.penumbra=1-y.spot.innerConeAngle/y.spot.outerConeAngle;
L.target.position.set(0,0,-1);L.add(L.target);break;default:throw Error("THREE.GLTFLoader: Unexpected light type: "+y.type);}L.position.set(0,0,0);L.decay=2;void 0!==y.intensity&&(L.intensity=y.intensity);L.name=z.createUniqueName(y.name||"light_"+v);y=Promise.resolve(L);z.cache.add(F,y);return y};Hc.prototype.createNodeAttachment=function(v){var z=this,F=this.parser;v=F.json.nodes[v];var y=(v.extensions&&v.extensions[this.name]||{}).light;return void 0===y?null:this._loadLight(y).then(function(L){return F._getNodeRef(z.cache,
y,L)})};var Pc=function(){this.name=Ua.KHR_MATERIALS_UNLIT};Pc.prototype.getMaterialType=function(){return THREE.MeshBasicMaterial};Pc.prototype.extendParams=function(v,z,F){var y=[];v.color=new THREE.Color(1,1,1);v.opacity=1;if(z=z.pbrMetallicRoughness){if(Array.isArray(z.baseColorFactor)){var L=z.baseColorFactor;v.color.fromArray(L);v.opacity=L[3]}void 0!==z.baseColorTexture&&y.push(F.assignTexture(v,"map",z.baseColorTexture))}return Promise.all(y)};var Fd=function(v){this.parser=v;this.name=Ua.KHR_MATERIALS_CLEARCOAT};
Fd.prototype.getMaterialType=function(v){v=this.parser.json.materials[v];return v.extensions&&v.extensions[this.name]?THREE.MeshPhysicalMaterial:null};Fd.prototype.extendMaterialParams=function(v,z){var F=this.parser,y=F.json.materials[v];if(!y.extensions||!y.extensions[this.name])return Promise.resolve();v=[];y=y.extensions[this.name];void 0!==y.clearcoatFactor&&(z.clearcoat=y.clearcoatFactor);void 0!==y.clearcoatTexture&&v.push(F.assignTexture(z,"clearcoatMap",y.clearcoatTexture));void 0!==y.clearcoatRoughnessFactor&&
(z.clearcoatRoughness=y.clearcoatRoughnessFactor);void 0!==y.clearcoatRoughnessTexture&&v.push(F.assignTexture(z,"clearcoatRoughnessMap",y.clearcoatRoughnessTexture));void 0!==y.clearcoatNormalTexture&&(v.push(F.assignTexture(z,"clearcoatNormalMap",y.clearcoatNormalTexture)),void 0!==y.clearcoatNormalTexture.scale&&(F=y.clearcoatNormalTexture.scale,z.clearcoatNormalScale=new THREE.Vector2(F,F)));return Promise.all(v)};var $c=function(v){this.parser=v;this.name=Ua.KHR_MATERIALS_SHEEN};$c.prototype.getMaterialType=
function(v){v=this.parser.json.materials[v];return v.extensions&&v.extensions[this.name]?THREE.MeshPhysicalMaterial:null};$c.prototype.extendMaterialParams=function(v,z){var F=this.parser,y=F.json.materials[v];if(!y.extensions||!y.extensions[this.name])return Promise.resolve();v=[];z.sheenColor=new THREE.Color(0,0,0);z.sheenRoughness=0;z.sheen=1;y=y.extensions[this.name];void 0!==y.sheenColorFactor&&z.sheenColor.fromArray(y.sheenColorFactor);void 0!==y.sheenRoughnessFactor&&(z.sheenRoughness=y.sheenRoughnessFactor);
void 0!==y.sheenColorTexture&&v.push(F.assignTexture(z,"sheenColorMap",y.sheenColorTexture));void 0!==y.sheenRoughnessTexture&&v.push(F.assignTexture(z,"sheenRoughnessMap",y.sheenRoughnessTexture));return Promise.all(v)};var Ub=function(v){this.parser=v;this.name=Ua.KHR_MATERIALS_TRANSMISSION};Ub.prototype.getMaterialType=function(v){v=this.parser.json.materials[v];return v.extensions&&v.extensions[this.name]?THREE.MeshPhysicalMaterial:null};Ub.prototype.extendMaterialParams=function(v,z){var F=this.parser,
y=F.json.materials[v];if(!y.extensions||!y.extensions[this.name])return Promise.resolve();v=[];y=y.extensions[this.name];void 0!==y.transmissionFactor&&(z.transmission=y.transmissionFactor);void 0!==y.transmissionTexture&&v.push(F.assignTexture(z,"transmissionMap",y.transmissionTexture));return Promise.all(v)};var Te=function(v){this.parser=v;this.name=Ua.KHR_MATERIALS_VOLUME};Te.prototype.getMaterialType=function(v){v=this.parser.json.materials[v];return v.extensions&&v.extensions[this.name]?THREE.MeshPhysicalMaterial:
null};Te.prototype.extendMaterialParams=function(v,z){var F=this.parser,y=F.json.materials[v];if(!y.extensions||!y.extensions[this.name])return Promise.resolve();v=[];y=y.extensions[this.name];z.thickness=void 0!==y.thicknessFactor?y.thicknessFactor:0;void 0!==y.thicknessTexture&&v.push(F.assignTexture(z,"thicknessMap",y.thicknessTexture));z.attenuationDistance=y.attenuationDistance||0;F=y.attenuationColor||[1,1,1];z.attenuationColor=new THREE.Color(F[0],F[1],F[2]);return Promise.all(v)};var Ef=function(v){this.parser=
v;this.name=Ua.KHR_MATERIALS_IOR};Ef.prototype.getMaterialType=function(v){v=this.parser.json.materials[v];return v.extensions&&v.extensions[this.name]?THREE.MeshPhysicalMaterial:null};Ef.prototype.extendMaterialParams=function(v,z){v=this.parser.json.materials[v];if(!v.extensions||!v.extensions[this.name])return Promise.resolve();v=v.extensions[this.name];z.ior=void 0!==v.ior?v.ior:1.5;return Promise.resolve()};var Ff=function(v){this.parser=v;this.name=Ua.KHR_MATERIALS_SPECULAR};Ff.prototype.getMaterialType=
function(v){v=this.parser.json.materials[v];return v.extensions&&v.extensions[this.name]?THREE.MeshPhysicalMaterial:null};Ff.prototype.extendMaterialParams=function(v,z){var F=this.parser,y=F.json.materials[v];if(!y.extensions||!y.extensions[this.name])return Promise.resolve();v=[];y=y.extensions[this.name];z.specularIntensity=void 0!==y.specularFactor?y.specularFactor:1;void 0!==y.specularTexture&&v.push(F.assignTexture(z,"specularIntensityMap",y.specularTexture));var L=y.specularColorFactor||[1,
1,1];z.specularColor=new THREE.Color(L[0],L[1],L[2]);void 0!==y.specularColorTexture&&v.push(F.assignTexture(z,"specularColorMap",y.specularColorTexture).then(function(Q){Q.encoding=THREE.sRGBEncoding}));return Promise.all(v)};var Mg=function(v){this.parser=v;this.name=Ua.KHR_TEXTURE_BASISU};Mg.prototype.loadTexture=function(v){var z=this.parser,F=z.json,y=F.textures[v];if(!y.extensions||!y.extensions[this.name])return null;y=F.images[y.extensions[this.name].source];var L=z.options.ktx2Loader;if(!L){if(F.extensionsRequired&&
0<=F.extensionsRequired.indexOf(this.name))throw Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return z.loadTextureImage(v,y,L)};var Gf=function(v){this.parser=v;this.name=Ua.EXT_TEXTURE_WEBP;this.isSupported=null};Gf.prototype.loadTexture=function(v){var z=this.name,F=this.parser,y=F.json,L=y.textures[v];if(!L.extensions||!L.extensions[z])return null;var Q=y.images[L.extensions[z].source],U=F.textureLoader;Q.uri&&(L=F.options.manager.getHandler(Q.uri),
null!==L&&(U=L));return this.detectSupport().then(function(X){if(X)return F.loadTextureImage(v,Q,U);if(y.extensionsRequired&&0<=y.extensionsRequired.indexOf(z))throw Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return F.loadTexture(v)})};Gf.prototype.detectSupport=function(){this.isSupported||(this.isSupported=new Promise(function(v){var z=new Image;z.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA";z.onload=z.onerror=function(){v(1===z.height)}}));
return this.isSupported};var Ng=function(v){this.name=Ua.EXT_MESHOPT_COMPRESSION;this.parser=v};Ng.prototype.loadBufferView=function(v){var z=this.parser.json;v=z.bufferViews[v];if(v.extensions&&v.extensions[this.name]){var F=v.extensions[this.name];v=this.parser.getDependency("buffer",F.buffer);var y=this.parser.options.meshoptDecoder;if(!y||!y.supported){if(z.extensionsRequired&&0<=z.extensionsRequired.indexOf(this.name))throw Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");
return null}return Promise.all([v,y.ready]).then(function(L){var Q=F.byteOffset||0,U=F.byteLength||0,X=F.count,ta=F.byteStride,pa=new ArrayBuffer(X*ta);L=new Uint8Array(L[0],Q,U);y.decodeGltfBuffer(new Uint8Array(pa),X,ta,L,F.mode,F.filter);return pa})}return null};var ci=function(v){this.name=Ua.KHR_BINARY_GLTF;this.body=this.content=null;var z=new DataView(v,0,12);this.header={magic:THREE.LoaderUtils.decodeText(new Uint8Array(v.slice(0,4))),version:z.getUint32(4,!0),length:z.getUint32(8,!0)};if("glTF"!==
this.header.magic)throw Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(2>this.header.version)throw Error("THREE.GLTFLoader: Legacy binary file detected.");z=this.header.length-12;for(var F=new DataView(v,12),y=0;y<z;){var L=F.getUint32(y,!0);y+=4;var Q=F.getUint32(y,!0);y+=4;1313821514===Q?(Q=new Uint8Array(v,12+y,L),this.content=THREE.LoaderUtils.decodeText(Q)):5130562===Q&&(Q=12+y,this.body=v.slice(Q,Q+L));y+=L}if(null===this.content)throw Error("THREE.GLTFLoader: JSON content not found.");
},Og=function(v,z){if(!z)throw Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=Ua.KHR_DRACO_MESH_COMPRESSION;this.json=v;this.dracoLoader=z;this.dracoLoader.preload()};Og.prototype.decodePrimitive=function(v,z){var F=this.json,y=this.dracoLoader,L=v.extensions[this.name].bufferView,Q=v.extensions[this.name].attributes,U={},X={},ta={};for(Ya in Q){var pa=Mf[Ya]||Ya.toLowerCase();U[pa]=Q[Ya]}for(var Ea in v.attributes){var Ya=Mf[Ea]||Ea.toLowerCase();void 0!==Q[Ea]&&(pa=F.accessors[v.attributes[Ea]],
ta[Ya]=je[pa.componentType],X[Ya]=!0===pa.normalized)}return z.getDependency("bufferView",L).then(function($a){return new Promise(function(nb){y.decodeDracoFile($a,function(gb){for(var Lb in gb.attributes){var Mb=gb.attributes[Lb],rc=X[Lb];void 0!==rc&&(Mb.normalized=rc)}nb(gb)},U,ta)})})};var Hf=function(){this.name=Ua.KHR_TEXTURE_TRANSFORM};Hf.prototype.extendTexture=function(v,z){void 0!==z.texCoord&&console.warn('THREE.GLTFLoader: Custom UV sets in "'+this.name+'" extension not yet supported.');
if(void 0===z.offset&&void 0===z.rotation&&void 0===z.scale)return v;v=v.clone();void 0!==z.offset&&v.offset.fromArray(z.offset);void 0!==z.rotation&&(v.rotation=z.rotation);void 0!==z.scale&&v.repeat.fromArray(z.scale);v.needsUpdate=!0;return v};var cd=function(v){var z=THREE.MeshStandardMaterial.call(this)||this;z.isGLTFSpecularGlossinessMaterial=!0;var F={specular:{value:(new THREE.Color).setHex(16777215)},glossiness:{value:1},specularMap:{value:null},glossinessMap:{value:null}};z._extraUniforms=
F;z.onBeforeCompile=function(y){for(var L in F)y.uniforms[L]=F[L];y.fragmentShader=y.fragmentShader.replace("uniform float roughness;","uniform vec3 specular;").replace("uniform float metalness;","uniform float glossiness;").replace("#include <roughnessmap_pars_fragment>","#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif").replace("#include <metalnessmap_pars_fragment>","#ifdef USE_GLOSSINESSMAP\n\tuniform sampler2D glossinessMap;\n#endif").replace("#include <roughnessmap_fragment>",
"vec3 specularFactor = specular;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\ttexelSpecular = sRGBToLinear( texelSpecular );\n\t// reads channel RGB, compatible with a glTF Specular-Glossiness (RGBA) texture\n\tspecularFactor *= texelSpecular.rgb;\n#endif").replace("#include <metalnessmap_fragment>","float glossinessFactor = glossiness;\n#ifdef USE_GLOSSINESSMAP\n\tvec4 texelGlossiness = texture2D( glossinessMap, vUv );\n\t// reads channel A, compatible with a glTF Specular-Glossiness (RGBA) texture\n\tglossinessFactor *= texelGlossiness.a;\n#endif").replace("#include <lights_physical_fragment>",
"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1. - max( specularFactor.r, max( specularFactor.g, specularFactor.b ) ) );\nvec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.roughness = max( 1.0 - glossinessFactor, 0.0525 ); // 0.0525 corresponds to the base mip of a 256 cubemap.\nmaterial.roughness += geometryRoughness;\nmaterial.roughness = min( material.roughness, 1.0 );\nmaterial.specularColor = specularFactor;")};
Object.defineProperties(z,{specular:{get:function(){return F.specular.value},set:function(y){F.specular.value=y}},specularMap:{get:function(){return F.specularMap.value},set:function(y){(F.specularMap.value=y)?this.defines.USE_SPECULARMAP="":delete this.defines.USE_SPECULARMAP}},glossiness:{get:function(){return F.glossiness.value},set:function(y){F.glossiness.value=y}},glossinessMap:{get:function(){return F.glossinessMap.value},set:function(y){(F.glossinessMap.value=y)?(this.defines.USE_GLOSSINESSMAP=
"",this.defines.USE_UV=""):(delete this.defines.USE_GLOSSINESSMAP,delete this.defines.USE_UV)}}});delete z.metalness;delete z.roughness;delete z.metalnessMap;delete z.roughnessMap;z.setValues(v);return z};$jscomp.inherits(cd,THREE.MeshStandardMaterial);cd.prototype.copy=function(v){THREE.MeshStandardMaterial.prototype.copy.call(this,v);this.specularMap=v.specularMap;this.specular.copy(v.specular);this.glossinessMap=v.glossinessMap;this.glossiness=v.glossiness;delete this.metalness;delete this.roughness;
delete this.metalnessMap;delete this.roughnessMap;return this};var he=function(){this.name=Ua.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS;this.specularGlossinessParams="color map lightMap lightMapIntensity aoMap aoMapIntensity emissive emissiveIntensity emissiveMap bumpMap bumpScale normalMap normalMapType displacementMap displacementScale displacementBias specularMap specular glossinessMap glossiness alphaMap envMap envMapIntensity refractionRatio".split(" ")};he.prototype.getMaterialType=function(){return cd};
he.prototype.extendParams=function(v,z,F){var y=z.extensions[this.name];v.color=new THREE.Color(1,1,1);v.opacity=1;z=[];if(Array.isArray(y.diffuseFactor)){var L=y.diffuseFactor;v.color.fromArray(L);v.opacity=L[3]}void 0!==y.diffuseTexture&&z.push(F.assignTexture(v,"map",y.diffuseTexture));v.emissive=new THREE.Color(0,0,0);v.glossiness=void 0!==y.glossinessFactor?y.glossinessFactor:1;v.specular=new THREE.Color(1,1,1);Array.isArray(y.specularFactor)&&v.specular.fromArray(y.specularFactor);void 0!==
y.specularGlossinessTexture&&(y=y.specularGlossinessTexture,z.push(F.assignTexture(v,"glossinessMap",y)),z.push(F.assignTexture(v,"specularMap",y)));return Promise.all(z)};he.prototype.createMaterial=function(v){var z=new cd(v);z.fog=!0;z.color=v.color;z.map=void 0===v.map?null:v.map;z.lightMap=null;z.lightMapIntensity=1;z.aoMap=void 0===v.aoMap?null:v.aoMap;z.aoMapIntensity=1;z.emissive=v.emissive;z.emissiveIntensity=1;z.emissiveMap=void 0===v.emissiveMap?null:v.emissiveMap;z.bumpMap=void 0===v.bumpMap?
null:v.bumpMap;z.bumpScale=1;z.normalMap=void 0===v.normalMap?null:v.normalMap;z.normalMapType=THREE.TangentSpaceNormalMap;v.normalScale&&(z.normalScale=v.normalScale);z.displacementMap=null;z.displacementScale=1;z.displacementBias=0;z.specularMap=void 0===v.specularMap?null:v.specularMap;z.specular=v.specular;z.glossinessMap=void 0===v.glossinessMap?null:v.glossinessMap;z.glossiness=v.glossiness;z.alphaMap=null;z.envMap=void 0===v.envMap?null:v.envMap;z.envMapIntensity=1;z.refractionRatio=.98;return z};
var Pg=function(){this.name=Ua.KHR_MESH_QUANTIZATION},qc=function(v,z,F,y){return THREE.Interpolant.call(this,v,z,F,y)||this};$jscomp.inherits(qc,THREE.Interpolant);qc.prototype.copySampleValue_=function(v){var z=this.resultBuffer,F=this.sampleValues,y=this.valueSize;v=v*y*3+y;for(var L=0;L!==y;L++)z[L]=F[v+L];return z};qc.prototype.beforeStart_=qc.prototype.copySampleValue_;qc.prototype.afterEnd_=qc.prototype.copySampleValue_;qc.prototype.interpolate_=function(v,z,F,y){var L=this.resultBuffer,Q=
this.sampleValues,U=this.valueSize,X=2*U,ta=3*U;y-=z;z=(F-z)/y;F=z*z;var pa=F*z;v*=ta;ta=v-ta;var Ea=-2*pa+3*F;pa-=F;var Ya=1-Ea;z=pa-F+z;for(F=0;F!==U;F++)L[F]=Ya*Q[ta+F+U]+z*Q[ta+F+X]*y+Ea*Q[v+F+U]+pa*Q[v+F]*y;return L};var If=new THREE.Quaternion,Jf=function(){return qc.apply(this,arguments)||this};$jscomp.inherits(Jf,qc);Jf.prototype.interpolate_=function(v,z,F,y){v=qc.prototype.interpolate_.call(this,v,z,F,y);If.fromArray(v).normalize().toArray(v);return v};var je={5120:Int8Array,5121:Uint8Array,
5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},Qg={9728:THREE.NearestFilter,9729:THREE.LinearFilter,9984:THREE.NearestMipmapNearestFilter,9985:THREE.LinearMipmapNearestFilter,9986:THREE.NearestMipmapLinearFilter,9987:THREE.LinearMipmapLinearFilter},Rg={33071:THREE.ClampToEdgeWrapping,33648:THREE.MirroredRepeatWrapping,10497:THREE.RepeatWrapping},Sg={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},Mf={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",
TEXCOORD_1:"uv2",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},Id={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},Tg={CUBICSPLINE:void 0,LINEAR:THREE.InterpolateLinear,STEP:THREE.InterpolateDiscrete},rb=function(v,z){v=void 0===v?{}:v;z=void 0===z?{}:z;this.json=v;this.extensions={};this.plugins={};this.options=z;this.cache=new p;this.associations=new Map;this.primitiveCache={};this.meshCache={refs:{},uses:{}};this.cameraCache={refs:{},uses:{}};
this.lightCache={refs:{},uses:{}};this.textureCache={};this.nodeNamesUsed={};"undefined"!==typeof createImageBitmap&&!1===/Firefox/.test(navigator.userAgent)?this.textureLoader=new THREE.ImageBitmapLoader(this.options.manager):this.textureLoader=new THREE.TextureLoader(this.options.manager);this.textureLoader.setCrossOrigin(this.options.crossOrigin);this.textureLoader.setRequestHeader(this.options.requestHeader);this.fileLoader=new THREE.FileLoader(this.options.manager);this.fileLoader.setResponseType("arraybuffer");
"use-credentials"===this.options.crossOrigin&&this.fileLoader.setWithCredentials(!0)};rb.prototype.setExtensions=function(v){this.extensions=v};rb.prototype.setPlugins=function(v){this.plugins=v};rb.prototype.parse=function(v,z){var F=this,y=this.json,L=this.extensions;this.cache.removeAll();this._invokeAll(function(Q){return Q._markDefs&&Q._markDefs()});Promise.all(this._invokeAll(function(Q){return Q.beforeRoot&&Q.beforeRoot()})).then(function(){return Promise.all([F.getDependencies("scene"),F.getDependencies("animation"),
F.getDependencies("camera")])}).then(function(Q){var U={scene:Q[0][y.scene||0],scenes:Q[0],animations:Q[1],cameras:Q[2],asset:y.asset,parser:F,userData:{}};R(L,U,y);fa(U,y);Promise.all(F._invokeAll(function(X){return X.afterRoot&&X.afterRoot(U)})).then(function(){v(U)})}).catch(z)};rb.prototype._markDefs=function(){for(var v=this.json.nodes||[],z=this.json.skins||[],F=this.json.meshes||[],y=0,L=z.length;y<L;y++)for(var Q=z[y].joints,U=0,X=Q.length;U<X;U++)v[Q[U]].isBone=!0;z=0;for(y=v.length;z<y;z++)L=
v[z],void 0!==L.mesh&&(this._addNodeRef(this.meshCache,L.mesh),void 0!==L.skin&&(F[L.mesh].isSkinnedMesh=!0)),void 0!==L.camera&&this._addNodeRef(this.cameraCache,L.camera)};rb.prototype._addNodeRef=function(v,z){void 0!==z&&(void 0===v.refs[z]&&(v.refs[z]=v.uses[z]=0),v.refs[z]++)};rb.prototype._getNodeRef=function(v,z,F){var y=this;if(1>=v.refs[z])return F;var L=F.clone(),Q=function(U,X){var ta=y.associations.get(U);null!=ta&&y.associations.set(X,ta);U=$jscomp.makeIterator(U.children.entries());
for(ta=U.next();!ta.done;ta=U.next()){var pa=$jscomp.makeIterator(ta.value);ta=pa.next().value;pa=pa.next().value;Q(pa,X.children[ta])}};Q(F,L);L.name+="_instance_"+v.uses[z]++;return L};rb.prototype._invokeOne=function(v){var z=Object.values(this.plugins);z.push(this);for(var F=0;F<z.length;F++){var y=v(z[F]);if(y)return y}return null};rb.prototype._invokeAll=function(v){var z=Object.values(this.plugins);z.unshift(this);for(var F=[],y=0;y<z.length;y++){var L=v(z[y]);L&&F.push(L)}return F};rb.prototype.getDependency=
function(v,z){var F=v+":"+z,y=this.cache.get(F);if(!y){switch(v){case "scene":y=this.loadScene(z);break;case "node":y=this.loadNode(z);break;case "mesh":y=this._invokeOne(function(L){return L.loadMesh&&L.loadMesh(z)});break;case "accessor":y=this.loadAccessor(z);break;case "bufferView":y=this._invokeOne(function(L){return L.loadBufferView&&L.loadBufferView(z)});break;case "buffer":y=this.loadBuffer(z);break;case "material":y=this._invokeOne(function(L){return L.loadMaterial&&L.loadMaterial(z)});break;
case "texture":y=this._invokeOne(function(L){return L.loadTexture&&L.loadTexture(z)});break;case "skin":y=this.loadSkin(z);break;case "animation":y=this.loadAnimation(z);break;case "camera":y=this.loadCamera(z);break;default:throw Error("Unknown type: "+v);}this.cache.add(F,y)}return y};rb.prototype.getDependencies=function(v){var z=this.cache.get(v);if(!z){var F=this;z=Promise.all((this.json[v+("mesh"===v?"es":"s")]||[]).map(function(y,L){return F.getDependency(v,L)}));this.cache.add(v,z)}return z};
rb.prototype.loadBuffer=function(v){var z=this.json.buffers[v],F=this.fileLoader;if(z.type&&"arraybuffer"!==z.type)throw Error("THREE.GLTFLoader: "+z.type+" buffer type is not supported.");if(void 0===z.uri&&0===v)return Promise.resolve(this.extensions[Ua.KHR_BINARY_GLTF].body);var y=this.options;return new Promise(function(L,Q){F.load(THREE.LoaderUtils.resolveURL(z.uri,y.path),L,void 0,function(){Q(Error('THREE.GLTFLoader: Failed to load buffer "'+z.uri+'".'))})})};rb.prototype.loadBufferView=function(v){var z=
this.json.bufferViews[v];return this.getDependency("buffer",z.buffer).then(function(F){var y=z.byteOffset||0;return F.slice(y,y+(z.byteLength||0))})};rb.prototype.loadAccessor=function(v){var z=this,F=this.json,y=this.json.accessors[v];if(void 0===y.bufferView&&void 0===y.sparse)return Promise.resolve(null);v=[];void 0!==y.bufferView?v.push(this.getDependency("bufferView",y.bufferView)):v.push(null);void 0!==y.sparse&&(v.push(this.getDependency("bufferView",y.sparse.indices.bufferView)),v.push(this.getDependency("bufferView",
y.sparse.values.bufferView)));return Promise.all(v).then(function(L){var Q=L[0],U=Sg[y.type],X=je[y.componentType],ta=X.BYTES_PER_ELEMENT,pa=y.byteOffset||0,Ea=void 0!==y.bufferView?F.bufferViews[y.bufferView].byteStride:void 0,Ya=!0===y.normalized;if(Ea&&Ea!==ta*U){var $a=Math.floor(pa/Ea);var nb="InterleavedBuffer:"+y.bufferView+":"+y.componentType+":"+$a+":"+y.count,gb=z.cache.get(nb);gb||($a=new X(Q,$a*Ea,y.count*Ea/ta),gb=new THREE.InterleavedBuffer($a,Ea/ta),z.cache.add(nb,gb));ta=new THREE.InterleavedBufferAttribute(gb,
U,pa%Ea/ta,Ya)}else $a=null===Q?new X(y.count*U):new X(Q,pa,y.count*U),ta=new THREE.BufferAttribute($a,U,Ya);if(void 0!==y.sparse)for(Ea=y.sparse.values.byteOffset||0,pa=new je[y.sparse.indices.componentType](L[1],y.sparse.indices.byteOffset||0,y.sparse.count*Sg.SCALAR),L=new X(L[2],Ea,y.sparse.count*U),null!==Q&&(ta=new THREE.BufferAttribute(ta.array.slice(),ta.itemSize,ta.normalized)),Q=0,X=pa.length;Q<X;Q++)if(Ea=pa[Q],ta.setX(Ea,L[Q*U]),2<=U&&ta.setY(Ea,L[Q*U+1]),3<=U&&ta.setZ(Ea,L[Q*U+2]),4<=
U&&ta.setW(Ea,L[Q*U+3]),5<=U)throw Error("THREE.GLTFLoader: Unsupported itemSize in sparse THREE.BufferAttribute.");return ta})};rb.prototype.loadTexture=function(v){var z=this.json,F=this.options;z=z.images[z.textures[v].source];var y=this.textureLoader;z.uri&&(F=F.manager.getHandler(z.uri),null!==F&&(y=F));return this.loadTextureImage(v,z,y)};rb.prototype.loadTextureImage=function(v,z,F){var y=this,L=this.json,Q=this.options,U=L.textures[v],X=(z.uri||z.bufferView)+":"+U.sampler;if(this.textureCache[X])return this.textureCache[X];
var ta=self.URL||self.webkitURL,pa=z.uri||"",Ea=!1;if(void 0!==z.bufferView)pa=y.getDependency("bufferView",z.bufferView).then(function($a){Ea=!0;$a=new Blob([$a],{type:z.mimeType});return pa=ta.createObjectURL($a)});else if(void 0===z.uri)throw Error("THREE.GLTFLoader: Image "+v+" is missing URI and bufferView");var Ya=Promise.resolve(pa).then(function($a){return new Promise(function(nb,gb){var Lb=nb;!0===F.isImageBitmapLoader&&(Lb=function(Mb){Mb=new THREE.Texture(Mb);Mb.needsUpdate=!0;nb(Mb)});
F.load(THREE.LoaderUtils.resolveURL($a,Q.path),Lb,void 0,gb)})}).then(function($a){!0===Ea&&ta.revokeObjectURL(pa);$a.flipY=!1;U.name&&($a.name=U.name);var nb=(L.samplers||{})[U.sampler]||{};$a.magFilter=Qg[nb.magFilter]||THREE.LinearFilter;$a.minFilter=Qg[nb.minFilter]||THREE.LinearMipmapLinearFilter;$a.wrapS=Rg[nb.wrapS]||THREE.RepeatWrapping;$a.wrapT=Rg[nb.wrapT]||THREE.RepeatWrapping;y.associations.set($a,{textures:v});return $a}).catch(function(){console.error("THREE.GLTFLoader: Couldn't load texture",
pa);return null});return this.textureCache[X]=Ya};rb.prototype.assignTexture=function(v,z,F){var y=this;return this.getDependency("texture",F.index).then(function(L){void 0===F.texCoord||0==F.texCoord||"aoMap"===z&&1==F.texCoord||console.warn("THREE.GLTFLoader: Custom UV set "+F.texCoord+" for texture "+z+" not yet supported.");if(y.extensions[Ua.KHR_TEXTURE_TRANSFORM]){var Q=void 0!==F.extensions?F.extensions[Ua.KHR_TEXTURE_TRANSFORM]:void 0;if(Q){var U=y.associations.get(L);L=y.extensions[Ua.KHR_TEXTURE_TRANSFORM].extendTexture(L,
Q);y.associations.set(L,U)}}return v[z]=L})};rb.prototype.assignFinalMaterial=function(v){var z=v.geometry,F=v.material,y=void 0===z.attributes.tangent,L=void 0!==z.attributes.color,Q=void 0===z.attributes.normal;if(v.isPoints){var U="PointsMaterial:"+F.uuid,X=this.cache.get(U);X||(X=new THREE.PointsMaterial,THREE.Material.prototype.copy.call(X,F),X.color.copy(F.color),X.map=F.map,X.sizeAttenuation=!1,this.cache.add(U,X));F=X}else v.isLine&&(U="LineBasicMaterial:"+F.uuid,X=this.cache.get(U),X||(X=
new THREE.LineBasicMaterial,THREE.Material.prototype.copy.call(X,F),X.color.copy(F.color),this.cache.add(U,X)),F=X);if(y||L||Q)U="ClonedMaterial:"+F.uuid+":",F.isGLTFSpecularGlossinessMaterial&&(U+="specular-glossiness:"),y&&(U+="derivative-tangents:"),L&&(U+="vertex-colors:"),Q&&(U+="flat-shading:"),X=this.cache.get(U),X||(X=F.clone(),L&&(X.vertexColors=!0),Q&&(X.flatShading=!0),y&&(X.normalScale&&(X.normalScale.y*=-1),X.clearcoatNormalScale&&(X.clearcoatNormalScale.y*=-1)),this.cache.add(U,X),this.associations.set(X,
this.associations.get(F))),F=X;F.aoMap&&void 0===z.attributes.uv2&&void 0!==z.attributes.uv&&z.setAttribute("uv2",z.attributes.uv);v.material=F};rb.prototype.getMaterialType=function(){return THREE.MeshStandardMaterial};rb.prototype.loadMaterial=function(v){var z=this,F=this.extensions,y=this.json.materials[v],L={},Q=y.extensions||{},U=[];if(Q[Ua.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS]){Q=F[Ua.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS];var X=Q.getMaterialType();U.push(Q.extendParams(L,y,z))}else if(Q[Ua.KHR_MATERIALS_UNLIT])Q=
F[Ua.KHR_MATERIALS_UNLIT],X=Q.getMaterialType(),U.push(Q.extendParams(L,y,z));else{Q=y.pbrMetallicRoughness||{};L.color=new THREE.Color(1,1,1);L.opacity=1;if(Array.isArray(Q.baseColorFactor)){var ta=Q.baseColorFactor;L.color.fromArray(ta);L.opacity=ta[3]}void 0!==Q.baseColorTexture&&U.push(z.assignTexture(L,"map",Q.baseColorTexture));L.metalness=void 0!==Q.metallicFactor?Q.metallicFactor:1;L.roughness=void 0!==Q.roughnessFactor?Q.roughnessFactor:1;void 0!==Q.metallicRoughnessTexture&&(U.push(z.assignTexture(L,
"metalnessMap",Q.metallicRoughnessTexture)),U.push(z.assignTexture(L,"roughnessMap",Q.metallicRoughnessTexture)));X=this._invokeOne(function(pa){return pa.getMaterialType&&pa.getMaterialType(v)});U.push(Promise.all(this._invokeAll(function(pa){return pa.extendMaterialParams&&pa.extendMaterialParams(v,L)})))}!0===y.doubleSided&&(L.side=THREE.DoubleSide);Q=y.alphaMode||"OPAQUE";"BLEND"===Q?(L.transparent=!0,L.depthWrite=!1):(L.format=THREE.RGBFormat,L.transparent=!1,"MASK"===Q&&(L.alphaTest=void 0!==
y.alphaCutoff?y.alphaCutoff:.5));void 0!==y.normalTexture&&X!==THREE.MeshBasicMaterial&&(U.push(z.assignTexture(L,"normalMap",y.normalTexture)),L.normalScale=new THREE.Vector2(1,1),void 0!==y.normalTexture.scale&&(Q=y.normalTexture.scale,L.normalScale.set(Q,Q)));void 0!==y.occlusionTexture&&X!==THREE.MeshBasicMaterial&&(U.push(z.assignTexture(L,"aoMap",y.occlusionTexture)),void 0!==y.occlusionTexture.strength&&(L.aoMapIntensity=y.occlusionTexture.strength));void 0!==y.emissiveFactor&&X!==THREE.MeshBasicMaterial&&
(L.emissive=(new THREE.Color).fromArray(y.emissiveFactor));void 0!==y.emissiveTexture&&X!==THREE.MeshBasicMaterial&&U.push(z.assignTexture(L,"emissiveMap",y.emissiveTexture));return Promise.all(U).then(function(){var pa=X===cd?F[Ua.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].createMaterial(L):new X(L);y.name&&(pa.name=y.name);pa.map&&(pa.map.encoding=THREE.sRGBEncoding);pa.emissiveMap&&(pa.emissiveMap.encoding=THREE.sRGBEncoding);fa(pa,y);z.associations.set(pa,{materials:v});y.extensions&&R(F,pa,y);return pa})};
rb.prototype.createUniqueName=function(v){for(var z=v=THREE.PropertyBinding.sanitizeNodeName(v||""),F=1;this.nodeNamesUsed[z];++F)z=v+"_"+F;this.nodeNamesUsed[z]=!0;return z};rb.prototype.loadGeometries=function(v){function z(Ya){return y[Ua.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(Ya,F).then(function($a){return xa($a,Ya,F)})}for(var F=this,y=this.extensions,L=this.primitiveCache,Q=[],U=0,X=v.length;U<X;U++){var ta=v[U],pa=cb(ta),Ea=L[pa];Ea?Q.push(Ea.promise):(Ea=void 0,Ea=ta.extensions&&ta.extensions[Ua.KHR_DRACO_MESH_COMPRESSION]?
z(ta):xa(new THREE.BufferGeometry,ta,F),L[pa]={primitive:ta,promise:Ea},Q.push(Ea))}return Promise.all(Q)};rb.prototype.loadMesh=function(v){for(var z=this,F=this.extensions,y=this.json.meshes[v],L=y.primitives,Q=[],U=0,X=L.length;U<X;U++){var ta=void 0===L[U].material?N(this.cache):this.getDependency("material",L[U].material);Q.push(ta)}Q.push(z.loadGeometries(L));return Promise.all(Q).then(function(pa){var Ea=pa.slice(0,pa.length-1),Ya=pa[pa.length-1];pa=[];for(var $a=0,nb=Ya.length;$a<nb;$a++){var gb=
Ya[$a],Lb=L[$a],Mb=Ea[$a];if(4===Lb.mode||5===Lb.mode||6===Lb.mode||void 0===Lb.mode)gb=!0===y.isSkinnedMesh?new THREE.SkinnedMesh(gb,Mb):new THREE.Mesh(gb,Mb),!0!==gb.isSkinnedMesh||gb.geometry.attributes.skinWeight.normalized||gb.normalizeSkinWeights(),5===Lb.mode?gb.geometry=bb(gb.geometry,THREE.TriangleStripDrawMode):6===Lb.mode&&(gb.geometry=bb(gb.geometry,THREE.TriangleFanDrawMode));else if(1===Lb.mode)gb=new THREE.LineSegments(gb,Mb);else if(3===Lb.mode)gb=new THREE.Line(gb,Mb);else if(2===
Lb.mode)gb=new THREE.LineLoop(gb,Mb);else if(0===Lb.mode)gb=new THREE.Points(gb,Mb);else throw Error("THREE.GLTFLoader: Primitive mode unsupported: "+Lb.mode);if(0<Object.keys(gb.geometry.morphAttributes).length){Mb=gb;Mb.updateMorphTargets();if(void 0!==y.weights)for(var rc=0,Rc=y.weights.length;rc<Rc;rc++)Mb.morphTargetInfluences[rc]=y.weights[rc];if(y.extras&&Array.isArray(y.extras.targetNames))if(rc=y.extras.targetNames,Mb.morphTargetInfluences.length===rc.length){Mb.morphTargetDictionary={};
Rc=0;for(var Sc=rc.length;Rc<Sc;Rc++)Mb.morphTargetDictionary[rc[Rc]]=Rc}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}gb.name=z.createUniqueName(y.name||"mesh_"+v);fa(gb,y);Lb.extensions&&R(F,gb,Lb);z.assignFinalMaterial(gb);pa.push(gb)}Ea=0;for(Ya=pa.length;Ea<Ya;Ea++)z.associations.set(pa[Ea],{meshes:v,primitives:Ea});if(1===pa.length)return pa[0];Ea=new THREE.Group;z.associations.set(Ea,{meshes:v});Ya=0;for($a=pa.length;Ya<$a;Ya++)Ea.add(pa[Ya]);return Ea})};
rb.prototype.loadCamera=function(v){var z;v=this.json.cameras[v];var F=v[v.type];if(F)return"perspective"===v.type?z=new THREE.PerspectiveCamera(THREE.MathUtils.radToDeg(F.yfov),F.aspectRatio||1,F.znear||1,F.zfar||2E6):"orthographic"===v.type&&(z=new THREE.OrthographicCamera(-F.xmag,F.xmag,F.ymag,-F.ymag,F.znear,F.zfar)),v.name&&(z.name=this.createUniqueName(v.name)),fa(z,v),Promise.resolve(z);console.warn("THREE.GLTFLoader: Missing camera parameters.")};rb.prototype.loadSkin=function(v){v=this.json.skins[v];
var z={joints:v.joints};return void 0===v.inverseBindMatrices?Promise.resolve(z):this.getDependency("accessor",v.inverseBindMatrices).then(function(F){z.inverseBindMatrices=F;return z})};rb.prototype.loadAnimation=function(v){for(var z=this.json.animations[v],F=[],y=[],L=[],Q=[],U=[],X=0,ta=z.channels.length;X<ta;X++){var pa=z.channels[X],Ea=z.samplers[pa.sampler];pa=pa.target;var Ya=void 0!==z.parameters?z.parameters[Ea.input]:Ea.input,$a=void 0!==z.parameters?z.parameters[Ea.output]:Ea.output;F.push(this.getDependency("node",
void 0!==pa.node?pa.node:pa.id));y.push(this.getDependency("accessor",Ya));L.push(this.getDependency("accessor",$a));Q.push(Ea);U.push(pa)}return Promise.all([Promise.all(F),Promise.all(y),Promise.all(L),Promise.all(Q),Promise.all(U)]).then(function(nb){var gb=nb[0],Lb=nb[1],Mb=nb[2],rc=nb[3];nb=nb[4];for(var Rc=[],Sc={},md=0,di=gb.length;md<di;Sc={$jscomp$loop$prop$targetNames$1772:Sc.$jscomp$loop$prop$targetNames$1772},md++){var mc=gb[md],ei=Lb[md],dd=Mb[md],Of=rc[md],Pf=nb[md];if(void 0!==mc){mc.updateMatrix();
mc.matrixAutoUpdate=!0;var Ue=void 0;switch(Id[Pf.path]){case Id.weights:Ue=THREE.NumberKeyframeTrack;break;case Id.rotation:Ue=THREE.QuaternionKeyframeTrack;break;default:Ue=THREE.VectorKeyframeTrack}var Jd=mc.name?mc.name:mc.uuid,fi=void 0!==Of.interpolation?Tg[Of.interpolation]:THREE.InterpolateLinear;Sc.$jscomp$loop$prop$targetNames$1772=[];Id[Pf.path]===Id.weights?mc.traverse(function(Qf){return function(ke){!0===ke.isMesh&&ke.morphTargetInfluences&&Qf.$jscomp$loop$prop$targetNames$1772.push(ke.name?
ke.name:ke.uuid)}}(Sc)):Sc.$jscomp$loop$prop$targetNames$1772.push(Jd);mc=dd.array;if(dd.normalized){dd=Na(mc.constructor);Jd=new Float32Array(mc.length);for(var ed=0,gi=mc.length;ed<gi;ed++)Jd[ed]=mc[ed]*dd;mc=Jd}dd=0;for(Jd=Sc.$jscomp$loop$prop$targetNames$1772.length;dd<Jd;dd++)ed=new Ue(Sc.$jscomp$loop$prop$targetNames$1772[dd]+"."+Id[Pf.path],ei.array,mc,fi),"CUBICSPLINE"===Of.interpolation&&(ed.createInterpolant=function(Qf){return new (this instanceof THREE.QuaternionKeyframeTrack?Jf:qc)(this.times,
this.values,this.getValueSize()/3,Qf)},ed.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),Rc.push(ed)}}return new THREE.AnimationClip(z.name?z.name:"animation_"+v,void 0,Rc)})};rb.prototype.createNodeMesh=function(v){var z=this,F=this.json.nodes[v];return void 0===F.mesh?null:z.getDependency("mesh",F.mesh).then(function(y){y=z._getNodeRef(z.meshCache,F.mesh,y);void 0!==F.weights&&y.traverse(function(L){if(L.isMesh)for(var Q=0,U=F.weights.length;Q<U;Q++)L.morphTargetInfluences[Q]=F.weights[Q]});
return y})};rb.prototype.loadNode=function(v){var z=this.extensions,F=this,y=this.json.nodes[v],L=y.name?F.createUniqueName(y.name):"";return function(){var Q=[],U=F._invokeOne(function(X){return X.createNodeMesh&&X.createNodeMesh(v)});U&&Q.push(U);void 0!==y.camera&&Q.push(F.getDependency("camera",y.camera).then(function(X){return F._getNodeRef(F.cameraCache,y.camera,X)}));F._invokeAll(function(X){return X.createNodeAttachment&&X.createNodeAttachment(v)}).forEach(function(X){Q.push(X)});return Promise.all(Q)}().then(function(Q){var U=
!0===y.isBone?new THREE.Bone:1<Q.length?new THREE.Group:1===Q.length?Q[0]:new THREE.Object3D;if(U!==Q[0])for(var X=0,ta=Q.length;X<ta;X++)U.add(Q[X]);y.name&&(U.userData.name=y.name,U.name=L);fa(U,y);y.extensions&&R(z,U,y);void 0!==y.matrix?(Q=new THREE.Matrix4,Q.fromArray(y.matrix),U.applyMatrix4(Q)):(void 0!==y.translation&&U.position.fromArray(y.translation),void 0!==y.rotation&&U.quaternion.fromArray(y.rotation),void 0!==y.scale&&U.scale.fromArray(y.scale));F.associations.has(U)||F.associations.set(U,
{});F.associations.get(U).nodes=v;return U})};rb.prototype.loadScene=function(v){var z=this.json,F=this.extensions;v=this.json.scenes[v];var y=this,L=new THREE.Group;v.name&&(L.name=y.createUniqueName(v.name));fa(L,v);v.extensions&&R(F,L,v);F=v.nodes||[];v=[];for(var Q=0,U=F.length;Q<U;Q++)v.push(oa(F[Q],L,z,y));return Promise.all(v).then(function(){y.associations=function(X){for(var ta=new Map,pa=$jscomp.makeIterator(y.associations),Ea=pa.next();!Ea.done;Ea=pa.next()){var Ya=$jscomp.makeIterator(Ea.value);
Ea=Ya.next().value;Ya=Ya.next().value;(Ea instanceof THREE.Material||Ea instanceof THREE.Texture)&&ta.set(Ea,Ya)}X.traverse(function($a){var nb=y.associations.get($a);null!=nb&&ta.set($a,nb)});return ta}(L);return L})};THREE.GLTFLoader=qb})();
