/*

 Copyright 2018 Observable, Inc.

 Permission to use, copy, modify, and/or distribute this software for any purpose
 with or without fee is hereby granted, provided that the above copyright notice
 and this permission notice appear in all copies.

 THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
 REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY AND
 FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
 INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM LOSS
 OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR OTHER
 TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR PERFORMANCE OF
 THIS SOFTWARE.
*/
var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.createTemplateTagFirstArg=function(g){return $jscomp.createTemplateTagFirstArgWithRaw(g,g)};$jscomp.createTemplateTagFirstArgWithRaw=function(g,m){g.raw=m;Object.freeze&&(Object.freeze(g),Object.freeze(m));return g};$jscomp.arrayIteratorImpl=function(g){var m=0;return function(){return m<g.length?{done:!1,value:g[m++]}:{done:!0}}};$jscomp.arrayIterator=function(g){return{next:$jscomp.arrayIteratorImpl(g)}};
$jscomp.makeIterator=function(g){var m=typeof Symbol!="undefined"&&Symbol.iterator&&g[Symbol.iterator];if(m)return m.call(g);if(typeof g.length=="number")return $jscomp.arrayIterator(g);throw Error(String(g)+" is not an iterable or ArrayLike");};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;$jscomp.ISOLATE_POLYFILLS=!1;$jscomp.FORCE_POLYFILL_PROMISE=!1;$jscomp.FORCE_POLYFILL_PROMISE_WHEN_NO_UNHANDLED_REJECTION=!1;
$jscomp.INSTRUMENT_ASYNC_CONTEXT=!0;$jscomp.defineProperty=$jscomp.ASSUME_ES5||typeof Object.defineProperties=="function"?Object.defineProperty:function(g,m,t){if(g==Array.prototype||g==Object.prototype)return g;g[m]=t.value;return g};
$jscomp.getGlobal=function(g){g=["object"==typeof globalThis&&globalThis,g,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var m=0;m<g.length;++m){var t=g[m];if(t&&t.Math==Math)return t}throw Error("Cannot find global object");};$jscomp.global=$jscomp.getGlobal(this);$jscomp.IS_SYMBOL_NATIVE=typeof Symbol==="function"&&typeof Symbol("x")==="symbol";$jscomp.TRUST_ES6_POLYFILLS=!$jscomp.ISOLATE_POLYFILLS||$jscomp.IS_SYMBOL_NATIVE;$jscomp.polyfills={};
$jscomp.propertyToPolyfillSymbol={};$jscomp.POLYFILL_PREFIX="$jscp$";var $jscomp$lookupPolyfilledValue=function(g,m,t){if(!t||g!=null){t=$jscomp.propertyToPolyfillSymbol[m];if(t==null)return g[m];t=g[t];return t!==void 0?t:g[m]}};$jscomp.polyfill=function(g,m,t,w){m&&($jscomp.ISOLATE_POLYFILLS?$jscomp.polyfillIsolated(g,m,t,w):$jscomp.polyfillUnisolated(g,m,t,w))};
$jscomp.polyfillUnisolated=function(g,m,t,w){t=$jscomp.global;g=g.split(".");for(w=0;w<g.length-1;w++){var z=g[w];if(!(z in t))return;t=t[z]}g=g[g.length-1];w=t[g];m=m(w);m!=w&&m!=null&&$jscomp.defineProperty(t,g,{configurable:!0,writable:!0,value:m})};
$jscomp.polyfillIsolated=function(g,m,t,w){var z=g.split(".");g=z.length===1;w=z[0];w=!g&&w in $jscomp.polyfills?$jscomp.polyfills:$jscomp.global;for(var B=0;B<z.length-1;B++){var G=z[B];if(!(G in w))return;w=w[G]}z=z[z.length-1];t=$jscomp.IS_SYMBOL_NATIVE&&t==="es6"?w[z]:null;m=m(t);m!=null&&(g?$jscomp.defineProperty($jscomp.polyfills,z,{configurable:!0,writable:!0,value:m}):m!==t&&($jscomp.propertyToPolyfillSymbol[z]===void 0&&(t=Math.random()*1E9>>>0,$jscomp.propertyToPolyfillSymbol[z]=$jscomp.IS_SYMBOL_NATIVE?
$jscomp.global.Symbol(z):$jscomp.POLYFILL_PREFIX+t+"$"+z),$jscomp.defineProperty(w,$jscomp.propertyToPolyfillSymbol[z],{configurable:!0,writable:!0,value:m})))};$jscomp.underscoreProtoCanBeSet=function(){var g={a:!0},m={};try{return m.__proto__=g,m.a}catch(t){}return!1};
$jscomp.setPrototypeOf=$jscomp.TRUST_ES6_POLYFILLS&&typeof Object.setPrototypeOf=="function"?Object.setPrototypeOf:$jscomp.underscoreProtoCanBeSet()?function(g,m){g.__proto__=m;if(g.__proto__!==m)throw new TypeError(g+" is not extensible");return g}:null;$jscomp.generator={};$jscomp.generator.ensureIteratorResultIsObject_=function(g){if(!(g instanceof Object))throw new TypeError("Iterator result "+g+" is not an object");};
$jscomp.generator.Context=function(){this.isRunning_=!1;this.yieldAllIterator_=null;this.yieldResult=void 0;this.nextAddress=1;this.finallyAddress_=this.catchAddress_=0;this.finallyContexts_=this.abruptCompletion_=null};$jscomp.generator.Context.prototype.start_=function(){if(this.isRunning_)throw new TypeError("Generator is already running");this.isRunning_=!0};$jscomp.generator.Context.prototype.stop_=function(){this.isRunning_=!1};
$jscomp.generator.Context.prototype.jumpToErrorHandler_=function(){this.nextAddress=this.catchAddress_||this.finallyAddress_};$jscomp.generator.Context.prototype.next_=function(g){this.yieldResult=g};$jscomp.generator.Context.prototype.throw_=function(g){this.abruptCompletion_={exception:g,isException:!0};this.jumpToErrorHandler_()};$jscomp.generator.Context.prototype.return=function(g){this.abruptCompletion_={return:g};this.nextAddress=this.finallyAddress_};
$jscomp.generator.Context.prototype.jumpThroughFinallyBlocks=function(g){this.abruptCompletion_={jumpTo:g};this.nextAddress=this.finallyAddress_};$jscomp.generator.Context.prototype.yield=function(g,m){this.nextAddress=m;return{value:g}};$jscomp.generator.Context.prototype.yieldAll=function(g,m){g=$jscomp.makeIterator(g);var t=g.next();$jscomp.generator.ensureIteratorResultIsObject_(t);if(t.done)this.yieldResult=t.value,this.nextAddress=m;else return this.yieldAllIterator_=g,this.yield(t.value,m)};
$jscomp.generator.Context.prototype.jumpTo=function(g){this.nextAddress=g};$jscomp.generator.Context.prototype.jumpToEnd=function(){this.nextAddress=0};$jscomp.generator.Context.prototype.setCatchFinallyBlocks=function(g,m){this.catchAddress_=g;m!=void 0&&(this.finallyAddress_=m)};$jscomp.generator.Context.prototype.setFinallyBlock=function(g){this.catchAddress_=0;this.finallyAddress_=g||0};$jscomp.generator.Context.prototype.leaveTryBlock=function(g,m){this.nextAddress=g;this.catchAddress_=m||0};
$jscomp.generator.Context.prototype.enterCatchBlock=function(g){this.catchAddress_=g||0;g=this.abruptCompletion_.exception;this.abruptCompletion_=null;return g};$jscomp.generator.Context.prototype.enterFinallyBlock=function(g,m,t){t?this.finallyContexts_[t]=this.abruptCompletion_:this.finallyContexts_=[this.abruptCompletion_];this.catchAddress_=g||0;this.finallyAddress_=m||0};
$jscomp.generator.Context.prototype.leaveFinallyBlock=function(g,m){m=this.finallyContexts_.splice(m||0)[0];if(m=this.abruptCompletion_=this.abruptCompletion_||m){if(m.isException)return this.jumpToErrorHandler_();m.jumpTo!=void 0&&this.finallyAddress_<m.jumpTo?(this.nextAddress=m.jumpTo,this.abruptCompletion_=null):this.nextAddress=this.finallyAddress_}else this.nextAddress=g};$jscomp.generator.Context.prototype.forIn=function(g){return new $jscomp.generator.Context.PropertyIterator(g)};
$jscomp.generator.Context.PropertyIterator=function(g){this.object_=g;this.properties_=[];for(var m in g)this.properties_.push(m);this.properties_.reverse()};$jscomp.generator.Context.PropertyIterator.prototype.getNext=function(){for(;this.properties_.length>0;){var g=this.properties_.pop();if(g in this.object_)return g}return null};$jscomp.generator.Engine_=function(g){this.context_=new $jscomp.generator.Context;this.program_=g};
$jscomp.generator.Engine_.prototype.next_=function(g){this.context_.start_();if(this.context_.yieldAllIterator_)return this.yieldAllStep_(this.context_.yieldAllIterator_.next,g,this.context_.next_);this.context_.next_(g);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.return_=function(g){this.context_.start_();var m=this.context_.yieldAllIterator_;if(m)return this.yieldAllStep_("return"in m?m["return"]:function(t){return{value:t,done:!0}},g,this.context_.return);this.context_.return(g);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.throw_=function(g){this.context_.start_();if(this.context_.yieldAllIterator_)return this.yieldAllStep_(this.context_.yieldAllIterator_["throw"],g,this.context_.next_);this.context_.throw_(g);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.yieldAllStep_=function(g,m,t){try{var w=g.call(this.context_.yieldAllIterator_,m);$jscomp.generator.ensureIteratorResultIsObject_(w);if(!w.done)return this.context_.stop_(),w;var z=w.value}catch(B){return this.context_.yieldAllIterator_=null,this.context_.throw_(B),this.nextStep_()}this.context_.yieldAllIterator_=null;t.call(this.context_,z);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.nextStep_=function(){for(;this.context_.nextAddress;)try{var g=this.program_(this.context_);if(g)return this.context_.stop_(),{value:g.value,done:!1}}catch(m){this.context_.yieldResult=void 0,this.context_.throw_(m)}this.context_.stop_();if(this.context_.abruptCompletion_){g=this.context_.abruptCompletion_;this.context_.abruptCompletion_=null;if(g.isException)throw g.exception;return{value:g.return,done:!0}}return{value:void 0,done:!0}};
$jscomp.generator.Generator_=function(g){this.next=function(m){return g.next_(m)};this.throw=function(m){return g.throw_(m)};this.return=function(m){return g.return_(m)};this[Symbol.iterator]=function(){return this}};$jscomp.generator.createGenerator=function(g,m){m=new $jscomp.generator.Generator_(new $jscomp.generator.Engine_(m));$jscomp.setPrototypeOf&&g.prototype&&$jscomp.setPrototypeOf(m,g.prototype);return m};$jscomp.asyncContextEnter=function(g){return $jscomp.asyncContextIdentity};
$jscomp.asyncContextIdentity=function(g){return g};$jscomp.initSymbol=function(){};
$jscomp.polyfill("Symbol",function(g){if(g)return g;var m=function(B,G){this.$jscomp$symbol$id_=B;$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:G})};m.prototype.toString=function(){return this.$jscomp$symbol$id_};var t="jscomp_symbol_"+(Math.random()*1E9>>>0)+"_",w=0,z=function(B){if(this instanceof z)throw new TypeError("Symbol is not a constructor");return new m(t+(B||"")+"_"+w++,B)};return z},"es6","es3");
$jscomp.polyfill("Symbol.iterator",function(g){if(g)return g;g=Symbol("Symbol.iterator");for(var m="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),t=0;t<m.length;t++){var w=$jscomp.global[m[t]];typeof w==="function"&&typeof w.prototype[g]!="function"&&$jscomp.defineProperty(w.prototype,g,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}})}return g},"es6",
"es3");$jscomp.iteratorPrototype=function(g){g={next:g};g[Symbol.iterator]=function(){return this};return g};$jscomp.polyfill("Array.prototype.fill",function(g){return g?g:function(m,t,w){var z=this.length||0;t<0&&(t=Math.max(0,z+t));if(w==null||w>z)w=z;w=Number(w);w<0&&(w=Math.max(0,z+w));for(t=Number(t||0);t<w;t++)this[t]=m;return this}},"es6","es3");$jscomp.typedArrayFill=function(g){return g?g:Array.prototype.fill};$jscomp.polyfill("Int8Array.prototype.fill",$jscomp.typedArrayFill,"es6","es5");
$jscomp.polyfill("Uint8Array.prototype.fill",$jscomp.typedArrayFill,"es6","es5");$jscomp.polyfill("Uint8ClampedArray.prototype.fill",$jscomp.typedArrayFill,"es6","es5");$jscomp.polyfill("Int16Array.prototype.fill",$jscomp.typedArrayFill,"es6","es5");$jscomp.polyfill("Uint16Array.prototype.fill",$jscomp.typedArrayFill,"es6","es5");$jscomp.polyfill("Int32Array.prototype.fill",$jscomp.typedArrayFill,"es6","es5");$jscomp.polyfill("Uint32Array.prototype.fill",$jscomp.typedArrayFill,"es6","es5");
$jscomp.polyfill("Float32Array.prototype.fill",$jscomp.typedArrayFill,"es6","es5");$jscomp.polyfill("Float64Array.prototype.fill",$jscomp.typedArrayFill,"es6","es5");
$jscomp.polyfill("Array.from",function(g){return g?g:function(m,t,w){t=t!=null?t:function(N){return N};var z=[],B=typeof Symbol!="undefined"&&Symbol.iterator&&m[Symbol.iterator];if(typeof B=="function"){m=B.call(m);for(var G=0;!(B=m.next()).done;)z.push(t.call(w,B.value,G++))}else for(B=m.length,G=0;G<B;G++)z.push(t.call(w,m[G],G));return z}},"es6","es3");
(function(g,m){typeof exports==="object"&&typeof module!=="undefined"?m(exports):typeof define==="function"&&define.amd?define(["exports"],m):(g=g||self,m(g.d3=g.d3||{}))})(this,function(g){function m(a,b,c,d){a-=c;b-=d;return a*a+b*b}function t(a,b,c,d,e,f){d=(d-b)*(e-a);a=(c-a)*(f-b);return Math.abs(d-a)>=3.3306690738754716E-16*Math.abs(d+a)?d-a:0}function w(a,b,c,d,e,f){return(t(e,f,a,b,c,d)||t(a,b,c,d,e,f)||t(c,d,e,f,a,b))<0}function z(a,b,c,d){if(d-c<=20)for(var e=c+1;e<=d;e++){for(var f=a[e],
h=b[f],k=e-1;k>=c&&b[a[k]]>h;)a[k+1]=a[k--];a[k+1]=f}else{e=c+1;f=d;B(a,c+d>>1,e);b[a[c]]>b[a[d]]&&B(a,c,d);b[a[e]]>b[a[d]]&&B(a,e,d);b[a[c]]>b[a[e]]&&B(a,c,e);h=a[e];for(k=b[h];;){do e++;while(b[a[e]]<k);do f--;while(b[a[f]]>k);if(f<e)break;B(a,e,f)}a[c+1]=a[f];a[f]=h;d-e+1>=f-c?(z(a,b,e,d),z(a,b,c,f-1)):(z(a,b,c,f-1),z(a,b,e,d))}}function B(a,b,c){var d=a[b];a[b]=a[c];a[c]=d}function G(a){return a[0]}function N(a){return a[1]}function O(a){return a[0]}function P(a){return a[1]}function Q(a){var b=
a.triangles;a=a.coords;for(var c=0;c<b.length;c+=3){var d=2*b[c],e=2*b[c+1],f=2*b[c+2];if((a[f]-a[d])*(a[e+1]-a[d+1])-(a[e]-a[d])*(a[f+1]-a[d+1])>1E-10)return!1}return!0}function R(a,b,c){return[a+Math.sin(a+b)*c,b+Math.cos(a-b)*c]}function S(a,b,c,d){var e=$jscomp.asyncContextEnter(1);return function h(){var k,p,q,l;return $jscomp.generator.createGenerator(h,function(n){switch(n.nextAddress){case 1:e(0,1),n.setFinallyBlock(2),k=0,p=(0,$jscomp.makeIterator)(a),q=p.next();case 4:if(q.done){n.jumpTo(2);
break}l=q.value;return n.yield(e(b.call(d,l,k,a)),7);case 7:return e(n.yieldResult,1),n.yield(e(c.call(d,l,k,a)),8);case 8:e(n.yieldResult,1);++k;q=p.next();n.jumpTo(4);break;case 2:n.enterFinallyBlock(),e(),n.leaveFinallyBlock(0)}})}()}var M=new Uint32Array(512),K=function(a){var b=a.length>>1;if(b>0&&typeof a[0]!=="number")throw Error("Expected coords to contain numbers.");this.coords=a;a=Math.max(2*b-5,0);this._triangles=new Uint32Array(a*3);this._halfedges=new Int32Array(a*3);this._hashSize=Math.ceil(Math.sqrt(b));
this._hullPrev=new Uint32Array(b);this._hullNext=new Uint32Array(b);this._hullTri=new Uint32Array(b);this._hullHash=(new Int32Array(this._hashSize)).fill(-1);this._ids=new Uint32Array(b);this._dists=new Float64Array(b);this.update()};K.from=function(a,b,c){b=b===void 0?G:b;c=c===void 0?N:c;for(var d=a.length,e=new Float64Array(d*2),f=0;f<d;f++){var h=a[f];e[2*f]=b(h);e[2*f+1]=c(h)}return new K(e)};K.prototype.update=function(){for(var a,b,c=this.coords,d=this._hullPrev,e=this._hullNext,f=this._hullTri,
h=this._hullHash,k=c.length>>1,p=Infinity,q=Infinity,l=-Infinity,n=-Infinity,r=0;r<k;r++){var u=c[2*r];a=c[2*r+1];u<p&&(p=u);a<q&&(q=a);u>l&&(l=u);a>n&&(n=a);this._ids[r]=r}l=(p+l)/2;q=(q+n)/2;p=Infinity;for(n=0;n<k;n++)if(r=m(l,q,c[2*n],c[2*n+1]),r<p){var v=n;p=r}q=c[2*v];n=c[2*v+1];p=Infinity;for(l=0;l<k;l++)if(l!==v&&(r=m(q,n,c[2*l],c[2*l+1]),r<p&&r>0)){var A=l;p=r}p=c[2*A];l=c[2*A+1];a=Infinity;for(r=0;r<k;r++)if(r!==v&&r!==A){u=p-q;var C=l-n;b=c[2*r]-q;var y=c[2*r+1]-n,x=u*u+C*C,H=b*b+y*y,E=
.5/(u*y-C*b);C=(y*x-C*H)*E;u=(u*H-b*x)*E;u=C*C+u*u;if(u<a){var J=r;a=u}}r=c[2*J];u=c[2*J+1];if(a===Infinity){for(e=0;e<k;e++)this._dists[e]=c[2*e]-c[0]||c[2*e+1]-c[1];z(this._ids,this._dists,0,k-1);e=new Uint32Array(k);d=c=0;for(f=-Infinity;d<k;d++)h=this._ids[d],this._dists[h]>f&&(e[c++]=h,f=this._dists[h]);this.hull=e.subarray(0,c);this.triangles=new Uint32Array(0);this.halfedges=new Uint32Array(0)}else{w(q,n,p,l,r,u)&&(a=A,b=p,x=l,A=J,p=r,l=u,J=a,r=b,u=x);b=p-q;a=l-n;x=r-q;y=u-n;H=b*b+a*a;E=x*
x+y*y;C=.5/(b*y-a*x);a=q+(y*H-a*E)*C;b=n+(b*E-x*H)*C;this._cx=a;this._cy=b;for(x=0;x<k;x++)this._dists[x]=m(c[2*x],c[2*x+1],a,b);z(this._ids,this._dists,0,k-1);this._hullStart=v;k=3;e[v]=d[J]=A;e[A]=d[v]=J;e[J]=d[A]=v;f[v]=0;f[A]=1;f[J]=2;h.fill(-1);h[this._hashKey(q,n)]=v;h[this._hashKey(p,l)]=A;h[this._hashKey(r,u)]=J;this.trianglesLen=0;this._addTriangle(v,A,J,-1,-1,-1);q=0;for(p=n=void 0;q<this._ids.length;q++)if(l=this._ids[q],r=c[2*l],u=c[2*l+1],!(q>0&&Math.abs(r-n)<=2.220446049250313E-16&&
Math.abs(u-p)<=2.220446049250313E-16)&&(n=r,p=u,l!==v&&l!==A&&l!==J)){b=a=0;for(x=this._hashKey(r,u);b<this._hashSize&&(a=h[(x+b)%this._hashSize],a===-1||a===e[a]);b++);b=a=d[a];for(x=void 0;x=e[b],!w(r,u,c[2*b],c[2*b+1],c[2*x],c[2*x+1]);)if(b=x,b===a){b=-1;break}if(b!==-1){H=this._addTriangle(b,l,e[b],-1,-1,f[b]);f[l]=this._legalize(H+2);f[b]=H;k++;for(E=e[b];x=e[E],w(r,u,c[2*E],c[2*E+1],c[2*x],c[2*x+1]);)H=this._addTriangle(E,l,x,f[l],-1,f[E]),f[l]=this._legalize(H+2),e[E]=E,k--,E=x;if(b===a)for(;x=
d[b],w(r,u,c[2*x],c[2*x+1],c[2*b],c[2*b+1]);)H=this._addTriangle(x,l,b,-1,f[b],f[x]),this._legalize(H+2),f[x]=H,e[b]=b,k--,b=x;this._hullStart=d[l]=b;e[b]=d[E]=l;e[l]=E;h[this._hashKey(r,u)]=l;h[this._hashKey(c[2*b],c[2*b+1])]=b}}this.hull=new Uint32Array(k);c=0;for(d=this._hullStart;c<k;c++)this.hull[c]=d,d=e[d];this.triangles=this._triangles.subarray(0,this.trianglesLen);this.halfedges=this._halfedges.subarray(0,this.trianglesLen)}};K.prototype._hashKey=function(a,b){var c=Math;a-=this._cx;b-=this._cy;
a/=Math.abs(a)+Math.abs(b);return c.floor.call(c,(b>0?3-a:1+a)/4*this._hashSize)%this._hashSize};K.prototype._legalize=function(a){for(var b=this._triangles,c=this._halfedges,d=this.coords,e=0,f;;){var h=c[a],k=a-a%3;f=k+(a+2)%3;if(h===-1){if(e===0)break;a=M[--e]}else{var p=h-h%3,q=p+(h+2)%3,l=b[f],n=b[a],r=b[k+(a+1)%3];k=b[q];var u=d[2*k],v=d[2*k+1],A=d[2*l]-u,C=d[2*l+1]-v,y=d[2*n]-u;n=d[2*n+1]-v;u=d[2*r]-u;r=d[2*r+1]-v;v=y*y+n*n;var x=u*u+r*r;if(A*(n*x-v*r)-C*(y*x-v*u)+(A*A+C*C)*(y*r-n*u)<0){b[a]=
k;b[h]=l;l=c[q];if(l===-1){k=this._hullStart;do{if(this._hullTri[k]===q){this._hullTri[k]=a;break}k=this._hullPrev[k]}while(k!==this._hullStart)}this._link(a,l);this._link(h,c[f]);this._link(f,q);f=p+(h+1)%3;e<M.length&&(M[e++]=f)}else{if(e===0)break;a=M[--e]}}}return f};K.prototype._link=function(a,b){this._halfedges[a]=b;b!==-1&&(this._halfedges[b]=a)};K.prototype._addTriangle=function(a,b,c,d,e,f){var h=this.trianglesLen;this._triangles[h]=a;this._triangles[h+1]=b;this._triangles[h+2]=c;this._link(h,
d);this._link(h+1,e);this._link(h+2,f);this.trianglesLen+=3;return h};var I=function(){this._x0=this._y0=this._x1=this._y1=null;this._=""};I.prototype.moveTo=function(a,b){this._+="M"+(this._x0=this._x1=+a)+","+(this._y0=this._y1=+b)};I.prototype.closePath=function(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")};I.prototype.lineTo=function(a,b){this._+="L"+(this._x1=+a)+","+(this._y1=+b)};I.prototype.arc=function(a,b,c){a=+a;b=+b;c=+c;var d=a+c,e=b;if(c<0)throw Error("negative radius");
if(this._x1===null)this._+="M"+d+","+e;else if(Math.abs(this._x1-d)>1E-6||Math.abs(this._y1-e)>1E-6)this._+="L"+d+","+e;c&&(this._+="A"+c+","+c+",0,1,1,"+(a-c)+","+b+"A"+c+","+c+",0,1,1,"+(this._x1=d)+","+(this._y1=e))};I.prototype.rect=function(a,b,c,d){this._+="M"+(this._x0=this._x1=+a)+","+(this._y0=this._y1=+b)+"h"+ +c+"v"+ +d+"h"+-c+"Z"};I.prototype.value=function(){return this._||null};var L=function(){this._=[]};L.prototype.moveTo=function(a,b){this._.push([a,b])};L.prototype.closePath=function(){this._.push(this._[0].slice())};
L.prototype.lineTo=function(a,b){this._.push([a,b])};L.prototype.value=function(){return this._.length?this._:null};var D=function(a,b){var c=(0,$jscomp.makeIterator)(b===void 0?[0,0,960,500]:b);b=c.next().value;var d=c.next().value;var e=c.next().value;c=c.next().value;if(!((e=+e)>=(b=+b)&&(c=+c)>=(d=+d)))throw Error("invalid bounds");this.delaunay=a;this._circumcenters=new Float64Array(a.points.length*2);this.vectors=new Float64Array(a.points.length*2);this.xmax=e;this.xmin=b;this.ymax=c;this.ymin=
d;this._init()};D.prototype.update=function(){this.delaunay.update();this._init();return this};D.prototype._init=function(){var a=this.delaunay,b=a.points,c=a.hull,d=a.triangles;a=this.vectors;for(var e=this.circumcenters=this._circumcenters.subarray(0,d.length/3*2),f=0,h=0,k=d.length,p,q;f<k;f+=3,h+=2){q=d[f]*2;var l=d[f+1]*2,n=d[f+2]*2;p=b[q];q=b[q+1];var r=b[n],u=b[n+1];n=b[l]-p;var v=b[l+1]-q;l=r-p;var A=u-q,C=n*n+v*v,y=l*l+A*A,x=(n*A-v*l)*2;x?Math.abs(x)<1E-8?(p=(p+r)/2,q=(q+u)/2):(r=1/x,p+=
(A*C-v*y)*r,q+=(n*y-l*C)*r):(p=(p+r)/2-1E8*A,q=(q+u)/2+1E8*l);e[h]=p;e[h+1]=q}d=c[c.length-1];f=d*4;k=b[2*d];q=b[2*d+1];a.fill(0);for(n=0;n<c.length;++n)d=c[n],e=f,h=k,p=q,f=d*4,k=b[2*d],q=b[2*d+1],a[e+2]=a[f]=p-q,a[e+3]=a[f+1]=k-h};D.prototype.render=function(a){var b=a==null?a=new I:void 0,c=this.delaunay,d=c.halfedges,e=c.inedges;c=c.hull;var f=this.circumcenters,h=this.vectors;if(c.length<=1)return null;for(var k=0,p=d.length;k<p;++k){var q=d[k];if(!(q<k)){var l=Math.floor(k/3)*2;q=Math.floor(q/
3)*2;this._renderSegment(f[l],f[l+1],f[q],f[q+1],a)}}d=c[c.length-1];for(k=0;k<c.length;++k)q=d,d=c[k],l=Math.floor(e[d]/3)*2,p=f[l],l=f[l+1],q*=4,(q=this._project(p,l,h[q+2],h[q+3]))&&this._renderSegment(p,l,q[0],q[1],a);return b&&b.value()};D.prototype.renderBounds=function(a){var b=a==null?a=new I:void 0;a.rect(this.xmin,this.ymin,this.xmax-this.xmin,this.ymax-this.ymin);return b&&b.value()};D.prototype.renderCell=function(a,b){var c=b==null?b=new I:void 0;a=this._clip(a);if(a!==null){b.moveTo(a[0],
a[1]);for(var d=a.length;a[0]===a[d-2]&&a[1]===a[d-1]&&d>1;)d-=2;for(var e=2;e<d;e+=2)a[e]===a[e-2]&&a[e+1]===a[e-1]||b.lineTo(a[e],a[e+1]);b.closePath();return c&&c.value()}};D.prototype.cellPolygons=function(){var a=this,b=$jscomp.asyncContextEnter(1);return function d(){var e,f,h,k,p,q;return $jscomp.generator.createGenerator(d,function(l){switch(l.nextAddress){case 1:b(0,1),l.setFinallyBlock(2),e=a,f=e.delaunay,h=f.points,k=0,p=h.length/2;case 4:if(!(k<p)){l.jumpTo(2);break}q=a.cellPolygon(k);
if(!q){l.jumpTo(5);break}return l.yield(b(q),8);case 8:b(l.yieldResult,1);case 5:++k;l.jumpTo(4);break;case 2:l.enterFinallyBlock(),b(),l.leaveFinallyBlock(0)}})}()};D.prototype.cellPolygon=function(a){var b=new L;this.renderCell(a,b);return b.value()};D.prototype._renderSegment=function(a,b,c,d,e){var f=this._regioncode(a,b),h=this._regioncode(c,d);if(f===0&&h===0)e.moveTo(a,b),e.lineTo(c,d);else if(a=this._clipSegment(a,b,c,d,f,h))e.moveTo(a[0],a[1]),e.lineTo(a[2],a[3])};D.prototype.contains=function(a,
b,c){return(b=+b,b!==b)||(c=+c,c!==c)?!1:this.delaunay._step(a,b,c)===a};D.prototype.neighbors=function(a){var b=this,c=$jscomp.asyncContextEnter(1);return function e(){var f,h,k,p,q,l,n,r,u;return $jscomp.generator.createGenerator(e,function(v){switch(v.nextAddress){case 1:c(0,1);v.setFinallyBlock(2);f=b._clip(a);if(!f){v.jumpTo(2);break}h=(0,$jscomp.makeIterator)(b.delaunay.neighbors(a));k=h.next();case 5:if(k.done){v.jumpTo(2);break}p=k.value;q=b._clip(p);if(!q){v.jumpTo(6);break}l=0;n=f.length;
case 11:if(!(l<n)){v.jumpTo(6);break}r=0;u=q.length;case 12:if(!(r<u)){l+=2;v.jumpTo(11);break}if(f[l]!=q[r]||f[l+1]!=q[r+1]||f[(l+2)%n]!=q[(r+u-2)%u]||f[(l+3)%n]!=q[(r+u-1)%u]){v.jumpTo(13);break}return v.yield(c(p),16);case 16:c(v.yieldResult,1);v.jumpTo(6);break;case 13:r+=2;v.jumpTo(12);break;case 6:k=h.next();v.jumpTo(5);break;case 2:v.enterFinallyBlock(),c(),v.leaveFinallyBlock(0)}})}()};D.prototype._cell=function(a){var b=this.circumcenters,c=this.delaunay,d=c.halfedges,e=c.triangles;c=c.inedges[a];
if(c===-1)return null;var f=[],h=c;do{var k=Math.floor(h/3);f.push(b[k*2],b[k*2+1]);h=h%3===2?h-2:h+1;if(e[h]!==a)break;h=d[h]}while(h!==c&&h!==-1);return f};D.prototype._clip=function(a){if(a===0&&this.delaunay.hull.length===1)return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];var b=this._cell(a);if(b===null)return null;var c=this.vectors,d=a*4;return c[d]||c[d+1]?this._clipInfinite(a,b,c[d],c[d+1],c[d+2],c[d+3]):this._clipFinite(a,b)};D.prototype._clipFinite=
function(a,b){for(var c=b.length,d=null,e,f,h=b[c-2],k=b[c-1],p,q=this._regioncode(h,k),l,n,r=0;r<c;r+=2)if(e=h,f=k,h=b[r],k=b[r+1],p=q,q=this._regioncode(h,k),p===0&&q===0)n=0,d?d.push(h,k):d=[h,k];else{if(p===0){if((e=this._clipSegment(e,f,h,k,p,q))===null)continue;f=(0,$jscomp.makeIterator)(e);f.next();f.next();e=f.next().value;p=f.next().value}else{if((e=this._clipSegment(h,k,e,f,q,p))===null)continue;l=(0,$jscomp.makeIterator)(e);e=l.next().value;p=l.next().value;f=l.next().value;var u=l.next().value;
l=n;n=this._edgecode(f,u);l&&n&&this._edge(a,l,n,d,d.length);d?d.push(f,u):d=[f,u]}l=n;n=this._edgecode(e,p);l&&n&&this._edge(a,l,n,d,d.length);d?d.push(e,p):d=[e,p]}if(d)l=n,n=this._edgecode(d[0],d[1]),l&&n&&this._edge(a,l,n,d,d.length);else if(this.contains(a,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2))return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];return d};D.prototype._clipSegment=function(a,b,c,d,e,f){for(;;){if(e===0&&f===0)return[a,b,c,d];if(e&
f)return null;var h=e||f;if(h&8){h=a+(c-a)*(this.ymax-b)/(d-b);var k=this.ymax}else h&4?(h=a+(c-a)*(this.ymin-b)/(d-b),k=this.ymin):h&2?(k=b+(d-b)*(this.xmax-a)/(c-a),h=this.xmax):(k=b+(d-b)*(this.xmin-a)/(c-a),h=this.xmin);e?(a=h,b=k,e=this._regioncode(a,b)):(c=h,d=k,f=this._regioncode(c,d))}};D.prototype._clipInfinite=function(a,b,c,d,e,f){b=Array.from(b);var h;(h=this._project(b[0],b[1],c,d))&&b.unshift(h[0],h[1]);(h=this._project(b[b.length-2],b[b.length-1],e,f))&&b.push(h[0],h[1]);if(b=this._clipFinite(a,
b))for(c=0,d=b.length,f=this._edgecode(b[d-2],b[d-1]);c<d;c+=2)e=f,f=this._edgecode(b[c],b[c+1]),e&&f&&(c=this._edge(a,e,f,b,c),d=b.length);else this.contains(a,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2)&&(b=[this.xmin,this.ymin,this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax]);return b};D.prototype._edge=function(a,b,c,d,e){for(;b!==c;){var f=void 0,h=void 0;switch(b){case 5:b=4;continue;case 4:b=6;f=this.xmax;h=this.ymin;break;case 6:b=2;continue;case 2:b=10;f=this.xmax;h=this.ymax;
break;case 10:b=8;continue;case 8:b=9;f=this.xmin;h=this.ymax;break;case 9:b=1;continue;case 1:b=5,f=this.xmin,h=this.ymin}d[e]===f&&d[e+1]===h||!this.contains(a,f,h)||(d.splice(e,0,f,h),e+=2)}if(d.length>4)for(a=0;a<d.length;a+=2)if(b=(a+2)%d.length,c=(a+4)%d.length,d[a]===d[b]&&d[b]===d[c]||d[a+1]===d[b+1]&&d[b+1]===d[c+1])d.splice(b,2),a-=2;return e};D.prototype._project=function(a,b,c,d){var e=Infinity,f;if(d<0){if(b<=this.ymin)return null;if((f=(this.ymin-b)/d)<e){var h=this.ymin;var k=a+(e=
f)*c}}else if(d>0){if(b>=this.ymax)return null;(f=(this.ymax-b)/d)<e&&(h=this.ymax,k=a+(e=f)*c)}if(c>0){if(a>=this.xmax)return null;(f=(this.xmax-a)/c)<e&&(k=this.xmax,h=b+f*d)}else if(c<0){if(a<=this.xmin)return null;(f=(this.xmin-a)/c)<e&&(k=this.xmin,h=b+f*d)}return[k,h]};D.prototype._edgecode=function(a,b){return(a===this.xmin?1:a===this.xmax?2:0)|(b===this.ymin?4:b===this.ymax?8:0)};D.prototype._regioncode=function(a,b){return(a<this.xmin?1:a>this.xmax?2:0)|(b<this.ymin?4:b>this.ymax?8:0)};var T=
2*Math.PI,F=function(a){this._delaunator=new K(a);this.inedges=new Int32Array(a.length/2);this._hullIndex=new Int32Array(a.length/2);this.points=this._delaunator.coords;this._init()};F.from=function(a,b,c,d){b=b===void 0?O:b;c=c===void 0?P:c;if("length"in a){for(var e=a.length,f=new Float64Array(e*2),h=0;h<e;++h){var k=a[h];f[h*2]=b.call(d,k,h,a);f[h*2+1]=c.call(d,k,h,a)}a=f}else a=Float64Array.from(S(a,b,c,d));return new F(a)};F.prototype.update=function(){this._delaunator.update();this._init();
return this};F.prototype._init=function(){var a=this._delaunator,b=this.points;if(a.hull&&a.hull.length>2&&Q(a)){this.collinear=Int32Array.from({length:b.length/2},function(q,l){return l}).sort(function(q,l){return b[2*q]-b[2*l]||b[2*q+1]-b[2*l+1]});a=this.collinear[0];var c=this.collinear[this.collinear.length-1];a=[b[2*a],b[2*a+1],b[2*c],b[2*c+1]];a=1E-8*Math.sqrt(Math.pow(a[3]-a[1],2)+Math.pow(a[2]-a[0],2));c=0;for(var d=b.length/2;c<d;++c){var e=R(b[2*c],b[2*c+1],a);b[2*c]=e[0];b[2*c+1]=e[1]}this._delaunator=
new K(b)}else delete this.collinear;e=this.halfedges=this._delaunator.halfedges;a=this.hull=this._delaunator.hull;var f=this.triangles=this._delaunator.triangles;c=this.inedges.fill(-1);d=this._hullIndex.fill(-1);for(var h=0,k=e.length;h<k;++h){var p=f[h%3===2?h-2:h+1];if(e[h]===-1||c[p]===-1)c[p]=h}e=0;for(f=a.length;e<f;++e)d[a[e]]=e;a.length<=2&&a.length>0&&(this.triangles=(new Int32Array(3)).fill(-1),this.halfedges=(new Int32Array(3)).fill(-1),this.triangles[0]=a[0],this.triangles[1]=a[1],this.triangles[2]=
a[1],c[a[0]]=1,a.length===2&&(c[a[1]]=0))};F.prototype.voronoi=function(a){return new D(this,a)};F.prototype.neighbors=function(a){var b=this,c=$jscomp.asyncContextEnter(1);return function e(){var f,h,k,p,q,l,n,r,u,v,A,C;return $jscomp.generator.createGenerator(e,function(y){switch(y.nextAddress){case 1:c(0,1);y.setFinallyBlock(2);f=b;h=f.inedges;k=f.hull;p=f._hullIndex;q=f.halfedges;l=f.triangles;n=f.collinear;if(!n){y.jumpTo(4);break}r=n.indexOf(a);if(!(r>0)){y.jumpTo(5);break}return y.yield(c(n[r-
1]),6);case 6:c(y.yieldResult,1);case 5:if(!(r<n.length-1)){y.jumpTo(7);break}return y.yield(c(n[r+1]),8);case 8:c(y.yieldResult,1);case 7:return y.return();case 4:u=h[a];if(u===-1)return y.return();v=u;A=-1;case 9:return y.yield(c(A=l[v]),12);case 12:c(y.yieldResult,1);v=v%3===2?v-2:v+1;if(l[v]!==a)return y.return();v=q[v];if(v!==-1){y.jumpTo(11);break}C=k[(p[a]+1)%k.length];if(C===A){y.jumpTo(14);break}return y.yield(c(C),15);case 15:c(y.yieldResult,1);case 14:return y.return();case 11:if(v!==u){y.jumpTo(9);
break}case 2:y.enterFinallyBlock(),c(),y.leaveFinallyBlock(0)}})}()};F.prototype.find=function(a,b,c){c=c===void 0?0:c;if((a=+a,a!==a)||(b=+b,b!==b))return-1;for(var d=c,e;(e=this._step(c,a,b))>=0&&e!==c&&e!==d;)c=e;return e};F.prototype._step=function(a,b,c){var d=this.inedges,e=this.hull,f=this._hullIndex,h=this.halfedges,k=this.triangles,p=this.points;if(d[a]===-1||!p.length)return(a+1)%(p.length>>1);var q=a,l=Math.pow(b-p[a*2],2)+Math.pow(c-p[a*2+1],2),n=d=d[a];do{var r=k[n],u=Math.pow(b-p[r*
2],2)+Math.pow(c-p[r*2+1],2);u<l&&(l=u,q=r);n=n%3===2?n-2:n+1;if(k[n]!==a)break;n=h[n];if(n===-1){n=e[(f[a]+1)%e.length];if(n!==r&&Math.pow(b-p[n*2],2)+Math.pow(c-p[n*2+1],2)<l)return n;break}}while(n!==d);return q};F.prototype.render=function(a){for(var b=a==null?a=new I:void 0,c=this.points,d=this.halfedges,e=this.triangles,f=0,h=d.length;f<h;++f){var k=d[f];if(!(k<f)){var p=e[f]*2;k=e[k]*2;a.moveTo(c[p],c[p+1]);a.lineTo(c[k],c[k+1])}}this.renderHull(a);return b&&b.value()};F.prototype.renderPoints=
function(a,b){b=b===void 0?2:b;for(var c=a==null?a=new I:void 0,d=this.points,e=0,f=d.length;e<f;e+=2){var h=d[e],k=d[e+1];a.moveTo(h+b,k);a.arc(h,k,b,0,T)}return c&&c.value()};F.prototype.renderHull=function(a){var b=a==null?a=new I:void 0,c=this.hull,d=this.points,e=c[0]*2,f=c.length;a.moveTo(d[e],d[e+1]);for(e=1;e<f;++e){var h=2*c[e];a.lineTo(d[h],d[h+1])}a.closePath();return b&&b.value()};F.prototype.hullPolygon=function(){var a=new L;this.renderHull(a);return a.value()};F.prototype.renderTriangle=
function(a,b){var c=b==null?b=new I:void 0,d=this.points,e=this.triangles,f=e[a*=3]*2,h=e[a+1]*2;a=e[a+2]*2;b.moveTo(d[f],d[f+1]);b.lineTo(d[h],d[h+1]);b.lineTo(d[a],d[a+1]);b.closePath();return c&&c.value()};F.prototype.trianglePolygons=function(){var a=this,b=$jscomp.asyncContextEnter(1);return function d(){var e,f,h,k;return $jscomp.generator.createGenerator(d,function(p){switch(p.nextAddress){case 1:b(0,1),p.setFinallyBlock(2),e=a,f=e.triangles,h=0,k=f.length/3;case 4:if(!(h<k)){p.jumpTo(2);break}return p.yield(b(a.trianglePolygon(h)),
7);case 7:b(p.yieldResult,1);++h;p.jumpTo(4);break;case 2:p.enterFinallyBlock(),b(),p.leaveFinallyBlock(0)}})}()};F.prototype.trianglePolygon=function(a){var b=new L;this.renderTriangle(a,b);return b.value()};g.Delaunay=F;g.Voronoi=D;Object.defineProperty(g,"__esModule",{value:!0})});
